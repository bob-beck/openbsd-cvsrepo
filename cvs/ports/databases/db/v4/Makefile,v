head	1.71;
access;
symbols
	OPENBSD_6_1:1.67.0.4
	OPENBSD_6_1_BASE:1.67
	OPENBSD_6_0:1.67.0.2
	OPENBSD_6_0_BASE:1.67
	OPENBSD_5_9:1.65.0.2
	OPENBSD_5_9_BASE:1.65
	OPENBSD_5_8:1.64.0.4
	OPENBSD_5_8_BASE:1.64
	OPENBSD_5_7:1.62.0.4
	OPENBSD_5_7_BASE:1.62
	OPENBSD_5_6:1.62.0.2
	OPENBSD_5_6_BASE:1.62
	OPENBSD_5_5:1.61.0.4
	OPENBSD_5_5_BASE:1.61
	OPENBSD_5_4:1.61.0.2
	OPENBSD_5_4_BASE:1.61
	OPENBSD_5_3:1.60.0.4
	OPENBSD_5_3_BASE:1.60
	OPENBSD_5_2:1.60.0.2
	OPENBSD_5_2_BASE:1.60
	OPENBSD_5_1_BASE:1.57
	OPENBSD_5_1:1.57.0.2
	OPENBSD_5_0:1.47.0.4
	OPENBSD_5_0_BASE:1.47
	OPENBSD_4_9:1.47.0.2
	OPENBSD_4_9_BASE:1.47
	OPENBSD_4_8:1.39.0.2
	OPENBSD_4_8_BASE:1.39
	OPENBSD_4_7:1.38.0.2
	OPENBSD_4_7_BASE:1.38
	OPENBSD_4_6:1.37.0.2
	OPENBSD_4_6_BASE:1.37
	OPENBSD_4_5:1.34.0.2
	OPENBSD_4_5_BASE:1.34
	OPENBSD_4_4:1.33.0.2
	OPENBSD_4_4_BASE:1.33
	OPENBSD_4_3:1.32.0.2
	OPENBSD_4_3_BASE:1.32
	OPENBSD_4_2:1.29.0.4
	OPENBSD_4_2_BASE:1.29
	OPENBSD_4_1:1.29.0.2
	OPENBSD_4_1_BASE:1.29
	OPENBSD_4_0:1.19.0.4
	OPENBSD_4_0_BASE:1.19
	OPENBSD_3_9:1.19.0.2
	OPENBSD_3_9_BASE:1.19
	OPENBSD_3_8:1.13.0.4
	OPENBSD_3_8_BASE:1.13
	OPENBSD_3_7:1.13.0.2
	OPENBSD_3_7_BASE:1.13
	OPENBSD_3_6:1.9.0.2
	OPENBSD_3_6_BASE:1.9
	OPENBSD_3_5:1.8.0.2
	OPENBSD_3_5_BASE:1.8
	sturm_2003-Dec-08:1.1.1.1
	sturm:1.1.1;
locks; strict;
comment	@# @;


1.71
date	2017.07.23.09.26.26;	author espie;	state Exp;
branches;
next	1.70;
commitid	FZPR2Emws5uDqXzb;

1.70
date	2017.07.16.19.18.49;	author espie;	state Exp;
branches;
next	1.69;
commitid	tt0GhWK5c4uf9ILG;

1.69
date	2017.04.21.13.27.46;	author kurt;	state Exp;
branches;
next	1.68;
commitid	lfz5IYSiUvvvq1Ub;

1.68
date	2017.04.10.11.45.24;	author sthen;	state Exp;
branches;
next	1.67;
commitid	XDh1zlSBq0boKsHk;

1.67
date	2016.06.29.16.14.38;	author espie;	state Exp;
branches;
next	1.66;
commitid	c1yQMbJbfo0CFBcL;

1.66
date	2016.03.12.16.45.57;	author naddy;	state Exp;
branches;
next	1.65;
commitid	cP79RvEDMQwHyvef;

1.65
date	2015.12.03.21.24.29;	author sthen;	state Exp;
branches;
next	1.64;
commitid	qh8BBe4z9PLvLPKf;

1.64
date	2015.06.13.08.35.18;	author ajacoutot;	state Exp;
branches;
next	1.63;
commitid	xMTz3ff5wnOINcta;

1.63
date	2015.03.19.20.25.26;	author naddy;	state Exp;
branches;
next	1.62;
commitid	zN8twHQGaJf3YJpT;

1.62
date	2014.05.07.15.42.15;	author kurt;	state Exp;
branches;
next	1.61;

1.61
date	2013.07.05.12.03.52;	author espie;	state Exp;
branches;
next	1.60;

1.60
date	2012.03.09.12.59.25;	author espie;	state Exp;
branches;
next	1.59;

1.59
date	2012.02.20.02.31.40;	author espie;	state Exp;
branches;
next	1.58;

1.58
date	2012.02.19.22.07.51;	author espie;	state Exp;
branches;
next	1.57;

1.57
date	2012.01.25.11.32.34;	author ajacoutot;	state Exp;
branches;
next	1.56;

1.56
date	2011.10.18.06.46.24;	author espie;	state Exp;
branches;
next	1.55;

1.55
date	2011.10.17.10.10.59;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	2011.10.07.13.54.30;	author kurt;	state Exp;
branches;
next	1.53;

1.53
date	2011.09.16.08.48.02;	author espie;	state Exp;
branches;
next	1.52;

1.52
date	2011.09.14.19.12.18;	author naddy;	state Exp;
branches;
next	1.51;

1.51
date	2011.09.12.18.02.34;	author naddy;	state Exp;
branches;
next	1.50;

1.50
date	2011.09.12.10.16.57;	author espie;	state Exp;
branches;
next	1.49;

1.49
date	2011.09.11.21.17.09;	author naddy;	state Exp;
branches;
next	1.48;

1.48
date	2011.08.30.17.16.35;	author jasper;	state Exp;
branches;
next	1.47;

1.47
date	2010.11.26.14.44.27;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2010.11.15.00.22.51;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	2010.11.12.08.06.42;	author sthen;	state Exp;
branches;
next	1.44;

1.44
date	2010.10.30.23.14.15;	author steven;	state Exp;
branches;
next	1.43;

1.43
date	2010.10.28.22.20.59;	author jasper;	state Exp;
branches;
next	1.42;

1.42
date	2010.10.28.09.10.54;	author steven;	state Exp;
branches;
next	1.41;

1.41
date	2010.08.25.23.06.00;	author sthen;	state Exp;
branches;
next	1.40;

1.40
date	2010.08.25.20.27.16;	author sthen;	state Exp;
branches;
next	1.39;

1.39
date	2010.07.10.20.06.54;	author naddy;	state Exp;
branches;
next	1.38;

1.38
date	2009.11.09.11.03.26;	author sthen;	state Exp;
branches;
next	1.37;

1.37
date	2009.04.26.09.38.25;	author sthen;	state Exp;
branches;
next	1.36;

1.36
date	2009.04.14.19.49.04;	author sthen;	state Exp;
branches;
next	1.35;

1.35
date	2009.03.11.21.28.45;	author bernd;	state Exp;
branches;
next	1.34;

1.34
date	2008.10.28.11.53.33;	author steven;	state Exp;
branches;
next	1.33;

1.33
date	2008.06.24.02.46.21;	author kurt;	state Exp;
branches;
next	1.32;

1.32
date	2008.02.14.21.51.31;	author kurt;	state Exp;
branches;
next	1.31;

1.31
date	2007.10.26.14.06.02;	author steven;	state Exp;
branches;
next	1.30;

1.30
date	2007.09.15.22.27.39;	author simon;	state Exp;
branches;
next	1.29;

1.29
date	2007.01.16.02.48.02;	author kurt;	state Exp;
branches;
next	1.28;

1.28
date	2006.11.25.22.54.28;	author steven;	state Exp;
branches;
next	1.27;

1.27
date	2006.11.15.17.23.27;	author kurt;	state Exp;
branches;
next	1.26;

1.26
date	2006.11.04.12.27.19;	author kurt;	state Exp;
branches;
next	1.25;

1.25
date	2006.11.03.04.50.39;	author kurt;	state Exp;
branches;
next	1.24;

1.24
date	2006.11.02.15.04.39;	author kurt;	state Exp;
branches;
next	1.23;

1.23
date	2006.11.02.12.26.37;	author bernd;	state Exp;
branches;
next	1.22;

1.22
date	2006.11.01.22.26.28;	author kurt;	state Exp;
branches;
next	1.21;

1.21
date	2006.10.28.11.19.20;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2006.10.18.11.05.55;	author steven;	state Exp;
branches;
next	1.19;

1.19
date	2006.01.17.14.25.32;	author naddy;	state Exp;
branches;
next	1.18;

1.18
date	2005.12.25.20.35.42;	author sturm;	state Exp;
branches;
next	1.17;

1.17
date	2005.11.03.23.12.45;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2005.11.01.15.44.24;	author bernd;	state Exp;
branches;
next	1.15;

1.15
date	2005.10.16.00.11.00;	author brad;	state Exp;
branches;
next	1.14;

1.14
date	2005.09.16.09.51.26;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2005.01.23.10.30.03;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2005.01.23.10.28.07;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2005.01.12.21.31.06;	author sturm;	state Exp;
branches;
next	1.10;

1.10
date	2004.11.22.16.59.29;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2004.05.27.21.05.25;	author pvalchev;	state Exp;
branches;
next	1.8;

1.8
date	2004.03.07.18.55.21;	author wilfried;	state Exp;
branches
	1.8.2.1;
next	1.7;

1.7
date	2004.02.27.01.10.03;	author brad;	state Exp;
branches;
next	1.6;

1.6
date	2004.02.24.00.06.43;	author naddy;	state Exp;
branches;
next	1.5;

1.5
date	2004.01.14.19.50.15;	author sturm;	state Exp;
branches;
next	1.4;

1.4
date	2004.01.10.08.36.28;	author sturm;	state Exp;
branches;
next	1.3;

1.3
date	2003.12.11.06.49.17;	author sturm;	state Exp;
branches;
next	1.2;

1.2
date	2003.12.10.18.03.00;	author sturm;	state Exp;
branches;
next	1.1;

1.1
date	2003.12.08.17.37.52;	author sturm;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.12.08.17.37.52;	author sturm;	state Exp;
branches;
next	;

1.8.2.1
date	2004.05.28.21.42.30;	author brad;	state Exp;
branches;
next	;


desc
@@


1.71
log
@add pthread to COMPILER_LIBCXX.
white lie, but it allows clang and gcc to be more similar
bump accordingly.
@
text
@# $OpenBSD: Makefile,v 1.70 2017/07/16 19:18:49 espie Exp $

COMMENT-java=	Java bindings for Berkeley DB, revision ${REV}

REV=		4
VERSION=	${REV}.6.21
PKGNAME-main=	${DISTNAME}
PKGSPEC-main =	db->=4,<5|db->=4v0,<5v0
PKGSPEC-java =  db-java->=4,<5|db-java->=4v0,<5v0
PKGSPEC-tcl =   db-tcl->=4,<5|db-tcl->=4v0,<5v0

PKGNAME-java=	db-java-${VERSION}
PKGNAME-tcl=	db-tcl-${VERSION}
EPOCH-main=	0
REVISION-main = 4
EPOCH-java=	0
EPOCH-tcl=	0
REVISION-java =	5
REVISION-tcl =	1
DBLIBDIR=	lib/db4

# XXX LIBdb_VERSION is used by x11/gnome/libgda
SHARED_LIBS +=	db                   5.0      # .0.0
SHARED_LIBS +=	db_cxx               6.0      # .0.0
SHARED_LIBS +=	db_java              5.0      # .0.0
SHARED_LIBS +=	db_tcl               6.0      # .0.0

MASTER_SITES0=	${HOMEPAGE}db/update/${VERSION}/
# patch 2 has converted DOS line-endings; no other change
# patches 1,3,4 are just mirrored
MASTER_SITES2=	https://spacehopper.org/mirrors/
PATCHFILES=	patch.${VERSION}.1:2 \
		patch.${VERSION}.2.fixed:2 \
		patch.${VERSION}.3:2 \
		patch.${VERSION}.4:2

CONFIGURE_STYLE=gnu

DEST_SUBDIR=	${REV}
WANTLIB=	c m ${COMPILER_LIBCXX}

PSEUDO_FLAVORS=	no_java bootstrap
FLAVOR?= 
MULTI_PACKAGES = -java

RUN_DEPENDS-java=	${BUILD_PKGPATH} \
			${MODJAVA_RUN_DEPENDS}
RUN_DEPENDS-tcl=	${BUILD_PKGPATH}
WANTLIB-java=

SUBST_VARS=	LIBdb_tcl_VERSION

pre-configure:
	@@perl -pi -e "s,db_(archive|checkpoint|deadlock|dump|hotbackup),db5_\0,g" ${WRKSRC}/test/*tcl
	@@perl -pi -e "s,db_(load|printlog|recover|stat|upgrade|verify),db5_\0,g" ${WRKSRC}/test/*tcl
	@@${SUBST_CMD} ${WRKSRC}/test/include.tcl

.include <bsd.port.mk>
@


1.70
log
@use COMPILER_LIBCXX where applicable
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2017/04/21 13:27:46 kurt Exp $
d15 1
a15 1
REVISION-main = 3
@


1.69
log
@- disconnect devel/jdk/1.7 from the build
- adjust java.port.mk so all 1.7 and lower ports now build with 1.8
- bump revision on affected ports
okay sthen@@, ian@@, landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2017/04/10 11:45:24 sthen Exp $
d40 1
a40 1
WANTLIB=	c m ${LIBCXX}
@


1.68
log
@use LIBCXX
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2016/06/29 16:14:38 espie Exp $
d18 1
a18 1
REVISION-java =	4
@


1.67
log
@add is-branch to all trivial ports that exist as multiple branches.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2016/03/12 16:45:57 naddy Exp $
d40 1
a40 1
WANTLIB=	c m stdc++
@


1.66
log
@get rid of NO_SHARED_ARCHS and PFRAG.shared
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2015/12/03 21:24:29 sthen Exp $
d15 1
a15 1
REVISION-main = 2
d18 2
a19 2
REVISION-java =	3
REVISION-tcl =	0
@


1.65
log
@switch my distfiles mirror to https
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2015/06/13 08:35:18 ajacoutot Exp $
d15 1
a15 1
REVISION-main = 1
@


1.64
log
@Add XXX: variables need to be in sync.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2015/03/19 20:25:26 naddy Exp $
d31 1
a31 1
MASTER_SITES2=	http://spacehopper.org/mirrors/
@


1.63
log
@fold lib-only PFRAG.shared into PLIST, and some related cleanups
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2014/05/07 15:42:15 kurt Exp $
d22 1
a22 1
# XXX sync LIBdb_VERSION in x11/gnome/libgda
@


1.62
log
@- Unlink jdk/1.6 and make jdk/1.7 the default jdk for all java ports
- Adjust java.port.mk and cmake to use 1.7
- Adjust jdk/1.7 for pkg_add upgrades
okay sthen@@, jasper@@, ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2013/07/05 12:03:52 espie Exp $
d15 1
a15 1
REVISION-main = 0
d18 1
a18 1
REVISION-java =	2
@


1.61
log
@the build process of those ports only leads to a .la file if shared objects
are being built, so put those files into the PFRAG.shared-main fragment
too (this is one port where fragment-folding can't work)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2012/03/09 12:59:25 espie Exp $
d18 1
a18 1
REVISION-java =	1
@


1.60
log
@java builds again
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2012/02/20 02:31:40 espie Exp $
d15 1
@


1.59
log
@actually, BROKEN is not subpackage dependent, so use IGNORE-java
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2012/02/19 22:07:51 espie Exp $
a19 1
IGNORE-java = 	build broken by rthreads
@


1.58
log
@classpath hangs with rthreads, so this takes java out.

mark the -java subpackage as broken, so that stuff that depends on other
db/v4 pieces can proceed.

(as discussed with sthen@@, aja@@, naddy@@)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2012/01/25 11:32:34 ajacoutot Exp $
d20 1
a20 1
BROKEN-java =	rthreads blocks classpath
@


1.57
log
@Add a comment, LIBdb_VERSION needs to be synced to databases/db/v4.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2011/10/18 06:46:24 espie Exp $
d20 1
@


1.56
log
@fix build: prevent infinite recursion thru python.
also annotate gamin for bootstrap property, and mark haddock,no_deps as
a "real flavor", since it's only used for bootstrap anyways AND significantly
changes the build.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2011/10/17 10:10:59 espie Exp $
d20 2
@


1.55
log
@convert databases/db to bsd.port.arch.mk, a bit more complicated since
there is a Makefile.inc.

Since the BUILD_PACKAGES tests have to happen there, put the java one there
as well, it won't trigger for db/v3, obviously.

Allows the removal of the ,java pseudo-flavor, since the ONLY_FOR_ARCH-* part
will take care of it.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2011/10/07 13:54:30 kurt Exp $
d39 1
a39 1
PSEUDO_FLAVORS=	no_java
@


1.54
log
@- remove devel/jdk/1.5 and lang/kaffe
- adjust java.port.mk for their removal
- bump affected packages
okay jasper@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2011/09/16 08:48:02 espie Exp $
d39 3
a41 2
PSEUDO_FLAVORS=	java
FLAVOR?=
d43 1
a43 1
RUN_DEPENDS-java=	databases/db/v${REV} \
d45 1
a45 1
RUN_DEPENDS-tcl=	databases/db/v${REV}
a46 12

.if ${FLAVOR:L:Mjava}
MULTI_PACKAGES+=-java
CONFIGURE_ARGS+=--enable-java
MODULES+=	java
MODJAVA_VER=	1.4+
MODJAVA_JRERUN=	Yes
CONFIGURE_ENV+=	JAVAC=${JAVA_HOME}/bin/javac \
		JAR=${JAVA_HOME}/bin/jar \
		JAVA=${JAVA_HOME}/bin/java
MAKE_FLAGS+=	DBJVERSION=${LIBdb_java_VERSION}
.endif
@


1.53
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2011/09/14 19:12:18 naddy Exp $
d17 1
a17 1
REVISION-java =	0
@


1.52
log
@Also bump EPOCH for the db4 -java and -tcl subpackages to deal with
an old screwup when REVISION was introduced.

Bump their dependent packages as well.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2011/09/12 18:02:34 naddy Exp $
d17 2
@


1.51
log
@bump all (sub)packages that depend on db/v4; requested by and help from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2011/09/12 10:16:57 espie Exp $
d9 2
a10 2
PKGSPEC-java =  db-java->=4,<5
PKGSPEC-tcl =   db-tcl->=4,<5
d15 2
a16 2
REVISION-java=	10
REVISION-tcl=	11
@


1.50
log
@fallout from db/v4, clean-up libreoffice port
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2011/09/11 21:17:09 naddy Exp $
d15 2
a16 2
REVISION-java=	9
REVISION-tcl=	10
@


1.49
log
@bump EPOCH to deal with an old screwup when REVISION was introduced; ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2011/08/30 17:16:35 jasper Exp $
d9 3
a11 1
# XXX specs for java,tcl ?
@


1.48
log
@- bump REVISION after recent java.port.mk change
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2010/11/26 14:44:27 espie Exp $
d8 1
a8 1
PKGSPEC-main =	db->=4,<5
d12 1
a12 1
REVISION-main=	5
@


1.47
log
@default db-* for db/v4 is incorrect, set PKGSPEC=db->=4,<5, bump packages
with erroneous depends.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2010/11/15 00:22:51 espie Exp $
d12 3
a14 3
REVISION-main=	4
REVISION-java=	8
REVISION-tcl=	9
@


1.46
log
@convert to new style depends
zap default spec that are not needed
convert libspecs as well
convert p* to REVISION.

No package changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2010/11/12 08:06:42 sthen Exp $
d8 2
d38 1
a38 1
RUN_DEPENDS-java=	db->=4,<5:databases/db/v${REV} \
d40 1
a40 1
RUN_DEPENDS-tcl=	db->=4,<5:databases/db/v${REV}
@


1.45
log
@The patchsets are no longer available at their old location on
oracle.com; I've mirrored them. Pointed out by Diana Eichert, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2010/10/30 23:14:15 steven Exp $
d36 1
a36 1
RUN_DEPENDS-java=	:db->=4,<5:databases/db/v${REV} \
d38 1
a38 1
RUN_DEPENDS-tcl=	:db->=4,<5:databases/db/v${REV}
@


1.44
log
@switch back to openbsd libtool
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2010/10/28 22:20:59 jasper Exp $
d20 2
a21 1
# converted DOS line-endings; no other change
d23 1
a23 1
PATCHFILES=	patch.${VERSION}.1:0 \
d25 2
a26 2
		patch.${VERSION}.3:0 \
		patch.${VERSION}.4:0
@


1.43
log
@- switch back to gnu libtool after recent libtool revert

ok sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2010/10/28 09:10:54 steven Exp $
d10 3
a12 3
REVISION-main=	3
REVISION-java=	7
REVISION-tcl=	8
@


1.42
log
@build with openbsd libtool and bump revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2010/08/25 20:27:16 sthen Exp $
d10 3
a12 3
REVISION-main=	2
REVISION-java=	6
REVISION-tcl=	7
@


1.41
log
@When bumping -main here in my last commit, I inadvertently replaced
PKGNAME-main=${DISTNAME}p0 with REVISION=1. As it is a multi-package port,
the PKGNAME-main=${DISTNAME} must be kept, REVISION must be an extra line.
Breakage noted by jasper@@
@
text
@d10 3
a12 3
REVISION-main=	1
REVISION-java=	5
REVISION-tcl=	6
@


1.40
log
@add missing wantlibs, new-style lib_depends/revision, bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2010/07/10 20:06:54 naddy Exp $
d7 1
@


1.39
log
@rename variable, REVISION has a special meaning now
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2009/11/09 11:03:26 sthen Exp $
d7 5
a11 3
PKGNAME-main=	${DISTNAME}p0
PKGNAME-java=	db-java-${VERSION}p5
PKGNAME-tcl=	db-tcl-${VERSION}p6
d29 1
a29 1
WANTLIB=	c
@


1.38
log
@bump following java.port.mk change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2009/04/26 09:38:25 sthen Exp $
d3 1
a3 1
COMMENT-java=	Java bindings for Berkeley DB, revision ${REVISION}
d5 2
a6 2
REVISION=	4
VERSION=	${REVISION}.6.21
d26 1
a26 1
DEST_SUBDIR=	${REVISION}
d32 1
a32 1
RUN_DEPENDS-java=	:db->=4,<5:databases/db/v${REVISION} \
d34 1
a34 1
RUN_DEPENDS-tcl=	:db->=4,<5:databases/db/v${REVISION}
@


1.37
log
@pkgname bumps following java.port.mk r1.18, pointed out by espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2009/04/14 19:49:04 sthen Exp $
d8 1
a8 1
PKGNAME-java=	db-java-${VERSION}p4
@


1.36
log
@add DISTPATCHes and bump PKGNAME; ok steven@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2009/03/11 21:28:45 bernd Exp $
d8 1
a8 1
PKGNAME-java=	db-java-${VERSION}p3
@


1.35
log
@Fix tcl and db dependencies. With help from naddy@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2008/10/28 11:53:33 steven Exp $
d7 3
a9 3
PKGNAME-main=	${DISTNAME}
PKGNAME-java=	db-java-${VERSION}p2
PKGNAME-tcl=	db-tcl-${VERSION}p5
d17 6
@


1.34
log
@switch to tcl 8.5

ok sthen
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2008/02/14 21:51:31 kurt Exp $
a6 1
PKGNAME=	${DISTNAME}
d8 2
a9 1
PKGNAME-java=	db-java-${VERSION}p1
d26 1
a26 1
RUN_DEPENDS-java=	:db-${REVISION}.*:databases/db/v${REVISION} \
d28 1
@


1.33
log
@Bump PKGNAME due to RUN_DEPENDS change caused by 1.3 and 1.4 jdk
depreciations.
@
text
@d14 1
a14 1
SHARED_LIBS +=	db_tcl               5.0      # .0.0
d42 2
d45 3
a47 3
	@@perl -pi -e "s,db_(archive|checkpoint|deadlock|dump|hotbackup),db4_\1,g" ${WRKSRC}/test/*tcl
	@@perl -pi -e "s,db_(load|printlog|recover|stat|upgrade|verify),db4_\1,g" ${WRKSRC}/test/*tcl
	@@perl -pi -e "s,!!DBVERSION!!,${LIBdb_VERSION}," ${WRKSRC}/test/include.tcl
@


1.32
log
@- pkg bump all 1.3+ ports due to 1.3-linux removal and change in
RUN_DEPENDS via java.port.mk. okay ian@@ pval@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2007/10/26 14:06:02 steven Exp $
d9 1
a9 1
PKGNAME-java=	db-java-${VERSION}p0
d34 1
a34 1
MODJAVA_VER=	1.3+
@


1.31
log
@update to 4.6.21

with lots of testing by sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2007/09/15 22:27:39 simon Exp $
d9 1
a9 1
PKGNAME-java=	db-java-${VERSION}
@


1.30
log
@remove surrounding quotes from COMMENT/BROKEN/PERMIT_*
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2007/01/16 02:48:02 kurt Exp $
d6 4
a9 4
VERSION=	${REVISION}.2.52
PKGNAME=	${DISTNAME}p11
PKGNAME-main=	${DISTNAME}p11
PKGNAME-java=	db-java-${VERSION}p3
d11 4
a14 4
SHARED_LIBS +=	db                   4.2      # .0.0
SHARED_LIBS +=	db_cxx               5.0      # .0.0
SHARED_LIBS +=	db_java              4.2      # .0.0
SHARED_LIBS +=	db_tcl               4.2      # .0.0
a16 2
PATCHFILES=	patch.${VERSION}.1:0 \
		patch.${VERSION}.2:0
d41 5
@


1.29
log
@bump pkg due to java.port.mk change in RUN_DEPENDS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2006/11/25 22:54:28 steven Exp $
d3 1
a3 1
COMMENT-java=	"Java bindings for Berkeley DB, revision ${REVISION}"
@


1.28
log
@new MULTI_PACKAGES
fix WANTLIB while here
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2006/11/15 17:23:27 kurt Exp $
d9 1
a9 1
PKGNAME-java=	db-java-${VERSION}p2
@


1.27
log
@Allow this port to be built with a 1.4 or 1.5 jdk too by including javac
arguments -target 1.3 and -source 1.3 (if javac supports it).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2006/11/04 12:27:19 kurt Exp $
d7 2
a8 1
PKGNAME=	${DISTNAME}p10
d28 4
a33 1
SUBPACKAGE?=
a34 3

. if defined(PACKAGING)
.  if ${SUBPACKAGE} == "-java"
a37 7
RUN_DEPENDS+=	:db-${REVISION}.*:databases/db/v${REVISION}
WANTLIB=
.  endif
. else

MODULES+=	java
MODJAVA_VER=	1.3+
a40 2
. endif

a41 1

@


1.26
log
@instead of building with java by default and a no_java pseudo flavor, go
with a a java pseudo flavor to enable the java build and subpackage.
no pkg bumps. as discussed with naddy@@, pval@@ & nikolay@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2006/11/03 04:50:39 kurt Exp $
d8 1
a8 1
PKGNAME-java=	db-java-${VERSION}p1
@


1.25
log
@set MODJAVA_VER=1.3+ and MODJAVA_JRERUN=Yes for java subpackage
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2006/11/02 15:04:39 kurt Exp $
d24 1
a24 2
.if ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "amd64"
PSEUDO_FLAVORS=	no_java
d27 1
a27 1
. if !${FLAVOR:L:Mno_java}
d32 2
a33 2
.  if defined(PACKAGING)
.   if ${SUBPACKAGE} == "-java"
d39 3
a41 2
.   endif
.  else
d47 1
a47 1
.  endif
a50 1
. endif
@


1.24
log
@fix stupid mistake. the java subpackage has shared libs, so lets install
them.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2006/11/02 12:26:37 bernd Exp $
d8 1
a8 1
PKGNAME-java=	db-java-${VERSION}p0
d36 2
a37 1
MODJAVA_VER=	1.4+
d43 1
a43 1
MODJAVA_VER=	1.4+
@


1.23
log
@Provide a no_java FLAVOR as discussed on icb.

ok robert@@, msf@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2006/11/01 22:26:28 kurt Exp $
d8 1
a8 1
PKGNAME-java=	db-java-${VERSION}
@


1.22
log
@enable java bindings for v4 and place into subpackage. with help and okay
from steven@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2006/10/28 11:19:20 espie Exp $
d25 4
d33 2
a34 2
.if defined(PACKAGING)
. if ${SUBPACKAGE} == "-java"
d39 2
a40 2
. endif
.else
d46 1
a46 1
.endif
d50 1
@


1.21
log
@a few more SHARED_LIBS reformat
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.20 2006/10/18 11:05:55 steven Exp $
d7 2
a8 1
PKGNAME=	${DISTNAME}p9
d12 1
d23 24
@


1.20
log
@homepage and master site moved to oracle.com
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2006/01/17 14:25:32 naddy Exp $
d7 3
a9 3
SHARED_LIBS=	db	4.2 \
		db_cxx	5.0 \
		db_tcl	4.2
@


1.19
log
@belated C++ libs bumps; ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2005/12/25 20:35:42 sturm Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p8
d11 1
a11 1
MASTER_SITES0=	${MASTER_SITES:S/snapshot/${VERSION}/}
@


1.18
log
@SHARED_LIBS and USE_LIBTOOL
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2005/11/03 23:12:45 brad Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p7
d8 1
a8 1
		db_cxx	4.2 \
@


1.17
log
@allow the autoconf script to detect that x86/gcc-assembly fast mutexes
should be used on amd64.

From Berkeley DB 4.3

Should resolve PR 4596
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2005/11/01 15:44:24 bernd Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p6
d7 3
@


1.16
log
@- fix file modes for some files
- bump PKGNAMES

v3: "looks good" espie@@, ok niallo@@
v4: ok niallo@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2005/10/16 00:11:00 brad Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p5
@


1.15
log
@put in replacement mutex code for powerpc. resolves issues previously
reported with Cyrus and powerpc.

From: Evolution's CVS repo via Stuart Henderson <stu at spacehopper dot org>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2005/09/16 09:51:26 espie Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p4
@


1.14
log
@Fix a buglet in bsd.port.mk where the PSEUDO_FLAVORS get encoded into
the FULLPKGPATH, thus providing changes to packing-lists which shouldn't
happen, and making update more difficult.

Accordingly, bump all pkgnames with PSEUDO_FLAVORS, and provide an
update @@pkgpath for the bug for most of them (left out the ones with 3
or 4 pseudo flavors for space constraints...)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2005/01/23 10:30:03 espie Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p3
@


1.13
log
@and bump the right package name...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2005/01/23 10:28:07 espie Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p2
@


1.12
log
@bad libspec, to find the correct library, you must look into a
directory where there's no candidate that is more recent.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2005/01/12 21:31:06 sturm Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p3
@


1.11
log
@better and consistent LIB_DEPENDS on db; this fixes a few possible
build time failures, where the wrong version of db could be found
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2004/11/22 16:59:29 espie Exp $
d5 2
a6 1
PKGNAME=	${DISTNAME}p2
@


1.10
log
@WANTLIB markers
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2004/05/27 21:05:25 pvalchev Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p1
@


1.9
log
@remove powerpc workaround and add patch for the mutex issue
provided by sleepycat via Philippe Lelédy <phl@@leledy.org>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2004/03/07 18:55:21 wilfried Exp $
d14 1
@


1.8
log
@fix for powerpc, ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2004/02/27 01:10:03 brad Exp $
a13 4

.if ${MACHINE_ARCH} == "powerpc"                                                    
CONFIGURE_ARGS+=--enable-posixmutexes                                       
.endif                                                                              
@


1.8.2.1
log
@MFC:
remove powerpc workaround and add patch for the mutex issue
provided by sleepycat via Philippe Lelédy <phl@@leledy.org>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2004/03/07 18:55:21 wilfried Exp $
d14 4
@


1.7
log
@add another distribution patch.

ok pvalchev@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2004/02/24 00:06:43 naddy Exp $
d14 4
@


1.6
log
@remove workarounds for gcc2.95/sparc64 optimizer bugs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2004/01/14 19:50:15 sturm Exp $
d5 1
d8 2
a9 1
PATCHFILES=	patch.${VERSION}.1:0
@


1.5
log
@update to db 4.2.52

from Aleksander Piotrowski <aleksander.piotrowski@@nic.com.pl>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2004/01/10 08:36:28 sturm Exp $
a11 4

.if ${MACHINE_ARCH} == "sparc64"
PATCH_LIST=	patch-* gcc-*
.endif
@


1.4
log
@use tcl 8.4
fix packaging on NO_SHARED_ARCHS
bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2003/12/11 06:49:17 sturm Exp $
d4 1
a4 2
VERSION=	${REVISION}.1.25
PKGNAME=	${DISTNAME}p2
d6 1
a6 1
MASTER_SITES0=	${MASTER_SITES:S/snapshot/4.1.25/}                                                                                              
d8 2
@


1.3
log
@set symlinks to *all* shared libraries
bump PKGNAMEs
noticed by brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2003/12/10 18:03:00 sturm Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p1
@


1.2
log
@create a link to lib/db4/libdb.so.4.1 in lib/
this got lost somehow
bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2003/12/08 17:37:52 sturm Exp $
d5 1
a5 1
PKGNAME=	${DISTNAME}p0
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d5 1
@


1.1.1.1
log
@split import of versions v3 and v4 of Berkeley DB
@
text
@@
