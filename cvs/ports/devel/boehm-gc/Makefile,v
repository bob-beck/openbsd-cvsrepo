head	1.64;
access;
symbols
	OPENBSD_6_1:1.63.0.2
	OPENBSD_6_1_BASE:1.63
	OPENBSD_6_0:1.62.0.2
	OPENBSD_6_0_BASE:1.62
	OPENBSD_5_9:1.60.0.2
	OPENBSD_5_9_BASE:1.60
	OPENBSD_5_8:1.59.0.4
	OPENBSD_5_8_BASE:1.59
	OPENBSD_5_7:1.57.0.4
	OPENBSD_5_7_BASE:1.57
	OPENBSD_5_6:1.57.0.2
	OPENBSD_5_6_BASE:1.57
	OPENBSD_5_5:1.53.0.2
	OPENBSD_5_5_BASE:1.53
	OPENBSD_5_4:1.51.0.2
	OPENBSD_5_4_BASE:1.51
	OPENBSD_5_3:1.47.0.2
	OPENBSD_5_3_BASE:1.47
	OPENBSD_5_2:1.45.0.2
	OPENBSD_5_2_BASE:1.45
	OPENBSD_5_1_BASE:1.42
	OPENBSD_5_1:1.42.0.6
	OPENBSD_5_0:1.42.0.4
	OPENBSD_5_0_BASE:1.42
	OPENBSD_4_9:1.42.0.2
	OPENBSD_4_9_BASE:1.42
	OPENBSD_4_8:1.40.0.2
	OPENBSD_4_8_BASE:1.40
	OPENBSD_4_7:1.39.0.2
	OPENBSD_4_7_BASE:1.39
	OPENBSD_4_6:1.37.0.6
	OPENBSD_4_6_BASE:1.37
	OPENBSD_4_5:1.37.0.4
	OPENBSD_4_5_BASE:1.37
	OPENBSD_4_4:1.37.0.2
	OPENBSD_4_4_BASE:1.37
	OPENBSD_4_3:1.35.0.2
	OPENBSD_4_3_BASE:1.35
	OPENBSD_4_2:1.34.0.2
	OPENBSD_4_2_BASE:1.34
	OPENBSD_4_1:1.33.0.2
	OPENBSD_4_1_BASE:1.33
	OPENBSD_4_0:1.32.0.4
	OPENBSD_4_0_BASE:1.32
	OPENBSD_3_9:1.32.0.2
	OPENBSD_3_9_BASE:1.32
	OPENBSD_3_8:1.29.0.8
	OPENBSD_3_8_BASE:1.29
	OPENBSD_3_7:1.29.0.6
	OPENBSD_3_7_BASE:1.29
	OPENBSD_3_6:1.29.0.4
	OPENBSD_3_6_BASE:1.29
	OPENBSD_3_5:1.29.0.2
	OPENBSD_3_5_BASE:1.29
	OPENBSD_3_4:1.24.0.2
	OPENBSD_3_4_BASE:1.24
	OPENBSD_3_3:1.23.0.2
	OPENBSD_3_3_BASE:1.23
	OPENBSD_3_2:1.21.0.2
	OPENBSD_3_2_BASE:1.21
	OPENBSD_3_1:1.17.0.2
	OPENBSD_3_1_BASE:1.17
	OPENBSD_3_0:1.16.0.2
	OPENBSD_3_0_BASE:1.16
	OPENBSD_2_9_TRACKING_SWITCH:1.16
	OPENBSD_2_9:1.14.0.4
	OPENBSD_2_9_BASE:1.14
	OPENBSD_2_8:1.14.0.2
	OPENBSD_2_8_BASE:1.14
	OPENBSD_2_7:1.11.0.2
	OPENBSD_2_7_BASE:1.11
	OPENBSD_2_6:1.5.0.2
	OPENBSD_2_6_BASE:1.5
	NIKLAS_990419:1.1.1.1
	NIKLAS:1.1.1;
locks; strict;
comment	@# @;


1.64
date	2017.04.10.11.45.25;	author sthen;	state Exp;
branches;
next	1.63;
commitid	XDh1zlSBq0boKsHk;

1.63
date	2016.11.12.10.33.04;	author jca;	state Exp;
branches;
next	1.62;
commitid	xlbXEQBAsvEdbZ7E;

1.62
date	2016.03.11.20.28.23;	author naddy;	state Exp;
branches;
next	1.61;
commitid	UYLP8TE6V7RS2GhJ;

1.61
date	2016.03.09.19.54.50;	author naddy;	state Exp;
branches;
next	1.60;
commitid	2u1M34uAdwXW3umM;

1.60
date	2016.02.21.22.01.56;	author tobiasu;	state Exp;
branches;
next	1.59;
commitid	lpJtaHkNXbCFJ7id;

1.59
date	2015.06.27.13.21.29;	author jasper;	state Exp;
branches;
next	1.58;
commitid	RYUTuq1kB8YyIrSL;

1.58
date	2015.05.22.11.31.12;	author ajacoutot;	state Exp;
branches;
next	1.57;
commitid	2khjHXfpTaOuNVcx;

1.57
date	2014.07.25.20.24.51;	author naddy;	state Exp;
branches;
next	1.56;
commitid	8GMPx3yovwEG6Hbs;

1.56
date	2014.07.09.14.31.10;	author robert;	state Exp;
branches;
next	1.55;
commitid	mP18koA32JvGEFq3;

1.55
date	2014.05.28.04.53.55;	author landry;	state Exp;
branches;
next	1.54;

1.54
date	2014.03.19.13.28.57;	author jasper;	state Exp;
branches;
next	1.53;

1.53
date	2014.02.09.06.01.54;	author shadchin;	state Exp;
branches;
next	1.52;

1.52
date	2013.10.11.23.48.23;	author naddy;	state Exp;
branches;
next	1.51;

1.51
date	2013.07.03.19.51.38;	author kurt;	state Exp;
branches;
next	1.50;

1.50
date	2013.06.01.21.05.28;	author kurt;	state Exp;
branches;
next	1.49;

1.49
date	2013.03.21.08.45.14;	author ajacoutot;	state Exp;
branches;
next	1.48;

1.48
date	2013.03.11.10.50.01;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	2012.12.21.12.50.14;	author sthen;	state Exp;
branches;
next	1.46;

1.46
date	2012.08.18.12.41.37;	author ajacoutot;	state Exp;
branches;
next	1.45;

1.45
date	2012.04.30.15.33.16;	author kurt;	state Exp;
branches;
next	1.44;

1.44
date	2012.03.24.21.21.18;	author kurt;	state Exp;
branches;
next	1.43;

1.43
date	2012.02.22.12.31.42;	author kurt;	state Exp;
branches;
next	1.42;

1.42
date	2010.11.15.19.45.56;	author espie;	state Exp;
branches;
next	1.41;

1.41
date	2010.10.18.17.47.51;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	2010.07.08.23.00.18;	author robert;	state Exp;
branches;
next	1.39;

1.39
date	2010.02.09.12.18.45;	author jasper;	state Exp;
branches;
next	1.38;

1.38
date	2009.12.09.20.36.49;	author sthen;	state Exp;
branches;
next	1.37;

1.37
date	2008.07.01.09.43.19;	author landry;	state Exp;
branches;
next	1.36;

1.36
date	2008.04.01.17.41.13;	author kurt;	state Exp;
branches;
next	1.35;

1.35
date	2007.09.16.02.52.57;	author merdely;	state Exp;
branches;
next	1.34;

1.34
date	2007.07.14.22.16.16;	author kili;	state Exp;
branches;
next	1.33;

1.33
date	2006.10.28.11.19.20;	author espie;	state Exp;
branches;
next	1.32;

1.32
date	2006.02.08.04.54.49;	author david;	state Exp;
branches;
next	1.31;

1.31
date	2006.01.06.14.42.59;	author bernd;	state Exp;
branches;
next	1.30;

1.30
date	2005.09.05.11.41.56;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2004.03.04.17.49.26;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2003.10.16.14.09.51;	author todd;	state Exp;
branches;
next	1.27;

1.27
date	2003.10.16.13.56.28;	author todd;	state Exp;
branches;
next	1.26;

1.26
date	2003.10.15.17.11.35;	author todd;	state Exp;
branches;
next	1.25;

1.25
date	2003.10.15.12.58.11;	author todd;	state Exp;
branches;
next	1.24;

1.24
date	2003.06.12.20.33.12;	author todd;	state Exp;
branches;
next	1.23;

1.23
date	2003.01.18.23.29.52;	author brad;	state Exp;
branches;
next	1.22;

1.22
date	2002.10.26.13.25.26;	author todd;	state Exp;
branches;
next	1.21;

1.21
date	2002.09.16.22.00.13;	author todd;	state Exp;
branches;
next	1.20;

1.20
date	2002.09.12.14.53.27;	author todd;	state Exp;
branches;
next	1.19;

1.19
date	2002.09.12.14.18.56;	author todd;	state Exp;
branches;
next	1.18;

1.18
date	2002.08.27.15.41.30;	author todd;	state Exp;
branches;
next	1.17;

1.17
date	2002.03.01.03.49.08;	author brad;	state Exp;
branches;
next	1.16;

1.16
date	2001.06.20.01.43.15;	author pvalchev;	state Exp;
branches;
next	1.15;

1.15
date	2001.05.06.00.12.53;	author lebel;	state Exp;
branches;
next	1.14;

1.14
date	2000.10.22.14.03.05;	author espie;	state Exp;
branches;
next	1.13;

1.13
date	2000.09.15.14.38.45;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2000.06.07.01.22.05;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2000.04.09.17.36.16;	author espie;	state Exp;
branches
	1.11.2.1;
next	1.10;

1.10
date	2000.03.24.22.11.38;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2000.02.16.10.52.09;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2000.02.15.05.04.11;	author turan;	state Exp;
branches;
next	1.7;

1.7
date	2000.02.12.06.29.52;	author turan;	state Exp;
branches;
next	1.6;

1.6
date	2000.02.11.00.37.21;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	99.10.06.19.00.29;	author brad;	state Exp;
branches;
next	1.4;

1.4
date	99.09.19.13.12.06;	author turan;	state Exp;
branches;
next	1.3;

1.3
date	99.08.18.02.44.20;	author angelos;	state Exp;
branches;
next	1.2;

1.2
date	99.04.19.22.33.44;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	99.04.19.21.34.05;	author niklas;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	99.04.19.21.34.05;	author niklas;	state Exp;
branches;
next	;

1.11.2.1
date	2000.09.15.04.48.55;	author marc;	state Exp;
branches;
next	;


desc
@@


1.64
log
@use LIBCXX
@
text
@# $OpenBSD: Makefile,v 1.63 2016/11/12 10:33:04 jca Exp $

COMMENT-main=	garbage collection and memory leak detection for C and C++
COMMENT-atomic=	access to hardware provided atomic memory operations

VERSION=	7.6.0
LIBAO_VERSION=	7.4.4

DISTNAME=	gc-${VERSION}

PKGNAME-atomic=	libatomic_ops-${LIBAO_VERSION}
PKGNAME-main=	boehm-gc-${VERSION}

DISTFILES=	${DISTNAME}${EXTRACT_SUFX} \
		libatomic_ops-${LIBAO_VERSION}${EXTRACT_SUFX}

MULTI_PACKAGES=	-main -atomic

SHARED_LIBS +=	gc		4.0	# 1.3
SHARED_LIBS +=	gccpp		0.0	# 1.3
SHARED_LIBS +=	cord		2.3	# 1.3
SHARED_LIBS +=  atomic_ops	1.3 	# 1.3
SHARED_LIBS +=  atomic_ops_gpl	1.3 	# 1.3

CATEGORIES=	devel

MASTER_SITES=	${HOMEPAGE}gc_source/

HOMEPAGE=	http://hboehm.info/gc/

# currently works only on most ELF archs
NOT_FOR_ARCHS=	m88k

PERMIT_PACKAGE_CDROM=	Yes

WANTLIB-main += m pthread ${LIBCXX}

MAKE_ENV=	CP="cp" \
		INSTALL_DATA="${INSTALL_DATA}" \
		INSTALL_MAN="${INSTALL_MAN}"

CONFIGURE_STYLE= gnu

CONFIGURE_ARGS= --with-libatomic-ops=no \
		--enable-cplusplus \
		--enable-threads=pthreads

post-extract:
	@@perl -pi -e "s,/usr/local,${PREFIX},g" ${WRKSRC}/doc/gc.man
	@@mv ${WRKDIR}/libatomic_ops-${LIBAO_VERSION} ${WRKBUILD}/libatomic_ops

pre-build:
# clean distributed objects and libs and rebuild
	@@cd ${WRKBUILD}/libatomic_ops && ${SETENV} ${MAKE_ENV} \
		${MAKE_PROGRAM} ${MAKE_FLAGS} clean all

post-install:
	@@cd ${WRKBUILD}/libatomic_ops && ${SETENV} ${MAKE_ENV} \
		${MAKE_PROGRAM} ${ALL_FAKE_FLAGS} install
	${INSTALL_DATA} ${WRKSRC}/doc/gc.man ${PREFIX}/man/man3/gc.3

.include <bsd.port.mk>
@


1.63
log
@Update to gc-7.6.0 and libatomic_ops-7.4.4

Maintenance only update for libatomic_ops.  Bulk build and ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2016/03/11 20:28:23 naddy Exp $
d36 1
a36 1
WANTLIB-main += m pthread stdc++
@


1.62
log
@garbage collect CONFIGURE_SHARED
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2016/03/09 19:54:50 naddy Exp $
d6 2
a7 2
VERSION=	7.4.2
LIBAO_VERSION=	7.4.0
a12 2
REVISION-atomic=1
REVISION-main=	0
a52 2
# no rule to get .lo from .S in subdirectory
	@@ln -s src/sparc_mach_dep.S ${WRKSRC}
a56 4
aliases=	malloc malloc_atomic free realloc enable_incremental \
		register_finalizer malloc_ignore_off_page \
		malloc_atomic_ignore_off_page set_warn_proc

a60 3
.for i in ${aliases}
	ln -s gc.3 ${PREFIX}/man/man3/GC_$i.3
.endfor
@


1.61
log
@no more vax
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2016/02/21 22:01:56 tobiasu Exp $
d46 1
a46 2
CONFIGURE_ARGS= ${CONFIGURE_SHARED} \
		--with-libatomic-ops=no \
@


1.60
log
@Fix boehm-gc on sparc. Bump libatomic_ops because its contents changed -
the change itself is without consequence on anything but sparc32.
ok sthen@@ naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2015/06/27 13:21:29 jasper Exp $
d34 1
a34 1
NOT_FOR_ARCHS=	m88k vax
@


1.59
log
@unbreak on mips64(el) by setting the right wordsize/alignment/datastart

with hint from miod@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2015/05/22 11:31:12 ajacoutot Exp $
d13 1
a13 1
REVISION-atomic=0
d51 1
a51 1
pre-configure:
@


1.58
log
@"/usr/local/lib/pkgconfig/" is part of mtree(8).
Packages should not own this dir to prevent its deletion or a warning that it
cannot be removed because it's not empty at pkg_delete(1) time.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2014/07/25 20:24:51 naddy Exp $
d34 1
a34 1
NOT_FOR_ARCHS=	m88k vax mips64 mips64el
@


1.57
log
@Work around a missing Makefile rule to derive a .lo from a source file
in a subdirectory; fixes the build on sparc64.

While here, don't run autoconf.  Nothing requires it.

ok jca@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2014/07/09 14:31:10 robert Exp $
d13 2
@


1.56
log
@update to boehm-gc 7.4.2 and libatomic_ops 7.4.0 and remove all
the patches that got integrated upstream
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2014/05/28 04:53:55 landry Exp $
d42 1
a42 3

AUTOCONF_VERSION= 2.68
CONFIGURE_STYLE= autoconf no-autoheader
d53 3
a56 1
pre-build:
@


1.55
log
@Update HOMEPAGE, from Seth Jackson (thanks!)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2014/03/19 13:28:57 jasper Exp $
d6 3
a8 1
VERSION=	7.2d
d10 2
a11 1
PKGNAME-atomic=	libatomic_ops-${VERSION}
a12 2
REVISION-atomic=0
REVISION-main=	1
d14 3
a16 1
WRKDIST=	${WRKDIR}/gc-7.2
d19 5
a23 3
SHARED_LIBS +=	gc	4.0	# .1.3
SHARED_LIBS +=	gccpp	0.0	# .1.3
SHARED_LIBS +=	cord	2.3	# .1.3
d36 1
a36 1
WANTLIB-main += pthread
d53 1
@


1.54
log
@no more m68k
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2014/02/09 06:01:54 shadchin Exp $
d10 2
a11 1
REVISION-main=	0
d24 1
a24 1
HOMEPAGE=	http://www.hpl.hp.com/personal/Hans_Boehm/gc/
@


1.53
log
@Fix incorrect define GC_OPENBSD_THREADS on sparc64. Fix build graphics/asymptote

Noticed by and ok landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2013/10/11 23:48:23 naddy Exp $
d26 1
a26 1
NOT_FOR_ARCHS=	m68k m88k vax mips64 mips64el
@


1.52
log
@Drop USE_GROFF since groff and mandoc produce identical output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2013/07/03 19:51:38 kurt Exp $
d10 1
@


1.51
log
@- Fix build conflict on hppa. okay landry@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2013/06/01 21:05:28 kurt Exp $
a34 1
USE_GROFF =	Yes
@


1.50
log
@- Update to 7.2d. Tested on i386, amd64, sparc64, macppc, hppa and alpha.
okay and testing by sthen, landry, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2013/03/21 08:45:14 ajacoutot Exp $
d41 1
@


1.49
log
@USE_LIBTOOL=Yes is the default now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2013/03/11 10:50:01 espie Exp $
d6 1
a6 1
VERSION=	7.0
d8 1
a8 1
PKGNAME-atomic=	libatomic_ops-1.2
a9 1
REVISION=	7
d11 1
d14 3
a16 2
SHARED_LIBS +=	gc	3.0	# .1.2
SHARED_LIBS +=  cord	2.3	# .1.3
a23 2
MAINTAINER=	Todd T. Fries <todd@@openbsd.org>

d29 1
a29 1
WANTLIB += pthread
d37 1
a37 1
AUTOCONF_VERSION= 2.61
d41 1
@


1.48
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2012/12/21 12:50:14 sthen Exp $
a35 1
USE_LIBTOOL=	Yes
@


1.47
log
@sync wantlib
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2012/08/18 12:41:37 ajacoutot Exp $
a28 3
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
@


1.46
log
@Remove irrelevant $FreeBSD RCS ids.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2012/04/30 15:33:16 kurt Exp $
d10 1
a10 1
REVISION=	6
d32 2
@


1.45
log
@Get GC_nprocs from sysconf _SC_NPROCESSORS_ONLN instead of
hardcoding to 1. From Brad Smith <brad@@comstyle.com> tested
in bulk build by naddy@@
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.44 2012/03/24 21:21:18 kurt Exp $
# $FreeBSD: Makefile,v 1.4 1999/01/10 20:12:06 steve Exp $
@


1.44
log
@Change suspend/resume signals to fix one problem with lang/mono. okay todd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2012/02/22 12:31:42 kurt Exp $
d11 1
a11 1
REVISION =	5
@


1.43
log
@Remove uthreads work-arounds. Works ok with rthreads now.
Tested by sthen@@ and espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2010/11/15 19:45:56 espie Exp $
d11 1
a11 1
REVISION =	4
@


1.42
log
@move depends to new style
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2010/10/18 17:47:51 espie Exp $
d11 1
a11 1
REVISION =	3
@


1.41
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2010/07/08 23:00:18 robert Exp $
d10 2
a11 1
PKGNAME-main=	boehm-gc-${VERSION}p3
@


1.40
log
@Bump UTHREAD_SP_OFFSET to the correct value on i386 after the layout change
in struct _machdep_state from libpthread.
The offset is hardcoded in boehm-gc because it's a private struct so we
cannot use offsetof(). This will probably not change soon again but I am
writing this as a note for people who will run into the same problem in
the future.
All the regression tests are passing now and mono builds fine too.
Thanks to kurt@@ for pointers.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2010/02/09 12:18:45 jasper Exp $
d38 1
@


1.39
log
@- extend archtecture tests for mips64el

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2009/12/09 20:36:49 sthen Exp $
d10 1
a10 1
PKGNAME-main=	boehm-gc-${VERSION}p2
@


1.38
log
@Add -pthread to the pkg-config files, bump PKGNAME. From Andreas Kahari.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2008/07/01 09:43:19 landry Exp $
d26 1
a26 1
NOT_FOR_ARCHS=	m68k m88k vax mips64
@


1.37
log
@Split boehm-gc into -main and -atomic subpackages.
The latter contains libatomic_ops-1.2, which is developed inside boehm-gc,
as stated on libatomic_ops homepage. No change on -main subpackage.
libatomic_ops may be used by a future eventual pulseaudio port, which is
being worked on.

Feedback, tweaks and ok kurt@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2008/04/01 17:41:13 kurt Exp $
d10 1
a10 1
PKGNAME-main=	boehm-gc-${VERSION}p1
@


1.36
log
@- use __data_start symbol to find the beginning of the data sections
and adjust boehm-gc to deal with any number of holes that may appear
between __data_start and _end. (requires -current binutils)
- work-around libpthread bugs that prevent sigsuspend() from working
in a signal handler by using pthread_suspend_np() + an arch/libpthread
specific offset to obtain the suspended thread's stack pointer.

thanks to sthen@@ and jasper@@ for access to other arches. discussed
with todd@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2007/09/16 02:52:57 merdely Exp $
d4 2
a5 1
COMMENT=	garbage collection and memory leak detection for C and C++
d9 4
a12 1
PKGNAME=	boehm-gc-${VERSION}p0
d48 5
d58 2
@


1.35
log
@Remove quotes surrounding COMMENT*/PERMIT_*/BROKEN
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2007/07/14 22:16:16 kili Exp $
d8 1
a8 1
PKGNAME=	boehm-gc-${VERSION}
d10 2
a11 2
SHARED_LIBS +=	gc	2.0	# .1.2
SHARED_LIBS +=  cord	1.3	# .1.3
d21 2
a22 1
NOT_FOR_ARCHS=	hppa powerpc vax
d35 2
a36 1
CONFIGURE_STYLE=gnu
d38 2
a39 4
CONFIGURE_ARGS= ${CONFIGURE_SHARED}

#XXX: support not finished yet
#	--enable-threads=pthreads
d42 1
a42 3
	@@mv ${WRKSRC}/doc/gc.man ${WRKSRC}/doc/gc.man.in
	@@sed -e "s,@@PREFIX@@,${PREFIX},g" ${WRKSRC}/doc/gc.man.in > \
		${WRKSRC}/doc/gc.man
@


1.34
log
@
Update to 7.0.

Most work done by kurt@@, who got bleeding eyes and has been trapped
into pthread issues because some of us (me and Stuart Henderson)
were slopyy and applied some patches only partial. A big sorry to
kurt@@ for this waste of time!

Tested by many. Intermediate ok's (IIRC) from kurt@@, naddy@@ and todd@@.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2006/10/28 11:19:20 espie Exp $
d4 1
a4 1
COMMENT=	"garbage collection and memory leak detection for C and C++"
@


1.33
log
@a few more SHARED_LIBS reformat
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2006/02/08 04:54:49 david Exp $
d6 6
a11 4
VERSION=	6.2
DISTNAME=	gc${VERSION}
PKGNAME=	boehm-gc-${VERSION}p1
SHARED_LIBS +=	gc                   1.2      # .1.2
d14 1
a20 1

a32 3
CONFIGURE_STYLE=autoconf no-autoheader
AUTOCONF_VERSION=2.54
CONFIGURE_ARGS= ${CONFIGURE_SHARED} --enable-full-debug
d34 1
a34 2
# XXX the below causes failures still
#	--enable-redirect-malloc 
d36 4
a39 1
WRKDIST=	${WRKDIR}/gc${VERSION}
d49 1
a54 5
	${INSTALL_DATA_DIR} ${PREFIX}/include/private
	${INSTALL_DATA} ${WRKSRC}/include/gc{,_{cpp,backptr,gcj,mark,typed}}.h ${PREFIX}/include
	${INSTALL_DATA} ${WRKSRC}/include/private/gc{config,_{hdrs,locks,priv,pmark}}.h ${PREFIX}/include/private

REGRESS_TARGET=	check-TESTS
@


1.32
log
@move any perl or sed substitutions from post-patch to pre-configure
(fixes make update-patches)
ok sturm@@; "looks reasonable" steven@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2006/01/06 14:42:59 bernd Exp $
d9 1
a9 1
SHARED_LIBS=	gc 1.2
@


1.31
log
@- SHARED_LIBS, USE_LIBTOOL
- fix stupid COMMENT for g-wrap
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2005/09/05 11:41:56 espie Exp $
d40 1
a40 1
post-patch:
@


1.30
log
@decent manpage behavior
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2004/03/04 17:49:26 espie Exp $
d8 3
a10 1
PKGNAME=	boehm-gc-${VERSION}p0
d30 1
@


1.29
log
@explicitly tag no-autoheader some ports for which re-running it after autoconf
is a problem.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.28 2003/10/16 14:09:51 todd Exp $
d8 1
a8 1
PKGNAME=	boehm-gc-${VERSION}
d42 3
d47 3
@


1.28
log
@be less specific; prompted by naddy
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2003/10/16 13:56:28 todd Exp $
d28 1
a28 1
CONFIGURE_STYLE=autoconf
@


1.27
log
@hppa,macppc,vax still do not work
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2003/10/15 17:11:35 todd Exp $
d17 1
a17 1
NOT_FOR_ARCHS=	hppa macppc vax
@


1.26
log
@teach boehm-gc about alpha having shared libs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2003/10/15 12:58:11 todd Exp $
d15 3
@


1.25
log
@Thanks to marius at monkey dot org for unbreaking this port.
Thanks to Andrew Delgleish for updating this to 6.2
patches submitted upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2003/06/12 20:33:12 todd Exp $
d25 2
a26 1
CONFIGURE_STYLE=gnu
@


1.24
log
@Mark this as broken.
This should have been done a while ago.
Fixing this is beyond me, and until this works, w3m and gcj are pointless as
well (opencm will be free of boehm-gc soon enough).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2003/01/18 23:29:52 brad Exp $
d6 1
a6 3
BROKEN=		"even regress fails with 'Memory fault' immediately."

VERSION=	6.1
d8 1
a8 1
PKGNAME=	boehm-gc-${VERSION}p1
d26 4
a29 1
CONFIGURE_ARGS= ${CONFIGURE_SHARED}
d31 1
a31 1
WRKDIST=	${WRKDIR}/gc6.1
d41 1
a41 1
	${INSTALL_DATA} ${WRKSRC}/include/gc{,_{cpp,backptr,gcj,mark}}.h ${PREFIX}/include
@


1.23
log
@bump PKGNAME, the recent commit from drahn@@ is really important for
ELF-based archs as having an old boehm-gc can cause programs to stop working
after the WorX addition. Noticed after trying to build w3m and it failed
miserably.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2002/10/26 13:25:26 todd Exp $
d5 2
@


1.22
log
@thanks to drahn@@ update to gc6.1 (misc bugfixes, I've heard good things, etc,
best of all, you can drop this in on shared archs as a replacement for 6.0,
I've tested opencm and w3m)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2002/09/16 22:00:13 todd Exp $
d8 1
a8 1
PKGNAME=	boehm-gc-${VERSION}
@


1.21
log
@more headers (needed by egcs)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2002/09/12 14:53:27 todd Exp $
d6 1
a6 1
VERSION=	6.0
d26 1
d28 1
a28 1
WRKDIST=	${WRKDIR}/gc6.0
@


1.20
log
@install one more header, needed by the upcoming opencm use
of /usr/local/include
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.19 2002/09/12 14:18:56 todd Exp $
d36 3
a38 1
	${INSTALL_DATA} ${WRKSRC}/include/gc{,_cpp,_backptr}.h ${PREFIX}/include
@


1.19
log
@take maintainership. niklas@@ resigned this
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.18 2002/08/27 15:41:30 todd Exp $
d36 1
a36 1
	${INSTALL_DATA} ${WRKSRC}/include/gc{,_cpp}.h ${PREFIX}/include
@


1.18
log
@update to 6.0
misc pieces from art@@, pval@@, and myself
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2002/03/01 03:49:08 brad Exp $
d14 1
a14 1
MAINTAINER=	Niklas Hallqvist <niklas@@openbsd.org>
@


1.17
log
@- add RCS id
- add HOMEPAGE
- use MASTER_SITE_BACKUP
@
text
@d1 1
a1 1
# $OpenBSD$
d6 3
a8 4
ONLY_FOR_ARCHS=	i386 m68k sparc

DISTNAME=	gc4.12
PKGNAME=	boehm-gc-4.12
d10 1
a10 3
NEED_VERSION=	1.500
MASTER_SITES=	${MASTER_SITE_BACKUP}
EXTRACT_CASES=	gc4.12.tar.gz) tar zxf ${FULLDISTDIR}/$$archive || true;;
d12 1
a12 1
HOMEPAGE=	http://ginger.hpl.hp.com/personal/Hans_Boehm/gc/
d25 1
a25 2
ALL_TARGET=	OpenBSD-pkg-all
INSTALL_TARGET=	OpenBSD-pkg-install
d27 1
a27 1
WRKDIST=	${WRKDIR}/gc
d30 9
a38 3
	@@mv ${WRKSRC}/gc.man ${WRKSRC}/gc.man.in
	@@sed -e "s,@@PREFIX@@,${PREFIX},g" ${WRKSRC}/gc.man.in > \
		${WRKSRC}/gc.man
@


1.16
log
@Remove deprecated LICENSE_TYPE and set appropriate # comments
with its contents.
@
text
@d1 1
d6 2
d11 3
a13 3
NEED_VERSION=	1.402
MASTER_SITES=	http://www.hpl.hp.com/personal/Hans_Boehm/gc/gc_source/ \
		http://reality.sgi.com/boehm_mti/gc_source/
d15 1
a15 3
ONLY_FOR_ARCHS=	i386 m68k sparc

EXTRACT_CASES= gc4.12.tar.gz) tar zxf ${FULLDISTDIR}/$$archive || true;;
a18 1
# License: BSD
d30 2
a31 1
WRKDIST=		${WRKDIR}/gc
@


1.15
log
@devel: COMMENT is out, bump NEED_VERSION.
@
text
@d18 1
a18 1
LICENSE_TYPE=		BSD
@


1.14
log
@Complete a few MAINTAINER names.
@
text
@d3 2
d8 1
a8 1
NEED_VERSION=	1.330
@


1.13
log
@New extract framework
@
text
@d14 1
a14 1
MAINTAINER=	niklas@@openbsd.org
@


1.12
log
@fake
@
text
@d6 1
a6 1
NEED_VERSION=	1.191
d12 1
a12 2

EXTRACT_AFTER_ARGS=	| tar -xf - || true
@


1.11
log
@explicit FAKE=No, so that we can turn FAKE on by default.
@
text
@a6 1
FAKE=No
@


1.11.2.1
log
@bring devel as of cut-over date into 2.7 branch
@
text
@d7 1
@


1.10
log
@Move all NEED_VERSION right after CATEGORY
@
text
@d7 1
@


1.9
log
@All the Makefiles cvs missed first time around...
@
text
@d6 1
a11 1
NEED_VERSION=	1.191
@


1.8
log
@espie will not shut up about this, DISTF -> DISTFILES, PKG -> PACKAGE
@
text
@d13 1
a13 1
EXTRACT_AFTER_ARGS=	| ${TAR} -xf - || true
d18 4
a21 4
PERMIT_PACKAGE_CDROM=	YES
PERMIT_PACKAGE_FTP=	YES
PERMIT_DISTFILES_CDROM=	YES
PERMIT_DISTFILES_FTP=	YES
d23 1
a23 1
MAKE_ENV=	CP="${CP}" \
d32 2
a33 2
	@@${MV} ${WRKSRC}/gc.man ${WRKSRC}/gc.man.in
	@@${SED} -e "s,@@PREFIX@@,${PREFIX},g" ${WRKSRC}/gc.man.in > \
@


1.7
log
@bsd licenses
@
text
@d18 4
a21 4
PERMIT_PKG_CDROM=	YES
PERMIT_PKG_FTP=		YES
PERMIT_DISTF_CDROM=	YES
PERMIT_DISTF_FTP=	YES
@


1.6
log
@Use WRKDIST where appropriate.
@
text
@d17 6
@


1.5
log
@- cleanup Makefile
- fix man page so path to headers/libs is not hardcoded to /usr/local
- add ONLY_FOR_ARCHS= i386 m68k sparc
- add support for SPARC; tested by marco@@
@
text
@d11 1
a11 1
NEED_VERSION=	1.89
d23 1
a23 1
WRKSRC=		${WRKDIR}/gc
@


1.4
log
@fix for badly constructed tarball.
@
text
@a0 5
# New ports collection makefile for:	boehm-gc
# Version required:	4.12
# Date created:		3 April 1999
# Whom:			Niklas Hallqvist <niklas@@openbsd.org>
#
a1 1
#
d6 8
a13 1
MASTER_SITES=	http://reality.sgi.com/employees/boehm_mti/gc_source/
d17 3
a19 1
EXTRACT_AFTER_ARGS=	| /bin/tar -xf - || true
a20 2
WRKSRC=		${WRKDIR}/gc
MAN3=		gc.3
d23 6
a28 4
MAKE_ENV+=	CP="${CP}"
MAKE_ENV+=	CXX="${CXX}"
MAKE_ENV+=	INSTALL_DATA="${INSTALL_DATA}"
MAKE_ENV+=	INSTALL_MAN="${INSTALL_MAN}"
@


1.3
log
@The Xerox site does not carry the port any more, revert to the SGI one.
@
text
@d16 1
a16 1
EXTRACT_AFTER_ARGS=	|| true
@


1.2
log
@Yet another remnant from the FreeBSD port removed
@
text
@d12 1
a12 2
MASTER_SITES=	ftp://ftp.parc.xerox.com/pub/gc/ \
		http://reality.sgi.com/employees/boehm_mti/gc_source/
@


1.1
log
@Initial revision
@
text
@a16 1
FETCH_BEFORE_ARGS=	-b
@


1.1.1.1
log
@Boehm's garbage collector for C & C++, can also find memleaks.
@
text
@@
