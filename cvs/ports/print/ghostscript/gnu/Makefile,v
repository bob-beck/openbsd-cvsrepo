head	1.108;
access;
symbols
	OPENBSD_6_0:1.107.0.2
	OPENBSD_6_0_BASE:1.107
	OPENBSD_5_9:1.106.0.2
	OPENBSD_5_9_BASE:1.106
	OPENBSD_5_8:1.106.0.4
	OPENBSD_5_8_BASE:1.106
	OPENBSD_5_7:1.103.0.2
	OPENBSD_5_7_BASE:1.103
	OPENBSD_5_6:1.102.0.2
	OPENBSD_5_6_BASE:1.102
	OPENBSD_5_5:1.101.0.2
	OPENBSD_5_5_BASE:1.101
	OPENBSD_5_4:1.98.0.2
	OPENBSD_5_4_BASE:1.98
	OPENBSD_5_3:1.95.0.2
	OPENBSD_5_3_BASE:1.95
	OPENBSD_5_2:1.91.0.2
	OPENBSD_5_2_BASE:1.91
	OPENBSD_5_1_BASE:1.89
	OPENBSD_5_1:1.89.0.2
	OPENBSD_5_0:1.85.0.2
	OPENBSD_5_0_BASE:1.85
	OPENBSD_4_9:1.81.0.2
	OPENBSD_4_9_BASE:1.81
	OPENBSD_4_8:1.75.0.2
	OPENBSD_4_8_BASE:1.75
	OPENBSD_4_7:1.71.0.2
	OPENBSD_4_7_BASE:1.71
	OPENBSD_4_6:1.67.0.2
	OPENBSD_4_6_BASE:1.67
	OPENBSD_4_5:1.63.0.2
	OPENBSD_4_5_BASE:1.63
	OPENBSD_4_4:1.57.0.2
	OPENBSD_4_4_BASE:1.57
	OPENBSD_4_3:1.53.0.2
	OPENBSD_4_3_BASE:1.53
	OPENBSD_4_2:1.49.0.2
	OPENBSD_4_2_BASE:1.49
	OPENBSD_4_1:1.48.0.2
	OPENBSD_4_1_BASE:1.48
	OPENBSD_4_0:1.45.0.2
	OPENBSD_4_0_BASE:1.45
	OPENBSD_3_9:1.44.0.2
	OPENBSD_3_9_BASE:1.44
	OPENBSD_3_8:1.42.0.2
	OPENBSD_3_8_BASE:1.42
	OPENBSD_3_7:1.41.0.2
	OPENBSD_3_7_BASE:1.41
	OPENBSD_3_6:1.37.0.2
	OPENBSD_3_6_BASE:1.37
	OPENBSD_3_5:1.36.0.2
	OPENBSD_3_5_BASE:1.36
	OPENBSD_3_4:1.34.0.2
	OPENBSD_3_4_BASE:1.34
	OPENBSD_3_3:1.31.0.2
	OPENBSD_3_3_BASE:1.31
	OPENBSD_3_2:1.27.0.2
	OPENBSD_3_2_BASE:1.27
	OPENBSD_3_1:1.25.0.2
	OPENBSD_3_1_BASE:1.25
	OPENBSD_3_0:1.22.0.2
	OPENBSD_3_0_BASE:1.22
	OPENBSD_2_9_TRACKING_SWITCH:1.22
	OPENBSD_2_9:1.16.0.2
	OPENBSD_2_9_BASE:1.16
	OPENBSD_2_8:1.13.0.2
	OPENBSD_2_8_BASE:1.13
	OPENBSD_2_7:1.9.0.2
	OPENBSD_2_7_BASE:1.9
	gs_5_50:1.1.1.1
	espie:1.1.1;
locks; strict;
comment	@# @;


1.108
date	2016.09.13.18.52.05;	author naddy;	state Exp;
branches;
next	1.107;
commitid	4Y8Q5bKBOfIWFq5Y;

1.107
date	2016.03.10.20.26.03;	author naddy;	state Exp;
branches;
next	1.106;
commitid	T6oveb7wdupobNCt;

1.106
date	2015.07.24.12.46.23;	author jasper;	state Exp;
branches;
next	1.105;
commitid	cYcMUQE9BNPkos92;

1.105
date	2015.05.23.08.40.02;	author ajacoutot;	state Exp;
branches;
next	1.104;
commitid	g6Cex7oAC94DWakL;

1.104
date	2015.04.06.21.04.30;	author ajacoutot;	state Exp;
branches;
next	1.103;
commitid	LH6KScydmg3oKxhj;

1.103
date	2015.02.16.22.57.12;	author naddy;	state Exp;
branches
	1.103.2.1;
next	1.102;
commitid	0dx3c9ckf7dE4tx1;

1.102
date	2014.04.19.14.30.05;	author sthen;	state Exp;
branches;
next	1.101;

1.101
date	2013.12.24.15.18.38;	author kili;	state Exp;
branches;
next	1.100;

1.100
date	2013.08.22.09.14.32;	author ajacoutot;	state Exp;
branches;
next	1.99;

1.99
date	2013.08.22.08.02.22;	author ajacoutot;	state Exp;
branches;
next	1.98;

1.98
date	2013.06.17.19.28.37;	author ajacoutot;	state Exp;
branches;
next	1.97;

1.97
date	2013.06.04.18.41.56;	author naddy;	state Exp;
branches;
next	1.96;

1.96
date	2013.03.11.11.37.53;	author espie;	state Exp;
branches;
next	1.95;

1.95
date	2013.02.15.12.40.00;	author kili;	state Exp;
branches;
next	1.94;

1.94
date	2012.09.09.08.57.36;	author kili;	state Exp;
branches;
next	1.93;

1.93
date	2012.08.22.06.24.17;	author ajacoutot;	state Exp;
branches;
next	1.92;

1.92
date	2012.08.04.17.51.44;	author ajacoutot;	state Exp;
branches;
next	1.91;

1.91
date	2012.07.11.10.26.31;	author kili;	state Exp;
branches;
next	1.90;

1.90
date	2012.03.09.10.59.54;	author espie;	state Exp;
branches;
next	1.89;

1.89
date	2011.11.16.12.43.23;	author kili;	state Exp;
branches;
next	1.88;

1.88
date	2011.11.13.21.18.40;	author kili;	state Exp;
branches;
next	1.87;

1.87
date	2011.09.16.11.13.41;	author espie;	state Exp;
branches;
next	1.86;

1.86
date	2011.09.08.10.34.06;	author ajacoutot;	state Exp;
branches;
next	1.85;

1.85
date	2011.07.18.20.24.36;	author kili;	state Exp;
branches;
next	1.84;

1.84
date	2011.07.06.13.49.17;	author kili;	state Exp;
branches;
next	1.83;

1.83
date	2011.06.08.19.15.48;	author kili;	state Exp;
branches;
next	1.82;

1.82
date	2011.03.02.07.10.55;	author ajacoutot;	state Exp;
branches;
next	1.81;

1.81
date	2010.11.22.09.34.10;	author espie;	state Exp;
branches;
next	1.80;

1.80
date	2010.11.20.09.48.39;	author espie;	state Exp;
branches;
next	1.79;

1.79
date	2010.10.24.21.32.39;	author ajacoutot;	state Exp;
branches;
next	1.78;

1.78
date	2010.10.18.21.25.08;	author espie;	state Exp;
branches;
next	1.77;

1.77
date	2010.10.11.08.17.16;	author jasper;	state Exp;
branches;
next	1.76;

1.76
date	2010.08.19.08.19.45;	author jasper;	state Exp;
branches;
next	1.75;

1.75
date	2010.07.26.20.07.31;	author edd;	state Exp;
branches
	1.75.2.1;
next	1.74;

1.74
date	2010.05.24.14.25.05;	author kili;	state Exp;
branches;
next	1.73;

1.73
date	2010.05.10.18.41.49;	author espie;	state Exp;
branches;
next	1.72;

1.72
date	2010.03.31.16.22.30;	author ajacoutot;	state Exp;
branches;
next	1.71;

1.71
date	2010.02.06.19.56.40;	author kili;	state Exp;
branches
	1.71.2.1;
next	1.70;

1.70
date	2010.01.04.19.14.52;	author jasper;	state Exp;
branches;
next	1.69;

1.69
date	2009.09.13.20.59.16;	author ajacoutot;	state Exp;
branches;
next	1.68;

1.68
date	2009.08.10.06.34.08;	author kili;	state Exp;
branches;
next	1.67;

1.67
date	2009.06.16.21.03.59;	author sthen;	state Exp;
branches
	1.67.2.1;
next	1.66;

1.66
date	2009.04.27.08.26.23;	author bernd;	state Exp;
branches;
next	1.65;

1.65
date	2009.04.16.19.53.38;	author jasper;	state Exp;
branches;
next	1.64;

1.64
date	2009.04.06.17.06.33;	author jasper;	state Exp;
branches;
next	1.63;

1.63
date	2009.01.19.12.46.22;	author kili;	state Exp;
branches;
next	1.62;

1.62
date	2008.12.23.10.55.30;	author ajacoutot;	state Exp;
branches;
next	1.61;

1.61
date	2008.12.23.00.18.01;	author jolan;	state Exp;
branches;
next	1.60;

1.60
date	2008.11.19.09.59.38;	author ajacoutot;	state Exp;
branches;
next	1.59;

1.59
date	2008.11.12.19.26.38;	author kili;	state Exp;
branches;
next	1.58;

1.58
date	2008.10.28.17.53.42;	author kili;	state Exp;
branches;
next	1.57;

1.57
date	2008.07.12.19.11.56;	author kili;	state Exp;
branches;
next	1.56;

1.56
date	2008.05.09.19.29.44;	author kili;	state Exp;
branches;
next	1.55;

1.55
date	2008.04.06.15.48.13;	author kili;	state Exp;
branches;
next	1.54;

1.54
date	2008.04.01.20.37.00;	author kili;	state Exp;
branches;
next	1.53;

1.53
date	2008.01.04.17.48.37;	author espie;	state Exp;
branches;
next	1.52;

1.52
date	2007.11.19.20.06.56;	author kili;	state Exp;
branches;
next	1.51;

1.51
date	2007.09.15.23.36.43;	author merdely;	state Exp;
branches;
next	1.50;

1.50
date	2007.09.15.21.36.44;	author merdely;	state Exp;
branches;
next	1.49;

1.49
date	2007.05.26.12.25.10;	author kili;	state Exp;
branches;
next	1.48;

1.48
date	2007.01.01.22.54.46;	author kili;	state Exp;
branches;
next	1.47;

1.47
date	2006.10.20.16.45.58;	author steven;	state Exp;
branches;
next	1.46;

1.46
date	2006.10.19.13.12.37;	author kili;	state Exp;
branches;
next	1.45;

1.45
date	2006.08.03.23.28.11;	author espie;	state Exp;
branches;
next	1.44;

1.44
date	2006.01.02.22.44.50;	author sturm;	state Exp;
branches;
next	1.43;

1.43
date	2006.01.02.20.22.19;	author sturm;	state Exp;
branches;
next	1.42;

1.42
date	2005.06.02.17.52.12;	author sturm;	state Exp;
branches;
next	1.41;

1.41
date	2005.01.25.17.19.33;	author alek;	state Exp;
branches;
next	1.40;

1.40
date	2005.01.24.16.00.14;	author brad;	state Exp;
branches;
next	1.39;

1.39
date	2004.10.24.20.58.47;	author brad;	state Exp;
branches;
next	1.38;

1.38
date	2004.09.15.18.32.14;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2004.07.10.17.21.58;	author brad;	state Exp;
branches;
next	1.36;

1.36
date	2004.02.25.01.28.07;	author brad;	state Exp;
branches;
next	1.35;

1.35
date	2004.01.29.19.11.04;	author pvalchev;	state Exp;
branches;
next	1.34;

1.34
date	2003.06.04.16.02.52;	author margarida;	state Exp;
branches;
next	1.33;

1.33
date	2003.06.04.01.14.14;	author margarida;	state Exp;
branches;
next	1.32;

1.32
date	2003.03.31.14.49.13;	author sturm;	state Exp;
branches;
next	1.31;

1.31
date	2002.12.26.18.41.14;	author sturm;	state Exp;
branches
	1.31.2.1;
next	1.30;

1.30
date	2002.12.03.13.30.39;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2002.12.03.13.17.07;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2002.10.28.13.40.41;	author naddy;	state Exp;
branches;
next	1.27;

1.27
date	2002.05.15.17.58.49;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2002.04.24.21.34.48;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2002.03.24.01.08.25;	author brad;	state Exp;
branches;
next	1.24;

1.24
date	2002.03.21.21.25.50;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2001.10.28.13.05.49;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2001.08.06.06.25.14;	author pvalchev;	state Exp;
branches;
next	1.21;

1.21
date	2001.07.27.17.46.48;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2001.07.03.15.38.26;	author espie;	state Exp;
branches;
next	1.19;

1.19
date	2001.06.20.01.43.32;	author pvalchev;	state Exp;
branches;
next	1.18;

1.18
date	2001.05.24.02.28.14;	author kevlo;	state Exp;
branches;
next	1.17;

1.17
date	2001.05.05.21.05.17;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2001.04.13.17.01.05;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2001.04.13.16.43.58;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2001.01.11.00.21.14;	author naddy;	state Exp;
branches;
next	1.13;

1.13
date	2000.10.22.15.43.16;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2000.10.22.13.26.51;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2000.06.25.22.40.15;	author brad;	state Exp;
branches;
next	1.10;

1.10
date	2000.05.31.13.01.08;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2000.03.30.21.09.55;	author espie;	state Exp;
branches
	1.9.2.1;
next	1.8;

1.8
date	2000.03.24.23.28.30;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2000.03.19.00.24.20;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2000.03.06.19.46.51;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2000.03.05.18.30.40;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2000.02.22.17.08.46;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2000.02.20.17.18.59;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2000.02.20.00.57.18;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2000.02.19.17.40.42;	author espie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.02.19.17.40.42;	author espie;	state Exp;
branches;
next	;

1.9.2.1
date	2000.09.15.05.13.11;	author marc;	state Exp;
branches;
next	;

1.31.2.1
date	2003.06.04.01.16.39;	author margarida;	state Exp;
branches;
next	1.31.2.2;

1.31.2.2
date	2003.06.04.16.03.29;	author margarida;	state Exp;
branches;
next	;

1.67.2.1
date	2010.02.16.04.12.47;	author william;	state Exp;
branches;
next	;

1.71.2.1
date	2010.08.21.11.10.50;	author jasper;	state Exp;
branches;
next	;

1.75.2.1
date	2010.08.21.11.08.34;	author jasper;	state Exp;
branches;
next	;

1.103.2.1
date	2015.07.24.12.47.44;	author jasper;	state Exp;
branches;
next	;
commitid	jrubmoKNGhGiMJOj;


desc
@@


1.108
log
@replace libiconv module
@
text
@# $OpenBSD: Makefile,v 1.107 2016/03/10 20:26:03 naddy Exp $

COMMENT=	GNU PostScript interpreter

VERSION=	9.07
DISTNAME=	ghostscript-${VERSION}
CATEGORIES=	print lang
SHARED_LIBS=	gs	15.0
REVISION=	3

MASTER_SITES=	http://downloads.ghostscript.com/public/

HOMEPAGE=	http://www.cs.wisc.edu/~ghost/

MAINTAINER=	Matthias Kilian <kili@@openbsd.org>

FLAVORS=	a4 gtk no_x11
FLAVOR?=

FLAVOR_STRING=	${FLAVOR_EXT:S/-/,/g}

SUBST_VARS=	VERSION FLAVOR_STRING

# AGPLv3, except for the included CMap files from Adobe, which may
# only be redistributed without modifications.
PERMIT_PACKAGE_CDROM=	Yes

WANTLIB=	c iconv ijs m jbig2dec jpeg>=62 lcms2 png>=6 pthread tiff z

RUN_DEPENDS=	print/ghostscript/gnu-fonts>=8.11p3
LIB_DEPENDS=	converters/libiconv	\
		graphics/jbig2dec	\
		graphics/jpeg		\
		graphics/lcms2		\
		graphics/png		\
		graphics/tiff		\
		print/ijs

CFLAGS+=	-DSYS_TYPES_HAS_STDINT_TYPES	\
		-I${LOCALBASE}/include		\
		-I${LOCALBASE}/include/ijs

STDLIBS=	-pthread -lm -liconv

# Note: all the device definitions are at the very end of this makefile.

MAKE_FLAGS=	BINDIR=./obj				\
		CFLAGS_STANDARD='${CFLAGS} -fPIC'	\
		COMPILE_INITS=0				\
		DEVICE_DEVS='${DEVICES:C/.*/\$(DD)&.dev/}'	\
		EXTRALIBS="${EXTRALIBS}"		\
		FT_BRIDGE=${FT_BRIDGE}			\
		GLGENDIR=./obj				\
		GLOBJDIR=./obj				\
		GLSRCDIR=./base				\
		ICCSRCDIR=./icclib			\
		INSTALL='${INSTALL}'			\
		INSTALL_DATA='${INSTALL_DATA}'		\
		INSTALL_PROGRAM='${INSTALL_PROGRAM}'	\
		LIBgs_VERSION=${LIBgs_VERSION}		\
		PSGENDIR=./obj				\
		PSLIBDIR=./lib				\
		PSOBJDIR=./obj				\
		PSSRCDIR=./psi				\
		SHARE_FT=1				\
		SHARE_IJS=1				\
		SHARE_JBIG2=1				\
		SHARE_JPEG=1				\
		SHARE_LCMS=1				\
		SHARE_LIBPNG=1				\
		SHARE_LIBTIFF=1				\
		SHARE_ZLIB=1				\
		SOBINRELDIR=../obj			\
		SOOBJRELDIR=../obj			\
		SOC_CFLAGS="${SOC_CFLAGS}"		\
		SOC_LIBS="${SOC_LIBS}"			\
		STDLIBS='${STDLIBS}'			\
		SYNC=posync				\
		TRUE_PREFIX='${LOCALBASE}'		\
		USE_GTK=${USE_GTK}			\
		XLDFLAGS=-L${LOCALBASE}/lib		\
		prefix='${PREFIX}'

USE_GMAKE=	Yes

ALL_TARGET =		so all ${ALL_TARGET_CUPS}
INSTALL_TARGET =	install install-so

SOC_LIBS =			-liconv -pthread

.if ${FLAVOR:Ma4}
CFLAGS+=	-DA4
.endif

# A word about the GTK_DEVICES and NOGTK_DEVICES variables.
# Originally, the display device is used by the gtk+ versions of
# ghostscript, but it works fine when called from external helpers or
# libraries (e.g. libspectre). With the correct sorting of device
# drivers, we can have a default output device set to x11 and a working
# 'display' driver without enforcing the gtk FLAVOR.

.if ${FLAVOR:Mgtk} && ${FLAVOR:Mno_x11}
ERRORS+= "Fatal: Conflicting flavors: ${FLAVOR}"
.elif ${FLAVOR:Mgtk}
LIB_DEPENDS+=	x11/gtk+2
MODULES+=	devel/gettext
WANTLIB+=	GL Xcomposite Xcursor Xdamage Xfixes Xi Xinerama
WANTLIB+=	Xrandr Xrender atk-1.0 cairo expat fontconfig freetype
WANTLIB+=	gdk-x11-2.0>=1000 gdk_pixbuf-2.0>=1000 gio-2.0 glib-2.0
WANTLIB+=	gobject-2.0 gtk-x11-2.0>=1000
WANTLIB+=	pango-1.0 pangocairo-1.0 pangoft2-1.0 pixman-1 pthread-stubs
WANTLIB+=	xcb xcb-render xcb-shm
WANTLIB+=	${MODGETTEXT_WANTLIB}
SOC_CFLAGS=	$$(pkg-config gtk+-2.0 --cflags)
SOC_LIBS+=	$$(pkg-config gtk+-2.0 --libs)
USE_GTK=	Yes
GTK_DEVICES=	display
NOGTK_DEVICES=
.else
USE_GTK=	No
GTK_DEVICES=
NOGTK_DEVICES=	display
.endif

.if !${FLAVOR:Mno_x11}
# XXX -freetype flags should be set with FT_CFLAGS and FT_LIBS
CFLAGS+=	-I${X11BASE}/include		\
		-I${X11BASE}/include/freetype2
STDLIBS+=	-lfreetype
WANTLIB+=	X11 Xt Xext freetype
DEVICES+=	${GTK_DEVICES} ${X11_DEVICES} ${NOGTK_DEVICES}
SOC_LIBS+=	-L${X11BASE}/lib -lXt -lXt -lXext -lfreetype
FT_BRIDGE=	1
.else
FT_BRIDGE=	0
.endif

NO_TEST=	Yes

# Avoid surprises in update-patches.
# Use the old-style (non-autoconf) build.
post-extract:
	find ${WRKDIST} -name '*.orig' -type f | xargs -r rm
	ln -s base/unix-gcc.mak ${WRKDIST}/Makefile
	cd ${WRKSRC} && mkdir junk && \
		mv expat freetype ijs jpeg lcms lcms2 libpng jbig2dec \
			openjpeg tiff zlib junk

pre-build:
	mkdir -p ${WRKDIST}/obj

pre-install:
	@@${INSTALL_DATA_DIR} ${PREFIX}/share/ghostscript
	@@${INSTALL_PROGRAM_DIR} ${PREFIX}/bin
	@@${INSTALL_MAN_DIR} ${PREFIX}/man/man1

.ifdef(DEBUG)
STRIP=		:
.endif

post-install:
	if [ -x ${PREFIX}/bin/gsc ]; then \
		mv ${PREFIX}/bin/gsc ${PREFIX}/bin/gs; \
	fi
	if [ -x ${PREFIX}/bin/gsx ]; then \
		mv ${PREFIX}/bin/gsx ${PREFIX}/bin/gs; \
	fi
	${STRIP} ${PREFIX}/bin/gs
	cd ${PREFIX}/man/man1 && \
		ln -sf ps2ps.1 eps2eps.1 && \
		ln -sf gslp.1 gsbj.1 && \
		ln -sf gslp.1 gsdj.1 && \
		ln -sf gslp.1 gsdj500.1 && \
		ln -sf gslp.1 gslj.1 && \
		ln -sf ps2pdf.1 ps2pdf12.1 && \
		ln -sf ps2pdf.1 ps2pdf13.1 && \
		ln -sf ps2pdf.1 ps2pdf14.1
	cd ${PREFIX}/man/de/man1 && \
		ln -sf ps2pdf.1 ps2pdf12.1 && \
		ln -sf ps2pdf.1 ps2pdf13.1 && \
		ln -sf ps2pdf.1 ps2pdf14.1 && \
		ln -sf ps2ps.1 eps2eps.1

# Device list based on configure.ac:
# X_DEVS (skipping x11_ and x11alt_, since those are dependencies of
# other devices).
X11_DEVICES=	x11 x11alpha x11cmyk x11cmyk2 x11cmyk4 x11cmyk8 \
		x11gray2 x11gray4 x11mono x11rg16x x11rg32x

# HP_DEVS
DEVICES+=	cdeskjet cdj1600 cdj500 cdj550 cdj670 cdj850 cdj880 \
		cdj890 cdj970 cdjcolor cdjmono cdnj500 chp2200 cljet5 cljet5c \
		cljet5pr deskjet djet500 djet500c dnj650c hpdj1120c \
		hpdj310 hpdj320 hpdj340 hpdj400 hpdj500 hpdj500c \
		hpdj510 hpdj520 hpdj540 hpdj550c hpdj560c hpdj600 \
		hpdj660c hpdj670c hpdj680c hpdj690c hpdj850c hpdj855c \
		hpdj870c hpdj890c hpdjplus hpdjportable laserjet \
		lj3100sw lj4dith lj5gray lj5mono ljet2p ljet3 ljet3d \
		ljet4 ljet4d ljetplus lp2563 paintjet pcl3 pj pjetxl \
		pjxl pjxl300 pxlcolor pxlmono

# PCLXL_DEVS
DEVICES+=	pxlmono pxlcolor

# EPSON_DEVS
DEVICES+=	alc1900 alc2000 alc4000 alc4100 alc8500 alc8600 \
		alc9100 epl2050 epl2050p epl2120 epl2500 epl2750 \
		epl5800 epl5900 epl6100 epl6200 eplcolor eplmono eps9high eps9mid \
		epson epsonc escp lp1800 lp1900 lp2200 lp2400 lp2500 \
		lp3000c lp7500 lp7700 lp7900 lp8000 lp8000c lp8100 \
		lp8200c lp8300c lp8300f lp8400f lp8500c lp8600 \
		lp8600f lp8700 lp8800c lp8900 lp9000b lp9000c lp9100 \
		lp9200b lp9200c lp9300 lp9400 lp9500c lp9600 lp9600s \
		lp9800c lps4500 lps6500 lq850 photoex st800 stcolor

# CANON_DEVS
DEVICES+=	bj10e bj200 bjc600 bjc800 bjccmyk bjccolor bjcgray \
		bjcmono lbp8 lips3

# LEXMARK_DEVS
DEVICES+=	lxm5700m lxm3200 lex2050 lex3200 lex5700 lex7000

# BROTHER_DEVS
DEVICES+=	hl1240 hl1250 hl7x0

# APPLE_DEVS
DEVICES+=	appledmp iwhi iwlo iwlq

# IBM_DEVS
DEVICES+=	ibmpro jetp3852

# OKI_DEVS
DEVICES+=	oki182 oki4w okiibm

# JAPAN_DEVS
DEVICES+=	bj10v bj10vh bjc880j dj505j escpage fmlbp fmpr jj100 \
		lbp310 lbp320 lips2p lips4 lips4v lj4dithp ljet4pjl \
		lp2000 md1xMono md50Eco md50Mono mj500c mj6000c \
		mj700v2c mj8000c ml600 npdl picty180 pr1000 pr1000_4 \
		pr150 pr201 rpdl

# MISC_PDEVS
DEVICES+=	ap3250 atx23 atx24 atx38 coslw2p coslwxl cp50 \
		declj250 dl2100 fs600 gdi imagen la50 la70 la75 \
		la75plus lj250 ln03 m8510 md2k md5k necp6 oce9050 \
		r4081 samsunggdi sj48 t4693d2 t4693d4 t4693d8 tek4696 \
		uniprint xes

# OPVP_DEVS
DEVICES+=	oprp opvp

# BMP_DEVS
DEVICES+=	bmp16 bmp16m bmp256 bmp32b bmpgray bmpmono bmpsep1 \
		bmpsep8

# FAX_DEVS
DEVICES+=	cfax dfaxhigh dfaxlow fax faxg3 faxg32d faxg4 tfax \
		tiffg3 tiffg32d tiffg4

# JPEG_DEVS
DEVICES+=	jpeg jpegcmyk jpeggray

# PNG_DEVS (note: png48 not mentioned in configure.ac)
DEVICES+=	png16 png16m png256 png48 pngalpha pnggray pngmono

# JBIG2_DEVS
DEVICES+=	jbig2

# TIFF_DEVS
DEVICES+=	tiff12nc tiff24nc tiff32nc tiff48nc tiff64nc tiffcrle tiffgray tifflzw \
		tiffpack tiffs tiffscaled tiffscaled24 tiffscaled8 tiffsep tiffsep1

# PCX_DEVS
DEVICES+=	pcx16 pcx24b pcx256 pcx2up pcxcmyk pcxgray pcxmono

# PBM_DEVS
DEVICES+=	pam pamcmyk32 pamcmyk4 pbm pbmraw pgm pgmraw pgnm pgnmraw pkm pkmraw \
		pksm pksmraw plan planc plang plank planm pnm pnmraw ppm ppmraw

# PS_DEVS
DEVICES+=	bbox epswrite inkcov pdfwrite ps2write psdcmyk psdf psdrgb \
		psgray psmono psrgb pswrite txtwrite

# MISC_FDEVS
DEVICES+=	bit bitcmyk bitrgb bitrgbtags ccr \
		cif devicen inferno mag16 mag256 mgr4 mgr8 mgrgray2 \
		mgrgray4 mgrgray8 mgrmono miff24 plan9bm sgirgb \
		spotcmyk sunhmono xcf

# Aditional devices not mentioned in configure.ac:
DEVICES+=	ijs

# Cups
LIB_DEPENDS+=	print/cups,-libs
WANTLIB += cups cupsimage
DEVICES+=	cups
ALL_TARGET_CUPS=cups
CUPSLIBS+=	$$(cups-config --image --libs)
EXTRALIBS+=	${CUPSLIBS}
SOC_LIBS+=	${CUPSLIBS}
MAKE_FLAGS+=	CUPSCFLAGS="$$(cups-config --cflags)" \
		CUPSSERVERBIN="$$(cups-config --serverbin)" \
		CUPSSERVERROOT="$$(cups-config --serverroot)" \
		CUPSDATA="$$(cups-config --datadir)" \
		CUPSPDFTORASTER=1 \
		CUPS_FONTPATH="${LOCALBASE}/share/cups/fonts" \
		CUPS_DATA="${LOCALBASE}/share/cups"

.include <bsd.port.mk>
@


1.107
log
@remove NO_SHARED_ARCHS, NO_SHARED_LIBS, and fold PFRAG.shared into PLIST
ok kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.106 2015/07/24 12:46:23 jasper Exp $
d28 1
a28 3
WANTLIB=	c ijs m jbig2dec jpeg>=62 lcms2 png>=6 pthread tiff z

MODULES=	converters/libiconv
d31 2
a32 1
LIB_DEPENDS=	graphics/jbig2dec	\
@


1.106
log
@Security fix for CVE-2015-3228 ghostscript-core: out-of-bounbds read and write in gs_ttf.ps

ok kili@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.105 2015/05/23 08:40:02 ajacoutot Exp $
d9 1
a9 1
REVISION=	2
d87 2
a88 6
# Hack to let ALL_TARGET etc. depend on the value of NO_SHARED_LIBS,
# which is available only after the inclusion of bsd.port.mk.
ALL_TARGET_NON_SHARED-No = 	so all ${ALL_TARGET_CUPS}
ALL_TARGET_NON_SHARED-Yes = 	all
INSTALL_TARGET_NON_SHARED-No =	install install-so
INSTALL_TARGET_NON_SHARED-Yes =	install
a114 1
NOT_FOR_ARCHS=	${NO_SHARED_ARCHS}
a310 3

ALL_TARGET =		${ALL_TARGET_NON_SHARED-${NO_SHARED_LIBS}}
INSTALL_TARGET =	${INSTALL_TARGET_NON_SHARED-${NO_SHARED_LIBS}}
@


1.105
log
@Update PLIST to register share/ghostscript/ as part of the package.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.104 2015/04/06 21:04:30 ajacoutot Exp $
d9 1
a9 1
REVISION=	1
@


1.104
log
@Move fonts from share/ghostscript/fonts to share/fonts/ghostscript.

ok kili@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2015/02/16 22:57:12 naddy Exp $
d9 1
a9 1
REVISION=	0
@


1.103
log
@Drop USE_GROFF from ports where the formatting differences are acceptable
or mandoc provides the more useful output.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.102 2014/04/19 14:30:05 sthen Exp $
d9 1
d32 1
a32 1
RUN_DEPENDS=	print/ghostscript/gnu-fonts
@


1.103.2.1
log
@Security fix for CVE-2015-3228 ghostscript-core: out-of-bounbds read and write in gs_ttf.ps

ok kili@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.103 2015/02/16 22:57:12 naddy Exp $
a6 1
REVISION=	0
@


1.102
log
@update the license marker, Artifex moved to the Affero license
ok kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.101 2013/12/24 15:18:38 kili Exp $
a41 1
USE_GROFF =	Yes
@


1.101
log
@Intermediate update to ghostscript-9.07.

9.10 will follow in a few days.

Thanks to aja@@ for doing some testing.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.100 2013/08/22 09:14:32 ajacoutot Exp $
d23 1
a23 1
# GPLv3, except for the included CMap files from Adobe, which may
@


1.100
log
@While the cups raster tools (gstoraster and gstopxl) are now in cups-filters,
we still need the cups device.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.98 2013/06/17 19:28:37 ajacoutot Exp $
d5 1
a5 1
VERSION=	9.06
a8 1
REVISION=	4
d152 2
a153 1
		mv freetype ijs jasper jpeg libpng jbig2dec tiff zlib junk
@


1.99
log
@Remove dependency on cups,-libs. gstoraster and friends are moving to
print/cups-filters.

ok kili@@ (maintainer)
@
text
@d9 1
a9 1
REVISION=	3
d90 1
a90 1
ALL_TARGET_NON_SHARED-No = 	so all
d298 16
@


1.98
log
@Some trivial WANTLIB and tweaks to unbreak after the Heimdal update.
Stop hardcoding the Kerberos libs and use krb5-config(1).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.97 2013/06/04 18:41:56 naddy Exp $
d9 1
a9 1
REVISION=	2
d90 1
a90 1
ALL_TARGET_NON_SHARED-No = 	so all ${ALL_TARGET_CUPS}
d92 1
a92 1
INSTALL_TARGET_NON_SHARED-No =	install install-so ${INSTALL_TARGET_CUPS}
a146 10
# Simulate ./configure.
post-configure:
	sed -e 's!@@prefix@@!${PREFIX}!' \
	    -e 's!@@exec_prefix@@!${PREFIX}!' \
	    -e 's!@@bindir@@!${PREFIX}/bin!' \
	    -e '/GS_LIB/s!/usr!${PREFIX}!' \
	    -e 's!@@SED_EXTENDED_REGEX_OPT@@!-nEe!' \
	    -e 's!@@GS@@!gs!' \
	    ${WRKSRC}/cups/gstopxl.in > ${WRKSRC}/cups/gstopxl

a188 7
	${INSTALL_SCRIPT_DIR} ${PREFIX}/libexec/cups/filter
	${INSTALL_SCRIPT} ${WRKSRC}/cups/gstopxl ${PREFIX}/libexec/cups/filter
	cd ${PREFIX}/libexec/cups/filter && ln -s gstopxl pstopxl
	cd ${PREFIX}/libexec/cups/filter && ln -s gstoraster pstoraster
	${INSTALL_DATA_DIR} ${PREFIX}/share/cups/model
	${INSTALL_DATA} ${WRKSRC}/cups/*.ppd ${PREFIX}/share/cups/model
	mv ${DESTDIR}/${SYSCONFDIR}/cups/ ${PREFIX}/share/ghostscript/${VERSION}/examples/
a297 17

# Cups
LIB_DEPENDS+=	print/cups,-libs
WANTLIB += cups cupsimage
DEVICES+=	cups
ALL_TARGET_CUPS=cups
INSTALL_TARGET_CUPS=	install-cups
CUPSLIBS+=	$$(cups-config --image --libs)
EXTRALIBS+=	${CUPSLIBS}
SOC_LIBS+=	${CUPSLIBS}
MAKE_FLAGS+=	CUPSCFLAGS="$$(cups-config --cflags)" \
		CUPSSERVERBIN="$$(cups-config --serverbin)" \
		CUPSSERVERROOT="$$(cups-config --serverroot)" \
		CUPSDATA="$$(cups-config --datadir)" \
		CUPSPDFTORASTER=1 \
		CUPS_FONTPATH="${LOCALBASE}/share/cups/fonts" \
		CUPS_DATA="${LOCALBASE}/share/cups"
@


1.97
log
@the png headers are now directly under include/
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.96 2013/03/11 11:37:53 espie Exp $
d9 1
a9 1
REVISION=	1
d318 1
a318 1
WANTLIB += asn1 crypto cups cupsimage gssapi krb5 ssl
@


1.96
log
@PERMIT_* / REGRESS->TEST sweep
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.95 2013/02/15 12:40:00 kili Exp $
d42 1
a42 2
		-I${LOCALBASE}/include/ijs	\
		-I${LOCALBASE}/include/libpng
@


1.95
log
@Ensure that cups/gdevcups.c is compiled with the same flags as
everything else, especially to get the same value for GX_COLOR_INDEX_TYPE
(and the same field sizes and offsets for the gx_device type).

This fixes crashes with the cups driver on 32 bit archs.

Reported and fix tested by Martin Crossley <martin@@crossleys.biz>.

ok aja@@ dcoppa@@ sthen@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.94 2012/09/09 08:57:36 kili Exp $
a25 2
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
a26 1
PERMIT_PACKAGE_FTP=	Yes
d146 1
a146 1
NO_REGRESS=	Yes
@


1.94
log
@Create mutexes with type PTHREAD_MUTEX_RECURSIVE to stop ghostscript from
aborting.

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.93 2012/08/22 06:24:17 ajacoutot Exp $
d9 1
a9 1
REVISION=	0
@


1.93
log
@Update to ghostscript-9.06.
This fixes a crash when using PDF printing with gtk-print.

ok kili@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.92 2012/08/04 17:51:44 ajacoutot Exp $
d9 1
@


1.92
log
@Compile/install gstoraster and the corresponding convs file.
Link gstoraster to pstoraster in case there are some oldies around that
still try to use pstoraster.
Remove the dlopen libcups hack and link to libcups as upstream intended.
Unconditionally depend on cups,-libs.

with and ok kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.91 2012/07/11 10:26:31 kili Exp $
d5 1
a5 1
VERSION=	9.05
a8 1
REVISION=	0
@


1.91
log
@Update ghostscript to 9.05.

THe following devices had been added:

        cdnj500, eplcolor, eplmono, inkcov, pamcmyk4, plan, planc,
        plang, plank, planm, tiff48nc, tiff64nc, tiffscaled,
        tiffscaled24, tiffscaled8, tiffsep1, txtwrite

The following devices had been removed:

        cgm24, cgm8, cgmmono, imdi, lx5000, wtscmyk, wtsimdi

No objections from aja@@ two or three days ago.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.90 2012/03/09 10:59:54 espie Exp $
d9 1
a35 1
BUILD_DEPENDS=	print/cups>=1.5.0
d94 1
a94 1
ALL_TARGET_NON_SHARED-No = 	so all
d96 1
a96 1
INSTALL_TARGET_NON_SHARED-No =	install install-so
d206 1
d209 1
d321 2
d324 12
@


1.90
log
@FLAVOR:L -> FLAVOR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.89 2011/11/16 12:43:23 kili Exp $
d5 1
a5 1
VERSION=	9.04
d8 1
a8 1
SHARED_LIBS=	gs	14.0
d10 1
a10 1
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=ghostscript/}
d30 1
a30 1
WANTLIB=	c ijs m jbig2dec jpeg>=62 lcms png>=6 pthread tiff z
d38 1
a38 1
		graphics/lcms		\
a65 1
		JPX_LIB=jasper				\
a91 9
# Jasper needs this. Everything else seems to work better without auto*.
WRKCONF=		${WRKSRC}/jasper
CONFIGURE_STYLE=	gnu
CONFIGURE_ENV=		AWK=/usr/bin/awk			\
			CFLAGS='${CFLAGS}'			\
			GREP=/usr/bin/grep			\
			LDFLAGS='${LDFLAGS} -L${LOCALBASE}/lib'	\
			LIBS=-ljpeg

d120 1
a120 1
WANTLIB+=	gmodule-2.0 gobject-2.0 gthread-2.0 gtk-x11-2.0>=1000
d159 1
a159 1
	    ${WRKSRC}/cups/pstopxl.in > ${WRKSRC}/cups/pstopxl
d167 1
a167 1
		mv freetype ijs jpeg libpng jbig2dec tiff zlib junk
d173 2
a174 2
	@@${INSTALL_DATA_DIR} ${PREFIX}/share/ghostscript 
	@@${INSTALL_PROGRAM_DIR} ${PREFIX}/bin 
d204 2
a205 1
	${INSTALL_SCRIPT} ${WRKSRC}/cups/pstopxl ${PREFIX}/libexec/cups/filter
d217 1
a217 1
		cdj890 cdj970 cdjcolor cdjmono chp2200 cljet5 cljet5c \
d233 1
a233 1
		epl5800 epl5900 epl6100 epl6200 eps9high eps9mid \
d244 1
a244 1
 
d246 1
a246 1
DEVICES+=	lex2050 lex3200 lex5700 lex7000 lx5000 lxm3200 lxm5700m
d253 1
a253 1
 
d280 1
a280 1
 
d284 1
a284 1
 
d286 1
a286 1
DEVICES+=	jpeg jpegcmyk jpeggray jpx
d295 2
a296 2
DEVICES+=	tiff12nc tiff24nc tiff32nc tiffcrle tiffgray tifflzw \
		tiffpack tiffs tiffsep
d302 2
a303 2
DEVICES+=	pam pamcmyk32 pbm pbmraw pgm pgmraw pgnm pgnmraw pkm pkmraw \
		pksm pksmraw pnm pnmraw ppm ppmraw
d306 2
a307 5
DEVICES+=	bbox epswrite pdfwrite ps2write psdcmyk psdf psdrgb \
		psgray psmono psrgb pswrite

# WTS_HALFTONING_DEVS
DEVICES+=	imdi simdi wtscmyk wtsimdi
d310 1
a310 1
DEVICES+=	bit bitcmyk bitrgb bitrgbtags ccr cgm24 cgm8 cgmmono \
@


1.89
log
@Update to ghostscript-9.04.

Enable jbig2dec support.

New devices still not enabled (I've to resort the
device list anyway).

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.88 2011/11/13 21:18:40 kili Exp $
d111 1
a111 1
.if ${FLAVOR:L:Ma4}
d122 1
a122 1
.if ${FLAVOR:L:Mgtk} && ${FLAVOR:L:Mno_x11}
d124 1
a124 1
.elif ${FLAVOR:L:Mgtk}
d146 1
a146 1
.if !${FLAVOR:L:Mno_x11}
@


1.88
log
@Don't build with -fno-builtin.

This was meant to reveal some problems decades ago, but actually it
now hides potential problems (with wrong printf format strings).

Format string problems will be dealt with after the update to gs9.04.

Thanks to espie@@ who noticed that gs uses -fno-builtin.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.87 2011/09/16 11:13:41 espie Exp $
d5 1
a5 1
VERSION=	9.02
a6 1
REVISION=	3
d8 1
a8 1
SHARED_LIBS=	gs	13.0
d30 1
a30 1
WANTLIB=	c ijs m jpeg>=62 lcms png>=6 pthread tiff z
d36 2
a37 1
LIB_DEPENDS=	graphics/jpeg		\
a65 1
		JBIG2SRCDIR=./jbig2dec			\
d299 3
@


1.87
log
@normalize pkgpath
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.86 2011/09/08 10:34:06 ajacoutot Exp $
d7 1
a7 1
REVISION=	2
@


1.86
log
@New libcupsimage version for dlopen.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.85 2011/07/18 20:24:36 kili Exp $
d7 1
a7 1
REVISION=	1
@


1.85
log
@Bring back pstopxl.

bleeding-eyes diff (zapping perl regexps from sed invocations) from
jirib, who also tested the complete diff.

According to jirib, it's still very slow (ten minutes for two pages),
but at least it works.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.84 2011/07/06 13:49:17 kili Exp $
d7 1
a7 1
REVISION=	0
d36 1
a36 1
BUILD_DEPENDS=	print/cups>=1.4.3
@


1.84
log
@Update to gs-9.02 to fix the google maps problem with pdf2ps.

Drop gstoraster (formerly known as ps2raster); it is replaced
by the new gstoraster package.

Also Drop pstopxl, it's currently broken (at least since gs-9.00).
If anyone needs it, please let me know (or patch/repair it yourself
and send me a diff). Note that it would need rather heavy patching
or it had to depend on gnu grep.

ok aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.83 2011/06/08 19:15:48 kili Exp $
d7 1
d162 10
d214 4
@


1.83
log
@Update to ghostscript-9.00.

ok landry@@ (after putting it in a bulk build... thanks)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.82 2011/03/02 07:10:55 ajacoutot Exp $
d5 1
a5 1
VERSION=	9.00
d8 1
a8 1
SHARED_LIBS=	gs	12.0
a54 4
		CUPSCFLAGS="$$(cups-config --cflags)"	\
		CUPSSERVERBIN="$$(cups-config --serverbin)" \
		CUPSSERVERROOT="$$(cups-config --serverroot)" \
		CUPSDATA="$$(cups-config --datadir)"	\
d127 1
a127 1
WANTLIB+=	Xau Xcomposite Xcursor Xdamage Xdmcp Xfixes Xi Xinerama
d132 2
a133 2
WANTLIB+=	xcb xcb-render
WANTLIB+=	GL Xxf86vm drm xcb-shm
d143 1
a143 1
NOGTK_DEVICES= display
a168 6
pre-configure:
	${SUBST_CMD} ${WRKSRC}/cups/pstoraster

pre-configure:
	${SUBST_CMD} ${WRKSRC}/cups/pstoraster

a202 2
	mv ${DESTDIR}/${SYSCONFDIR}/cups/* ${PREFIX}/share/ghostscript/${VERSION}/examples
	rm -rf ${DESTDIR}/${SYSCONFDIR}/cups
@


1.82
log
@Do not hardcode fonts path in pstoraster and fix it while here.
Create ${SYSCONFDIR}/cups/ with the correct group ownership.

Tweaks from and ok kili@@ (maintainer).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.81 2010/11/22 09:34:10 espie Exp $
d5 1
a5 1
VERSION=	8.63
a6 1
REVISION=	16
d8 1
a8 1
SHARED_LIBS=	gs	11.0
d23 1
a23 1
# GPLv2, except for the included CMap files from Adobe, which may
d30 1
a30 1
WANTLIB=	c ijs m jpeg>=62 png>=6 pthread z
d36 2
a37 1
LIB_DEPENDS=	graphics/jpeg	\
d39 1
d48 2
d54 1
d61 1
d64 1
a64 1
		GLSRCDIR=./src				\
d75 2
a76 1
		PSSRCDIR=./src				\
d78 1
d80 1
d82 1
d84 2
d88 1
a88 1
		STDLIBS='-pthread -lm -liconv'		\
d113 1
a113 1
SOC_LIBS =			-L${LOCALBASE}/lib -ljpeg -pthread
d136 2
a137 1
WANTLIB+=	xcb xcb-render xcb-render-util
d151 5
a155 1
WANTLIB+=	X11 Xt Xext
d157 4
a160 1
SOC_LIBS+=	-L${X11BASE}/lib -lXt -lXt -lXext
d169 6
a174 2
	ln -s src/unix-gcc.mak ${WRKDIST}/Makefile
	cd ${WRKSRC} && rm -rf zlib ijs jpeg libpng
@


1.81
log
@missed some new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.80 2010/11/20 09:48:39 espie Exp $
d7 1
a7 1
REVISION=	15
d152 3
@


1.80
log
@new depends
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.79 2010/10/24 21:32:39 ajacoutot Exp $
d31 1
a31 1
WANTLIB=	c ijs m jpeg.>=62 png.>=6 pthread z
d118 1
a118 1
LIB_DEPENDS+=	::x11/gtk+2
d122 2
a123 2
WANTLIB+=	gdk-x11-2.0.>=1000 gdk_pixbuf-2.0.>=1000 gio-2.0 glib-2.0
WANTLIB+=	gmodule-2.0 gobject-2.0 gthread-2.0 gtk-x11-2.0.>=1000
@


1.79
log
@Remove USE_X11.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.78 2010/10/18 21:25:08 espie Exp $
d35 5
a39 5
RUN_DEPENDS=	:ghostscript-fonts-*:print/ghostscript/gnu-fonts
BUILD_DEPENDS=	:cups->=1.4.3:print/cups
LIB_DEPENDS=	::graphics/jpeg	\
		::graphics/png		\
		::print/ijs
@


1.78
log
@USE_GROFF=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.77 2010/10/11 08:17:16 jasper Exp $
a138 1
USE_X11=	Yes
@


1.77
log
@- fix WANTLIB after cairo update.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.76 2010/08/19 08:19:45 jasper Exp $
d45 1
@


1.76
log
@Security fix for SA40452
Ghostscript "-P-" Command Line Option Security Issue.

ok kili@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2010/07/26 20:07:31 edd Exp $
d7 1
a7 1
REVISION=	14
d122 1
a122 1
WANTLIB+=	glitz gmodule-2.0 gobject-2.0 gthread-2.0 gtk-x11-2.0.>=1000
@


1.75
log
@Convert a whole bunch of ports/print to use new WANTLIB/LIB_DEPENDS/REVISION.
OK aja@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.74 2010/05/24 14:25:05 kili Exp $
d7 1
a7 1
REVISION=	13
@


1.75.2.1
log
@Security fix for SA40452
Ghostscript "-P-" Command Line Option Security Issue.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.75 2010/07/26 20:07:31 edd Exp $
d7 1
a7 1
REVISION=	14
@


1.74
log
@Remove all traces of SO(BIN|REL)DIR, as ./obj/foo and ./obj/../obj/foo
are different files for gmake, which leads to wrong target rebuilds
on NFS. Some targets are still rebuilt on NFS, but at least in the
correct order and without trashing ./obj/ld.tr and/or ./obj/ldt.tr.

This hopefully fixes the build problems landry@@ and marco@@ had with
WRKOBJDIR on NFS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.73 2010/05/10 18:41:49 espie Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p12
d31 1
a31 1
WANTLIB=	m c pthread z
d37 3
a39 3
LIB_DEPENDS=	jpeg.>=62::graphics/jpeg	\
		png.>=6::graphics/png		\
		ijs::print/ijs
d117 1
a117 1
LIB_DEPENDS+=	gdk-x11-2.0.>=1000,gdk_pixbuf-2.0.>=1000,gtk-x11-2.0.>=1000::x11/gtk+2
d119 6
a124 4
WANTLIB+=	Xcomposite Xcursor Xdamage Xau Xdmcp Xfixes Xi Xinerama \
		Xrandr Xrender atk-1.0 cairo expat fontconfig freetype \
		gio-2.0 glib-2.0 glitz gmodule-2.0 gobject-2.0 pango-1.0 \
		pangocairo-1.0 pangoft2-1.0 pixman-1 pthread-stubs xcb
@


1.73
log
@use "our" make :C modifier instead of systemV substitution, since that one
is a bit fuzzy, and we want to change it to help xenocara.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2010/03/31 16:22:30 ajacoutot Exp $
a73 2
		SOBINRELDIR=../obj			\
		SOOBJRELDIR=../obj			\
@


1.72
log
@Bump cups requirements.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2010/02/06 19:56:40 kili Exp $
d54 1
a54 1
		DEVICE_DEVS='${DEVICES:=$(DD)%.dev}'	\
@


1.71
log
@Actully build the complete thing during make build instead of linking
obj/gs during make fake. This fixes the breakage on hppa found by
landry@@ the other day. Bump PKGNAME to be save (shouldn't be
necessary, but the failure on hppa was weird enough to get paranoic).

Builds fine on hppa for landry@@.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.70 2010/01/04 19:14:52 jasper Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p11
d36 1
a36 1
BUILD_DEPENDS=	::print/cups
@


1.71.2.1
log
@Security fix for SA40452
Ghostscript "-P-" Command Line Option Security Issue.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.71 2010/02/06 19:56:40 kili Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p12
@


1.70
log
@SECURITY FIX:
CVE-2009-4270: Ghostscript "errprintf()" Buffer Overflow Vulnerability

ok kili@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.69 2009/09/13 20:59:16 ajacoutot Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p10
d98 1
a98 1
ALL_TARGET_NON_SHARED-No = 	so
@


1.69
log
@Always add the 'display' device for !no_x11.
Thanks to kili@@'s idea, it is possible to make it wok alongside regular
command line invocation whether we have gtk support or not.
This change fixes helpers like libspectre which depend on this device
driver being available (even when we don't want the gtk FLAVOR).

Tweak DESCR while here.

ok kili@@ aka The Thing Padawan
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.68 2009/08/10 06:34:08 kili Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p9
@


1.68
log
@WANTLIB changes after xcb addition and bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2009/06/16 21:03:59 sthen Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p8
d109 7
d124 1
a124 1
		pangocairo-1.0 pangoft2-1.0 pixman-1
a125 1
DEVICES+=	${GTK_DEVICES}
d129 2
d133 2
d139 2
a140 2
WANTLIB+=	X11 Xt Xext pthread-stubs xcb
DEVICES+=	${X11_DEVICES}
a300 3

# gtk (display driver)
GTK_DEVICES=	display
@


1.67
log
@add a patch from upstream; fixes printing PDFs with canon drivers bjc600/800.
ok kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2009/04/27 08:26:23 bernd Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p7
d129 1
a129 1
WANTLIB+=	X11 Xt Xext
@


1.67.2.1
log
@MFC:

SECURITY FIX

Resolves CVE-2009-4270

ok jasper@@ kili@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.67 2009/06/16 21:03:59 sthen Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p10
@


1.66
log
@Sync after latest cups library bump.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.65 2009/04/16 19:53:38 jasper Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p6
@


1.65
log
@- add security fix for CVE-2009-0196

ok kili@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2009/04/06 17:06:33 jasper Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p5
@


1.64
log
@- add SECURITY FIXES for SA34534, CVE-2009-0583 and CVE-2009-0584.
patches taken from upstream and gentoo bugreports

ok kili@@ (MAINTAINER)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.63 2009/01/19 12:46:22 kili Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p4
@


1.63
log
@
Build, install and use libgs in all flavors on shared archs. Note:
there is currently no libgs (not even a libgs.a) on static archs.

Install only *one* binary (bin/gs), even in the gtk flavor; the gsc
binary in the gtk flavor was identically to gsx, with the exception
that the display driver (which is the sole purpose of the gtk flavor)
didn't work in gsc.

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2008/12/23 10:55:30 ajacoutot Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p3
@


1.62
log
@- last commit needed a bump
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2008/12/23 00:18:01 jolan Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p2
d76 2
d81 1
d96 9
d116 1
a116 1
		glib-2.0 glitz gmodule-2.0 gobject-2.0 pango-1.0 \
a117 4
MAKE_FLAGS+=	SOC_CFLAGS="$$(pkg-config gtk+-2.0 --cflags)" \
		SOC_LIBS="$$(pkg-config gtk+-2.0 --libs) -pthread"
ALL_TARGET=	so
INSTALL_TARGET=	install install-so
d120 5
d131 1
d156 6
a161 5
.if ${FLAVOR:L:Mgtk}
	${STRIP} ${PREFIX}/bin/gsc
	${STRIP} ${PREFIX}/bin/gsx
	ln -sf gsc ${PREFIX}/bin/gs
.else
a162 1
.endif
d296 3
@


1.61
log
@respect SYSCONFDIR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.60 2008/11/19 09:59:38 ajacoutot Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p1
@


1.60
log
@- install pstoraster.convs sample file so that CUPS can use pstoraster
without any configuration tweaks

ok kili@@ (maintainer)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2008/11/12 19:26:38 kili Exp $
d163 2
a164 2
	mv ${DESTDIR}/etc/cups/* ${PREFIX}/share/ghostscript/${VERSION}/examples
	rm -rf ${DESTDIR}/etc/cups
@


1.59
log
@
Use dlopen(2) for cups libraries to get rid of the cups flavor and
the evil circular dependencies.

Idea: bernd@@
Tests: ajacoutot@@
Catering: Sir Lancelot
Music: Dave Soldier and Komar & Melamid

ok ajacoutot@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2008/10/28 17:53:42 kili Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p0
@


1.58
log
@
Update to 8.63.

ok ajacoutot (who trusts me... hrhrhr)
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2008/07/12 19:11:56 kili Exp $
d7 1
d17 1
a17 1
FLAVORS=	a4 gtk no_x11 cups
d36 1
a36 1

d50 4
d106 2
a107 5
MAKE_FLAGS+=	SOC_CFLAGS="$$(pkg-config gtk+-2.0 --cflags)"
# This one is used in the addition of SOC_LIBS to MAKE_FLAGS later.
# We need this stunt to get gsc and gsx linked correctly when the cups
# flavor is enabled.
SOC_LIBS=	$$(pkg-config gtk+-2.0 --libs) -pthread
a119 16
.if ${FLAVOR:L:Mcups}
LIB_DEPENDS+=	cups.>=3,cupsimage.>=2::print/cups
CUPSLIBS=	$$(cups-config --image --libs)
EXTRALIBS+=	${CUPSLIBS}
SOC_LIBS+=	${CUPSLIBS}
DEVICES+=	${CUPS_DEVICES}
WANTLIB+=	crypto ssl tiff
MAKE_FLAGS+=	CUPSCFLAGS="$$(cups-config --cflags)" \
		CUPSSERVERBIN="$$(cups-config --serverbin)" \
		CUPSSERVERROOT="$$(cups-config --serverroot)" \
		CUPSDATA="$$(cups-config --datadir)"
.endif

SOC_LIBS?=
MAKE_FLAGS+=	SOC_LIBS="${SOC_LIBS}"

a162 1
.if ${FLAVOR:L:Mcups}
a163 3
.else
	rm -rf ${PREFIX}/libexec/cups
.endif
d276 1
a276 1
CUPS_DEVICES=	cups
@


1.57
log
@
Instead of copying the address, just copy the color data.

Initially found by naddy grepping for suspicious casts.
Bug and patch approved upstream.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2008/05/09 19:29:44 kili Exp $
d5 1
a5 1
VERSION=	8.62
a6 1
PKGNAME=	${DISTNAME}p2
d30 1
a30 1
WANTLIB=	m c z
d71 2
a72 1
		STDLIBS='-lm -liconv'			\
d100 1
a100 1
		pangocairo-1.0 pangoft2-1.0
d105 1
a105 1
SOC_LIBS=	$$(pkg-config gtk+-2.0 --libs)
d124 1
a124 1
WANTLIB+=	crypto pthread ssl tiff
@


1.56
log
@
Fix the build of the gtk flavor on amd64.

Tested by steven@@, who also found the problem.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.55 2008/04/06 15:48:13 kili Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p1
@


1.55
log
@
Re-add some important files dropped with the last update.

Noticed by Onat I. <onatinadresi@@gmail.com>, fix double-checked also
by Onat I. and Giovanni Bechis <bigionews@@snb.it>.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2008/04/01 20:37:00 kili Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p0
@


1.54
log
@
Update to 8.62.

NOTE: the cups flavor will probably vanish very soon. See
http://marc.info/?l=openbsd-ports&m=120624299930920&w=2 for
explanation.

"looks ok", and some testing, jakemsr@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.53 2008/01/04 17:48:37 espie Exp $
d7 1
@


1.53
log
@tweak FAKE_FLAGS semantics to saner defaults.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.52 2007/11/19 20:06:56 kili Exp $
d5 1
a5 1
VERSION=	8.60
d8 1
a8 1
SHARED_LIBS=	gs	10.0
d100 5
a104 2
MAKE_FLAGS+=	SOC_CFLAGS="$$(pkg-config gtk+-2.0 --cflags)" \
		SOC_LIBS="$$(pkg-config gtk+-2.0 --libs)"
d119 3
a121 1
EXTRALIBS+=	$$(cups-config --image --libs)
d124 4
d130 3
d273 1
a273 1
DEVICES+=	pam pbm pbmraw pgm pgmraw pgnm pgnmraw pkm pkmraw \
@


1.52
log
@
Update to 8.60.
Add a cups flavor (for the pstoraster thingy).
Accept the truth and dake maintainership.

Tested by many.
ok simon@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.51 2007/09/15 23:36:43 merdely Exp $
a121 2

FAKE_FLAGS+=	${MAKE_FLAGS} DESTDIR=${WRKINST}
@


1.51
log
@Put quotes back around ERRORS.

From simon@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2007/09/15 21:36:44 merdely Exp $
d5 2
a6 3
VERSION=	8.54
DISTNAME=	ghostscript-${VERSION}-gpl
PKGNAME=	${DISTNAME:S,-gpl,,}p1
d8 1
a8 1
SHARED_LIBS=	gs	9.0
d14 5
d23 2
a24 1
# GPL 
a28 1
WANTLIB=		m c z jpeg png
d30 3
d36 8
a43 1
LIB_DEPENDS=	::graphics/png ::graphics/jpeg
d45 1
a45 67
BASE_FLAGS=	INSTALL_PROGRAM='${INSTALL_SCRIPT}' \
		INSTALL_DATA='${INSTALL_DATA}' \
		SHARE_LIBPNG=1 \
		SHARE_ZLIB=1 \
		CFLAGS_STANDARD='${CFLAGS}' \
		XLDFLAGS=-L${LOCALBASE}/lib \
		BINDIR=./obj \
		GLSRCDIR=./src \
		GLGENDIR=./obj \
		GLOBJDIR=./obj \
		PSSRCDIR=./src \
		PSLIBDIR=./lib \
		PSGENDIR=./obj \
		PSOBJDIR=./obj \
		JBIG2SRCDIR=./jbig2dec \
		ICCSRCDIR=./icclib \
		IJSSRCDIR=./ijs \
		SOOBJRELDIR=../obj \
		SOBINRELDIR=../obj \
		STDLIBS='-lm' \
		LIBgs_VERSION=${LIBgs_VERSION}

PDFDIR=share/ghostscript/${VERSION}/lib

X11_DEVICE_DEVS1= $$(DD)x11.dev $$(DD)x11alpha.dev $$(DD)x11cmyk.dev \
$$(DD)x11cmyk2.dev $$(DD)x11cmyk4.dev $$(DD)x11cmyk8.dev \
$$(DD)x11gray2.dev $$(DD)x11gray4.dev $$(DD)x11mono.dev

BASE_DEVICE_DEVS1= $$(DD)ap3250.dev $$(DD)appledmp.dev $$(DD)bbox.dev \
$$(DD)bit.dev $$(DD)bitcmyk.dev $$(DD)bitrgb.dev $$(DD)bj10e.dev \
$$(DD)bj200.dev $$(DD)bjc600.dev $$(DD)bjc800.dev $$(DD)bmp16.dev \
$$(DD)bmp16m.dev $$(DD)bmp256.dev $$(DD)bmp32b.dev $$(DD)bmpgray.dev \
$$(DD)bmpmono.dev $$(DD)bmpsep1.dev $$(DD)bmpsep8.dev $$(DD)ccr.dev \
$$(DD)cdeskjet.dev $$(DD)cdj500.dev $$(DD)cdj550.dev $$(DD)cdjcolor.dev \
$$(DD)cdjmono.dev $$(DD)cgm24.dev $$(DD)cgm8.dev $$(DD)cgmmono.dev \
$$(DD)cif.dev $$(DD)cljet5.dev $$(DD)cljet5c.dev $$(DD)cp50.dev \
$$(DD)declj250.dev $$(DD)deskjet.dev $$(DD)devicen.dev $$(DD)dfaxhigh.dev \
$$(DD)dfaxlow.dev $$(DD)djet500.dev $$(DD)djet500c.dev $$(DD)dnj650c.dev \
$$(DD)eps9high.dev $$(DD)eps9mid.dev $$(DD)epson.dev $$(DD)epsonc.dev \
$$(DD)epswrite.dev $$(DD)faxg3.dev $$(DD)faxg32d.dev $$(DD)faxg4.dev \
$$(DD)hl7x0.dev $$(DD)ibmpro.dev $$(DD)ijs.dev $$(DD)imagen.dev \
$$(DD)inferno.dev $$(DD)iwhi.dev $$(DD)iwlo.dev $$(DD)iwlq.dev \
$$(DD)jetp3852.dev $$(DD)jpeg.dev $$(DD)jpeggray.dev $$(DD)laserjet.dev \
$$(DD)lbp8.dev $$(DD)lips3.dev $$(DD)lj250.dev $$(DD)lj4dith.dev \
$$(DD)lj5gray.dev $$(DD)lj5mono.dev $$(DD)ljet2p.dev $$(DD)ljet3.dev \
$$(DD)ljet3d.dev $$(DD)ljet4.dev $$(DD)ljet4d.dev $$(DD)ljetplus.dev \
$$(DD)lp2563.dev $$(DD)lp8000.dev $$(DD)lq850.dev $$(DD)m8510.dev \
$$(DD)mgr4.dev $$(DD)mgr8.dev $$(DD)mgrgray2.dev $$(DD)mgrgray4.dev \
$$(DD)mgrgray8.dev $$(DD)mgrmono.dev $$(DD)miff24.dev $$(DD)necp6.dev \
$$(DD)oce9050.dev $$(DD)oki182.dev $$(DD)okiibm.dev $$(DD)paintjet.dev \
$$(DD)pbm.dev $$(DD)pbmraw.dev $$(DD)pcx16.dev $$(DD)pcx24b.dev \
$$(DD)pcx256.dev $$(DD)pcxcmyk.dev $$(DD)pcxgray.dev $$(DD)pcxmono.dev \
$$(DD)pdfwrite.dev $$(DD)pgm.dev $$(DD)pgmraw.dev $$(DD)pgnm.dev \
$$(DD)pgnmraw.dev $$(DD)pj.dev $$(DD)pjetxl.dev $$(DD)pjxl.dev \
$$(DD)pjxl300.dev $$(DD)pkm.dev $$(DD)pkmraw.dev $$(DD)pksm.dev \
$$(DD)pksmraw.dev $$(DD)plan9bm.dev $$(DD)png16.dev $$(DD)png16m.dev \
$$(DD)png256.dev $$(DD)png48.dev $$(DD)pngalpha.dev $$(DD)pnggray.dev \
$$(DD)pngmono.dev $$(DD)pnm.dev $$(DD)pnmraw.dev $$(DD)ppm.dev \
$$(DD)ppmraw.dev $$(DD)ps2write.dev $$(DD)psdcmyk.dev $$(DD)psdrgb.dev \
$$(DD)psgray.dev $$(DD)psmono.dev $$(DD)psrgb.dev $$(DD)pswrite.dev \
$$(DD)pxlcolor.dev $$(DD)pxlmono.dev $$(DD)r4081.dev $$(DD)sgirgb.dev \
$$(DD)sj48.dev $$(DD)spotcmyk.dev $$(DD)st800.dev $$(DD)stcolor.dev \
$$(DD)t4693d2.dev $$(DD)t4693d4.dev $$(DD)t4693d8.dev $$(DD)tek4696.dev \
$$(DD)tiff12nc.dev $$(DD)tiff24nc.dev $$(DD)tiff32nc.dev \
$$(DD)tiffcrle.dev $$(DD)tiffg3.dev $$(DD)tiffg32d.dev $$(DD)tiffg4.dev \
$$(DD)tiffgray.dev $$(DD)tifflzw.dev $$(DD)tiffpack.dev $$(DD)tiffsep.dev \
$$(DD)uniprint.dev $$(DD)xcf.dev
d47 28
a74 2
MAKE_FLAGS=	${BASE_FLAGS}
CFLAGS+=	-DSYS_TYPES_HAS_STDINT_TYPES
d76 1
a76 2
INCPATHS=	-I${LOCALBASE}/include				\
		-I${LOCALBASE}/include/libpng
d78 2
a79 1
USE_GMAKE=	Yes
d81 5
a85 7
CONFIGURE_ENV=	CFLAGS="${CFLAGS} ${INCPATHS}"			\
		LDFLAGS="${LDFLAGS} -L${LOCALBASE}/lib"		\
		LIBS=-ljpeg


FLAVORS=	a4 gtk no_x11
FLAVOR?=
d94 8
a101 3
MODULES=	devel/gettext
LIB_DEPENDS+=	gtk.>=1,gdk::x11/gtk+
WANTLIB+=	Xi glib gmodule
d103 3
a105 6
INSTALL_TARGET=	soinstall
NOT_FOR_ARCHS=${NO_SHARED_ARCHS}
X11_DEVICE_DEVS1+=	$$(DD)display.dev
.else
ALL_TARGET=	all
INSTALL_TARGET=	install
d108 1
a108 4
.if ${FLAVOR:L:Mno_x11}
CONFIGURE_ARGS+=--without-x
BASE_FLAGS+=	DEVICE_DEVS1='${BASE_DEVICE_DEVS1}'
.else
d110 9
a118 3
CONFIGURE_ARGS+=--with-x
WANTLIB+=	X11 Xt SM Xext ICE
BASE_FLAGS+=	DEVICE_DEVS1='${X11_DEVICE_DEVS1} ${BASE_DEVICE_DEVS1}'
d123 1
a123 3
FAKE_FLAGS=${BASE_FLAGS} prefix=${WRKINST}${PREFIX} \
		mandir=${WRKINST}${PREFIX}/man

d126 1
d129 2
a130 3

pre-configure:
	rm -rf ${WRKDIST}/{jpeg,libpng,zlib}
d140 4
d146 3
a148 3
	strip ${PREFIX}/bin/gsc
	strip ${PREFIX}/bin/gsx
	ln -s gsc ${PREFIX}/bin/gs
d150 1
a150 1
	strip ${PREFIX}/bin/gs
d166 121
@


1.50
log
@Remove surrounding quotes in COMMENT/PERMIT_*/ERRORS
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.49 2007/05/26 12:25:10 kili Exp $
d120 1
a120 1
ERRORS+= Fatal: Conflicting flavors: ${FLAVOR}
@


1.49
log
@
Use the pdf_sec.ps shipped with ghostcript 8.54, which has the minor
advance of actually working.
DIST_SUBDIR and Makefile.inc are obsolete now, so drop them.
Use included (and patched) jasper to simplify the update to gs 8.56.

ok jasper@@, jakemsr@@
"go for it", espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2007/01/01 22:54:46 kili Exp $
d3 1
a3 1
COMMENT=	"GNU PostScript interpreter"
d120 1
a120 1
ERRORS+= "Fatal: Conflicting flavors: ${FLAVOR}"
@


1.48
log
@
xargs without -r is bad. Why didn't anyone yell at me when i committed this?
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2006/10/20 16:45:58 steven Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME:S,-gpl,,}p0
a11 1
MASTER_SITES1=	${PDF_SITES}
a14 4
GS_SOURCES=	${DISTNAME}${EXTRACT_SUFX}
DISTFILES=	${GS_SOURCES} pdf_sec.ps:1
EXTRACT_ONLY=	${GS_SOURCES}

a17 1
DIST_SUBDIR=	gs
d24 1
a24 1
WANTLIB=		m c z jasper jpeg png
d29 1
a29 1
LIB_DEPENDS=	::graphics/png ::graphics/jpeg ::graphics/jasper
d103 1
a103 2
		-I${LOCALBASE}/include/libpng			\
		-I${LOCALBASE}/include/jasper
a111 2
# The pdf_sec.ps non-stub version has been moved to a separate package

d155 1
a155 1
	rm -rf ${WRKDIST}/{jasper,jpeg,libpng,zlib}
a186 1
	${INSTALL_DATA} ${FULLDISTDIR}/pdf_sec.ps ${PREFIX}/${PDFDIR}
@


1.47
log
@add @@pkgpath line to allow updating ghostscript/afpl packages

reminded by henning@@, help from espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.46 2006/10/19 13:12:37 kili Exp $
d161 1
a161 1
	find ${WRKDIST} -name '*.orig' -type f | xargs rm
@


1.46
log
@
Update to 8.54.

Some help by steven@@ and espie@@.

"commit" espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.45 2006/08/03 23:28:11 espie Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME:S,-gpl,,}
d20 3
a22 1
SUBST_VARS=	VERSION
@


1.45
log
@new lib specs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.44 2006/01/02 22:44:50 sturm Exp $
d5 3
a7 3
VERSION=	7.05
DISTNAME=	ghostscript-${VERSION}
PKGNAME=	${DISTNAME}p7
d9 1
a9 1
SHARED_LIBS=	gs	7.05
d11 1
a11 2
DIR=		gnu/gs${VERSION:S/.//}
MASTER_SITES=	${GS_SITES} ${MASTER_SITE_GNU:=ghostscript/}
d16 1
d18 1
d20 1
a20 1
SUBST_VARS=		OSREV	VERSION
d28 1
a28 5
WANTLIB=		m c z pthread


JPEGDIR=graphics/jpeg
PNGDIR=graphics/png
a29 1
BUILD_DEPENDS=	::${JPEGDIR}:patch ::${PNGDIR}:patch
d33 1
a33 3
LIB_DEPENDS=	png.>=2::${PNGDIR}

EXTRACT_ONLY=	${GS_SOURCES}
a34 2
WRKSRC=		${WRKDIST}/src
WRKBUILD=	${WRKDIST}
d41 14
a54 9
		XINCLUDE=-I${X11BASE}/include \
		XLIBS='Xt SM ICE Xext X11' \
		XLIBDIRS=-L${X11BASE}/lib \
		GLOBJDIR=./objects \
		GLGENDIR=./objects \
		PSOBJDIR=./objects \
		PSGENDIR=./objects \
		STDLIBS='-pthread -lm' \
		DEVICE_DEVS= \
d59 40
a98 10
X11_DEVICE_DEVS1=\
$$(DD)x11.dev $$(DD)x11alpha.dev $$(DD)x11cmyk.dev $$(DD)x11cmyk2.dev \
$$(DD)x11cmyk4.dev $$(DD)x11cmyk8.dev $$(DD)x11gray2.dev $$(DD)x11gray4.dev \
$$(DD)x11mono.dev

BASE_DEVICE_DEVS1=\
$$(DD)cljet5.dev $$(DD)deskjet.dev $$(DD)djet500.dev $$(DD)laserjet.dev \
$$(DD)ljet2p.dev $$(DD)ljet3.dev $$(DD)ljet3d.dev $$(DD)ljet4.dev \
$$(DD)ljetplus.dev $$(DD)lj5mono.dev $$(DD)lj5gray.dev $$(DD)lp2563.dev \
$$(DD)oce9050.dev $$(DD)faxg3.dev $$(DD)faxg32d.dev $$(DD)faxg4.dev \
d100 2
a101 28
$$(DD)epswrite.dev $$(DD)pdfwrite.dev $$(DD)pswrite.dev $$(DD)pxlmono.dev \
$$(DD)pxlcolor.dev $$(DD)bit.dev $$(DD)bitrgb.dev $$(DD)bitcmyk.dev \
$$(DD)bmpmono.dev $$(DD)bmp16.dev $$(DD)bmp256.dev $$(DD)bmp16m.dev \
$$(DD)cgmmono.dev $$(DD)cgm8.dev $$(DD)cgm24.dev $$(DD)jpeg.dev \
$$(DD)jpeggray.dev $$(DD)miff24.dev $$(DD)pcxmono.dev $$(DD)pcxgray.dev \
$$(DD)pcx16.dev $$(DD)pcx256.dev $$(DD)pcx24b.dev $$(DD)pcxcmyk.dev \
$$(DD)pbm.dev $$(DD)pbmraw.dev $$(DD)pgm.dev $$(DD)pgmraw.dev $$(DD)pgnm.dev \
$$(DD)pgnmraw.dev $$(DD)pnm.dev $$(DD)pnmraw.dev $$(DD)ppm.dev \
$$(DD)ppmraw.dev $$(DD)pkm.dev $$(DD)pkmraw.dev $$(DD)plan9bm.dev \
$$(DD)pngmono.dev $$(DD)pnggray.dev $$(DD)png16.dev $$(DD)png256.dev \
$$(DD)png16m.dev $$(DD)psmono.dev $$(DD)psgray.dev $$(DD)psrgb.dev \
$$(DD)tiff12nc.dev $$(DD)tiff24nc.dev $$(DD)tifflzw.dev $$(DD)tiffpack.dev \
$$(DD)ap3250.dev $$(DD)appledmp.dev $$(DD)bj10e.dev $$(DD)bj200.dev \
$$(DD)bjc600.dev $$(DD)bjc800.dev $$(DD)ccr.dev $$(DD)cdeskjet.dev \
$$(DD)cdjcolor.dev $$(DD)cdjmono.dev $$(DD)cdj500.dev $$(DD)cdj550.dev \
$$(DD)cp50.dev $$(DD)declj250.dev $$(DD)djet500c.dev $$(DD)dnj650c.dev \
$$(DD)epson.dev $$(DD)eps9mid.dev $$(DD)eps9high.dev $$(DD)epsonc.dev \
$$(DD)hl7x0.dev $$(DD)ibmpro.dev $$(DD)imagen.dev $$(DD)iwhi.dev \
$$(DD)iwlo.dev $$(DD)iwlq.dev $$(DD)jetp3852.dev $$(DD)lbp8.dev \
$$(DD)lips3.dev $$(DD)lj250.dev $$(DD)lj4dith.dev $$(DD)lp8000.dev \
$$(DD)lq850.dev $$(DD)m8510.dev $$(DD)necp6.dev $$(DD)oki182.dev \
$$(DD)okiibm.dev $$(DD)paintjet.dev $$(DD)pj.dev $$(DD)pjetxl.dev \
$$(DD)pjxl.dev $$(DD)pjxl300.dev $$(DD)r4081.dev $$(DD)sj48.dev \
$$(DD)st800.dev $$(DD)stcolor.dev $$(DD)t4693d2.dev $$(DD)t4693d4.dev \
$$(DD)t4693d8.dev $$(DD)tek4696.dev $$(DD)uniprint.dev $$(DD)dfaxhigh.dev \
$$(DD)dfaxlow.dev $$(DD)cif.dev $$(DD)inferno.dev $$(DD)mgrmono.dev \
$$(DD)mgrgray2.dev $$(DD)mgrgray4.dev $$(DD)mgrgray8.dev $$(DD)mgr4.dev \
$$(DD)mgr8.dev $$(DD)sgirgb.dev
d103 12
a114 1
MAKE_FLAGS=	${BASE_FLAGS} prefix=${PREFIX}
a115 1
GS_SOURCES=	ghostscript-${VERSION}.tar.gz
a116 2
ALL_TARGET=	all
INSTALL_TARGET=	install
d132 2
a133 2
ALL_TARGET+=so
INSTALL_TARGET+=soinstall
d135 1
a135 1
MAKE_FLAGS += EXTRALIBS="-L${X11BASE}/lib -lXt -lSM -lICE -lXext -lX11 -L${LOCALBASE}/lib -lpng"
d137 2
a138 1
end_install=
d141 4
a144 1
.if !${FLAVOR:L:Mno_x11}
d146 2
a148 3
WANTLIB+=	X11 Xt SM Xext ICE
.else
BASE_FLAGS+=	DEVICE_DEVS1='${BASE_DEVICE_DEVS1}'
d153 3
a155 1
FAKE_FLAGS=${BASE_FLAGS} prefix=${WRKINST}${PREFIX}
d157 1
d159 1
a159 2
	ln -s ${WRKDIR}/${JPEGDIR}/jpeg* ${WRKDIST}/jpeg
	ln -s ${WRKDIR}/${PNGDIR}/libpng* ${WRKDIST}/libpng
d161 2
a162 2
do-configure:
	cd ${WRKBUILD} && ln -s ${WRKSRC}/unix-gcc.mak Makefile
d165 1
a165 4
	mkdir -p ${WRKDIST}/objects
	mkdir -p ${WRKDIST}/bin
	mkdir -p ${WRKDIST}/soobj
	mkdir -p ${WRKDIST}/sobin
d173 5
d179 1
d187 2
a188 1
		ln -sf ps2pdf.1 ps2pdf13.1
d192 1
@


1.44
log
@SHARED_LIBS, bump PKGNAME due to plist changes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.43 2006/01/02 20:22:19 sturm Exp $
d37 1
a37 1
LIB_DEPENDS=	png.2::${PNGDIR}
d121 1
a121 1
LIB_DEPENDS+=	gtk.1,gdk::x11/gtk+
@


1.43
log
@line wrap
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2005/06/02 17:52:12 sturm Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p6
d9 1
d57 2
a58 1
		DEVICE_DEVS=
@


1.42
log
@fix a4 FLAVOR

from Gerardo Santana Gmez Garrido <gerardo.santana at gmail.com>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.41 2005/01/25 17:19:33 alek Exp $
d61 3
a63 2
$$(DD)x11.dev $$(DD)x11alpha.dev $$(DD)x11cmyk.dev $$(DD)x11cmyk2.dev $$(DD)x11cmyk4.dev \
$$(DD)x11cmyk8.dev $$(DD)x11gray2.dev $$(DD)x11gray4.dev $$(DD)x11mono.dev
d66 16
a81 13
$$(DD)cljet5.dev $$(DD)deskjet.dev $$(DD)djet500.dev $$(DD)laserjet.dev $$(DD)ljet2p.dev \
$$(DD)ljet3.dev $$(DD)ljet3d.dev $$(DD)ljet4.dev $$(DD)ljetplus.dev $$(DD)lj5mono.dev \
$$(DD)lj5gray.dev $$(DD)lp2563.dev $$(DD)oce9050.dev $$(DD)faxg3.dev $$(DD)faxg32d.dev \
$$(DD)faxg4.dev $$(DD)tiffcrle.dev $$(DD)tiffg3.dev $$(DD)tiffg32d.dev $$(DD)tiffg4.dev \
$$(DD)epswrite.dev $$(DD)pdfwrite.dev $$(DD)pswrite.dev $$(DD)pxlmono.dev $$(DD)pxlcolor.dev \
$$(DD)bit.dev $$(DD)bitrgb.dev $$(DD)bitcmyk.dev $$(DD)bmpmono.dev $$(DD)bmp16.dev \
$$(DD)bmp256.dev $$(DD)bmp16m.dev $$(DD)cgmmono.dev $$(DD)cgm8.dev $$(DD)cgm24.dev \
$$(DD)jpeg.dev $$(DD)jpeggray.dev $$(DD)miff24.dev $$(DD)pcxmono.dev $$(DD)pcxgray.dev \
$$(DD)pcx16.dev $$(DD)pcx256.dev $$(DD)pcx24b.dev $$(DD)pcxcmyk.dev $$(DD)pbm.dev \
$$(DD)pbmraw.dev $$(DD)pgm.dev $$(DD)pgmraw.dev $$(DD)pgnm.dev $$(DD)pgnmraw.dev \
$$(DD)pnm.dev $$(DD)pnmraw.dev $$(DD)ppm.dev $$(DD)ppmraw.dev $$(DD)pkm.dev \
$$(DD)pkmraw.dev $$(DD)plan9bm.dev $$(DD)pngmono.dev $$(DD)pnggray.dev $$(DD)png16.dev \
$$(DD)png256.dev $$(DD)png16m.dev $$(DD)psmono.dev $$(DD)psgray.dev $$(DD)psrgb.dev \
d83 16
a98 13
$$(DD)ap3250.dev $$(DD)appledmp.dev $$(DD)bj10e.dev $$(DD)bj200.dev $$(DD)bjc600.dev \
$$(DD)bjc800.dev $$(DD)ccr.dev $$(DD)cdeskjet.dev $$(DD)cdjcolor.dev $$(DD)cdjmono.dev \
$$(DD)cdj500.dev $$(DD)cdj550.dev $$(DD)cp50.dev $$(DD)declj250.dev $$(DD)djet500c.dev \
$$(DD)dnj650c.dev $$(DD)epson.dev $$(DD)eps9mid.dev $$(DD)eps9high.dev $$(DD)epsonc.dev \
$$(DD)hl7x0.dev $$(DD)ibmpro.dev $$(DD)imagen.dev $$(DD)iwhi.dev $$(DD)iwlo.dev \
$$(DD)iwlq.dev $$(DD)jetp3852.dev $$(DD)lbp8.dev $$(DD)lips3.dev $$(DD)lj250.dev \
$$(DD)lj4dith.dev $$(DD)lp8000.dev $$(DD)lq850.dev $$(DD)m8510.dev $$(DD)necp6.dev \
$$(DD)oki182.dev $$(DD)okiibm.dev $$(DD)paintjet.dev $$(DD)pj.dev $$(DD)pjetxl.dev \
$$(DD)pjxl.dev $$(DD)pjxl300.dev $$(DD)r4081.dev $$(DD)sj48.dev $$(DD)st800.dev \
$$(DD)stcolor.dev $$(DD)t4693d2.dev $$(DD)t4693d4.dev $$(DD)t4693d8.dev $$(DD)tek4696.dev \
$$(DD)uniprint.dev $$(DD)dfaxhigh.dev $$(DD)dfaxlow.dev $$(DD)cif.dev $$(DD)inferno.dev \
$$(DD)mgrmono.dev $$(DD)mgrgray2.dev $$(DD)mgrgray4.dev $$(DD)mgrgray8.dev \
$$(DD)mgr4.dev $$(DD)mgr8.dev $$(DD)sgirgb.dev
@


1.41
log
@- Don't set soname for libs
- Use devel/gettext MODULE
- Add WANTLIB markers
- Bump PKGNAME

go ahead brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.40 2005/01/24 16:00:14 brad Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p5
d104 1
a104 1
.if ${FLAVOR:U:Ma4}
@


1.40
log
@bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.39 2004/10/24 20:58:47 brad Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p4
d26 1
d111 1
d113 1
d125 1
@


1.39
log
@Fix insecure tempfile creation in pj-gs.sh, ps2epsi, pv.sh and sysvlp.sh.

http://marc.theaimsgroup.com/?l=bugtraq&m=109655739113230&w=2
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.38 2004/09/15 18:32:14 espie Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p3
@


1.38
log
@new plists
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.37 2004/07/10 17:21:58 brad Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p2
@


1.37
log
@add a no_x11 FLAVOR
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.36 2004/02/25 01:28:07 brad Exp $
d110 1
a110 1
LIB_DEPENDS+=	gtk.1::x11/gtk+
@


1.36
log
@bump PKGNAME
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.35 2004/01/29 19:11:04 pvalchev Exp $
a36 2
USE_X11=	Yes

a38 1
#WRKDIST=	${WRKDIR}/gs${VERSION}
d54 2
a55 1
		STDLIBS='-pthread -lm' 
d59 30
a88 37
BASE_FLAGS+=	DEVICE_DEVS1='\
$$(DD)x11.dev $$(DD)x11alpha.dev $$(DD)x11cmyk.dev $$(DD)x11cmyk2.dev \
$$(DD)x11cmyk4.dev $$(DD)x11cmyk8.dev $$(DD)x11gray2.dev \
$$(DD)x11gray4.dev $$(DD)x11mono.dev $$(DD)cljet5.dev $$(DD)deskjet.dev \
$$(DD)djet500.dev $$(DD)laserjet.dev $$(DD)ljet2p.dev $$(DD)ljet3.dev \
$$(DD)ljet3d.dev $$(DD)ljet4.dev $$(DD)ljetplus.dev $$(DD)lj5mono.dev \
$$(DD)lj5gray.dev $$(DD)lp2563.dev $$(DD)oce9050.dev $$(DD)faxg3.dev \
$$(DD)faxg32d.dev $$(DD)faxg4.dev $$(DD)tiffcrle.dev $$(DD)tiffg3.dev \
$$(DD)tiffg32d.dev $$(DD)tiffg4.dev $$(DD)epswrite.dev $$(DD)pdfwrite.dev \
$$(DD)pswrite.dev $$(DD)pxlmono.dev $$(DD)pxlcolor.dev $$(DD)bit.dev \
$$(DD)bitrgb.dev $$(DD)bitcmyk.dev $$(DD)bmpmono.dev $$(DD)bmp16.dev \
$$(DD)bmp256.dev $$(DD)bmp16m.dev $$(DD)cgmmono.dev $$(DD)cgm8.dev \
$$(DD)cgm24.dev $$(DD)jpeg.dev $$(DD)jpeggray.dev $$(DD)miff24.dev \
$$(DD)pcxmono.dev $$(DD)pcxgray.dev $$(DD)pcx16.dev $$(DD)pcx256.dev \
$$(DD)pcx24b.dev $$(DD)pcxcmyk.dev $$(DD)pbm.dev $$(DD)pbmraw.dev \
$$(DD)pgm.dev $$(DD)pgmraw.dev $$(DD)pgnm.dev $$(DD)pgnmraw.dev \
$$(DD)pnm.dev $$(DD)pnmraw.dev $$(DD)ppm.dev $$(DD)ppmraw.dev \
$$(DD)pkm.dev $$(DD)pkmraw.dev $$(DD)plan9bm.dev $$(DD)pngmono.dev \
$$(DD)pnggray.dev $$(DD)png16.dev $$(DD)png256.dev $$(DD)png16m.dev \
$$(DD)psmono.dev $$(DD)psgray.dev $$(DD)psrgb.dev $$(DD)tiff12nc.dev \
$$(DD)tiff24nc.dev $$(DD)tifflzw.dev $$(DD)tiffpack.dev $$(DD)ap3250.dev \
$$(DD)appledmp.dev $$(DD)bj10e.dev $$(DD)bj200.dev $$(DD)bjc600.dev \
$$(DD)bjc800.dev $$(DD)ccr.dev $$(DD)cdeskjet.dev $$(DD)cdjcolor.dev \
$$(DD)cdjmono.dev $$(DD)cdj500.dev $$(DD)cdj550.dev \
$$(DD)cp50.dev \
$$(DD)declj250.dev $$(DD)djet500c.dev $$(DD)dnj650c.dev $$(DD)epson.dev \
$$(DD)eps9mid.dev $$(DD)eps9high.dev $$(DD)epsonc.dev $$(DD)hl7x0.dev \
$$(DD)ibmpro.dev $$(DD)imagen.dev $$(DD)iwhi.dev $$(DD)iwlo.dev \
$$(DD)iwlq.dev $$(DD)jetp3852.dev \
$$(DD)lbp8.dev $$(DD)lips3.dev \
$$(DD)lj250.dev $$(DD)lj4dith.dev $$(DD)lp8000.dev \
$$(DD)lq850.dev $$(DD)m8510.dev $$(DD)necp6.dev $$(DD)oki182.dev \
$$(DD)okiibm.dev $$(DD)paintjet.dev $$(DD)pj.dev $$(DD)pjetxl.dev \
$$(DD)pjxl.dev $$(DD)pjxl300.dev $$(DD)r4081.dev $$(DD)sj48.dev \
$$(DD)st800.dev $$(DD)stcolor.dev $$(DD)t4693d2.dev $$(DD)t4693d4.dev \
$$(DD)t4693d8.dev $$(DD)tek4696.dev $$(DD)uniprint.dev \
$$(DD)dfaxhigh.dev $$(DD)dfaxlow.dev $$(DD)cif.dev $$(DD)inferno.dev \
d90 1
a90 2
$$(DD)mgr4.dev $$(DD)mgr8.dev $$(DD)sgirgb.dev'

a91 2
# $$(DD)la50.dev $$(DD)la70.dev $$(DD)la75.dev $$(DD)la75plus.dev 
# $$(DD)ln03.dev $$(DD)xes.dev 
a93 3

#MAKE_FILE=	src/unix-gcc.mak

d100 2
a101 1
FLAVORS=A4 gtk
d103 1
a103 2
FLAVOR?=
.if ${FLAVOR:U:MA4}
d107 3
a109 1
.if ${FLAVOR:L:Mgtk}
d117 7
@


1.35
log
@- Fonts have been split-off into gnu-fonts
- Enable run-time dependency on gnu-fonts
From Kurt Miller <truk@@optonline.net>
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.34 2003/06/04 16:02:52 margarida Exp $
d7 1
a7 1
PKGNAME=	${DISTNAME}p1
@


1.34
log
@hrmph!

patiently pointed by naddy@@, thanks!
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.33 2003/06/04 01:14:14 margarida Exp $
d12 1
a12 2
MASTER_SITES1= 	${MASTER_SITE_GNU:=ghostscript/}
MASTER_SITES2=	${PDF_SITES}
d16 1
a16 1
DISTFILES=	${GS_SOURCES} ${GS_FONTS_STD}:1 pdf_sec.ps:2
d33 2
a109 5
#  Note: the following two are real files that have symlinks with
#  later version numbers pointing to them.  To avoid unnecessarily
#  downloading distfiles, do not change these when upgrading the port
#  unless the files really change.
GS_FONTS_STD=	gnu-gs-fonts-std-6.0.tar.gz
a152 2
	cd ${PREFIX}/share/ghostscript  && \
			tar xzf ${FULLDISTDIR}/${GS_FONTS_STD}
@


1.33
log
@Security Fix:
A problem with Ghostscript could make it possible to execute
arbitrary commands. The vulnerability exists when GhostScript
is used to process specially formatted PS files.
An attacker can exploit this vulnerability by creating a
malicious PS file which, when processed with GhostScript, will
result in the execution of arbitrary system commands.

Bump version to 7.05p1

ok naddy@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.32 2003/03/31 14:49:13 sturm Exp $
d5 1
a5 1
VERSION=	7.05p1
d7 1
@


1.32
log
@USE_X11=Yes
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2002/12/26 18:41:14 sturm Exp $
d3 1
a3 1
COMMENT="GNU PostScript interpreter"
d5 1
a5 1
VERSION=	7.05
@


1.31
log
@fonts archive changed name

espie@@ OK
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.30 2002/12/03 13:30:39 espie Exp $
d34 2
@


1.31.2.1
log
@* MFC
Security Fix:
A problem with Ghostscript could make it possible to execute
arbitrary commands. The vulnerability exists when GhostScript
is used to process specially formatted PS files.
An attacker can exploit this vulnerability by creating a
malicious PS file which, when processed with GhostScript, will
result in the execution of arbitrary system commands.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31 2002/12/26 18:41:14 sturm Exp $
d3 1
a3 1
COMMENT=	"GNU PostScript interpreter"
d5 1
a5 1
VERSION=	7.05p1
@


1.31.2.2
log
@here too
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.31.2.1 2003/06/04 01:16:39 margarida Exp $
d5 1
a5 1
VERSION=	7.05
a6 1
PKGNAME=	${DISTNAME}p1
@


1.30
log
@better distsites
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.29 2002/12/03 13:17:07 espie Exp $
d110 1
a110 1
GS_FONTS_STD=	ghostscript-fonts-std-6.0.tar.gz
@


1.29
log
@Update gnu ghostscript to 7.05, now that this is free.

Compared to AFPL ghostscript 7.00, main difference is some CJK support
(currently untested, needs keyed CJK fonts).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2002/10/28 13:40:41 naddy Exp $
d10 3
a12 2
MASTER_SITES=	${GS_SITES}
MASTER_SITES1=	${PDF_SITES}
d16 1
a16 1
DISTFILES=	${GS_SOURCES} ${GS_FONTS_STD} pdf_sec.ps:1
@


1.28
log
@No regression tests available.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.27 2002/05/15 17:58:49 espie Exp $
d5 1
a5 1
VERSION=	6.51
a7 1
NEED_VERSION=	1.525
d10 2
a11 3
MASTER_SITES=	${GS_SITES} ${MASTER_SITE_GNU:=ghostscript/}
MASTER_SITES1=	${MASTER_SITE_GNU:=ghostscript/}
MASTER_SITES2=	${PDF_SITES}
d15 1
a15 1
DISTFILES=	${GS_SOURCES} ${GS_FONTS_STD}:1 pdf_sec.ps:2
d20 1
d36 1
a36 1
WRKDIST=	${WRKDIR}/ghostscript-${VERSION}
d56 1
a56 1
BASE_FLAGS+=	DEVICE_DEVS='\
d102 1
a102 1
MAKE_FILE=	src/unixansi.mak
d109 1
a109 1
GS_FONTS_STD=	gnu-gs-fonts-std-6.0.tar.gz
d111 3
a113 2
# Additional driver HP 850, see http://www.erdw.ethz.ch/~bonk/hp850/hp850.html
HP850_DRV=	hp8xxs13.zip
d115 1
a115 1
# The pdf_sec.ps non-stub version has been moved to a separate package
a116 1
FLAVORS=A4
d118 3
d122 8
a129 2
.if ${FLAVOR:U} == "A4"
CFLAGS+=	-DA4
d134 1
a134 3
FAKE_FLAGS=${BASE_FLAGS} \
	prefix=${WRKINST}${PREFIX} \
	man1dir=${WRKINST}${PREFIX}/man/man1
d139 3
a141 2
	# Sloppy gnu guys don't clean up. Why am I not surprised ?
	rm -f ${WRKSRC}/{zfileio.c,gdevx.c}.orig
d144 4
a147 2
	mkdir -p ${WRKBUILD}/objects
	mkdir -p ${WRKBUILD}/bin
d150 3
a152 3
	${INSTALL_DATA_DIR} ${PREFIX}/share/ghostscript 
	${INSTALL_PROGRAM_DIR} ${PREFIX}/bin 
	${INSTALL_MAN_DIR} ${PREFIX}/man/man1
d157 13
a169 1
	@@strip ${PREFIX}/bin/gs
@


1.27
log
@MASTER_SITE_SUBDIR kill
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.26 2002/04/24 21:34:48 espie Exp $
d123 2
@


1.26
log
@Adjust ports with non-package/install dependencies for the new mechanism.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2002/03/24 01:08:25 brad Exp $
d11 2
a12 2
MASTER_SITES=	${GS_SITES} ${MASTER_SITE_GNU}
MASTER_SITES1=	${MASTER_SITE_GNU}
a16 1
MASTER_SITE_SUBDIR=     ghostscript
@


1.25
log
@- -lc_r -> -pthread
- replace fonts distfile with one that is fetchable.
--
Ok'd by: maintainer
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2002/03/21 21:25:50 espie Exp $
d8 1
a8 1
NEED_VERSION=	1.515
d130 2
a131 2
	ln -s `cd ${PORTSDIR} && cd ${JPEGDIR} && FLAVOR='' make show=WRKDIST` ${WRKDIST}/jpeg
	ln -s `cd ${PORTSDIR} && cd ${PNGDIR} && FLAVOR='' make show=WRKDIST` ${WRKDIST}/libpng
@


1.24
log
@Bump NEED_VERSION
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.23 2001/10/28 13:05:49 espie Exp $
d12 2
a13 1
MASTER_SITES1= ${PDF_SITES}
d18 1
a18 1
DISTFILES=	${GS_SOURCES} ${GS_FONTS_STD} pdf_sec.ps:1
d54 1
a54 1
		STDLIBS='-lc_r -lm' 
d111 1
a111 1
GS_FONTS_STD=	ghostscript-fonts-std-6.0.tar.gz
d119 1
a120 1
FLAVOR?=
d140 3
a142 3
	@@${INSTALL_DATA_DIR} ${PREFIX}/share/ghostscript 
	@@${INSTALL_PROGRAM_DIR} ${PREFIX}/bin 
	@@${INSTALL_MAN_DIR} ${PREFIX}/man/man1
d147 1
a147 1
	strip ${PREFIX}/bin/gs
@


1.23
log
@Zap default MAINTAINER from Makefile.
Especially now that the default line is more verbose.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.22 2001/08/06 06:25:14 pvalchev Exp $
d8 1
a8 1
NEED_VERSION=	1.395
@


1.22
log
@PREFIX -> LOCALBASE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.21 2001/07/27 17:46:48 espie Exp $
a27 2
MAINTAINER=	ports@@openbsd.org

d31 1
a31 2
BUILD_DEPENDS=	/nonexistent::${JPEGDIR}:patch \
		/nonexistent::${PNGDIR}:patch
@


1.21
log
@Fix a4 build now that flavors checks are better.
From Yozo Toda.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.20 2001/07/03 15:38:26 espie Exp $
d48 1
a48 1
		XLDFLAGS=-L${PREFIX}/lib \
@


1.20
log
@Gnu ghostscript 6.51, mostly revamped aladdin ghostscript 6.50
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2001/06/20 01:43:31 pvalchev Exp $
d132 2
a133 2
	ln -s `cd ${PORTSDIR} && cd ${JPEGDIR} && make show VARNAME=WRKDIST` ${WRKDIST}/jpeg
	ln -s `cd ${PORTSDIR} && cd ${PNGDIR} && make show VARNAME=WRKDIST` ${WRKDIST}/libpng
@


1.19
log
@Remove deprecated LICENSE_TYPE and set appropriate # comments
with its contents.
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.18 2001/05/24 02:28:14 kevlo Exp $
# Original from:	Andreas Klemm <andreas@@klemm.gtn.com>
d3 3
a5 2
COMMENT=	"GNU Postscript interpreter"
VERSION=	5.50
d7 1
a7 1
CATEGORIES=	print
d11 4
a15 1
# Eventually, the FSF should wake up...
d17 1
a17 9
MASTER_SITES= ${GS_SITES} ${MASTER_SITE_GNU}

HOMEPAGE=	http://www.cs.wisc.edu/%7Eghost/

MASTER_SITES0=  http://www.erdw.ethz.ch/%7Ebonk/ftp/gs-driver-distrib/
MASTER_SITES1= ${PDF_SITES}

DISTFILES=	${GS_SOURCES} ${GS_FONTS_STD} ${GS_FONTS_OTHER} \
		${HP850_DRV}:0 pdf_sec.ps:1
a21 2
# png and jpeg sources are under a BSD license
# License: GPL BSD
d27 1
d34 1
a34 2
		/nonexistent::${PNGDIR}:patch \
		unzip::archivers/unzip \
d39 4
a42 1
WRKDIST=	${WRKDIR}/gs${VERSION}
d56 43
a98 1
		DEVICE_DEVS="`cat ${FILESDIR}/devices`"
a99 1
PDFDIR=share/ghostscript/${VERSION}
d101 2
a103 1
FAKE_FLAGS=	${BASE_FLAGS} prefix=${WRKINST}${PREFIX}
a104 2
MAKE_FILE=	unixansi.mak
MAN1=		gs.1 pdf2dsc.1 pdf2ps.1 ps2ascii.1 ps2epsi.1 ps2pdf.1 ps2ps.1
d106 3
a108 1
GS_SOURCES=	gnu-gs-${VERSION}.tar.gz
d113 1
a113 2
GS_FONTS_STD=	gnu-gs-fonts-std-5.50.tar.gz
GS_FONTS_OTHER=	gnu-gs-fonts-other-5.50.tar.gz
a119 1

d127 4
d132 4
a135 3
	ln -s `cd ${PORTSDIR} && cd ${JPEGDIR} && make show VARNAME=WRKDIST` ${WRKSRC}/jpeg
	ln -s `cd ${PORTSDIR} && cd ${PNGDIR} && make show VARNAME=WRKDIST` ${WRKSRC}/libpng
	cd ${WRKSRC} && unzip -Lao ${FULLDISTDIR}/${HP850_DRV} -x devs.mak
d138 2
a139 1
	mkdir -p ${WRKSRC}/objects
a146 2
	cd ${PREFIX}/share/ghostscript/fonts && \
			tar xzf ${FULLDISTDIR}/${GS_FONTS_OTHER}
a147 1
# install the readme and license file of the hp8xxx driver as well
a149 6
	${INSTALL_SCRIPT} ${WRKSRC}/unix-lpr.sh ${PREFIX}/bin
	${INSTALL_SCRIPT} ${WRKSRC}/lprsetup.sh ${PREFIX}/bin
	${INSTALL_DATA} ${WRKSRC}/license.hp8 \
		${PREFIX}/share/ghostscript/${VERSION}/doc
	${INSTALL_DATA} ${WRKSRC}/readme.hp8 \
		${PREFIX}/share/ghostscript/${VERSION}/doc
@


1.18
log
@Bump major rev in png dependeny entries after upgrade of png:
png.1 -> png.2
--
Ok'd by: brad@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.17 2001/05/05 21:05:17 espie Exp $
d28 1
a28 1
LICENSE_TYPE=		GPL BSD
@


1.17
log
@There was a confusion wrt `domestic crypto'.
Ghostscript's pdf_sec.ps add-on is not affected, so kill the encrypt
package.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.16 2001/04/13 17:01:05 espie Exp $
d43 1
a43 1
LIB_DEPENDS=	png.1::${PNGDIR}
@


1.16
log
@PDFDIR relative to PREFIX. Useful for PLIST.

Let ghostscript-encrypt grab its directory directly from aladdin or gnu
ghostscript.

Includes a perfectly sick hack to obtain PDFDIR from those directories:
we do need PORTSDIR at Makefile parsing time, and for that, we just hack
its value from the current Makefile, avoiding endless recursion with
a flag.

Note that this hack is clean though, and doesn't need extra knowledge from
the rest of the ports tree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.15 2001/04/13 16:43:58 espie Exp $
d19 1
d22 1
a22 1
		${HP850_DRV}:0 
d117 1
@


1.15
log
@Minor clean-up.
Provides PDFDIR to help encrypt port.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.14 2001/01/11 00:21:14 naddy Exp $
d61 1
a61 1
PDFDIR=${PREFIX}/share/ghostscript/${VERSION}
@


1.14
log
@fix CFLAGS; ok espie@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.13 2000/10/22 15:43:16 espie Exp $
d4 3
a6 1
DISTNAME=	ghostscript-5.50
d8 1
a8 1
NEED_VERSION=	1.241
d10 1
a10 1
DIR=		gnu/gs550
d23 1
a23 1
SUBST_VARS=		OSREV
d45 1
a45 1
WRKDIST=	${WRKDIR}/gs5.50
d61 2
d69 1
a69 1
GS_SOURCES=	gnu-gs-5.50.tar.gz
d113 1
a113 1
		${PREFIX}/share/ghostscript/5.50/doc
d115 1
a115 1
		${PREFIX}/share/ghostscript/5.50/doc
@


1.13
log
@Kill
FAKE=Yes
HAS_CONFIGURE, GNU_CONFIGURE, USE_IMAKE, NO_INSTALL_MANPAGES, USE_AUTOCONF
and bump NEED_VERSION accordingly.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.12 2000/10/22 13:26:51 espie Exp $
d48 1
a50 1
		XCFLAGS='${CFLAGS}' \
@


1.12
log
@Use var substitution to yield a better installation message
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2000/06/25 22:40:15 brad Exp $
a60 1
FAKE=		Yes
@


1.11
log
@change dependency, png.1.6 -> png.1
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.10 2000/05/31 13:01:08 espie Exp $
d21 1
@


1.10
log
@Missed by Federico
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.9 2000/03/30 21:09:55 espie Exp $
d39 1
a39 1
LIB_DEPENDS=	png.1.6::${PNGDIR}
@


1.9
log
@Flavored ghostscript
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.8 2000/03/24 23:28:30 espie Exp $
d39 1
a39 1
LIB_DEPENDS=	png.1.3::${PNGDIR}
@


1.9.2.1
log
@bring print as of cut-over date into 2.7 branch
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.11 2000/06/25 22:40:15 brad Exp $
d39 1
a39 1
LIB_DEPENDS=	png.1::${PNGDIR}
@


1.8
log
@Introduce :: in *_DEPENDS as a place holder for a package spec
Bump NEED_VERSION.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.7 2000/03/19 00:24:20 espie Exp $
d6 1
a6 1
NEED_VERSION=	 1.230
d78 5
a82 1
.if defined(A4) 
a83 8
PKGNAME=${DISTNAME}-A4
.endif

pre-fetch:
.if !defined(A4)
	@@${ECHO_MSG} "Type \"make A4=yes\" if you want -DA4 for compilation."
.else
	@@${ECHO_MSG} "Using -DA4 for compilation."
@


1.7
log
@Don't depend on :extract, that's stupid.
Even if it doesn't make a difference now,
:patch ensures we won't miss jpeg/png changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.6 2000/03/06 19:46:51 espie Exp $
d6 1
a6 1
NEED_VERSION=	1.223
d35 3
a37 3
BUILD_DEPENDS=	/nonexistent:${JPEGDIR}:patch \
		/nonexistent:${PNGDIR}:patch \
		unzip:archivers/unzip \
d39 1
a39 1
LIB_DEPENDS=	png.1.3:${PNGDIR}
@


1.6
log
@Fake
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.5 2000/03/05 18:30:40 espie Exp $
d35 2
a36 2
BUILD_DEPENDS=	/nonexistent:${JPEGDIR}:extract \
		/nonexistent:${PNGDIR}:extract \
@


1.5
log
@PORTSDIR no longer needed in *DEPENDS.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.4 2000/02/22 17:08:46 espie Exp $
d43 1
a43 1
MAKE_FLAGS=	INSTALL_PROGRAM='${INSTALL_SCRIPT}' \
a44 1
		prefix=${PREFIX} \
d58 3
@


1.4
log
@MAKEFILE-> MAKE_FILE
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2000/02/20 17:18:59 espie Exp $
d6 1
a29 2
NEED_VERSION=	1.210

d32 2
a33 2
JPEGDIR=${PORTSDIR}/graphics/jpeg
PNGDIR=${PORTSDIR}/graphics/png
d37 1
a37 1
		unzip:${PORTSDIR}/archivers/unzip \
d89 2
a90 2
	ln -s `cd ${JPEGDIR} && make show VARNAME=WRKDIST` ${WRKSRC}/jpeg
	ln -s `cd ${PNGDIR} && make show VARNAME=WRKDIST` ${WRKSRC}/libpng
@


1.3
log
@Set up list of common mirrors in preparation for Aladdin ghostscript.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2000/02/20 00:57:18 espie Exp $
d29 1
a29 1
NEED_VERSION=	1.202
d61 1
a61 1
MAKEFILE=	unixansi.mak
@


1.2
log
@Missing ", let all devices be built correctly...
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1.1.1 2000/02/19 17:40:42 espie Exp $
d7 5
a11 4
# Eventually, this will show up on gnu's master sites... whenever the
# FSF wakes up.
MASTER_SITES=	ftp://ftp.cs.wisc.edu/ghost/gnu/gs550/ \
		$(MASTER_SITE_GNU)
a16 1
MASTER_SITE_SUBDIR=     ghostscript
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD$
d58 1
a58 1
		DEVICE_DEVS=`cat ${FILESDIR}/devices`
@


1.1.1.1
log
@New ghostscript port, living in a subdir.
Important changes:
- prodded by Nikolay Sturm to do the upgrade,
- Gnu-ghostscript is now 5.50, packaging changed slightly,
- most patches have been integrated,
- use MAKE_FLAGS to remove Makefile patches and gnu-make dependency,
- pull pdf_encrypt out from the main package so that gs can be distributed
on CD-Rom,
- simplify DEVICE_DEVS (get list from NetBSD), removed interactive script
for now, as it wasn't reliably upgraded,
- infrastructure allows for Aladdin ghostscript along-side.
@
text
@@
