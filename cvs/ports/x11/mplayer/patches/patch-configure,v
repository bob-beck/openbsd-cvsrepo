head	1.80;
access;
symbols
	OPENBSD_6_1:1.80.0.2
	OPENBSD_6_1_BASE:1.80
	OPENBSD_6_0:1.79.0.2
	OPENBSD_6_0_BASE:1.79
	OPENBSD_5_9:1.78.0.2
	OPENBSD_5_9_BASE:1.78
	OPENBSD_5_8:1.77.0.4
	OPENBSD_5_8_BASE:1.77
	OPENBSD_5_7:1.76.0.2
	OPENBSD_5_7_BASE:1.76
	OPENBSD_5_6:1.74.0.2
	OPENBSD_5_6_BASE:1.74
	OPENBSD_5_5:1.73.0.2
	OPENBSD_5_5_BASE:1.73
	OPENBSD_5_4:1.70.0.2
	OPENBSD_5_4_BASE:1.70
	OPENBSD_5_3:1.66.0.2
	OPENBSD_5_3_BASE:1.66
	OPENBSD_5_2:1.63.0.2
	OPENBSD_5_2_BASE:1.63
	OPENBSD_5_1_BASE:1.60
	OPENBSD_5_1:1.60.0.2
	OPENBSD_5_0:1.59.0.2
	OPENBSD_5_0_BASE:1.59
	OPENBSD_4_9:1.57.0.2
	OPENBSD_4_9_BASE:1.57
	OPENBSD_4_8:1.56.0.2
	OPENBSD_4_8_BASE:1.56
	OPENBSD_4_7:1.55.0.2
	OPENBSD_4_7_BASE:1.55
	OPENBSD_4_6:1.51.0.2
	OPENBSD_4_6_BASE:1.51
	OPENBSD_4_5:1.50.0.2
	OPENBSD_4_5_BASE:1.50
	OPENBSD_4_4:1.46.0.2
	OPENBSD_4_4_BASE:1.46
	OPENBSD_4_3:1.44.0.2
	OPENBSD_4_3_BASE:1.44
	OPENBSD_4_2:1.41.0.2
	OPENBSD_4_2_BASE:1.41
	OPENBSD_4_1:1.40.0.2
	OPENBSD_4_1_BASE:1.40
	OPENBSD_4_0:1.39.0.2
	OPENBSD_4_0_BASE:1.39
	OPENBSD_3_9:1.37.0.2
	OPENBSD_3_9_BASE:1.37
	OPENBSD_3_8:1.35.0.2
	OPENBSD_3_8_BASE:1.35
	OPENBSD_3_7:1.30.0.2
	OPENBSD_3_7_BASE:1.30
	OPENBSD_3_6:1.27.0.2
	OPENBSD_3_6_BASE:1.27
	OPENBSD_3_5:1.25.0.2
	OPENBSD_3_5_BASE:1.25
	OPENBSD_3_4:1.21.0.2
	OPENBSD_3_4_BASE:1.21
	OPENBSD_3_3:1.19.0.2
	OPENBSD_3_3_BASE:1.19
	OPENBSD_3_2:1.13.0.2
	OPENBSD_3_2_BASE:1.13
	biorn_20020508:1.1.1.1
	pvalchev:1.1.1;
locks; strict;
comment	@# @;


1.80
date	2016.10.08.20.14.06;	author ajacoutot;	state Exp;
branches;
next	1.79;
commitid	YbWVo3dl0aAWXN48;

1.79
date	2016.03.14.19.50.13;	author ajacoutot;	state Exp;
branches;
next	1.78;
commitid	qy3kOZbBj36dlQSa;

1.78
date	2015.09.10.08.31.36;	author ajacoutot;	state Exp;
branches;
next	1.77;
commitid	tgPTt6WZnPJoMIlp;

1.77
date	2015.05.11.23.23.17;	author ajacoutot;	state Exp;
branches;
next	1.76;
commitid	5cFsLxpaTZF16MGL;

1.76
date	2014.11.14.06.18.42;	author brad;	state Exp;
branches;
next	1.75;
commitid	MO3F9wGuewRw1ml3;

1.75
date	2014.09.03.06.43.28;	author brad;	state Exp;
branches;
next	1.74;
commitid	DRtyxBukVzaSLVkq;

1.74
date	2014.05.16.01.34.50;	author brad;	state Exp;
branches;
next	1.73;

1.73
date	2014.01.10.21.52.29;	author brad;	state Exp;
branches;
next	1.72;

1.72
date	2013.12.12.21.41.54;	author brad;	state Exp;
branches;
next	1.71;

1.71
date	2013.09.06.23.14.40;	author brad;	state Exp;
branches;
next	1.70;

1.70
date	2013.05.05.21.11.32;	author brad;	state Exp;
branches;
next	1.69;

1.69
date	2013.04.30.00.46.56;	author brad;	state Exp;
branches;
next	1.68;

1.68
date	2013.04.11.17.32.35;	author brad;	state Exp;
branches;
next	1.67;

1.67
date	2013.03.13.02.28.11;	author brad;	state Exp;
branches;
next	1.66;

1.66
date	2013.01.21.16.23.05;	author brad;	state Exp;
branches;
next	1.65;

1.65
date	2013.01.14.02.17.15;	author brad;	state Exp;
branches;
next	1.64;

1.64
date	2012.08.27.06.19.48;	author ajacoutot;	state Exp;
branches;
next	1.63;

1.63
date	2012.06.28.18.53.02;	author jasper;	state Exp;
branches;
next	1.62;

1.62
date	2012.05.03.06.51.24;	author ajacoutot;	state Exp;
branches;
next	1.61;

1.61
date	2012.03.30.13.23.03;	author phessler;	state Exp;
branches;
next	1.60;

1.60
date	2011.12.30.17.40.40;	author edd;	state Exp;
branches;
next	1.59;

1.59
date	2011.06.25.14.15.43;	author edd;	state Exp;
branches;
next	1.58;

1.58
date	2011.03.29.20.04.41;	author edd;	state Exp;
branches;
next	1.57;

1.57
date	2010.11.08.21.25.44;	author edd;	state Exp;
branches;
next	1.56;

1.56
date	2010.05.26.21.29.56;	author jakemsr;	state Exp;
branches;
next	1.55;

1.55
date	2010.02.23.19.59.13;	author phessler;	state Exp;
branches;
next	1.54;

1.54
date	2009.11.18.21.20.15;	author jakemsr;	state Exp;
branches;
next	1.53;

1.53
date	2009.10.11.13.36.23;	author edd;	state Exp;
branches;
next	1.52;

1.52
date	2009.07.14.19.43.07;	author naddy;	state Exp;
branches;
next	1.51;

1.51
date	2009.05.05.11.40.08;	author sthen;	state Exp;
branches;
next	1.50;

1.50
date	2009.02.08.20.25.09;	author naddy;	state Exp;
branches;
next	1.49;

1.49
date	2009.01.16.02.39.53;	author jakemsr;	state Exp;
branches;
next	1.48;

1.48
date	2008.12.15.21.30.07;	author naddy;	state Exp;
branches;
next	1.47;

1.47
date	2008.10.30.18.33.42;	author ratchov;	state Exp;
branches;
next	1.46;

1.46
date	2008.05.01.13.52.19;	author sthen;	state Exp;
branches;
next	1.45;

1.45
date	2008.04.16.01.43.12;	author jakemsr;	state Exp;
branches;
next	1.44;

1.44
date	2008.02.18.16.37.38;	author espie;	state Exp;
branches;
next	1.43;

1.43
date	2008.02.08.17.32.41;	author jakemsr;	state Exp;
branches;
next	1.42;

1.42
date	2007.11.15.07.50.27;	author jakemsr;	state Exp;
branches;
next	1.41;

1.41
date	2007.04.19.08.37.09;	author ajacoutot;	state Exp;
branches;
next	1.40;

1.40
date	2007.01.22.15.04.04;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	2006.08.16.15.17.15;	author biorn;	state Exp;
branches;
next	1.38;

1.38
date	2006.07.19.21.40.47;	author robert;	state Exp;
branches;
next	1.37;

1.37
date	2006.01.17.07.41.58;	author jakemsr;	state Exp;
branches;
next	1.36;

1.36
date	2005.11.23.00.05.39;	author biorn;	state Exp;
branches;
next	1.35;

1.35
date	2005.05.27.04.33.06;	author pvalchev;	state Exp;
branches;
next	1.34;

1.34
date	2005.05.13.16.14.00;	author biorn;	state Exp;
branches;
next	1.33;

1.33
date	2005.05.09.12.24.38;	author biorn;	state Exp;
branches;
next	1.32;

1.32
date	2005.04.09.22.06.19;	author pvalchev;	state Exp;
branches;
next	1.31;

1.31
date	2005.04.01.06.28.58;	author biorn;	state Exp;
branches;
next	1.30;

1.30
date	2005.03.09.16.07.29;	author biorn;	state Exp;
branches;
next	1.29;

1.29
date	2004.12.22.22.22.20;	author biorn;	state Exp;
branches;
next	1.28;

1.28
date	2004.10.18.06.48.20;	author biorn;	state Exp;
branches;
next	1.27;

1.27
date	2004.06.22.08.13.11;	author brad;	state Exp;
branches;
next	1.26;

1.26
date	2004.05.06.07.27.49;	author biorn;	state Exp;
branches;
next	1.25;

1.25
date	2004.03.04.12.57.45;	author avsm;	state Exp;
branches;
next	1.24;

1.24
date	2003.12.16.17.17.33;	author biorn;	state Exp;
branches;
next	1.23;

1.23
date	2003.11.02.23.30.27;	author brad;	state Exp;
branches;
next	1.22;

1.22
date	2003.09.25.20.59.01;	author sturm;	state Exp;
branches;
next	1.21;

1.21
date	2003.04.21.15.29.16;	author brad;	state Exp;
branches;
next	1.20;

1.20
date	2003.04.17.10.35.07;	author wilfried;	state Exp;
branches;
next	1.19;

1.19
date	2003.02.16.07.25.18;	author brad;	state Exp;
branches;
next	1.18;

1.18
date	2003.01.03.23.06.36;	author brad;	state Exp;
branches;
next	1.17;

1.17
date	2002.12.22.14.19.47;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2002.11.13.17.54.35;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2002.10.28.17.56.08;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2002.10.14.09.50.48;	author pvalchev;	state Exp;
branches;
next	1.13;

1.13
date	2002.08.18.13.17.50;	author espie;	state Exp;
branches;
next	1.12;

1.12
date	2002.08.18.11.26.48;	author espie;	state Exp;
branches;
next	1.11;

1.11
date	2002.06.27.22.03.49;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2002.06.04.11.35.09;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2002.06.04.11.26.17;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2002.05.16.13.57.49;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2002.05.16.11.58.48;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2002.05.15.22.27.01;	author pvalchev;	state Exp;
branches;
next	1.5;

1.5
date	2002.05.14.03.05.31;	author pvalchev;	state Exp;
branches;
next	1.4;

1.4
date	2002.05.12.18.50.46;	author niklas;	state Exp;
branches;
next	1.3;

1.3
date	2002.05.12.08.25.57;	author pvalchev;	state Exp;
branches;
next	1.2;

1.2
date	2002.05.12.08.16.24;	author pvalchev;	state Exp;
branches;
next	1.1;

1.1
date	2002.05.09.05.19.10;	author pvalchev;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2002.05.09.05.19.10;	author pvalchev;	state Exp;
branches;
next	;


desc
@@


1.80
log
@Update to mplayer-20161008.

from Brad (maintainer)
@
text
@$OpenBSD: patch-configure,v 1.79 2016/03/14 19:50:13 ajacoutot Exp $
--- configure.orig	Sat Oct  8 14:36:44 2016
+++ configure	Sat Oct  8 15:03:37 2016
@@@@ -1503,39 +1503,39 @@@@ echo configuration: $configuration > "$TMPLOG"
 echo >> "$TMPLOG"
 
 
-# local FFmpeg checkout handling
-if test -e ffmpeg/.svn ; then
-    echo "You have an outdated FFmpeg SVN checkout in ffmpeg/, please (re)move or replace it"
-    exit 1
-fi
+## local FFmpeg checkout handling
+#if test -e ffmpeg/.svn ; then
+#    echo "You have an outdated FFmpeg SVN checkout in ffmpeg/, please (re)move or replace it"
+#    exit 1
+#fi
+#
+#FFBRANCH=master
+#test -e FFBRANCH && FFBRANCH=$(cat FFMPEG_BRANCH)
+#
+#if test -e ffmpeg/mp_auto_pull ; then
+#    echo "Updating FFmpeg, (re)move ffmpeg/mp_auto_pull to disable"
+#    (cd ffmpeg && git checkout $FFBRANCH)
+#    if ! (cd ffmpeg && git pull --rebase --ff-only) ; then
+#        echo "git pull failed, (re)move ffmpeg/mp_auto_pull to disable pulling"
+#        exit 1
+#    fi
+#fi
+#
+#if test "$ffmpeg_a" != "no" && ! test -e ffmpeg ; then
+#    echo "No FFmpeg checkout, press enter to download one with git or CTRL+C to abort"
+#    read tmp
+#    if ! git clone -b $FFBRANCH --depth 1 git://source.ffmpeg.org/ffmpeg.git ffmpeg ; then
+#        rm -rf ffmpeg
+#        echo "Failed to get a FFmpeg checkout"
+#        echo "Please try again or put FFmpeg source code copy into ffmpeg/ manually."
+#        echo "Nightly snapshot: http://ffmpeg.org/releases/ffmpeg-snapshot.tar.bz2"
+#        echo "To use a github mirror via http (e.g. because a firewall blocks git):"
+#        echo "git clone --depth 1 https://github.com/FFmpeg/FFmpeg ffmpeg; touch ffmpeg/mp_auto_pull"
+#        exit 1
+#    fi
+#    touch ffmpeg/mp_auto_pull
+#fi
 
-FFBRANCH=master
-test -e FFBRANCH && FFBRANCH=$(cat FFMPEG_BRANCH)
-
-if test -e ffmpeg/mp_auto_pull ; then
-    echo "Updating FFmpeg, (re)move ffmpeg/mp_auto_pull to disable"
-    (cd ffmpeg && git checkout $FFBRANCH)
-    if ! (cd ffmpeg && git pull --rebase --ff-only) ; then
-        echo "git pull failed, (re)move ffmpeg/mp_auto_pull to disable pulling"
-        exit 1
-    fi
-fi
-
-if test "$ffmpeg_a" != "no" && ! test -e ffmpeg ; then
-    echo "No FFmpeg checkout, press enter to download one with git or CTRL+C to abort"
-    read tmp
-    if ! git clone -b $FFBRANCH --depth 1 git://source.ffmpeg.org/ffmpeg.git ffmpeg ; then
-        rm -rf ffmpeg
-        echo "Failed to get a FFmpeg checkout"
-        echo "Please try again or put FFmpeg source code copy into ffmpeg/ manually."
-        echo "Nightly snapshot: http://ffmpeg.org/releases/ffmpeg-snapshot.tar.bz2"
-        echo "To use a github mirror via http (e.g. because a firewall blocks git):"
-        echo "git clone --depth 1 https://github.com/FFmpeg/FFmpeg ffmpeg; touch ffmpeg/mp_auto_pull"
-        exit 1
-    fi
-    touch ffmpeg/mp_auto_pull
-fi
-
 list_subparts() {
   test ! -e ffmpeg/libav${3} && return 1
   pattern="s/^[^#]*${1}.*([^ ,]*, *\([^ ,)]*\).*/\1_${2}/p"
@@@@ -2420,7 +2420,7 @@@@ case "$host_arch" in
     arch='sparc'
     iproc='sparc'
     if test "$host_arch" = "sparc64" ; then
-      _vis='yes'
+      # _vis='yes'
       proc='ultrasparc'
       def_fast_64bit='#define HAVE_FAST_64BIT 1'
     elif sunos ; then
@@@@ -2792,7 +2792,7 @@@@ cat > $TMPC << EOF
 int ff_extern;
 EOF
 cc_check -c || die "Symbol mangling check failed."
-sym=$($_nm -P -g $TMPEXE | grep ff_extern)
+sym=$($_nm -g $TMPEXE | grep ff_extern | cut -d ' ' -f 3)
 extern_prefix=${sym%%ff_extern*}
 def_extern_asm="#define EXTERN_ASM $extern_prefix"
 def_extern_prefix="#define EXTERN_PREFIX \"$extern_prefix\""
@@@@ -2852,7 +2852,7 @@@@ else
 fi
 
 CFLAGS="-D_ISOC99_SOURCE -I. -Iffmpeg $CFLAGS"
-HOSTCFLAGS="-D_ISOC99_SOURCE -I. -Iffmpeg -O3"
+HOSTCFLAGS="-D_ISOC99_SOURCE -I. -Iffmpeg $CFLAGS"
 
 # On glibc, add some more CPPFLAGS for enabling required functionality.
 cpp_condition_check features.h "defined __GLIBC__" &&
@@@@ -2929,7 +2929,7 @@@@ elif test $relocatable = "yes" ; then
 fi
 echores $relocatable
 
-if x86_32 ; then
+if false ; then # x86_32
   # Checking assembler (_as) compatibility...
   # Added workaround for older as that reads from stdin by default - atmos
   as_version=$(echo '' | $_as -version 2>&1 | sed -n 's/^.*assembler \(version \)*\([0-9.]*\).*$/\2/p')
@@@@ -6271,7 +6271,7 @@@@ echocheck "cdparanoia"
 if test "$_cdparanoia" = auto ; then
     _cdparanoia=no
     for inc_tmp in "" "-I/usr/include/cdda" "-I/usr/local/include/cdda" ; do
-      statement_check_broken cdda_interface.h cdda_paranoia.h 'paranoia_cachemodel_size(NULL, 0)' $inc_tmp -lcdda_interface -lcdda_paranoia &&
+      statement_check_broken cdda_interface.h cdda_paranoia.h 'paranoia_free(NULL)' $inc_tmp -lcdda_interface -lcdda_paranoia &&
         _cdparanoia=yes && extra_cflags="$extra_cflags $inc_tmp" && break
     done
 fi
@@@@ -8190,6 +8190,7 @@@@ extra_ldflags="$extra_ldflags $libm"
 # XML documentation tests
 echocheck "XML catalogs"
 for try_catalog in \
+  ${LOCALBASE}/share/sgml/catalog \
   /etc/sgml/catalog \
   /usr/share/xml/docbook/*/catalog.xml \
   /opt/local/share/xml/docbook-xml/*/catalog.xml \
@@@@ -8217,6 +8218,7 @@@@ fi
 
 echocheck "XML chunked stylesheet"
 for try_chunk_xsl in \
+  ${LOCALBASE}/share/xsl/docbook/html/chunk.xsl \
   /usr/share/xml/docbook/*/html/chunk.xsl \
   /usr/share/sgml/docbook/stylesheet/xsl/nwalsh/html/chunk.xsl \
   /usr/share/sgml/docbook/yelp/docbook/html/chunk.xsl \
@@@@ -8242,6 +8244,7 @@@@ fi
 
 echocheck "XML monolithic stylesheet"
 for try_docbook_xsl in \
+  ${LOCALBASE}/share/xsl/docbook/html/docbook.xsl \
   /usr/share/xml/docbook/*/html/docbook.xsl \
   /usr/share/sgml/docbook/stylesheet/xsl/nwalsh/html/docbook.xsl \
   /usr/share/sgml/docbook/yelp/docbook/html/docbook.xsl \
@@@@ -8295,6 +8298,7 @@@@ EOF
 echocheck "XML DTD"
 #FIXME: This should prefer higher version numbers, not the other way around ..
 for try_dtd in \
+  ${LOCALBASE}/share/xml/docbook/*/docbookx.dtd \
   /usr/share/xml/docbook/*/dtd/4*/docbookx.dtd \
   /usr/share/xml/docbook/*/docbookx.dtd \
   /usr/share/sgml/docbook/*/docbookx.dtd \
@@@@ -9431,9 +9435,6 @@@@ cmp -s "$TMPH" config.h || mv -f "$TMPH" config.h
 
 ############################################################################
 
-# Create FFmpeg config files only for internal ffmpeg
-if test "$ffmpeg_a" = yes; then
-
 # Create avconfig.h for FFmpeg.
 cat > "$TMPH" << EOF
 /* Generated by mpconfigure */
@@@@ -9497,8 +9498,6 @@@@ print_enabled_components(){
 
 print_enabled_components libavcodec/bsf_list.c AVBitStreamFilter bitstream_filters $libavbsfs
 print_enabled_components libavformat/protocol_list.c URLProtocol url_protocols $libavprotocols
-
-fi
 
 #############################################################################
 
@


1.79
log
@Update to mplayer-20160306.

from Brad (maintainer)
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.78 2015/09/10 08:31:36 ajacoutot Exp $
--- configure.orig	Sun Mar  6 20:23:29 2016
+++ configure	Sun Mar 13 21:32:53 2016
d76 1
a76 1
@@@@ -2415,7 +2415,7 @@@@ case "$host_arch" in
d85 1
a85 1
@@@@ -2787,7 +2787,7 @@@@ cat > $TMPC << EOF
d94 1
a94 1
@@@@ -2847,7 +2847,7 @@@@ else
d103 1
a103 1
@@@@ -2924,7 +2924,7 @@@@ elif test $relocatable = "yes" ; then
d112 1
a112 1
@@@@ -6247,7 +6247,7 @@@@ echocheck "cdparanoia"
d121 1
a121 1
@@@@ -8164,6 +8164,7 @@@@ extra_ldflags="$extra_ldflags $libm"
d129 1
a129 1
@@@@ -8191,6 +8192,7 @@@@ fi
d137 1
a137 1
@@@@ -8216,6 +8218,7 @@@@ fi
d145 1
a145 1
@@@@ -8269,6 +8272,7 @@@@ EOF
d153 1
a153 1
@@@@ -9405,9 +9409,6 @@@@ cmp -s "$TMPH" config.h || mv -f "$TMPH" config.h
d163 4
a166 4
@@@@ -9452,8 +9453,6 @@@@ cat > ffmpeg/config.h << EOF
 #include "../config.h"
 EOF
 touch ffmpeg/.config
@


1.78
log
@Update to mplayer-20150910.

from Brad (maintainer)
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.77 2015/05/11 23:23:17 ajacoutot Exp $
--- configure.orig	Thu Sep 10 03:13:54 2015
+++ configure	Thu Sep 10 03:18:41 2015
@@@@ -1498,39 +1498,39 @@@@ echo configuration: $configuration > "$TMPLOG"
d76 1
a76 1
@@@@ -2399,7 +2399,7 @@@@ case "$host_arch" in
d85 1
a85 1
@@@@ -2747,7 +2747,7 @@@@ cat > $TMPC << EOF
d89 1
a89 1
-sym=$($_nm -P -g $TMPEXE)
d94 10
a103 1
@@@@ -2875,7 +2875,7 @@@@ elif test $relocatable = "yes" ; then
d112 1
a112 1
@@@@ -6190,7 +6190,7 @@@@ echocheck "cdparanoia"
d121 1
a121 1
@@@@ -8103,6 +8103,7 @@@@ extra_ldflags="$extra_ldflags $libm"
d129 1
a129 1
@@@@ -8130,6 +8131,7 @@@@ fi
d137 1
a137 1
@@@@ -8155,6 +8157,7 @@@@ fi
d145 1
a145 1
@@@@ -8208,6 +8211,7 @@@@ EOF
d153 19
@


1.77
log
@Update to mplayer-20150510.

from brad (maintainer)
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.76 2014/11/14 06:18:42 brad Exp $
--- configure.orig	Sun May 10 18:35:37 2015
+++ configure	Sun May 10 18:40:30 2015
d103 1
a103 1
@@@@ -6176,7 +6176,7 @@@@ echocheck "cdparanoia"
d112 1
a112 1
@@@@ -8082,6 +8082,7 @@@@ extra_ldflags="$extra_ldflags $libm"
d120 1
a120 1
@@@@ -8109,6 +8110,7 @@@@ fi
d128 1
a128 1
@@@@ -8134,6 +8136,7 @@@@ fi
d136 1
a136 1
@@@@ -8187,6 +8190,7 @@@@ EOF
@


1.76
log
@Update to MPlayer 20141103 snapshot.

ok sthen@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.75 2014/09/03 06:43:28 brad Exp $
--- configure.orig	Mon Nov  3 01:29:00 2014
+++ configure	Mon Nov  3 01:34:51 2014
d76 1
a76 1
@@@@ -2392,7 +2392,7 @@@@ case "$host_arch" in
d85 1
a85 1
@@@@ -2735,7 +2735,7 @@@@ cat > $TMPC << EOF
d94 1
a94 1
@@@@ -2863,7 +2863,7 @@@@ elif test $relocatable = "yes" ; then
d103 1
a103 1
@@@@ -6165,7 +6165,7 @@@@ echocheck "cdparanoia"
d112 1
a112 1
@@@@ -8071,6 +8071,7 @@@@ extra_ldflags="$extra_ldflags $libm"
d120 1
a120 1
@@@@ -8098,6 +8099,7 @@@@ fi
d128 1
a128 1
@@@@ -8123,6 +8125,7 @@@@ fi
d136 1
a136 1
@@@@ -8176,6 +8179,7 @@@@ EOF
@


1.75
log
@Update to MPlayer 20140824 snapshot.

ok jca@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.74 2014/05/16 01:34:50 brad Exp $
--- configure.orig	Sun Aug 24 20:39:15 2014
+++ configure	Sun Aug 24 20:52:56 2014
@@@@ -1513,39 +1513,39 @@@@ echo configuration: $configuration > "$TMPLOG"
d76 1
a76 1
@@@@ -2400,7 +2400,7 @@@@ case "$host_arch" in
d85 1
a85 1
@@@@ -2736,7 +2736,7 @@@@ cat > $TMPC << EOF
d94 1
a94 1
@@@@ -2864,7 +2864,7 @@@@ elif test $relocatable = "yes" ; then
d103 1
a103 1
@@@@ -6213,7 +6213,7 @@@@ echocheck "cdparanoia"
d112 1
a112 1
@@@@ -8169,6 +8169,7 @@@@ extra_ldflags="$extra_ldflags $libm"
d120 1
a120 1
@@@@ -8196,6 +8197,7 @@@@ fi
d128 1
a128 1
@@@@ -8221,6 +8223,7 @@@@ fi
d136 1
a136 1
@@@@ -8274,6 +8277,7 @@@@ EOF
@


1.74
log
@Update to FFmpeg 20140412 snapshot. From 2.2 branch.

Update to MPlayer 20140412 snapshot.

Take MAINTAINER for MPlayer. ok edd@@

ok ajacoutot@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.73 2014/01/10 21:52:29 brad Exp $
--- configure.orig	Sat Apr 12 17:12:35 2014
+++ configure	Sat Apr 12 17:15:59 2014
@@@@ -1505,39 +1505,39 @@@@ echo configuration: $configuration > "$TMPLOG"
d76 1
a76 1
@@@@ -2390,7 +2390,7 @@@@ case "$host_arch" in
d85 1
a85 1
@@@@ -2724,7 +2724,7 @@@@ cat > $TMPC << EOF
d94 1
a94 1
@@@@ -2852,7 +2852,7 @@@@ elif test $relocatable = "yes" ; then
d103 1
a103 1
@@@@ -6191,7 +6191,7 @@@@ echocheck "cdparanoia"
d112 1
a112 1
@@@@ -8146,6 +8146,7 @@@@ extra_ldflags="$extra_ldflags $libm"
d120 1
a120 1
@@@@ -8173,6 +8174,7 @@@@ fi
d128 1
a128 1
@@@@ -8198,6 +8200,7 @@@@ fi
d136 1
a136 1
@@@@ -8251,6 +8254,7 @@@@ EOF
@


1.73
log
@Update to MPlayer 20140106 snapshot.

ok edd@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.72 2013/12/12 21:41:54 brad Exp $
--- configure.orig	Mon Jan  6 17:03:04 2014
+++ configure	Mon Jan  6 17:22:43 2014
@@@@ -1497,36 +1497,36 @@@@ echo configuration: $configuration > "$TMPLOG"
d19 3
d24 1
a24 1
+#    (cd ffmpeg && git checkout master)
d31 1
a31 1
+#if ! test -e ffmpeg ; then
d34 1
a34 1
+#    if ! git clone --depth 1 git://source.ffmpeg.org/ffmpeg.git ffmpeg ; then
d46 3
d51 1
a51 1
-    (cd ffmpeg && git checkout master)
d58 1
a58 1
-if ! test -e ffmpeg ; then
d61 1
a61 1
-    if ! git clone --depth 1 git://source.ffmpeg.org/ffmpeg.git ffmpeg ; then
d74 1
d76 1
a76 2
   sed -n "$pattern" ffmpeg/libav${3} | toupper
@@@@ -2364,7 +2364,7 @@@@ case "$host_arch" in
d85 1
a85 1
@@@@ -2692,7 +2692,7 @@@@ cat > $TMPC << EOF
d94 10
a103 1
@@@@ -6153,7 +6153,7 @@@@ echocheck "cdparanoia"
d112 1
a112 1
@@@@ -8099,6 +8099,7 @@@@ extra_ldflags="$extra_ldflags $libm"
d120 1
a120 1
@@@@ -8126,6 +8127,7 @@@@ fi
d128 1
a128 1
@@@@ -8151,6 +8153,7 @@@@ fi
d136 1
a136 1
@@@@ -8204,6 +8207,7 @@@@ EOF
@


1.72
log
@Use MPlayer configure's --target option to pass in the systems machine arch
and eliminate a chunk of the configure patch to recognize some of the MIPS
ports.

ok edd@@ sthen@@
@
text
@d1 4
a4 29
$OpenBSD: patch-configure,v 1.71 2013/09/06 23:14:40 brad Exp $
--- configure.orig	Mon Aug 19 10:49:15 2013
+++ configure	Wed Dec 11 22:26:11 2013
@@@@ -523,6 +523,7 @@@@ Audio output:
   --disable-nas          disable NAS audio output [autodetect]
   --disable-sgiaudio     disable SGI audio output [autodetect]
   --disable-sunaudio     disable Sun audio output [autodetect]
+  --disable-sndio        disable OpenBSD sndio audio output [autodetect]
   --disable-kai          disable KAI audio output [autodetect]
   --disable-dart         disable DART audio output [autodetect]
   --disable-win32waveout disable Windows waveout audio output [autodetect]
@@@@ -756,6 +757,7 @@@@ _xf86keysym=auto
 _mlib=no #broken, thus disabled
 _sgiaudio=auto
 _sunaudio=auto
+_sndio=auto
 _alsa=auto
 _fastmemcpy=yes
 hardcoded_tables=no
@@@@ -1193,6 +1195,8 @@@@ for ac_option do
   --disable-mlib)       _mlib=no        ;;
   --enable-sunaudio)    _sunaudio=yes   ;;
   --disable-sunaudio)   _sunaudio=no    ;;
+  --enable-sndio)	_sndio=yes	;;
+  --disable-sndio)	_sndio=no	;;
   --enable-sgiaudio)    _sgiaudio=yes   ;;
   --disable-sgiaudio)   _sgiaudio=no    ;;
   --enable-alsa)        _alsa=yes       ;;
@@@@ -1491,36 +1495,36 @@@@ echo configuration: $configuration > "$TMPLOG"
d70 1
a70 1
@@@@ -2349,7 +2353,7 @@@@ case "$host_arch" in
d79 1
a79 1
@@@@ -2672,7 +2676,7 @@@@ cat > $TMPC << EOF
d88 1
a88 24
@@@@ -5776,6 +5780,22 @@@@ fi
 echores "$_sunaudio"
 
 
+echocheck "sndio audio"
+if test "$_sndio" = auto ; then
+  _sndio=no
+  statement_check sndio.h 'sio_initpar(NULL)' -lsndio && _sndio=yes
+fi
+if test "$_sndio" = yes ; then
+  def_sndio='#define CONFIG_SNDIO_AUDIO 1'
+  _aomodules="sndio $_aomodules"
+  extra_ldflags="$extra_ldflags -lsndio"
+else
+  def_sndio='#undef CONFIG_SNDIO_AUDIO'
+  _noaomodules="sndio $_noaomodules"
+fi
+echores "$_sndio"
+
+
 def_mlib='#define CONFIG_MLIB 0'
 if sunos; then
 echocheck "Sun mediaLib"
@@@@ -6087,7 +6107,7 @@@@ echocheck "cdparanoia"
d97 1
a97 1
@@@@ -8033,6 +8053,7 @@@@ extra_ldflags="$extra_ldflags -lm"
d105 1
a105 1
@@@@ -8060,6 +8081,7 @@@@ fi
d113 1
a113 1
@@@@ -8085,6 +8107,7 @@@@ fi
d121 1
a121 1
@@@@ -8138,6 +8161,7 @@@@ EOF
a128 16
@@@@ -8413,6 +8437,7 @@@@ SPEEX = $_speex
 STREAM_CACHE = $_stream_cache
 SGIAUDIO = $_sgiaudio
 SUNAUDIO = $_sunaudio
+SNDIO = $_sndio
 SVGA = $_svga
 TDFXFB = $_tdfxfb
 TDFXVID = $_tdfxvid
@@@@ -8846,6 +8871,7 @@@@ $def_ossaudio_devmixer
 $def_pulse
 $def_sgiaudio
 $def_sunaudio
+$def_sndio
 $def_win32waveout
 
 $def_ladspa
@


1.71
log
@Update to MPlayer 20130819 snapshot.

ok gonzalo@@ sthen@@ edd@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.70 2013/05/05 21:11:32 brad Exp $
d3 1
a3 1
+++ configure	Tue Aug 20 02:49:06 2013
a94 9
@@@@ -1696,7 +1700,7 @@@@ if test -z "$_target" ; then
       sh3|sh4|sh4a) host_arch=sh ;;
       s390) host_arch=s390 ;;
       s390x) host_arch=s390x ;;
-      *mips*) host_arch=mips ;;
+      sgi|mips*|loongson) host_arch=mips ;;
       vax) host_arch=vax ;;
       xtensa*) host_arch=xtensa ;;
       *) host_arch=UNKNOWN ;;
@


1.70
log
@- Simplify sndio configure check based on feedback from upstream
- Remove X LP64 patch as the bug was fixed upstream awhile ago

ok sthen@@
@
text
@d1 31
a31 6
$OpenBSD: patch-configure,v 1.69 2013/04/30 00:46:56 brad Exp $
--- configure.orig	Thu Feb 14 14:46:19 2013
+++ configure	Sun May  5 00:59:13 2013
@@@@ -35,34 +35,37 @@@@
 #
 #############################################################################
d33 1
d38 1
a38 3
+# OpenBSD
+# Don't do anything funky with Git or SVN, we will provide mplayer with FFmpeg
+#
d45 1
d69 1
d92 4
a95 29
 # Prevent locale nonsense from breaking basic text processing utilities
 export LC_ALL=C
 
@@@@ -542,6 +545,7 @@@@ Audio output:
   --disable-nas          disable NAS audio output [autodetect]
   --disable-sgiaudio     disable SGI audio output [autodetect]
   --disable-sunaudio     disable Sun audio output [autodetect]
+  --disable-sndio        disable OpenBSD sndio audio output [autodetect]
   --disable-kai          disable KAI audio output [autodetect]
   --disable-dart         disable DART audio output [autodetect]
   --disable-win32waveout disable Windows waveout audio output [autodetect]
@@@@ -795,6 +799,7 @@@@ _xf86keysym=auto
 _mlib=no #broken, thus disabled
 _sgiaudio=auto
 _sunaudio=auto
+_sndio=auto
 _alsa=auto
 _fastmemcpy=yes
 hardcoded_tables=no
@@@@ -1222,6 +1227,8 @@@@ for ac_option do
   --disable-mlib)       _mlib=no        ;;
   --enable-sunaudio)    _sunaudio=yes   ;;
   --disable-sunaudio)   _sunaudio=no    ;;
+  --enable-sndio)	_sndio=yes	;;
+  --disable-sndio)	_sndio=no	;;
   --enable-sgiaudio)    _sgiaudio=yes   ;;
   --disable-sgiaudio)   _sgiaudio=no    ;;
   --enable-alsa)        _alsa=yes       ;;
@@@@ -1635,7 +1642,7 @@@@ if test -z "$_target" ; then
d104 1
a104 1
@@@@ -2288,7 +2295,7 @@@@ case "$host_arch" in
d113 1
a113 1
@@@@ -2611,7 +2618,7 @@@@ cat > $TMPC << EOF
d122 1
a122 1
@@@@ -5767,6 +5774,22 @@@@ fi
d145 1
a145 17
@@@@ -5883,7 +5906,15 @@@@ else
   default_dvd_device="/dev/dvd"
 fi
 
+if win32 || os2 || dragonfly || freebsd || openbsd || sunos || amigaos ; then
+  default_bluray_device=$default_cdrom_device
+elif darwin ; then
+  default_bluray_device="/dev/rdiskN"
+else
+  default_bluray_device="/dev/dvd"
+fi
 
+
 echocheck "VCD support"
 if test "$_vcd" = auto; then
   _vcd=no
@@@@ -6033,7 +6064,7 @@@@ echocheck "cdparanoia"
d154 1
a154 1
@@@@ -7978,6 +8009,7 @@@@ extra_ldflags="$extra_ldflags -lm"
d162 1
a162 1
@@@@ -8005,6 +8037,7 @@@@ fi
d170 1
a170 1
@@@@ -8030,6 +8063,7 @@@@ fi
d178 1
a178 1
@@@@ -8083,6 +8117,7 @@@@ EOF
d186 1
a186 1
@@@@ -8354,6 +8389,7 @@@@ SPEEX = $_speex
d194 1
a194 9
@@@@ -8687,6 +8723,7 @@@@ $(ff_config_enable "$cpuexts_all" "$cpuexts" "#" "HAVE
 /* Blu-ray/DVD/VCD/CD */
 #define DEFAULT_CDROM_DEVICE "$default_cdrom_device"
 #define DEFAULT_DVD_DEVICE   "$default_dvd_device"
+#define DEFAULT_BLURAY_DEVICE   "$default_bluray_device"
 $def_bluray
 $def_bsdi_dvd
 $def_cddb
@@@@ -8773,6 +8810,7 @@@@ $def_ossaudio_devmixer
@


1.69
log
@Tweak some of the Makefile comments and remove some hacks in the
configure script which are no longer necessary.

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.68 2013/04/11 17:32:35 brad Exp $
d3 1
a3 1
+++ configure	Sun Apr 14 17:14:18 2013
d121 1
a121 1
@@@@ -5767,6 +5774,26 @@@@ fi
a126 4
+  cat > $TMPC << EOF
+#include <sndio.h>
+int main(void) { struct sio_par par; sio_initpar(&par); return 0; }
+EOF
d128 1
a128 1
+  cc_check -lsndio && _sndio=yes
d144 1
a144 1
@@@@ -5883,7 +5910,15 @@@@ else
d160 1
a160 1
@@@@ -6033,7 +6068,7 @@@@ echocheck "cdparanoia"
d169 1
a169 1
@@@@ -7978,6 +8013,7 @@@@ extra_ldflags="$extra_ldflags -lm"
d177 1
a177 1
@@@@ -8005,6 +8041,7 @@@@ fi
d185 1
a185 1
@@@@ -8030,6 +8067,7 @@@@ fi
d193 1
a193 1
@@@@ -8083,6 +8121,7 @@@@ EOF
d201 1
a201 1
@@@@ -8354,6 +8393,7 @@@@ SPEEX = $_speex
d209 1
a209 1
@@@@ -8687,6 +8727,7 @@@@ $(ff_config_enable "$cpuexts_all" "$cpuexts" "#" "HAVE
d217 1
a217 1
@@@@ -8773,6 +8814,7 @@@@ $def_ossaudio_devmixer
@


1.68
log
@Remove png hack no longer necessary.

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.67 2013/03/13 02:28:11 brad Exp $
d3 1
a3 1
+++ configure	Mon Apr  8 21:21:03 2013
d121 1
a121 51
@@@@ -2659,7 +2666,7 @@@@ elif test -z "$CFLAGS" ; then
   elif test "$cc_vendor" != "gnu" ; then
     CFLAGS="-O2 $_march $_mcpu $_pipe"
   else
-    CFLAGS="-O4 $_march $_mcpu $_pipe -ffast-math -fomit-frame-pointer"
+    CFLAGS="$_march $_mcpu $_pipe -ffast-math -fomit-frame-pointer"
     WARNFLAGS="-Wall -Wno-switch -Wno-parentheses -Wpointer-arith -Wredundant-decls"
     WARN_CFLAGS="-Werror-implicit-function-declaration"
     extra_ldflags="$extra_ldflags -ffast-math"
@@@@ -2962,8 +2969,11 @@@@ echores "$ibm_asm"
 def_gnu_as='#define HAVE_GNU_AS 0'
 gnu_as=no
 echocheck "GNU assembler"
-inline_asm_check '".macro m n\n\\n:.int 0\n.endm\nm x"' &&
-  gnu_as=yes && def_gnu_as='#define HAVE_GNU_AS 1'
+# OpenBSD - some altivec stuff causes build failures, fix from kili
+if ! ppc; then
+	inline_asm_check '".macro m n\n\\n:.int 0\n.endm\nm x"' &&
+	  gnu_as=yes && def_gnu_as='#define HAVE_GNU_AS 1'
+fi
 echores "$gnu_as"
 
 fi
@@@@ -3590,7 +3600,6 @@@@ echores "$_fast_inttypes"
 
 echocheck "malloc.h"
 _malloc=no
-header_check malloc.h && _malloc=yes
 if test "$_malloc" = yes ; then
   def_malloc_h='#define HAVE_MALLOC_H 1'
 else
@@@@ -3617,7 +3626,8 @@@@ if test "$_memalign" = yes ; then
 else
   def_memalign='#define HAVE_MEMALIGN 0'
   def_map_memalign='#define memalign(a, b) malloc(b)'
-  darwin || def_memalign_hack='#define CONFIG_MEMALIGN_HACK 1'
+  # OpenBSD - prevent CONFIG_MEMALIGN_HACK which causes exit crash
+  #darwin || def_memalign_hack='#define CONFIG_MEMALIGN_HACK 1'
 fi
 echores "$_memalign"
 
@@@@ -4838,6 +4848,8 @@@@ if test "$_aa" = yes ; then
   def_aa='#define CONFIG_AA 1'
   if cygwin ; then
     libs_mplayer="$libs_mplayer $(aalib-config --libs | cut -d " " -f 2,5,6)"
+  else
+    libs_mplayer="$libs_mplayer $(aalib-config --libs)"
   fi
   vomodules="aa $vomodules"
 else
@@@@ -5767,6 +5779,26 @@@@ fi
d148 1
a148 1
@@@@ -5883,7 +5915,15 @@@@ else
d164 1
a164 1
@@@@ -6033,7 +6073,7 @@@@ echocheck "cdparanoia"
d173 1
a173 1
@@@@ -7978,6 +8018,7 @@@@ extra_ldflags="$extra_ldflags -lm"
d181 1
a181 1
@@@@ -8005,6 +8046,7 @@@@ fi
d189 1
a189 1
@@@@ -8030,6 +8072,7 @@@@ fi
d197 1
a197 1
@@@@ -8083,6 +8126,7 @@@@ EOF
d205 1
a205 1
@@@@ -8354,6 +8398,7 @@@@ SPEEX = $_speex
d213 1
a213 1
@@@@ -8687,6 +8732,7 @@@@ $(ff_config_enable "$cpuexts_all" "$cpuexts" "#" "HAVE
d221 1
a221 1
@@@@ -8773,6 +8819,7 @@@@ $def_ossaudio_devmixer
@


1.67
log
@Update to MPlayer 20130214 snapshot.

ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.66 2013/01/21 16:23:05 brad Exp $
d3 1
a3 1
+++ configure	Thu Feb 14 14:52:41 2013
a170 16
@@@@ -5017,13 +5029,13 @@@@ int main(void) {
   return strcmp(PNG_LIBPNG_VER_STRING, png_libpng_ver);
 }
 EOF
-    cc_check -lpng -lz && _png=yes
+    cc_check -lpng -lz -lm && _png=yes
   fi
 fi
 echores "$_png"
 if test "$_png" = yes ; then
   def_png='#define CONFIG_PNG 1'
-  extra_ldflags="$extra_ldflags -lpng -lz"
+  extra_ldflags="$extra_ldflags -lpng -lz -lm"
 else
   def_png='#undef CONFIG_PNG'
 fi
@


1.66
log
@Update to MPlayer 20120725 snapshot.

Testing by naddy@@ sthen@@ landry@@ dcoppa@@
OK naddy@@ dcoppa@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.62 2012/05/03 06:51:24 ajacoutot Exp $
--- configure.orig	Sat Jan 19 01:18:49 2013
+++ configure	Sat Jan 19 23:35:10 2013
@@@@ -35,29 +35,32 @@@@
d21 1
d31 1
a31 1
+#    if ! git clone --depth 1 git://git.videolan.org/ffmpeg.git ffmpeg ; then
d34 4
d44 1
d54 1
a54 1
-    if ! git clone --depth 1 git://git.videolan.org/ffmpeg.git ffmpeg ; then
d57 4
d69 1
a69 1
@@@@ -538,6 +541,7 @@@@ Audio output:
d77 1
a77 1
@@@@ -783,6 +787,7 @@@@ _xf86keysym=auto
d85 1
a85 1
@@@@ -1211,6 +1216,8 @@@@ for ac_option do
d94 1
a94 1
@@@@ -1527,7 +1534,7 @@@@ if test -z "$_target" ; then
d103 1
a103 1
@@@@ -2242,7 +2249,7 @@@@ case "$host_arch" in
d112 1
a112 1
@@@@ -2561,7 +2568,7 @@@@ cat > $TMPC << EOF
d121 1
a121 1
@@@@ -2609,7 +2616,7 @@@@ elif test -z "$CFLAGS" ; then
d130 1
a130 1
@@@@ -2879,8 +2886,11 @@@@ echores "$ibm_asm"
d144 1
a144 1
@@@@ -3488,7 +3498,6 @@@@ echores "$_fast_inttypes"
d152 1
a152 1
@@@@ -3507,7 +3516,8 @@@@ if test "$_memalign" = yes ; then
d162 1
a162 1
@@@@ -4673,6 +4683,8 @@@@ if test "$_aa" = yes ; then
d171 1
a171 1
@@@@ -4852,13 +4864,13 @@@@ int main(void) {
d187 1
a187 1
@@@@ -5602,6 +5614,26 @@@@ fi
d214 1
a214 1
@@@@ -5718,7 +5750,15 @@@@ else
d230 1
a230 1
@@@@ -5868,7 +5908,7 @@@@ echocheck "cdparanoia"
d239 1
a239 1
@@@@ -7806,6 +7846,7 @@@@ echores "$_dvdnav"
d247 1
a247 1
@@@@ -7833,6 +7874,7 @@@@ fi
d255 1
a255 1
@@@@ -7858,6 +7900,7 @@@@ fi
d263 1
a263 1
@@@@ -7911,6 +7954,7 @@@@ EOF
d271 1
a271 1
@@@@ -8179,6 +8223,7 @@@@ SPEEX = $_speex
d279 1
a279 1
@@@@ -8489,6 +8534,7 @@@@ $(ff_config_enable "$cpuexts_all" "$cpuexts" "#" "HAVE
d287 1
a287 1
@@@@ -8575,6 +8621,7 @@@@ $def_ossaudio_devmixer
@


1.65
log
@Update after FFmpeg 20121026 update.

ok sthen@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.64 2012/08/27 06:19:48 ajacoutot Exp $
--- configure.orig	Tue Mar  8 19:33:03 2011
+++ configure	Fri Aug 31 16:24:28 2012
@@@@ -35,29 +35,33 @@@@
d9 1
a9 7
-  echo "You have an outdated FFmpeg SVN checkout in ffmpeg/, please (re)move or replace it"
-  exit 1
-fi
 
-if test -e ffmpeg/mp_auto_pull ; then
-  if ! (cd ffmpeg && git pull --rebase --ff-only) ; then
-    echo "git pull failed, (re)move ffmpeg/mp_auto_pull to disable pulling"
a10 1
-  fi
d13 1
a13 1
+# Don't do anything funky with git or svn, we will provide mplayer with ffmpeg
d16 2
a17 2
+#  echo "You have an outdated FFmpeg SVN checkout in ffmpeg/, please (re)move or replace it"
+#  exit 1
d21 4
a24 4
+#  if ! (cd ffmpeg && git pull --rebase --ff-only) ; then
+#    echo "git pull failed, (re)move ffmpeg/mp_auto_pull to disable pulling"
+#    exit 1
+#  fi
d28 8
a35 8
+#  echo "No FFmpeg checkout, press enter to download one with git or CTRL+C to abort"
+#  read tmp
+#  if ! git clone --depth 1 git://git.videolan.org/ffmpeg.git ffmpeg ; then
+#    rm -rf ffmpeg
+#    echo "Failed to get a FFmpeg checkout"
+#    exit 1
+#  fi
+#  touch ffmpeg/mp_auto_pull
d38 7
d46 8
a53 8
-  echo "No FFmpeg checkout, press enter to download one with git or CTRL+C to abort"
-  read tmp
-  if ! git clone --depth 1 git://git.videolan.org/ffmpeg.git ffmpeg ; then
-    rm -rf ffmpeg
-    echo "Failed to get a FFmpeg checkout"
-    exit 1
-  fi
-  touch ffmpeg/mp_auto_pull
d56 1
a56 1
 # Prevent locale nonsense from breaking basic text processing utils
d59 1
a59 1
@@@@ -510,6 +514,7 @@@@ Audio output:
d67 1
a67 1
@@@@ -745,6 +750,7 @@@@ _xf86keysym=auto
d75 1
a75 1
@@@@ -1169,6 +1175,8 @@@@ for ac_option do
d84 2
a85 6
@@@@ -1486,10 +1494,10 @@@@ if test -z "$_target" ; then
       sparc64) host_arch=sparc64 ;;
       parisc*|hppa*|9000*) host_arch=hppa ;;
       arm*|zaurus|cats) host_arch=arm ;;
-      sh3|sh4|sh4a) host_arch=sh ;;
+      sh3|sh4|sh4a|landisk) host_arch=sh ;;
d93 1
a93 1
@@@@ -2200,7 +2208,7 @@@@ case "$host_arch" in
d102 1
a102 1
@@@@ -2519,7 +2527,7 @@@@ cat > $TMPC << EOF
d111 1
a111 1
@@@@ -2578,7 +2586,7 @@@@ elif test -z "$CFLAGS" ; then
d118 1
d120 1
a120 2
   fi
@@@@ -2860,8 +2868,11 @@@@ echores "$ibm_asm"
d134 1
a134 10
@@@@ -3118,7 +3129,7 @@@@ if test "$_posix4" = yes ; then
 fi
 echores "$_posix4"
 
-for func in exp2 exp2f llrint llrintf log2 log2f lrint lrintf round roundf truncf; do
+for func in exp2 exp2f llrint llrintf log2 log2f lrint lrintf round roundf trunc truncf; do
 echocheck $func
 eval _$func=no
 statement_check math.h "${func}(2.0)" -D_ISOC99_SOURCE $_ld_lm && eval _$func=yes
@@@@ -3461,7 +3472,6 @@@@ echores "$_fast_inttypes"
d142 1
a142 1
@@@@ -3480,7 +3490,8 @@@@ if test "$_memalign" = yes ; then
d152 1
a152 1
@@@@ -4661,6 +4672,8 @@@@ if test "$_aa" = yes ; then
d161 8
a168 1
@@@@ -4846,7 +4859,7 @@@@ fi
d177 1
a177 1
@@@@ -5663,6 +5676,26 @@@@ fi
d204 1
a204 1
@@@@ -5780,7 +5813,15 @@@@ else
d220 8
a227 16
@@@@ -5805,7 +5846,7 @@@@ echores "$_vcd"
 echocheck "Blu-ray support"
 if test "$_bluray" = auto ; then
   _bluray=no
-  statement_check libbluray/bluray.h 'bd_get_title_info(0, 0)' -lbluray && _bluray=yes
+  statement_check libbluray/bluray.h 'bd_get_title_info(0, 0, 0)' -lbluray && _bluray=yes
 fi
 if test "$_bluray" = yes ; then
   def_bluray='#define CONFIG_LIBBLURAY 1'
@@@@ -7360,6 +7401,8 @@@@ if test "$_tv_v4l2" = auto ; then
   _tv_v4l2=no
   if test "$_tv" = yes && linux ; then
     header_check_broken sys/time.h linux/videodev2.h && _tv_v4l2=yes
+  elif test "$_tv" = yes && openbsd ; then
+    header_check sys/videoio.h && _tv_v4l2=yes
   fi
d229 33
a261 2
 if test "$_tv_v4l2" = yes ; then
@@@@ -8069,6 +8112,7 @@@@ SPEEX = $_speex
d269 1
a269 1
@@@@ -8357,6 +8401,7 @@@@ $(ff_config_enable "$cpuexts_all" "$cpuexts" "#" "HAVE
d277 1
a277 1
@@@@ -8445,6 +8490,7 @@@@ $def_ossaudio_devmixer
a284 8
@@@@ -8622,6 +8668,7 @@@@ $def_round
 $def_roundf
 $def_ten_operands
 $def_threads
+$def_trunc
 $def_truncf
 $def_xform_asm
 $def_xmm_clobbers
@


1.64
log
@Remove -pthread patching.

from Brad
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.63 2012/06/28 18:53:02 jasper Exp $
d3 1
a3 1
+++ configure	Thu Aug 16 17:53:14 2012
d147 9
a155 1
@@@@ -3480,7 +3491,8 @@@@ if test "$_memalign" = yes ; then
d165 1
a165 1
@@@@ -4661,6 +4673,8 @@@@ if test "$_aa" = yes ; then
d174 1
a174 1
@@@@ -4846,7 +4860,7 @@@@ fi
d183 1
a183 16
@@@@ -4854,12 +4868,12 @@@@ fi
 echocheck "MNG support"
 if test "$_mng" = auto ; then
   _mng=no
-  return_statement_check libmng.h 'const char * p_ver = mng_version_text()' '!p_ver || p_ver[0] == 0' -lmng -lz $_ld_lm && _mng=yes
+  return_statement_check libmng.h 'const char * p_ver = mng_version_text()' '!p_ver || p_ver[0] == 0' -llcms -ljpeg -lmng -lz $_ld_lm && _mng=yes
 fi
 echores "$_mng"
 if test "$_mng" = yes ; then
   def_mng='#define CONFIG_MNG 1'
-  extra_ldflags="$extra_ldflags -lmng -lz"
+  extra_ldflags="$extra_ldflags -lmng -llcms -lz -ljpeg $_ld_m"
 else
   def_mng='#undef CONFIG_MNG'
 fi
@@@@ -5663,6 +5677,26 @@@@ fi
d210 1
a210 1
@@@@ -5780,7 +5814,15 @@@@ else
d226 1
a226 1
@@@@ -5805,7 +5847,7 @@@@ echores "$_vcd"
d235 1
a235 10
@@@@ -6521,7 +6563,7 @@@@ echores "$_libmpeg2"
 echocheck "libdca support"
 if test "$_libdca" = auto ; then
   _libdca=no
-  for _ld_dca in -ldca -ldts ; do
+  for _ld_dca in -ldca; do
     statement_check_broken stdint.h dts.h 'dts_init(0)' $_ld_dca $_ld_lm &&
       extra_ldflags="$extra_ldflags $_ld_dca" && _libdca=yes && break
   done
@@@@ -7360,6 +7402,8 @@@@ if test "$_tv_v4l2" = auto ; then
d244 1
a244 1
@@@@ -8069,6 +8113,7 @@@@ SPEEX = $_speex
d252 1
a252 1
@@@@ -8357,6 +8402,7 @@@@ $(ff_config_enable "$cpuexts_all" "$cpuexts" "#" "HAVE
d260 1
a260 1
@@@@ -8445,6 +8491,7 @@@@ $def_ossaudio_devmixer
d268 1
a268 1
@@@@ -8622,6 +8669,7 @@@@ $def_round
@


1.63
log
@recognize landisk as an 'sh' target.

from brad
ok edd@@ (MAINTAINER)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.62 2012/05/03 06:51:24 ajacoutot Exp $
d3 1
a3 1
+++ configure	Thu Jun 28 02:45:17 2012
a156 9
@@@@ -3585,7 +3597,7 @@@@ int main(void) { pthread_t tid; return pthread_create(
 EOF
 _pthreads=no
 if ! hpux ; then
-  for _ld_tmp in "-lpthreadGC2" "" "-lpthread" "-pthread" ; do
+  for _ld_tmp in "-lpthreadGC2" "" "-pthread" "-lpthread" ; do
     # for crosscompilation, we cannot execute the program, be happy if we can link statically
     cc_check $THREAD_CFLAGS $_ld_tmp && (tmp_run || test "$_ld_static") && _ld_pthread="$_ld_tmp" && _pthreads=yes && break
   done
@


1.62
log
@Adjust after libdvdcss/libdvdnav/libdvdread updates.

from Brad, ok sthen@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.61 2012/03/30 13:23:03 phessler Exp $
d3 1
a3 1
+++ configure	Fri Mar 30 17:05:21 2012
d84 6
a89 2
@@@@ -1489,7 +1497,7 @@@@ if test -z "$_target" ; then
       sh3|sh4|sh4a) host_arch=sh ;;
@


1.61
log
@allow mplayer to play (non-encrypted) bluray discs.

reviewed by Brad, edd@@ and sthen@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.60 2011/12/30 17:40:40 edd Exp $
--- configure.orig	Wed Mar  9 01:33:03 2011
+++ configure	Wed Jan 25 10:27:59 2012
d247 1
a247 13
@@@@ -5832,8 +5874,9 @@@@ if test "$_dvdread_internal" = auto ; then
 elif test "$_dvdread" = auto ; then
   _dvdread=no
   if test "$_dl" = yes; then
-    _dvdreadcflags=$($_dvdreadconfig --cflags 2> /dev/null)
-    _dvdreadlibs=$($_dvdreadconfig --libs 2> /dev/null)
+# OpenBSD - we do not use dvdread-config, picked up anyway without
+#    _dvdreadcflags=$($_dvdreadconfig --cflags 2> /dev/null)
+#    _dvdreadlibs=$($_dvdreadconfig --libs 2> /dev/null)
     if header_check dvdread/dvd_reader.h $_dvdreadcflags $_dvdreadlibs $_ld_dl ; then
       _dvdread=yes
       extra_cflags="$extra_cflags $_dvdreadcflags"
@@@@ -6521,7 +6564,7 @@@@ echores "$_libmpeg2"
d256 1
a256 1
@@@@ -7360,6 +7403,8 @@@@ if test "$_tv_v4l2" = auto ; then
d265 1
a265 1
@@@@ -8069,6 +8114,7 @@@@ SPEEX = $_speex
d273 1
a273 1
@@@@ -8357,6 +8403,7 @@@@ $(ff_config_enable "$cpuexts_all" "$cpuexts" "#" "HAVE
d281 1
a281 1
@@@@ -8445,6 +8492,7 @@@@ $def_ossaudio_devmixer
d289 1
a289 1
@@@@ -8622,6 +8670,7 @@@@ $def_round
@


1.60
log
@Make mplayer build with Brad's ffmpeg update.
From brad, OK aja@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.59 2011/06/25 14:15:43 edd Exp $
--- configure.orig	Tue Mar  8 19:33:03 2011
+++ configure	Sat Sep 24 15:53:18 2011
d222 26
a247 1
@@@@ -5832,8 +5866,9 @@@@ if test "$_dvdread_internal" = auto ; then
d259 1
a259 1
@@@@ -6521,7 +6556,7 @@@@ echores "$_libmpeg2"
d268 1
a268 1
@@@@ -7360,6 +7395,8 @@@@ if test "$_tv_v4l2" = auto ; then
d277 1
a277 1
@@@@ -8069,6 +8106,7 @@@@ SPEEX = $_speex
d285 9
a293 1
@@@@ -8445,6 +8483,7 @@@@ $def_ossaudio_devmixer
d301 1
a301 1
@@@@ -8622,6 +8661,7 @@@@ $def_round
@


1.59
log
@make mplayer build with thew new libass.

OK sthen@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.58 2011/03/29 20:04:41 edd Exp $
--- configure.orig	Wed Mar  9 00:33:03 2011
+++ configure	Fri Jun 24 12:19:32 2011
d134 9
d268 8
@


1.58
log
@Update mplayer to a newer snapshot, this time with dynamic linking of ffmpeg!
With help from and OK landry@@, jakemsr@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.57 2010/11/08 21:25:44 edd Exp $
d3 1
a3 1
+++ configure	Wed Mar  9 00:46:58 2011
@


1.57
log
@Update to mplayer-20101024. Noteworthy improvements include vpx
(webm) support and alpha support. This work is a joint effort from
myself, naddy@@ and jakemsr@@. Cheers.

OK jakemsr@@
@
text
@d1 59
a59 4
$OpenBSD: patch-configure,v 1.56 2010/05/26 21:29:56 jakemsr Exp $
--- configure.orig	Thu Oct 21 10:35:56 2010
+++ configure	Sat Nov  6 13:41:02 2010
@@@@ -461,6 +461,7 @@@@ Audio output:
d67 1
a67 1
@@@@ -698,6 +699,7 @@@@ _xf86keysym=auto
d75 1
a75 1
@@@@ -1126,6 +1128,8 @@@@ for ac_option do
d84 1
a84 1
@@@@ -1446,7 +1450,7 @@@@ if test -z "$_target" ; then
d93 1
a93 1
@@@@ -2157,7 +2161,7 @@@@ case "$host_arch" in
d102 1
a102 1
@@@@ -2476,7 +2480,7 @@@@ cat > $TMPC << EOF
d111 1
a111 1
@@@@ -2535,7 +2539,7 @@@@ elif test -z "$CFLAGS" ; then
d120 1
a120 1
@@@@ -2817,8 +2821,11 @@@@ echores "$ibm_asm"
d134 1
a134 1
@@@@ -3436,7 +3443,8 @@@@ if test "$_memalign" = yes ; then
d144 1
a144 1
@@@@ -3543,7 +3551,7 @@@@ int main(void) { pthread_t tid; return pthread_create(
d153 1
a153 1
@@@@ -4664,6 +4672,8 @@@@ if test "$_aa" = yes ; then
d162 15
a176 8
@@@@ -4873,14 +4883,14 @@@@ int main(void) {
   return !p_ver || p_ver[0] == 0;
 }
 EOF
-  if cc_check -lmng -lz $_ld_lm ; then
+  if cc_check -lmng -llcms -ljpeg -lz -lm $_ld_lm ; then
     _mng=yes
   fi
d182 1
a182 1
+  extra_ldflags="$extra_ldflags -lmng -llcms -ljpeg -lz -lm"
d186 1
a186 1
@@@@ -5691,6 +5701,26 @@@@ fi
d213 1
a213 1
@@@@ -5860,8 +5890,9 @@@@ if test "$_dvdread_internal" = auto ; then
d225 1
a225 10
@@@@ -6347,7 +6378,7 @@@@ elif test "$_libvorbis" = yes ; then
   def_vorbis='#define CONFIG_OGGVORBIS 1'
   codecmodules="libvorbis $codecmodules"
   res_comment="libvorbis"
-  extra_ldflags="$extra_ldflags -lvorbis -logg"
+  extra_ldflags="$extra_ldflags -lvorbisenc -lvorbis -logg"
   libavencoders="$libavencoders LIBVORBIS_ENCODER"
 else
   _vorbis=no
@@@@ -6547,7 +6578,7 @@@@ echores "$_libmpeg2"
d234 1
a234 1
@@@@ -7448,6 +7479,8 @@@@ if test "$_tv_v4l2" = auto ; then
d237 1
a237 1
     header_check linux/videodev2.h && _tv_v4l2=yes
d243 1
a243 1
@@@@ -8158,6 +8191,7 @@@@ SPEEX = $_speex
d251 1
a251 1
@@@@ -8540,6 +8574,7 @@@@ $def_ossaudio_devmixer
@


1.56
log
@update to mplayer-export-snapshot-20100308

locally:
* fix audio when using bsdbt848 video driver (problems noted by simon@@)
* allow 24-bit audio output formats in the sndio backend (from ratchov@@)

mostly from edd@@ (MAINTAINER)
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.55 2010/02/23 19:59:13 phessler Exp $
--- configure.orig	Thu Mar  4 14:46:44 2010
+++ configure	Mon Mar  8 21:09:42 2010
@@@@ -423,6 +423,7 @@@@ Audio output:
d12 1
a12 1
@@@@ -665,6 +666,7 @@@@ _xf86keysym=auto
d20 1
a20 1
@@@@ -1098,6 +1100,8 @@@@ for ac_option do
d29 1
a29 1
@@@@ -1434,7 +1438,7 @@@@ if test -z "$_target" ; then
d38 10
a47 1
@@@@ -2456,7 +2460,7 @@@@ cat > $TMPC << EOF
d56 34
a89 9
@@@@ -3205,6 +3209,7 @@@@ if test "$_struct_sockaddr_storage" = auto; then
 #if HAVE_WINSOCK2_H
 #include <winsock2.h>
 #else
+#include <stdlib.h>
 #include <sys/socket.h>
 #endif
 int main(void) { struct sockaddr_storage sas; return 0; }
@@@@ -3613,7 +3618,7 @@@@ int main(void) { pthread_t tid; return pthread_create(
d98 1
a98 1
@@@@ -4892,6 +4897,8 @@@@ if test "$_aa" = yes ; then
d105 1
a105 1
   _vomodules="aa $_vomodules"
d107 1
a107 1
@@@@ -5188,14 +5195,14 @@@@ int main(void) {
d124 1
a124 9
@@@@ -5823,6 +5830,7 @@@@ fi
 if test "$_jack" = yes ; then
   def_jack='#define CONFIG_JACK 1'
   _aomodules="jack $_aomodules"
+  libs_mplayer="$libs_mplayer $(pkg-config --libs jack)"
 else
   _noaomodules="jack $_noaomodules"
 fi
@@@@ -5985,6 +5993,26 @@@@ fi
d151 6
a156 15
@@@@ -6100,7 +6128,7 @@@@ elif dragonfly ; then
 elif freebsd ; then
   default_cdrom_device="/dev/acd0"
 elif openbsd ; then
-  default_cdrom_device="/dev/rcd0a"
+  default_cdrom_device="/dev/rcd0c"
 elif sunos ; then
   default_cdrom_device="/vol/dev/aliases/cdrom0"
   # Modern Solaris versions use HAL instead of the vold daemon, the volfs
@@@@ -6169,8 +6197,9 @@@@ elif test "$_dvdread" = auto ; then
 #include <dvdread/nav_read.h>
 int main(void) { return 0; }
 EOF
-    _dvdreadcflags=$($_dvdreadconfig --cflags)
-    _dvdreadlibs=$($_dvdreadconfig --libs)
d158 3
a160 4
+#    _dvdreadcflags=$($_dvdreadconfig --cflags)
+#    _dvdreadlibs=$($_dvdreadconfig --libs)
     if cc_check -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE \
       $_dvdreadcflags $_dvdreadlibs $_ld_dl ; then
d162 14
a175 4
@@@@ -6848,7 +6877,7 @@@@ if test "$_libdca" = auto ; then
 #include <dts.h>
 int main(void) { dts_init(0); return 0; }
 EOF
d178 2
a179 9
     cc_check $_ld_dca $_ld_lm && extra_ldflags="$extra_ldflags $_ld_dca" \
       && _libdca=yes && break
   done
@@@@ -6898,7 +6927,7 @@@@ int main(void) { unsigned long x, y; faacEncOpen(48000
 EOF
   _faac=no
   for _ld_faac in "-lfaac" "-lfaac -lmp4v2 -lstdc++" ; do
-    cc_check -O4 $_ld_faac $_ld_lm && libs_mencoder="$libs_mencoder $_ld_faac" && _faac=yes && break
+    cc_check $_ld_faac $_ld_lm && libs_mencoder="$libs_mencoder $_ld_faac" && _faac=yes && break
d181 6
a186 15
 fi
 if test "$_faac" = yes ; then
@@@@ -7899,6 +7928,15 @@@@ if test "$_tv_v4l2" = auto ; then
 int main(void) { return 0; }
 EOF
     cc_check && _tv_v4l2=yes
+  else
+    cat > $TMPC <<EOF
+#include <stdlib.h>
+#include <sys/types.h>
+#include <sys/ioctl.h>
+#include <sys/videoio.h>
+int main(void) { return 0; }
+EOF
+    cc_check && _tv_v4l2=yes
d190 1
a190 1
@@@@ -8637,6 +8675,7 @@@@ SPEEX = $_speex
d198 1
a198 1
@@@@ -9026,6 +9065,7 @@@@ $def_ossaudio_devmixer
@


1.55
log
@enable building on loongson

OK jasper@@

ports is unlocked for a while only for those who have been informed.
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.54 2009/11/18 21:20:15 jakemsr Exp $
--- configure.orig	Thu Jun 25 01:31:17 2009
+++ configure	Sat Feb 13 11:34:11 2010
@@@@ -420,6 +420,7 @@@@ Audio output:
d8 2
a9 1
+  --disable-sndio        disable sndio audio output [autodetect]
d12 1
a12 2
   --disable-coreaudio    disable CoreAudio audio output [autodetect]
@@@@ -651,6 +652,7 @@@@ _xf86keysym=auto
d19 5
a23 5
 _unrar_exec=auto
@@@@ -1075,6 +1077,8 @@@@ for ac_option do
   --disable-mlib)	_mlib=no	;;
   --enable-sunaudio)	_sunaudio=yes	;;
   --disable-sunaudio)	_sunaudio=no	;;
d26 4
a29 4
   --enable-sgiaudio)	_sgiaudio=yes	;;
   --disable-sgiaudio)	_sgiaudio=no	;;
   --enable-alsa)	_alsa=yes	;;
@@@@ -1408,7 +1412,7 @@@@ if test -z "$_target" ; then
d33 1
a33 1
-      mips*) host_arch=mips ;;
d38 1
a38 1
@@@@ -2374,7 +2378,7 @@@@ cat > $TMPC << EOF
d45 1
d47 9
a55 2
 echores $extern_prefix
@@@@ -3347,7 +3351,7 @@@@ int main(void) { pthread_t tid; return pthread_create(
d64 1
a64 1
@@@@ -4666,6 +4670,8 @@@@ if test "$_aa" = yes ; then
d73 1
a73 1
@@@@ -4911,14 +4917,14 @@@@ int main(void) {
d90 1
a90 1
@@@@ -5510,6 +5516,7 @@@@ fi
d98 1
a98 1
@@@@ -5672,6 +5679,26 @@@@ fi
d125 1
a125 1
@@@@ -5767,7 +5794,7 @@@@ elif dragonfly ; then
d134 13
a146 1
@@@@ -6507,7 +6534,7 @@@@ if test "$_libdca" = auto ; then
d150 2
a151 2
-  for _ld_dca in -ldts -ldca ; do
+  for _ld_dca in -ldca ; do
d155 1
a155 1
@@@@ -6557,7 +6584,7 @@@@ int main(void) { unsigned long x, y; faacEncOpen(48000
d164 1
a164 1
@@@@ -7560,6 +7587,15 @@@@ if test "$_tv_v4l2" = auto ; then
d180 1
a180 1
@@@@ -8303,6 +8339,7 @@@@ SPEEX = $_speex
d188 1
a188 1
@@@@ -8677,6 +8714,7 @@@@ $def_ossaudio_devmixer
@


1.54
log
@* simple patch to make it work on mips64
* audio/tremor is a LIB_DEPENDS, no need to also be a BUILD_DEPENDS

ok edd@@, jasper@@, ajacoutot@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.53 2009/10/11 13:36:23 edd Exp $
--- configure.orig	Wed Jun 24 16:31:17 2009
+++ configure	Mon Nov 16 00:09:58 2009
d34 1
a34 1
+      sgi|mips*) host_arch=mips ;;
@


1.53
log
@New version of mplayer based upon a snapshot (20090708).
  * fixes some flv playback
  * removed ggi output - broken i386/sparc64.
  * removed gui (deprecated) - use gnome-mplayer instead.
  * removed win32 codecs - opensource codecs are good quality.

OK, naddy@@, sthen@@
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.orig	Thu Jun 25 00:31:17 2009
+++ configure	Thu Aug 27 18:05:38 2009
d29 9
@


1.52
log
@Use libdca for DTS support (-ac dts).  This allows playing DTS audio tracks
on DVDs.  ok biorn@@
@
text
@d1 4
a4 13
$OpenBSD: patch-configure,v 1.51 2009/05/05 11:40:08 sthen Exp $
--- configure.orig	Sun Oct  7 21:49:33 2007
+++ configure	Mon Jul 13 23:49:43 2009
@@@@ -76,7 +76,7 @@@@ cc_check() {
 }
 
 cxx_check() {
-  compile_check $TMPCPP $@@ -lstdc++
+  compile_check $TMPCPP $@@ -lstdc++ -lm
 }
 
 tmp_run() {
@@@@ -397,6 +397,7 @@@@ Audio output:
d8 2
a9 1
+  --disable-libsndio     disable libsndio audio output [autodetect]
d11 2
a12 12
   --disable-select       disable using select() on the audio device [enable]
 
@@@@ -501,7 +502,7 @@@@ _libavcodec_a=auto
 _libamr_nb=auto
 _libamr_wb=auto
 _libavdecoders_all=`sed -n 's/^[^#]*DEC.*(.*, *\(.*\)).*/\1_decoder/p' libavcodec/allcodecs.c | tr '[a-z]' '[A-Z]'`
-_libavdecoders=` echo $_libavdecoders_all | sed -e s/LIBFAAD_DECODER// -e s/MPEG4AAC_DECODER//  -e s/LIBA52_DECODER// -e s/LIBGSM_DECODER// -e s/LIBGSM_MS_DECODER// -e s/LIBVORBIS_DECODER// `
+_libavdecoders=` echo $_libavdecoders_all | sed -e s/LIBFAAD_DECODER// -e s/MPEG4AAC_DECODER//  -e s/LIBA52_DECODER// -e s/LIBGSM_DECODER// -e s/LIBGSM_MS_DECODER// -e s/LIBVORBIS_DECODER// -e s/VORBIS_DECODER// `
 _libavencoders_all=`sed -n 's/^[^#]*ENC.*(.*, *\(.*\)).*/\1_encoder/p' libavcodec/allcodecs.c | tr '[a-z]' '[A-Z]'`
 _libavencoders=` echo $_libavencoders_all | sed -e s/LIBGSM_ENCODER// -e s/LIBGSM_MS_ENCODER// -e s/LIBTHEORA_ENCODER// `
 _libavparsers_all=`sed -n 's/^[^#]*PARSER.*(.*, *\(.*\)).*/\1_parser/p' libavcodec/allcodecs.c | tr '[a-z]' '[A-Z]'`
@@@@ -598,6 +599,7 @@@@ _xf86keysym=auto
d16 1
a16 1
+_libsndio=auto
d19 2
a20 2
 _unrarlib=yes
@@@@ -963,6 +965,8 @@@@ for ac_option do
d24 2
a25 2
+  --enable-libsndio)	_libsndio=yes	;;
+  --disable-libsndio)	_libsndio=no	;;
d29 10
a38 19
@@@@ -1557,6 +1561,8 @@@@ if x86 ; then
   pparam=`echo $exts | sed -e s/k6_mtrr/mtrr/ -e s/cyrix_arr/mtrr/ -e s/centaur_mcr/mtrr/ \
                            -e s/xmm/sse/ -e s/kni/sse/`
 
+  if x86_64 ; then pparam="3dnow 3dnowext mmx mmxext xmm sse sse2" ; fi
+
   for ext in $pparam ; do
     eval test \"\$_$ext\" = auto 2>/dev/null && eval _$ext=kernel_check
   done
@@@@ -2323,7 +2329,7 @@@@ fi # if darwin && test "$cc_vendor" = "gnu" ; then
 # Checking for CFLAGS
 _install_strip="-s"
 if test "$_profile" != "" || test "$_debug" != "" ; then
-  CFLAGS="-W -Wall -O2 $_march $_mcpu $_pipe $_debug $_profile"
+  CFLAGS="-W -Wall -O1 $_march $_mcpu $_pipe $_debug $_profile"
   _install_strip=
 elif test -z "$CFLAGS" ; then
   if test "$cc_vendor" = "intel" ; then
@@@@ -3065,7 +3071,7 @@@@ int main(void) { pthread_t tid; return pthread_create 
d41 1
a41 1
 if not hpux ; then
d45 1
a45 1
     cc_check $_ld_tmp && (tmp_run || test "$_ld_static") && _ld_pthread="$_ld_tmp" && _pthreads=yes && break
d47 2
a48 11
@@@@ -3108,7 +3114,7 @@@@ fi
 echores "$_rpath"
 
 echocheck "iconv"
-if test "$_iconv" = auto ; then
+if test "$_iconv" != no ; then
   cat > $TMPC << EOF
 #include <stdio.h>
 #include <unistd.h>
@@@@ -4369,6 +4375,8 @@@@ if test "$_aa" = yes ; then
   _def_aa='#define HAVE_AA 1'
d50 1
a50 1
     _libs_mplayer="$_libs_mplayer `aalib-config --libs | cut -d " " -f 2,5,6`"
d52 1
a52 1
+    _libs_mplayer="$_libs_mplayer -laa"
a53 1
   _vosrc="$_vosrc vo_aa.c"
a54 8
@@@@ -4576,7 +4584,7 @@@@ fi
 echores "$_png"
 if test "$_png" = yes ; then
   _def_png='#define HAVE_PNG 1'
-  _ld_extra="$_ld_extra -lpng -lz"
+  _ld_extra="$_ld_extra -lpng -lz $_ld_lm"
   _vosrc="$_vosrc vo_png.c"
   _vomodules="png $_vomodules"
d56 26
a81 11
@@@@ -5129,7 +5137,8 @@@@ fi
 echocheck "JACK"
 if test "$_jack" = auto ; then
   _jack=yes
-
+fi
+if test "$_jack" = yes ; then
 cat > $TMPC << EOF
 #include <jack/jack.h>
 int main(void) { jack_client_new("test"); return 0; }
@@@@ -5303,6 +5312,27 @@@@ fi
d85 2
a86 2
+echocheck "libsndio audio"
+if test "$_libsndio" = auto ; then
d91 2
a92 2
+  _libsndio=no
+  cc_check -lsndio && _libsndio=yes
d94 4
a97 5
+if test "$_libsndio" = yes ; then
+  _def_libsndio='#define USE_LIBSNDIO_AUDIO 1'
+  _aosrc="$_aosrc ao_libsndio.c"
+  _aomodules="libsndio $_aomodules"
+  _libs_mplayer="$_libs_mplayer -lsndio"
d99 2
a100 2
+  _def_libsndio='#undef USE_LIBSNDIO_AUDIO'
+  _noaomodules="libsndio $_noaomodules"
d102 1
a102 1
+echores "$_libsndio"
d105 1
d108 12
a119 12
 if test "$_mlib" = auto ; then
@@@@ -5343,7 +5373,7 @@@@ fi #if irix
 
 
 echocheck "VCD support"
-if linux || bsdos || freebsd || netbsd || sunos || darwin || mingw32; then
+if linux || bsdos || freebsd || netbsd || sunos || darwin || mingw32 || openbsd ; then
   _inputmodules="vcd $_inputmodules"
   _def_vcd='#define HAVE_VCD 1'
   _vcd="yes"
@@@@ -5592,7 +5622,7 @@@@ int main()
 }
d121 4
a124 5
   _fontconfig=no
-  for _ld_tmp in "" "-lexpat -lfreetype" "-lexpat -lfreetype -lz" ; do
+  for _ld_tmp in "" "-lexpat -lfreetype" "-lexpat -lfreetype -lz $_ld_lm" ; do
     _ld_tmp="-lfontconfig $_ld_tmp"
     cc_check $_ld_tmp && _fontconfig=yes && _ld_extra="$_ld_extra $_ld_tmp" && break
d126 1
a126 2
@@@@ -5704,10 +5734,10 @@@@ cat > $TMPC << EOF
 int main(void) { (void) inflate(0, Z_NO_FLUSH); return 0; }
d128 9
a136 13
 _zlib=no
-cc_check -lz && _zlib=yes
+cc_check "-lz $_ld_lm" && _zlib=yes
 if test "$_zlib" = yes ; then
   _def_zlib='#define HAVE_ZLIB 1'
-  _ld_extra="$_ld_extra -lz"
+  _ld_extra="$_ld_extra -lz $_ld_lm"
 else
   _def_zlib='#undef HAVE_ZLIB'
   _libavdecoders=`echo $_libavdecoders | sed -e s/FLASHSV_DECODER// -e s/PNG_DECODER// -e s/ZMBV_DECODER// -e s/DXA_DECODER// `
@@@@ -5986,11 +6016,11 @@@@ if test "$_libdca" = auto ; then
 #include <dts.h>
 int main(void) { dts_init (0); return 0; }
d138 10
a147 17
-  cc_check -ldts $_ld_lm && _libdca=yes
+  cc_check -ldca $_ld_lm && _libdca=yes
 fi
 if test "$_libdca" = yes ; then
   _def_libdca='#define USE_LIBDCA 1'
-  _ld_extra="$_ld_extra -ldts"
+  _ld_extra="$_ld_extra -ldca"
   _codecmodules="libdca $_codecmodules"
 else
   _def_libdca='#undef USE_LIBDCA'
@@@@ -6207,7 +6237,7 @@@@ if test "$_real" = auto ; then
   _real=no
   _res_comment="dynamic loader support needed"
   if test "$_dl" = yes || test "$_win32dll" = yes &&
-     (linux || freebsd || netbsd || win32 || darwin) ; then
+     (linux || freebsd || netbsd || openbsd || win32 || darwin) ; then
     _real=yes
d150 17
a166 17
@@@@ -8151,6 +8181,7 @@@@ $_def_openal_h
 $_def_sys_asoundlib_h
 $_def_alsa_asoundlib_h
 $_def_sunaudio
+$_def_libsndio
 $_def_sgiaudio
 $_def_win32waveout
 $_def_nas
@@@@ -8240,7 +8271,7 @@@@ $_def_vcd
 #define DEFAULT_CDROM_DEVICE    "/dev/disk1"
 #define DEFAULT_DVD_DEVICE	"/dev/rdiskN"
 #elif defined(__OpenBSD__)
-#define DEFAULT_CDROM_DEVICE	"/dev/rcd0a"
+#define DEFAULT_CDROM_DEVICE	"/dev/rcd0c"
 #define DEFAULT_DVD_DEVICE	DEFAULT_CDROM_DEVICE
 #elif defined(__FreeBSD__) || defined(__FreeBSD_kernel__)
 #define DEFAULT_CDROM_DEVICE	"/dev/acd0"
@


1.51
log
@make FLAVOR=DEBUG work better (the upstream configure script adds -O2
with DEBUG so that SSE can build; only -O1 is actually needed though,
and is cleaner in GDB. -O0 builds fail with SSE; disabling SSE is
not helpful for debugging real problems).

from Valery Masiutsin with feedback from myself and Bjrn Sandell
(maintainer, who is ok with the diff).
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.50 2009/02/08 20:25:09 naddy Exp $
--- configure.orig	Sun Oct  7 22:49:33 2007
+++ configure	Sun Apr 19 13:55:04 2009
d170 14
@


1.50
log
@Switch default CD/DVD device to /dev/rcd0c because rcd0a doesn't work for
audio CDs.  Document the device in the man page.  ok biorn@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.49 2009/01/16 02:39:53 jakemsr Exp $
--- configure.orig	Sun Oct  7 21:49:33 2007
+++ configure	Sun Feb  8 19:48:58 2009
d56 9
@


1.49
log
@- remove artsd and esd support and related patches
- update DESCR to reflect reality
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.48 2008/12/15 21:30:07 naddy Exp $
--- configure.orig	Sun Oct  7 15:49:33 2007
+++ configure	Tue Dec 30 03:29:05 2008
d178 9
@


1.48
log
@SECURITY:
Fix for stack buffer overflow vulnerability while parsing malformed
TwinVQ media files.  From upstream SVN.  ok biorn@@
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.orig	Sun Oct  7 21:49:33 2007
+++ configure	Mon Dec 15 18:43:58 2008
a91 9
@@@@ -5054,7 +5062,7 @@@@ if test "$_arts" = yes ; then
   _def_arts='#define USE_ARTS 1'
   _aosrc="$_aosrc ao_arts.c"
   _aomodules="arts $_aomodules"
-  _libs_mplayer="$_libs_mplayer `artsc-config --libs`"
+  _libs_mplayer="$_libs_mplayer `artsc-config --libs` -lstdc++"
   _inc_extra="$_inc_extra `artsc-config --cflags`"
 else
   _noaomodules="arts $_noaomodules"
d102 1
a102 9
@@@@ -5144,6 +5153,7 @@@@ EOF
   fi
 fi
 
+
 if test "$_jack" = yes ; then
   _def_jack='#define USE_JACK 1'
   _aosrc="$_aosrc ao_jack.c"
@@@@ -5303,6 +5313,27 @@@@ fi
d130 1
a130 1
@@@@ -5343,7 +5374,7 @@@@ fi #if irix
d139 1
a139 1
@@@@ -5592,7 +5623,7 @@@@ int main()
d148 1
a148 1
@@@@ -5704,10 +5735,10 @@@@ cat > $TMPC << EOF
d161 1
a161 1
@@@@ -6207,7 +6238,7 @@@@ if test "$_real" = auto ; then
d170 1
a170 1
@@@@ -8151,6 +8182,7 @@@@ $_def_openal_h
@


1.47
log
@add libsndio backend to mplayer
ok sthen@@
@
text
@d1 3
a3 2
--- configure.old	Mon Sep 29 17:11:48 2008
+++ configure	Mon Sep 29 17:13:03 2008
@


1.46
log
@fix the test for jack in configure, so that --disable-jack is
correctly honoured. unbreaks bulk build packages.

ok jakemsr
@
text
@d1 2
a2 3
$OpenBSD: patch-configure,v 1.45 2008/04/16 01:43:12 jakemsr Exp $
--- configure.orig	Sun Oct  7 20:49:33 2007
+++ configure	Thu May  1 00:29:07 2008
d12 9
a20 1
@@@@ -501,7 +501,7 @@@@ _libavcodec_a=auto
d29 18
a46 1
@@@@ -1557,6 +1557,8 @@@@ if x86 ; then
d55 1
a55 1
@@@@ -3065,7 +3067,7 @@@@ int main(void) { pthread_t tid; return pthread_create 
d64 1
a64 1
@@@@ -3108,7 +3110,7 @@@@ fi
d73 1
a73 1
@@@@ -4369,6 +4371,8 @@@@ if test "$_aa" = yes ; then
d82 1
a82 1
@@@@ -4576,7 +4580,7 @@@@ fi
d91 1
a91 1
@@@@ -5054,7 +5058,7 @@@@ if test "$_arts" = yes ; then
d100 1
a100 1
@@@@ -5129,7 +5133,8 @@@@ fi
d110 1
a110 1
@@@@ -5144,6 +5149,7 @@@@ EOF
d118 29
a146 1
@@@@ -5343,7 +5349,7 @@@@ fi #if irix
d155 1
a155 1
@@@@ -5592,7 +5598,7 @@@@ int main()
d164 1
a164 1
@@@@ -5704,10 +5710,10 @@@@ cat > $TMPC << EOF
d177 1
a177 1
@@@@ -6207,7 +6213,7 @@@@ if test "$_real" = auto ; then
d186 8
@


1.45
log
@
add jack support as a FLAVOR

"no objections" MAINTAINER
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.44 2008/02/18 16:37:38 espie Exp $
--- configure.orig	Sun Oct  7 21:49:33 2007
+++ configure	Mon Feb 18 17:25:13 2008
d76 1
a76 1
@@@@ -5129,7 +5133,7 @@@@ fi
d82 1
d86 1
a86 3
@@@@ -5142,8 +5146,8 @@@@ EOF
   else
     _jack=no
d88 1
a88 1
-fi
d94 1
a94 1
@@@@ -5343,7 +5347,7 @@@@ fi #if irix
d103 1
a103 1
@@@@ -5592,7 +5596,7 @@@@ int main()
d112 1
a112 1
@@@@ -5704,10 +5708,10 @@@@ cat > $TMPC << EOF
d125 1
a125 1
@@@@ -6207,7 +6211,7 @@@@ if test "$_real" = auto ; then
@


1.44
log
@very sloppy update, restore realplayer support
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.43 2008/02/08 17:32:41 jakemsr Exp $
d76 19
@


1.43
log
@
maintenence update to mplayer-1.0rc2

ok biorn@@ (MAINTAINER), ajacoutot@@, brad@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.42 2007/11/15 07:50:27 jakemsr Exp $
--- configure.orig	Sun Oct  7 12:49:33 2007
+++ configure	Mon Feb  4 16:20:05 2008
d107 9
@


1.42
log
@- quit using select() for audio playback.  we end up counting bytes
in the playback buffer and waiting until there's enough space anyway.
- use -pthread instead of -lpthread for pthreads linkage
- don't even try to use the "real time sample counter" on *BSD, since
it's not that same as with Sun audio.
- use the audio(4) interface to the mixer "master" volume control
- actually mute the audio when output volume is '0'
- set the audio(4) blocksize to match size of chunks to be written
- provide *BSD equivilents to some Sun functionality
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.41 2007/04/19 08:37:09 ajacoutot Exp $
--- configure.orig	Sun Jun 11 11:35:47 2006
+++ configure	Thu Jul 19 23:31:17 2007
@@@@ -77,7 +77,7 @@@@ cc_check() {
d13 10
a22 1
@@@@ -839,6 +839,8 @@@@ if x86 || x86_64 ; then
d29 1
a29 1
     eval _$ext=auto && eval _$ext=yes
d31 1
a31 1
@@@@ -2939,7 +2941,7 @@@@ int main(void) { pthread_t tid; return pthread_create 
d40 1
a40 1
@@@@ -2970,7 +2972,7 @@@@ fi
a45 2
   _iconv_tmp='#include <iconv.h>'
 
d47 3
a49 1
@@@@ -4137,6 +4139,8 @@@@ if test "$_aa" = yes ; then
d52 1
a52 1
     _ld_aa=`aalib-config --libs | cut -d " " -f 2,5,6`
d54 1
a54 1
+    _ld_aa="-laa"
d58 19
a76 1
@@@@ -5089,7 +5093,7 @@@@ echores "$_sgiaudio"
d80 2
a81 2
-if linux || bsdos || freebsd || netbsd || sunos || darwin ; then
+if linux || bsdos || freebsd || netbsd || sunos || darwin || openbsd ; then
d85 22
a106 36
@@@@ -6723,7 +6727,7 @@@@ if test "$_tv_bsdbt848" = auto ; then
  if test "$_tv" = yes ; then
     cat > $TMPC <<EOF
 #include <sys/types.h>
-#if defined(__NetBSD__)
+#if defined(__NetBSD__) || defined(__OpenBSD__)
 #include <dev/ic/bt8xx.h>
 #else
 #include <machine/ioctl_bt848.h>
@@@@ -7453,7 +7457,7 @@@@ CACA_LIB = $_ld_caca
 # audio output
 ALSA_LIB = $_ld_alsa
 NAS_LIB = $_ld_nas
-ARTS_LIB = $_ld_arts
+ARTS_LIB = $_ld_arts -lstdc++
 ARTS_INC = $_inc_arts
 ESD_LIB = $_ld_esd
 ESD_INC = $_inc_esd
@@@@ -7764,7 +7768,7 @@@@ $_def_malloc
 $_def_memalign
 #ifndef HAVE_MEMALIGN
 # define memalign(a,b) malloc(b)
-#define MEMALIGN_HACK 1
+/* #undef MEMALIGN_HACK 1 */
 #endif
 
 /* Define this if your system has the "alloca.h" header file */
@@@@ -8042,7 +8046,7 @@@@ $_def_vcd
 #define DEFAULT_DVD_DEVICE	"/dev/rdiskN"
 #elif defined(__OpenBSD__)
 #define DEFAULT_CDROM_DEVICE	"/dev/rcd0a"
-#define DEFAULT_DVD_DEVICE	DEFAULT_CDROM_DEVICE
+#define DEFAULT_DVD_DEVICE	"/dev/rcd0c"
 #elif defined(__FreeBSD__)
 #define DEFAULT_CDROM_DEVICE	"/dev/acd0"
 #define DEFAULT_DVD_DEVICE	DEFAULT_CDROM_DEVICE
@


1.41
log
@- add live555 support
- regen patches while here

from brad
ok robert@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.40 2007/01/22 15:04:04 espie Exp $
--- configure.orig	Sun Jun 11 20:35:47 2006
+++ configure	Thu Apr 19 09:41:27 2007
d21 9
@


1.40
log
@enable xvidcore
tweak default dvd device to match OpenBSD.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.39 2006/08/16 15:17:15 biorn Exp $
d3 10
a12 1
+++ configure	Mon Jan 15 14:07:33 2007
@


1.39
log
@
Bring back CPU extentions on amd64.

"lock ok" sturm@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.38 2006/07/19 21:40:47 robert Exp $
d3 1
a3 1
+++ configure	Sat Aug 12 12:01:53 2006
d67 9
@


1.38
log
@update to versio 1.0pre8; include the speex and mpcdec codecs by default;
this version of mplayer now uses gtk2;

ok biorn@@ and tested by many
@
text
@d1 1
a1 1
$OpenBSD$
d3 11
a13 2
+++ configure	Sat Jul  8 16:12:25 2006
@@@@ -2970,7 +2970,7 @@@@
d22 1
a22 1
@@@@ -4137,6 +4137,8 @@@@
d31 1
a31 1
@@@@ -5089,7 +5091,7 @@@@
d40 1
a40 1
@@@@ -6723,7 +6725,7 @@@@
d49 1
a49 1
@@@@ -7453,7 +7455,7 @@@@
d58 1
a58 1
@@@@ -7764,7 +7766,7 @@@@
@


1.37
log
@enable bktr(4) support, and enhance the bktr(4) support by:
- adding support for setting the channel set
- making it use audio(4) instead of ossaudio(3)
- making it explicitly mute the tuner on exit
- use the tuner as default video source, as opposed to RCA

ok biorn@@, robert@@
@
text
@d1 5
a5 40
$OpenBSD: patch-configure,v 1.36 2005/11/23 00:05:39 biorn Exp $
--- configure.orig	Wed Apr 13 04:46:35 2005
+++ configure	Sun Dec 25 17:31:12 2005
@@@@ -475,6 +475,9 @@@@ if test -z "$_target" ; then
         if [ "`$_cc -dumpmachine | grep x86_64 | cut -d- -f1`" = "x86_64" -a \
              -z "`echo $CFLAGS | grep -- -m32`"  ]; then
           host_arch=x86_64
+        elif [ "`$_cc -dumpmachine | grep amd64 | cut -d- -f1`" = "amd64" -a \
+              -z "`echo $CFLAGS | grep -- -m32`"  ]; then
+          host_arch=x86_64
         else
           host_arch=i386
         fi
@@@@ -484,7 +487,7 @@@@ if test -z "$_target" ; then
       sparc) host_arch=sparc ;;
       sparc64) host_arch=sparc64 ;;
       parisc*|hppa*|9000*) host_arch=hppa ;;
-      arm*) host_arch=arm ;;
+      zaurus|cats) host_arch=arm ;;
       s390) host_arch=s390 ;;
       s390x) host_arch=s390x ;;
       mips) host_arch=mips ;;
@@@@ -710,10 +713,15 @@@@ fi
 
 x86_exts_check()
 {
+  case $host_arch in
+  x86_64) pparam="3dnow 3dnowext mmx mmxext xmm sse2"
+    ;;
+  *)
   pparam=`$_cpuinfo | grep 'features' | cut -d ':' -f 2 | _head 1`
   if test -z "$pparam" ; then
     pparam=`$_cpuinfo | grep 'flags' | cut -d ':' -f 2 | _head 1`
   fi
+  esac
 
   _mmx=no
   _3dnow=no
@@@@ -2195,7 +2203,7 @@@@ fi
 
d13 1
a13 1
@@@@ -3789,6 +3797,8 @@@@ if test "$_aa" = yes ; then
d22 1
a22 1
@@@@ -4730,7 +4740,7 @@@@ echores "$_sgiaudio"
d30 2
a31 14
   echores "ok"
@@@@ -5323,7 +5333,10 @@@@ _inc_faad="-I`pwd`/libfaad2"
 if test "$_faad_internal" = auto ; then
   # the faad check needs a config.h file
   if not test -f "config.h" ; then
-    > config.h
+    cat > config.h << EOF
+/* C99 lrintf function available */
+$_def_lrintf  
+EOF
   fi
   # internal faad: check if our dear gcc is able to compile it...
   cp "`pwd`/libfaad2/cfft.c" $TMPC
@@@@ -6115,7 +6128,7 @@@@ if test "$_tv_bsdbt848" = auto ; then
d40 1
a40 1
@@@@ -6775,7 +6788,7 @@@@ CACA_LIB = $_ld_caca
d49 1
a49 1
@@@@ -7041,7 +7054,7 @@@@ $_def_malloc
d54 1
a54 1
+/* #define MEMALIGN_HACK 1 */
@


1.36
log
@Fix breakage in internal faad2 detection. Noted by jolan@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.35 2005/05/27 04:33:06 pvalchev Exp $
--- configure.orig	Wed Apr 13 13:46:35 2005
+++ configure	Wed Nov 23 00:41:37 2005
d78 9
@


1.35
log
@recognise zaurus/cats (not the most elegant way but least intrusive now)
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.34 2005/05/13 16:14:00 biorn Exp $
--- configure.orig	Wed Apr 13 05:46:35 2005
+++ configure	Sun May  8 13:21:59 2005
d66 13
a78 1
@@@@ -6775,7 +6785,7 @@@@ CACA_LIB = $_ld_caca
d87 1
a87 1
@@@@ -7041,7 +7051,7 @@@@ $_def_malloc
@


1.34
log
@unbreak aa FLAVOR. Found and tested by Matthias Kilian
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.33 2005/05/09 12:24:38 biorn Exp $
--- configure.orig	Wed Apr 13 13:46:35 2005
+++ configure	Thu May 12 08:57:20 2005
d14 9
@


1.33
log
@Update to 1.0pre7
Don't depend on ogg/vorbis as it's built in now
Put fontconfig and freetype in WANTLIB and BUILD_DEPEND on pkgconfig if
 FLAVOR is not no_x11.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.32 2005/04/09 22:06:19 pvalchev Exp $
d3 1
a3 1
+++ configure	Wed Apr 20 06:35:54 2005
d39 10
a48 1
@@@@ -4730,7 +4738,7 @@@@ echores "$_sgiaudio"
d57 1
a57 1
@@@@ -6775,7 +6783,7 @@@@ CACA_LIB = $_ld_caca
d66 1
a66 1
@@@@ -7041,7 +7049,7 @@@@ $_def_malloc
@


1.32
log
@change x86_64->amd64 now; from biorn
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.31 2005/04/01 06:28:58 biorn Exp $
--- configure.orig	Thu Dec 23 08:36:00 2004
+++ configure	Sat Apr  9 01:51:28 2005
@@@@ -465,6 +465,9 @@@@ if test -z "$_target" ; then
d14 1
a14 1
@@@@ -700,10 +703,15 @@@@ fi
d30 1
a30 1
@@@@ -2180,7 +2188,7 @@@@ echores "$_setlocale"
d39 1
a39 1
@@@@ -4659,7 +4667,7 @@@@ echores "$_sgiaudio"
d48 1
a48 1
@@@@ -6607,7 +6615,7 @@@@ CACA_LIB = $_ld_caca
d57 1
a57 1
@@@@ -6877,7 +6885,7 @@@@ $_def_malloc
@


1.31
log
@
- Make amd64 use MMX and friends. Tested by niallo and naddy.
- Avoid picking up libdv and libsmb

Looks fine, naddy@@
@
text
@d1 14
a14 4
$OpenBSD: patch-configure,v 1.30 2005/03/09 16:07:29 biorn Exp $
--- configure.orig	Thu Dec 23 16:36:00 2004
+++ configure	Wed Mar  9 20:19:18 2005
@@@@ -700,10 +700,15 @@@@ fi
d30 1
a30 1
@@@@ -2180,7 +2185,7 @@@@ echores "$_setlocale"
d39 1
a39 1
@@@@ -4659,7 +4664,7 @@@@ echores "$_sgiaudio"
d48 1
a48 1
@@@@ -6607,7 +6612,7 @@@@ CACA_LIB = $_ld_caca
d57 1
a57 1
@@@@ -6877,7 +6882,7 @@@@ $_def_malloc
@


1.30
log
@
Finally take it to 1.0pre6a

Prodded by espi@@, ok sturm@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.29 2004/12/22 22:22:20 biorn Exp $
d3 18
a20 2
+++ configure	Fri Dec 31 01:09:24 2004
@@@@ -2180,7 +2180,7 @@@@ echores "$_setlocale"
d29 1
a29 1
@@@@ -4659,7 +4659,7 @@@@ echores "$_sgiaudio"
d38 1
a38 1
@@@@ -6607,7 +6607,7 @@@@ CACA_LIB = $_ld_caca
d47 1
a47 1
@@@@ -6877,7 +6877,7 @@@@ $_def_malloc
@


1.29
log
@Security: Upgrade to 1.0pre5try2 (see http://www.mplayerhq.hu/)

Also unbreak arts FLAVOR (from Stephan Tesch) and fix up DESCR
(from Michael Knudsen and joshua stein).

ok sturm@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.28 2004/10/18 06:48:20 biorn Exp $
--- configure.orig	Thu Jul 15 00:04:42 2004
+++ configure	Wed Dec 15 19:52:03 2004
@@@@ -2001,7 +2001,7 @@@@ echores "$_setlocale"
d13 1
a13 1
@@@@ -4329,7 +4329,7 @@@@ echores "$_sgiaudio"
d17 2
a18 2
-if linux || bsdos || freebsd || netbsd || sunos ; then
+if linux || bsdos || freebsd || netbsd || openbsd || sunos ; then
d22 1
a22 1
@@@@ -6171,7 +6171,7 @@@@ CACA_LIB = $_ld_caca
d31 9
@


1.28
log
@update to 1.0pre5
ok pvalchev@@
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.27 2004/06/22 08:13:11 brad Exp $
--- configure.orig	Thu Jul 15 09:50:13 2004
+++ configure	Thu Jul 15 09:51:27 2004
d22 9
@


1.27
log
@- disable the Vidix support
- instead of passing --target for powerpc just make the configure
script recognize macppc as another name for a powerpc system

ok MAINTAINER
@
text
@d1 13
a13 13
$OpenBSD: patch-configure,v 1.26 2004/05/06 07:27:49 biorn Exp $
--- configure.orig	2004-04-26 05:44:06.000000000 -0400
+++ configure	2004-05-28 22:12:05.000000000 -0400
@@@@ -440,7 +440,7 @@@@ if test -z "$_target" ; then
       i[3-9]86*|x86|x86pc|k5|k6|k6_2|k6_3|k6-2|k6-3|pentium*|athlon*|i586_i686|i586-i686) host_arch=i386 ;;
       ia64) host_arch=ia64 ;;
       x86_64|amd64) host_arch=x86_64 ;;
-      ppc) host_arch=ppc ;;
+      macppc|ppc) host_arch=ppc ;;
       alpha) host_arch=alpha ;;
       sparc*) host_arch=sparc ;;
       parisc*|hppa*|9000*) host_arch=hppa ;;
@@@@ -4148,7 +4148,7 @@@@ echores "$_sgiaudio"
a21 19
@@@@ -4991,7 +4991,7 @@@@ fi
 
 
 echocheck "iconv"
-if test "$_iconv" = auto ; then
+if test "$_iconv" != no ; then
   _iconv_tmp='#include <iconv.h>'
 
   cat > $TMPC << EOF
@@@@ -6459,6 +6459,9 @@@@ $_def_vcd
 #elif defined(SYS_DARWIN)
 #define DEFAULT_CDROM_DEVICE    "/dev/rdiskN"
 #define DEFAULT_DVD_DEVICE	DEFAULT_CDROM_DEVICE
+#elif defined(__OpenBSD__)
+#define DEFAULT_CDROM_DEVICE	"/dev/rcd0a"
+#define DEFAULT_DVD_DEVICE	DEFAULT_CDROM_DEVICE
 #else
 #define DEFAULT_CDROM_DEVICE    "/dev/cdrom"
 #define DEFAULT_DVD_DEVICE	"/dev/dvd"
@


1.26
log
@Take it to 1.0pre4

ok brad@@
@
text
@d1 12
a12 3
$OpenBSD: patch-configure,v 1.25 2004/03/04 12:57:45 avsm Exp $
--- configure.orig	2004-04-26 11:44:06.000000000 +0200
+++ configure	2004-04-28 12:24:12.000000000 +0200
@


1.25
log
@support amd64, ok and tweaks maintainer, pvalchev@@
@
text
@d1 4
a4 13
$OpenBSD: patch-configure,v 1.24 2003/12/16 17:17:33 biorn Exp $
--- configure.orig	2003-12-08 21:33:31.000000000 +0000
+++ configure	2004-03-04 12:53:03.000000000 +0000
@@@@ -431,7 +431,7 @@@@ if test -z "$_target" ; then
       case "`( uname -m ) 2>&1`" in
       i[3-9]86*|x86|x86pc|k5|k6|k6_2|k6_3|k6-2|k6-3|pentium*|athlon*|i586_i686|i586-i686) host_arch=i386 ;;
       ia64) host_arch=ia64 ;;
-      x86_64) host_arch=x86_64 ;;
+      x86_64|amd64) host_arch=x86_64 ;;
       ppc) host_arch=ppc ;;
       alpha) host_arch=alpha ;;
       sparc*) host_arch=sparc ;;
@@@@ -4020,7 +4020,7 @@@@ echores "$_sgiaudio"
d13 1
a13 1
@@@@ -4826,7 +4826,7 @@@@ fi
d22 1
a22 1
@@@@ -6298,6 +6298,9 @@@@ $_def_vcd
@


1.24
log
@Update to 1.0pre3
Ok espie@@ pvalchev@@
@
text
@d1 12
a12 3
$OpenBSD: patch-configure,v 1.23 2003/11/02 23:30:27 brad Exp $
--- configure.orig	2003-12-08 22:33:31.000000000 +0100
+++ configure	2003-12-09 01:07:04.000000000 +0100
@


1.23
log
@upgrade to mplayer 1.0pre2

based on diff from MAINTAINER
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.22 2003/09/25 20:59:01 sturm Exp $
--- configure.orig	2003-10-05 11:34:40.000000000 -0400
+++ configure	2003-10-28 18:00:19.000000000 -0500
@@@@ -3903,7 +3903,7 @@@@ echores "$_sgiaudio"
d13 1
a13 10
@@@@ -4442,7 +4442,7 @@@@ int main(void) {
   return 0;
 }
 EOF
-  if cc_check $_inc_faad $_ld_faad -lm && "$TMPO" >> "$TMPLOG" ; then
+  if ($_cc $_inc_faad $_ld_faad -lm -o "$TMPO" "$TMPC") && "$TMPO" >> "$TMPLOG" ; then
     _faad_version=`"$TMPO"`
     _faad_tempversion=`"$TMPO" | sed -e 's/^\([0-9]\{1,\}\)\.\([0-9]\{1,\}\).*/\1\2/'`
     _def_faad_version="#define FAADVERSION $_faad_tempversion"
@@@@ -4691,7 +4691,7 @@@@ fi
d22 1
a22 1
@@@@ -6123,6 +6123,9 @@@@ $_def_vcd
@


1.22
log
@SECURITY UPDATE to 0.92

fixes a remotely exploitable buffer overflow in ASX headers that could
be used to make mplayer run arbitrary code

from maintainer Bjoern Sandell
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.21 2003/04/21 15:29:16 brad Exp $
--- configure.orig	2003-08-09 16:12:30.000000000 +0200
+++ configure	2003-08-24 10:47:19.000000000 +0200
@@@@ -3524,7 +3524,7 @@@@ echores "$_sgiaudio"
d13 10
a22 1
@@@@ -4173,7 +4173,7 @@@@ fi
d31 1
a31 1
@@@@ -5406,6 +5406,9 @@@@ $_def_vcd
@


1.21
log
@use a reasonable default CD/DVD-ROM device name of /dev/rcd0a instead
of Linux's /dev/cdrom.
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.19 2003/02/16 07:25:18 brad Exp $
--- configure.orig	Sat Mar 22 11:29:16 2003
+++ configure	Mon Apr 14 20:13:45 2003
@@@@ -3518,7 +3518,7 @@@@ echores "$_sgiaudio"
d13 1
a13 1
@@@@ -4168,7 +4168,7 @@@@ fi
d22 1
a22 2
@@@@ -5400,6 +5400,9 @@@@ $_def_vcd
 #define DEFAULT_DVD_DEVICE	"D:"
d25 1
a25 1
+#define DEFAULT_DVD_DEVICE	DEFAULT_CDROM_DEVICE
d28 1
a28 1
 #define DEFAULT_DVD_DEVICE	DEFAULT_CDROM_DEVICE
d31 1
@


1.20
log
@update to 0.90; from maintainer Bjorn Sandell <biorn@@dce.chalmers.se>

No big changes; iconv flavor is gone, remove sparc64 from supported
architectures
@
text
@d2 2
a3 2
--- configure.orig	Sat Mar 22 17:29:16 2003
+++ configure	Mon Apr  7 09:29:04 2003
d22 10
@


1.19
log
@upgrade to mplayer 0.90rc4

based on diff from MAINTAINER for 0.90rc3
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.18 2003/01/03 23:06:36 brad Exp $
--- configure.orig	Sat Feb  8 17:29:05 2003
+++ configure	Thu Feb 13 16:58:25 2003
@@@@ -3414,7 +3414,7 @@@@ echores "$_sgiaudio"
d13 1
a13 1
@@@@ -4019,7 +4019,7 @@@@ fi
@


1.18
log
@upgrade to mplayer 0.90rc2
- with PLIST changes from me
--
From: MAINTAINER
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.17 2002/12/22 14:19:47 espie Exp $
--- configure.orig	Mon Dec 23 01:33:05 2002
+++ configure	Wed Dec 25 21:55:52 2002
@@@@ -3296,7 +3296,7 @@@@ echores "$_sgiaudio"
d13 1
a13 1
@@@@ -3858,7 +3858,7 @@@@ fi
@


1.17
log
@Update to 0.90rc1.
From maintainer, Bjorn.

PP fix from niklas@@
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.16 2002/11/13 17:54:35 espie Exp $
--- configure.orig	Sat Dec  7 00:54:02 2002
+++ configure	Sun Dec  8 21:08:07 2002
@@@@ -3278,7 +3278,7 @@@@ echores "$_sgiaudio"
d13 1
a13 1
@@@@ -3840,7 +3840,7 @@@@ fi
@


1.16
log
@update to mplayer 0.90pre10, from maintainer.
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.15 2002/10/28 17:56:08 espie Exp $
--- configure.orig	Sat Nov  9 18:44:28 2002
+++ configure	Tue Nov 12 06:02:39 2002
@@@@ -3190,7 +3190,7 @@@@ echores "$_sgiaudio"
d13 1
a13 1
@@@@ -3740,7 +3740,7 @@@@ fi
@


1.15
log
@0.90pre9, update from Bjorn Sandell, and fix mplayer-fontmaker shadows.
@
text
@d1 4
a4 16
$OpenBSD: patch-configure,v 1.14 2002/10/14 09:50:48 pvalchev Exp $
--- configure.orig	Thu Oct 24 20:12:40 2002
+++ configure	Fri Oct 25 00:19:00 2002
@@@@ -1842,6 +1842,11 @@@@ if test "$_soundcard" = yes ; then
 else
   _def_soundcard='#undef HAVE_SOUNDCARD_H'
 fi
+if test openbsd && test "$_ossaudio" = no ; then
+  _def_soundcard='#undef HAVE_SOUNDCARD_H'
+  _inc_soundcard=''
+  _soundcard='no'
+fi
 echores "$_soundcard"
 else
   _def_soundcard='#undef HAVE_SOUNDCARD_H'
@@@@ -3128,7 +3133,7 @@@@ echores "$_sgiaudio"
d13 1
a13 1
@@@@ -3680,7 +3685,7 @@@@ fi
@


1.14
log
@Update to mplayer-0.90pre8; from biorn@@dce.chalmers.se
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.13 2002/08/18 13:17:50 espie Exp $
--- configure.orig	Tue Sep 17 21:47:55 2002
+++ configure	Thu Sep 19 17:14:38 2002
@@@@ -1828,6 +1828,11 @@@@ if test "$_soundcard" = yes ; then
d16 1
a16 1
@@@@ -3093,7 +3098,7 @@@@ echores "$_sgiaudio"
d25 1
a25 1
@@@@ -3623,7 +3628,7 @@@@ fi
@


1.13
log
@cdparanoia support, actually needs correct cddb support for OpenBSD...
(seems it's not quite used yet, as it insists on going thru a cache)
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.12 2002/08/18 11:26:48 espie Exp $
--- configure.orig	Mon Aug  5 19:23:22 2002
+++ configure	Sun Aug 18 14:54:42 2002
@@@@ -1728,6 +1728,11 @@@@ if test "$_soundcard" = yes ; then
d16 1
a16 1
@@@@ -2955,7 +2960,7 @@@@ echores "$_sgiaudio"
d25 9
a33 17
@@@@ -2968,7 +2973,7 @@@@ fi
 echocheck "DVD support (libmpdvdkit)"
 if test "$_dvdkit" = auto ; then
  _dvdkit=no
- if linux || freebsd || netbsd || darwin || cygwin; then
+ if linux || freebsd || netbsd || openbsd || darwin || cygwin; then
   test -f "./libmpdvdkit/Makefile" && _dvdkit=yes
  fi
 fi
@@@@ -3109,6 +3114,7 @@@@ if test "$_cdparanoia" = yes ; then
     _def_cdparanoia='#define HAVE_CDDA'
     _inputmodules="cdda $_inputmodules"
     _ld_cdparanoia="$_ld_cdparanoia -lcdda_interface -lcdda_paranoia"
+    openbsd && _ld_cdparanoia="$_ld_cdparanoia -lutil"
 else
     _def_cdparanoia='#undef HAVE_CDDA'
     _noinputmodules="cdda $_noinputmodules"
@


1.12
log
@Update to 0.90pre6, mostly from maintainer.
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.11 2002/06/27 22:03:49 espie Exp $
--- configure.orig	Tue Aug  6 22:13:17 2002
+++ configure	Tue Aug  6 22:23:29 2002
d34 8
@


1.11
log
@Update to 0.90pre5
Most work by Biorn, some testing by pval and me.
@
text
@d1 6
a6 4
$OpenBSD: patch-configure,v 1.10 2002/06/04 11:35:09 espie Exp $
--- configure.orig	Sat Jun  8 00:41:25 2002
+++ configure	Mon Jun 17 20:17:52 2002
@@@@ -1611,7 +1611,7 @@@@ else
d8 9
a16 16
 echores "$_sys_soundcard"
 
-if test "$_sys_soundcard" != yes ; then
+if test "$_sys_soundcard" != yes -a "$_ossaudio" != no; then
 echocheck "soundcard.h"
 cat > $TMPC << EOF
 #include <soundcard.h>
@@@@ -2720,6 +2720,7 @@@@ if test "$_ossaudio" = yes ; then
   else
      if netbsd || openbsd ; then
        _def_ossaudio_devdsp='#define PATH_DEV_DSP "/dev/sound"'
+       _ld_arch="$_ld_arch -lossaudio"
      else
        _def_ossaudio_devdsp='#define PATH_DEV_DSP "/dev/dsp"'
      fi
@@@@ -2875,7 +2876,7 @@@@ echores "$_sgiaudio"
d25 1
a25 1
@@@@ -2888,7 +2889,7 @@@@ fi
d29 2
a30 2
- if linux || freebsd || netbsd ; then
+ if linux || freebsd || netbsd || openbsd; then
a33 40
@@@@ -3258,7 +3259,7 @@@@ EOF
   _iconv=no
   if freebsd ; then
     cc_check  -lm -lgiconv && _iconv=yes
-  elif bsdos ; then
+  elif bsdos || openbsd; then
     cc_check  -lm -liconv && _iconv=yes
   else
     cc_check -lm && _iconv=yes
@@@@ -3268,6 +3269,7 @@@@ if test "$_iconv" = yes ; then
   _def_iconv='#define USE_ICONV 1'
   freebsd && _ld_iconv='-lgiconv'
   bsdos && _ld_iconv='-liconv'
+  openbsd && _ld_iconv='-liconv'
 else
   _def_iconv='#undef USE_ICONV'
 fi
@@@@ -3778,7 +3780,6 @@@@ test "$_xanim" = yes && _ld_dl_dynamic='
 _ld_arch="$_ld_arch $_ld_pthread $_ld_dl $_ld_dl_dynamic"
 bsdos && _ld_arch="$_ld_arch -ldvd"
 if netbsd || openbsd ; then
-  _ld_arch="$_ld_arch -lossaudio"
   x86 && _ld_arch="$_ld_arch -li386"
 fi
 
@@@@ -3847,10 +3848,10 @@@@ cat > config.mak << EOF
 
 LANG = C
 TARGET_OS = $system_name
-prefix = $_prefix
-DATADIR = $_datadir
-CONFDIR = $_confdir
-LIBDIR = $_libdir
+prefix = \$(DESTDIR)$_prefix
+DATADIR = \$(DESTDIR)$_datadir
+CONFDIR = \$(DESTDIR)$_confdir
+LIBDIR = \$(DESTDIR)$_libdir
 #AR = ar
 CC = $_cc
 AWK = $_awk
@


1.10
log
@revert. not yet.
@
text
@d1 4
a4 4
$OpenBSD: patch-configure,v 1.8 2002/05/16 13:57:49 espie Exp $
--- configure.orig	Mon May 13 22:52:10 2002
+++ configure	Thu May 16 15:49:14 2002
@@@@ -1538,7 +1538,7 @@@@ else
d13 1
a13 1
@@@@ -2591,6 +2591,7 @@@@ if test "$_ossaudio" = yes ; then
d21 1
a21 1
@@@@ -2720,7 +2721,7 @@@@ echores "$_sgiaudio"
d30 10
a39 1
@@@@ -3103,7 +3104,7 @@@@ EOF
d48 1
a48 1
@@@@ -3113,6 +3114,7 @@@@ if test "$_iconv" = yes ; then
d56 1
a56 1
@@@@ -3614,7 +3616,6 @@@@ test "$_xanim" = yes && _ld_dl_dynamic='
d64 1
a64 1
@@@@ -3683,10 +3684,10 @@@@ cat > config.mak << EOF
@


1.9
log
@blech, close file descriptors.
@
text
@d3 1
a3 1
+++ configure	Sat May 18 23:16:51 2002
a29 9
@@@@ -2733,7 +2734,7 @@@@ fi
 echocheck "DVD support (libmpdvdkit)"
 if test "$_dvdkit" = auto ; then
  _dvdkit=no
- if linux || freebsd || netbsd ; then
+ if linux || freebsd || netbsd || openbsd; then
   test -f "./libmpdvdkit/Makefile" && _dvdkit=yes
  fi
 fi
@


1.8
log
@Add libiconv flavor for subtitles
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.7 2002/05/16 11:58:48 espie Exp $
d3 1
a3 1
+++ configure	Thu May 16 15:49:14 2002
d30 9
@


1.7
log
@minimal patches to compile vcd support in. Doesn't work yet.
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.6 2002/05/15 22:27:01 pvalchev Exp $
d3 1
a3 1
+++ configure	Thu May 16 00:42:02 2002
d30 18
a47 1
@@@@ -3614,7 +3615,6 @@@@ test "$_xanim" = yes && _ld_dl_dynamic='
d55 1
a55 1
@@@@ -3683,10 +3683,10 @@@@ cat > config.mak << EOF
@


1.6
log
@MPlayer-0.90pre4; from Bjrn Sandell <biorn@@dce.chalmers.se>
@
text
@d1 1
a1 1
$OpenBSD$
d3 1
a3 1
+++ configure	Wed May 15 00:26:49 2002
d21 9
@


1.5
log
@-li386 needed on x86 for win32 flavor; from biorn@@dce.chalmers.se
@
text
@d1 4
a4 15
$OpenBSD: patch-configure,v 1.4 2002/05/12 18:50:46 niklas Exp $
--- configure.orig	Sat May  4 00:13:06 2002
+++ configure	Mon May 13 19:44:26 2002
@@@@ -1390,8 +1390,8 @@@@ if test "$_malloc" = yes ; then
 else
   _def_malloc='#undef HAVE_MALLOC_H'
 fi
-# malloc.h emits a warning in FreeBSD
-freebsd && _def_malloc='#undef HAVE_MALLOC_H'
+# malloc.h emits a warning in FreeBSD and OpenBSD
+freebsd || openbsd && _def_malloc='#undef HAVE_MALLOC_H'
 echores "$_malloc"
 
 
@@@@ -1522,7 +1522,7 @@@@ else
d13 1
a13 1
@@@@ -2500,6 +2500,7 @@@@ if test "$_ossaudio" = yes ; then
d21 1
a21 2
@@@@ -3522,8 +3523,10 @@@@ test "$_xanim" = yes && _ld_dl_dynamic='
 
d24 4
a27 6
-netbsd && _ld_arch="$_ld_arch -li386 -lossaudio"
-openbsd && _ld_arch="$_ld_arch -li386 -lossaudio"
+
+if netbsd || openbsd ; then
+  x86  && _ld_arch="$_ld_arch -li386"
+fi
d29 1
a29 3
 _def_debug='#undef MP_DEBUG'
 test "$_debug" && _def_debug='#define MP_DEBUG 1'
@@@@ -3590,11 +3593,10 @@@@ cat > config.mak << EOF
a36 1
-AR = ar
d41 1
a43 1
 # OPTFLAGS = -O4 $_profile $_debug $_march $_mcpu -pipe -fomit-frame-pointer -ffast-math
@


1.4
log
@shut off oss completely; ok pval@@
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.3 2002/05/12 08:25:57 pvalchev Exp $
d3 1
a3 1
+++ configure	Sun May 12 20:08:33 2002
d24 9
a32 1
@@@@ -3522,8 +3522,11 @@@@ test "$_xanim" = yes && _ld_dl_dynamic='
d39 1
a39 2
+if netbsd ; then
+  _ld_arch="$_ld_arch -lossaudio"
d45 1
a45 1
@@@@ -3590,11 +3593,11 @@@@ cat > config.mak << EOF
a53 1
+TARGET_ARCH = $host_arch
@


1.3
log
@- Drop OSS flavor as there is enough better choices.
- Fix bogus configure check which would link mplayed with -lossaudio
  unconditionally on i386.
@
text
@d1 3
a3 3
$OpenBSD: patch-configure,v 1.2 2002/05/12 08:16:24 pvalchev Exp $
--- configure.orig	Fri May  3 16:13:06 2002
+++ configure	Sun May 12 02:22:52 2002
d15 9
@


1.2
log
@First cut at macppc support.  (Some things may not work yet)
@
text
@d1 1
a1 1
$OpenBSD: patch-configure,v 1.1.1.1 2002/05/09 05:19:10 pvalchev Exp $
d3 1
a3 1
+++ configure	Sun May 12 01:38:59 2002
d22 1
a22 1
+if netbsd || openbsd  ; then
@


1.1
log
@Initial revision
@
text
@d1 3
a3 3
$OpenBSD$
--- configure.orig	Sat May  4 00:13:06 2002
+++ configure	Wed May  8 01:19:24 2002
d29 1
a29 1
@@@@ -3590,11 +3593,10 @@@@ cat > config.mak << EOF
d38 1
@


1.1.1.1
log
@Import of mplayer-0.90pre3 - Movie Player

MPlayer is a movie player for LINUX (runs on many other Unices, and
non-x86 CPUs, see the documentation). It plays most MPEG, VOB, AVI,
VIVO, ASF/WMV, QT/MOV, FLI, NuppelVideo, yuv4mpeg, FILM, RoQ, and some
RealMedia files, supported by many native, XAnim, and Win32 DLL codecs.
You can watch VideoCD, SVCD, DVD, 3ivx, FLI, and even DivX movies too
(and you don't need the avifile library at all!).

Submitted by Bjrn Sandell <biorn@@dce.chalmers.se>, work also done by me

Withstanding issues: see how to deal with optimization detection at build
time so that binary packages can be created; check make it work on
platforms other than i386, etc. things can be done in-tree.
@
text
@@
