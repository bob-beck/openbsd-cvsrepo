head	1.3;
access;
symbols
	OPENBSD_5_5:1.2.0.6
	OPENBSD_5_5_BASE:1.2
	OPENBSD_5_4:1.2.0.2
	OPENBSD_5_4_BASE:1.2
	OPENBSD_5_3:1.1.1.7.0.28
	OPENBSD_5_3_BASE:1.1.1.7
	OPENBSD_5_2:1.1.1.7.0.26
	OPENBSD_5_2_BASE:1.1.1.7
	OPENBSD_5_1_BASE:1.1.1.7
	OPENBSD_5_1:1.1.1.7.0.24
	OPENBSD_5_0:1.1.1.7.0.22
	OPENBSD_5_0_BASE:1.1.1.7
	OPENBSD_4_9:1.1.1.7.0.20
	OPENBSD_4_9_BASE:1.1.1.7
	OPENBSD_4_8:1.1.1.7.0.18
	OPENBSD_4_8_BASE:1.1.1.7
	OPENBSD_4_7:1.1.1.7.0.14
	OPENBSD_4_7_BASE:1.1.1.7
	OPENBSD_4_6:1.1.1.7.0.16
	OPENBSD_4_6_BASE:1.1.1.7
	OPENBSD_4_5:1.1.1.7.0.12
	OPENBSD_4_5_BASE:1.1.1.7
	OPENBSD_4_4:1.1.1.7.0.10
	OPENBSD_4_4_BASE:1.1.1.7
	OPENBSD_4_3:1.1.1.7.0.8
	OPENBSD_4_3_BASE:1.1.1.7
	OPENBSD_4_2:1.1.1.7.0.6
	OPENBSD_4_2_BASE:1.1.1.7
	OPENBSD_4_1:1.1.1.7.0.4
	OPENBSD_4_1_BASE:1.1.1.7
	OPENBSD_4_0:1.1.1.7.0.2
	OPENBSD_4_0_BASE:1.1.1.7
	HEIMDAL_0_7_2:1.1.1.7
	OPENBSD_3_9:1.1.1.6.0.6
	OPENBSD_3_9_BASE:1.1.1.6
	OPENBSD_3_8:1.1.1.6.0.4
	OPENBSD_3_8_BASE:1.1.1.6
	OPENBSD_3_7:1.1.1.6.0.2
	OPENBSD_3_7_BASE:1.1.1.6
	HEIMDAL_0_6_3:1.1.1.6
	OPENBSD_3_6:1.1.1.5.0.6
	OPENBSD_3_6_BASE:1.1.1.5
	OPENBSD_3_5:1.1.1.5.0.4
	OPENBSD_3_5_BASE:1.1.1.5
	OPENBSD_3_4:1.1.1.5.0.2
	OPENBSD_3_4_BASE:1.1.1.5
	HEIMDAL_0_6:1.1.1.5
	HEIMDAL_0_6RC1:1.1.1.4
	OPENBSD_3_3:1.1.1.3.0.6
	OPENBSD_3_3_BASE:1.1.1.3
	OPENBSD_3_2:1.1.1.3.0.4
	OPENBSD_3_2_BASE:1.1.1.3
	OPENBSD_3_1:1.1.1.3.0.2
	OPENBSD_3_1_BASE:1.1.1.3
	HEIMDAL_0_4e:1.1.1.3
	OPENBSD_3_0:1.1.1.2.0.2
	OPENBSD_3_0_BASE:1.1.1.2
	HEIMDAL_0_3f:1.1.1.2
	HEIMDAL_0_3e:1.1.1.1
	KTH:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2014.04.22.10.01.16;	author reyk;	state dead;
branches;
next	1.2;

1.2
date	2013.06.17.18.57.39;	author robert;	state Exp;
branches;
next	1.1;

1.1
date	2001.05.25.07.44.19;	author hin;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.05.25.07.44.19;	author hin;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2001.06.22.21.09.58;	author hin;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2002.02.06.08.51.38;	author hin;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2003.05.11.02.14.11;	author hin;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2003.05.13.02.58.11;	author hin;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2004.10.29.15.55.17;	author biorn;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2006.04.14.07.31.11;	author biorn;	state Exp;
branches;
next	;


desc
@@


1.3
log
@The complexity and quality of kerberosV and the fact that almost
nobody is using it doesn't justify to have it in base - disable and
remove it.  If the 2 two people who use it still want it, they can
make a port or recompile OpenBSD on their own.

There is a quote in theo.c from August 2010: "basically, dung beetles
fucking.  that's what kerberosV + openssl is like".

Discussed with many.  Tests by henning@@ reyk@@ and others.
ok deraadt@@ henning@@
@
text
@
We stop writing change logs, see the source code version control systems history log instead
	
2008-07-28  Love Hornquist Astrand  <lha@@h5l.org>

	* lib/krb5/v4_glue.c: The "kaserver" part of Heimdal occasionally
	issues invalid AFS tokens
	(here "occasionally" means for certain users in certain realms).
	
	In lib/krb5/v4_glue.c, in the routine storage_to_etext the ticket
	is padded to a multiple of 8 bytes. If it is already a multiple of
	8 bytes, 8 additional 0-bytes are added.
	
	This catches the AFS krb4 ticket decoder by surprise: unless the
	ticket is exactly 56 bytes, it only supports the minimum necessary
	padding.  It detects the superfluous padding by comparing the
	ticket length decoded to the advertised ticket length.
	
	Hence a 7-letter userid in "cern.ch" which resulted in a ticket of
	40 bytes, got "padded" to 48 bytes which the rxkad decoder
	rejected.
	
	From Rainer Toebbicke.

2008-07-25  Love Hörnquist Åstrand  <lha@@h5l.org>

	* kuser/kinit.c: add --ok-as-delegate and --windows flags

	* kpasswd/kpasswd-generator.c: Switch to krb5_set_password.

	* kuser/kinit.c: Use krb5_cc_set_config.

	* lib/krb5/cache.c: Add krb5_cc_[gs]et_config.

2008-07-22  Love Hörnquist Åstrand  <lha@@h5l.org>

	* lib/krb5/crypto.c: Allow numbers to be enctypes to as long as
	they are valid.

2008-07-17  Love Hörnquist Åstrand  <lha@@h5l.org>

	* lib/hdb/version-script.map: some random bits needed for libkadm

2008-07-15  Love Hörnquist Åstrand  <lha@@h5l.org>

	* lib/krb5/send_to_kdc_plugin.h: add name for send_to_kdc plugin.
	
	* lib/krb5/krbhst.c: handle KRB5_PLUGIN_NO_HANDLE for lookup
	plugin.

	* lib/krb5/send_to_kdc.c: Add support for the send_to_kdc plugin
	interface.

	* lib/krb5/Makefile.am: add send_to_kdc_plugin.h
	
	* lib/krb5/krb5_err.et: add plugin error codes

2008-07-14  Love Hornquist Astrand  <lha@@kth.se>

	* lib/hdb/Makefile.am: EXTRA_DIST += version-script.map

2008-07-14  Love Hornquist Astrand  <lha@@kth.se>

	* lib/krb5/krb5_{address,ccache}.3: spelling, from openbsd via janne
	johansson

2008-07-13  Love Hörnquist Åstrand  <lha@@kth.se>

	* lib/krb5/version-script.map: add krb5_free_error_message

2008-06-21  Love Hörnquist Åstrand  <lha@@kth.se>

	* lib/krb5/init_creds_pw.c: switch to krb5_set_password().

2008-06-18  Love Hörnquist Åstrand  <lha@@kth.se>

	* lib/krb5/time.c (krb5_set_real_time): handle negative usec

2008-05-31  Love Hörnquist Åstrand  <lha@@kth.se>

	* lib/krb5/krb5_locl.h: Add <wind.h>

	* lib/krb5/crypto.c: Use wind_utf8ucs2_length to convert the password to utf16.

2008-05-30  Love Hörnquist Åstrand  <lha@@kth.se>

	* lib/krb5/kcm.c: Add back krb5_kcmcache argument to try_door().

2008-05-27  Love Hörnquist Åstrand  <lha@@kth.se>

	* lib/krb5/error_string.c (krb5_free_error_message): constify
	
	* lib/krb5/error_string.c: Add krb5_get_error_message().

	* lib/krb5/doxygen.c: krb5_cc_new_unique() is name of the creation
	function.
	
2008-04-30  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/hdb/hdb-ldap.c: Use the _ext api for OpenLDAP, from Honza
	Machacek (gentoo).

2008-04-28  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/crypto.c: Use DES_set_key_unchecked().

	* lib/krb5/krb5.conf.5: Document default_cc_type.

	* lib/krb5/cache.c: Pick up [libdefaults]default_cc_type

2008-04-27  Love Hörnquist Åstrand  <lha@@it.su.se>
	
	* kdc/kaserver.c: Use DES_set_key_unchecked().

2008-04-21  Love Hörnquist Åstrand  <lha@@it.su.se>

	* doc/hx509.texi: About the pkcs11 module.

	* doc/hx509.texi: Pick up version from vars.texi

	* doc/hx509.texi: No MIT code in hx509.

	* hx509 now includes a pkcs11 implementation.

2008-04-20  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/hdb/Makefile.am: Move OpenLDAP includes to AM_CPPFLAGS to
	avoid dropping other defines for the library.

2008-04-17  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5: add __declspec() for windows.

	* configure.in: Update rk_WIN32_EXPORT, add gssapi to
	rk_WIN32_EXPORT.
	
	* configure.in: Lets try dependency tracking for automake 1.10 and
	later.
	
	* configure.in: Use at least libtool-2.2.

	* configure.in: Use LT_INIT the right way.

	* lib/krb5/Makefile.am: Update make-proto usage.

	* configure.in: Run autoupdate, use LT_INIT().

2008-04-15  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/test_forward.c: Don't print krb5_error_code since we
	are using krb5_err().

	* lib/krb5/ticket.c: Cast krb5_error_code to int to avoid warning.

	* lib/krb5/scache.c: Cast krb5_error_code to int to avoid warning.

	* lib/krb5/principal.c: Cast enum to int to avoid warning.

	* lib/krb5/pkinit.c: Cast krb5_error_code to int to avoid warning.

	* lib/krb5/pac.c: Cast size_t to unsigned long to avoid warning.

	* lib/krb5/error_string.c: Cast krb5_error_code to int to avoid
	warning.

	* lib/krb5/keytab_keyfile.c: Make num_entries an uint32 to avoid
	negative numbers and type warnings.

	* lib/krb5: cc_get_version returns an int, update.

2008-04-10  Love Hörnquist Åstrand  <lha@@it.su.se>

	* configure.in: Check for <asl.h>.

2008-04-09  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/version-script.map: sort and export _krb5_pk_kdf

	* lib/krb5/crypto.c: Check kdf params. calculate the second half
	of the key.

	* lib/krb5/Makefile.am: Add test_pknistkdf

	* lib/krb5/test_pknistkdf.c: Test the new pkinit nist kdf.

	* lib/krb5/crypto.c: Complete _krb5_pk_kdf.

	* lib/krb5/crypto.c: First version of KDF in
	draft-ietf-krb-wg-pkinit-alg-agility-03.txt.
	
2008-04-08  Love Hörnquist Åstrand  <lha@@it.su.se>

	* doc/setup.texi: Add text about smbk5pwd overlay from Buchan
	Milne.
	
	* lib/krb5/krb5_locl.h: Name the pkinit type enum.

	* kdc/pkinit.c: Rename constants to match global header.

	* lib/krb5/pkinit.c: Drop krb5_pk_identity and rename constants to
	match global header.

	* kdc/pkinit.c: Pick up krb5_pk_identity from krb5_locl.h.

	* lib/krb5/scache.c (scc_alloc): %x is unsigned int.
	
2008-04-07  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/version-script.map: Sort and add krb5_cc_switch.

	* lib/krb5/acache.c: Use unsigned where appropriate.

	* kcm/glue.c: Adapt to chenge to krb5_cc_ops.

	* kcm/acl.c: Add missing op.

	* kdc/connect.c: Use unsigned where appropriate.

	* lib/krb5/n-fold.c: Use size_t where appropriate.

	* lib/krb5/get_addrs.c: Use unsigned where appropriate.

	* lib/krb5/crypto.c: Use unsigned where appropriate.

	* lib/krb5/crc.c: Use unsigned where appropriate.

	* lib/krb5/changepw.c: simplify

	* lib/krb5/copy_host_realm.c: simplify

	* kuser/kswitch.c: Implement --principal.

2008-04-05  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/cache.c: allow returning the default cc-type.

	* kuser/kswitch.c: Enable switching between existing caches.

	* lib/krb5/cache.c: Add krb5_cc_switch, to set the default
	credential cache.

	* lib/krb5/acache.c: Implement set_default.

	* lib/krb5/krb5.h: Extend krb5_cc_ops and add set_default to set
	the default cc name for a credential type.

2008-04-04  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/test_cc.c: test remove

	* lib/krb5/fcache.c: Make the remove cred slight more atomic, now
	it might lose creds, but there will be no empty cache at any time.

	* lib/krb5/scache.c: Do credential iteration by temporary table.

2008-04-02  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/acache.c: Translate ccErrInvalidCCache.

	* lib/krb5/scache.c: implemetation of a sqlite3 backed credential
	cache.

	* lib/krb5/test_cc.c: test acc and scc

	* lib/krb5/acache.c: Only release context if its in use.

2008-04-01  Love Hörnquist Åstrand  <lha@@it.su.se>

	* doc/setup.texi: No patching of OpenLDAP is needed, from Buchan
	Milne.

2008-03-30  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/Makefile.am: Add scache.

	* lib/krb5/scache.c: initial implementation

	* lib/Makefile.am: sqlite

	* configure.in: lib/sqlite/Makefile

2008-03-26  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/fcache.c: Make the storing credential an atomic
	write(2) to avoid signal races, bug traced by Harald Barth and Lars
	Malinowsky.

2008-03-25  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/fcache.c: Make erase_file() do locking too.

	* kcm/protocol.c: Make work when moving to a non-existant
	cred-cache.

	* lib/krb5/test_cc.c: more verbose info.
	
	* lib/krb5/test_cc.c: test krb5_cc_move().
	
2008-03-23  Love Hörnquist Åstrand  <lha@@it.su.se>
	
	* lib/krb5/get_cred.c: Try both kdc server referral and the old
	client chasing mode.

	* lib/krb5/get_cred.c: Don't do canonicalize by default, make
	add_cred() sane, make loop detection in credential fetching
	better.

	* lib/krb5/krb5_locl.h: Add flag EXTRACT_TICKET_AS_REQ.

	* lib/krb5/init_creds_pw.c: Tell _krb5_extract_ticket that this is
	an AS-REQ.

	* lib/krb5/get_in_tkt.c: Make server referral work.
	
2008-03-22  Love Hörnquist Åstrand  <lha@@it.su.se>
	
	* lib/krb5/get_in_tkt.c: check no server referral, don't use
	stringent length tests since encryption layer does padding for
	us...

	* kdc/kerberos5.c: Match name in ClientCanonicalizedNames with -10

	* lib/krb5/principal.c (_krb5_principal_compare_PrincipalName):
	new function to compare a principal to a PrincipalName.

	* lib/krb5/init_creds_pw.c: Move client referral checking to
	_krb5_extract_ticket().

	* lib/krb5/get_in_tkt.c: More bits for server referral.

	* lib/krb5/get_in_tkt.c: Make working with client referrals.

	* lib/krb5/get_cred.c: Try moving referrals checking into
	_krb5_extract_ticket().

	* lib/krb5/get_in_tkt.c: Try moving referrals checking into
	_krb5_extract_ticket().

2008-03-21  Love Hörnquist Åstrand  <lha@@it.su.se>
	
	* kdc/krb5tgs.c: Send SERVER-REFERRAL data in rep.padata instead
	of auth_data in ticket.

2008-03-20  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/init_creds_pw.c: remove lost bits from using
	krb5_principal_set_realm
	
	* kdc/krb5tgs.c: Better referrals support, use canonicalize flag.

	* kdc/hprop.c: use krb5_principal_set_realm

	* lib/krb5/init_creds_pw.c: use krb5_principal_set_realm

	* lib/krb5/verify_user.c: use krb5_principal_set_realm

	* lib/krb5/version-script.map: add krb5_principal_set_realm

	* lib/krb5/principal.c: add krb5_principal_set_realm

	* lib/krb5/get_cred.c: Insecure tgs referrals.

	* lib/krb5/get_cred.c: Dont try key usage KRB5_KU_AP_REQ_AUTH for
	TGS-REQ. This drop compatibility with pre 0.3d KDCs.
	
	* lib/krb5/get_cred.c: catch KRB5_GC_CANONICALIZE.

	* lib/krb5/krb5.h: set KRB5_GC_CANONICALIZE.

	* kuser/kgetcred.c: set KRB5_GC_CANONICALIZE.

	* kuser/kgetcred.c: Add stub --canonicalize implementation.

2008-03-19  Love Hörnquist Åstrand  <lha@@it.su.se>

	* doc/setup.texi: Fix sasl-regexp, from Howard Chu.

2008-03-14  Love Hörnquist Åstrand  <lha@@it.su.se>

	* kdc/kx509.c: Adapt to hx509_env changes.
	
2008-03-10  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/pkinit.c: Try searchin the key by to use by first
	looking for for PK-INIT EKU, then the Microsoft smart card EKU and
	last, no special EKU at all.

2008-03-09  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/acache.c: Create a new credential cache is ->get_name
	is called, make acc_initialize() reset the existing credential
	cache if needed.

	* lib/krb5/acache.c (acc_get_name): just return the cache_name
	directly instead of trying to resolve it.

2008-02-23  Love Hörnquist Åstrand  <lha@@it.su.se>

	* include/Makefile.am (CLEANFILES): add wind.h and wind_err.h and
	sort.

2008-02-11  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/hdb/hdb-ldap.c: Use malloc() instead of static buffer.

	* lib/hdb/hdb-ldap.c: Use ldap_get_values_len, from LaMont Jones
	via Brian May and Debian.

	* doc/Makefile.am: add libwind

2008-02-05  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/test_renew.c: Remove extra ;, From Dennis Davis.

	* lib/krb5/store_emem.c: Make compile on-pre c99 compilers. From
	Dennis Davis.

2008-02-03  Love Hörnquist Åstrand  <lha@@it.su.se>

	* tools/heimdal-gssapi.pc.in: Add wind.

	* tools/krb5-config.in: Add wind.

	* lib/krb5/pac.c: Use libwind.

2008-02-01  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/Makefile.am: SUBDIRS: add wind

2008-01-29  Love Hörnquist Åstrand  <lha@@it.su.se>

	* doc/programming.texi: See the Kerberos 5 API introduction and
	documentation on the Heimdal webpage.
	
2008-01-27  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5: better error strings for the keytab fetching functions

	* lib/krb5/verify_krb5_conf.c: Catch deprecated entries.

	* lib/krb5/get_cred.c: Remove support
	for [libdefaults]capath (not [libdefaults] capaths though).

2008-01-25  Love Hörnquist Åstrand  <lha@@it.su.se>

	* tools/heimdal-gssapi.pc.in: Fix caps of prefix, from Joakim
	Fallsjo.

2008-01-24  Love Hörnquist Åstrand  <lha@@it.su.se>
	
	* lib/krb5/fcache.c (fcc_move): more explict why the fcc_move
	failes, handle cross device moves.
	
2008-01-21  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/get_for_creds.c: Use on variable less.

	* lib/krb5/get_for_creds.c: Try to handle ticket full and
	ticketless tickets better. Add doxygen comments while here.

	* lib/krb5/test_forward.c: Used for testing
	krb5_get_forwarded_creds().
	
	* lib/krb5/Makefile.am: noinst_PROGRAMS += test_forward

	* lib/krb5/Makefile.am: drop CHECK_SYMBOLS

	* lib/hdb/Makefile.am: drop CHECK_SYMBOLS

	* kdc/Makefile.am: drop CHECK_SYMBOLS

2008-01-18  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/version-script.map: Add krb5_digest_probe.
	
2008-01-13  Love Hörnquist Åstrand  <lha@@it.su.se>
	
	* lib/krb5/pkinit.c: Replace hx509_name_to_der_name with
	hx509_name_binary.

2008-01-12  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/Makefile.am: add missing files

	* Happy new year.
@


1.2
log
@update kerberosV to Heimdal 1.5.2 using BSD Makefiles based
on the ones from FreeBSD

This is getting commited now so that we can patch it up
fast in the tree.
There are known regressions so please don't try to build
this on your own now, please wait for the next available
snapshot.

If however you would still want to build it, make sure
build and install everything in the tools directory first.

This is not the full commit yet because there are several
subdirectories.
@
text
@@


1.1
log
@Initial revision
@
text
@a0 1
2001-02-05  Assar Westerlund  <assar@@assaris.sics.se>
d2 139
a140 1
	* Release 0.3e
d142 1
a142 1
2001-01-30  Assar Westerlund  <assar@@sics.se>
d144 1
a144 6
	* kdc/hprop.c (v4_get_masterkey): check kdb_verify_master_key
	properly
	(kdb_prop): decrypt key properly
	* kdc/hprop.c: handle building with KRB4 always try to decrypt v4
	data with the master key leave it up to the v5 how to encrypt with
	that master key
d146 1
a146 6
	* kdc/kstash.c: include file name in error messages
	* kdc/hprop.c: fix a typo and check some more return values
	* lib/hdb/hdb-ldap.c (LDAP__lookup_princ): call ldap_search_s
	correctly.  From Jacques Vidrine <n@@nectar.com>
	* kdc/misc.c (db_fetch): HDB_ERR_NOENTRY makes more sense than
	ENOENT
d148 1
a148 6
	* lib/krb5/Makefile.am (libkrb5_la_LDFLAGS): bump version to
	15:0:0
	* lib/hdb/Makefile.am (libhdb_la_LDFLAGS): bump version to 7:0:0
	* lib/asn1/Makefile.am (libasn1_la_LDFLAGS): bump version to 4:0:2
	* kdc/misc.c (db_fetch): return an error code.  change callers to
	look at this and try to print it in log messages
d150 2
a151 2
	* lib/krb5/crypto.c (decrypt_internal_derived): check that there's
	enough data
d153 1
a153 1
2001-01-29  Assar Westerlund  <assar@@sics.se>
d155 1
a155 2
	* kdc/hprop.c (realm_buf): move it so it becomes properly
	conditional on KRB4
d157 1
a157 4
	* lib/hdb/mkey.c (hdb_unseal_keys_mkey, hdb_seal_keys_mkey,
	hdb_unseal_keys, hdb_seal_keys): check that we have the correct
	master key and that we manage to decrypt the key properly,
	returning an error code.  fix all callers to check return value.
d159 1
a159 4
	* tools/krb5-config.in: use @@LIB_des_appl@@
	* tools/Makefile.am (krb5-config): add LIB_des_appl
	* configure.in (LIB_des): set correctly
	(LIB_des_appl): add for the use by krb5-config.in
d161 47
a207 3
	* lib/krb5/store_fd.c (fd_fetch, fd_store): use net_{read,write}
	to make sure of not dropping data when doing it over a socket.
	(this might break when used with ordinary files on win32)
d209 1
a209 1
	* lib/hdb/hdb_err.et (NO_MKEY): add
d211 1
a211 2
	* kdc/kerberos5.c (as_rep): be paranoid and check
	krb5_enctype_to_string for failure, noted by <lha@@stacken.kth.se>
d213 1
a213 3
	* lib/krb5/krb5_init_context.3, lib/krb5/krb5_context.3,
	lib/krb5/krb5_auth_context.3: add new man pages, contributed by
	<lha@@stacken.kth.se>
d215 1
a215 1
	* use the openssl api for md4/md5/sha and handle openssl/*.h
d217 1
a217 2
	* kdc/kaserver.c (do_getticket): check length of ticket.  noted by
 	<lha@@stacken.kth.se>
d219 1
a219 1
2001-01-28  Assar Westerlund  <assar@@sics.se>
d221 1
a221 2
	* configure.in: send -R instead of -rpath to libtool to set
	runtime library paths
d223 1
a223 1
	* lib/krb5/Makefile.am: remove all dependencies on libkrb
d225 1
a225 1
2001-01-27  Assar Westerlund  <assar@@sics.se>
d227 1
a227 2
	* appl/rcp: add port of bsd rcp changed to use existing rsh,
	contributed by Richard Nyberg <rnyberg@@it.su.se>
d229 1
a229 1
2001-01-27  Johan Danielsson  <joda@@pdc.kth.se>
d231 1
a231 2
	* lib/krb5/get_port.c: don't warn if the port name can't be found,
	nobody cares anyway
d233 1
a233 1
2001-01-26  Johan Danielsson  <joda@@pdc.kth.se>
d235 1
a235 2
	* kdc/hprop.c: make it possible to convert a v4 dump file without
	having any v4 libraries; the kdb backend still require them
d237 1
a237 2
	* kdc/v4_dump.c: include shadow definition of kdb Principal, so we
	don't have to depend on any v4 libraries
d239 2
a240 2
	* kdc/hprop.h: include shadow definition of kdb Principal, so we
	don't have to depend on any v4 libraries
d242 1
a242 1
	* lib/hdb/print.c: reduce number of memory allocations
d244 2
a245 1
	* lib/hdb/mkey.c: add support for reading krb4 /.k files
d247 1
a247 1
2001-01-19  Assar Westerlund  <assar@@sics.se>
d249 1
a249 2
	* lib/krb5/krb5.conf.5: document admin_server and kpasswd_server
	for realms document capath better
d251 2
a252 2
	* lib/krb5/krbhst.c (krb5_get_krb_changepw_hst): preferably look
	at kpasswd_server before admin_server
d254 1
a254 4
	* lib/krb5/get_cred.c (get_cred_from_kdc_flags): look in
	[libdefaults]capath for better hint of realm to send request to.
	this allows the client to specify `realm routing information' in
	case it cannot be done at the server (which is preferred)
d256 1
a256 5
	* lib/krb5/rd_priv.c (krb5_rd_priv): handle no sequence number as
	zero when we were expecting a sequence number.  MIT krb5 cannot
	generate a sequence number of zero, instead generating no sequence
	number
	* lib/krb5/rd_safe.c (krb5_rd_safe): dito
d258 1
a258 1
2001-01-11  Assar Westerlund  <assar@@sics.se>
d260 2
a261 1
	* kpasswd/kpasswdd.c: add --port option
d263 1
a263 1
2001-01-10  Assar Westerlund  <assar@@sics.se>
d265 1
a265 2
	* lib/krb5/appdefault.c (krb5_appdefault_string): fix condition
	just before returning
d267 1
a267 1
2001-01-09  Assar Westerlund  <assar@@sics.se>
d269 2
a270 1
	* appl/kf/kfd.c (proto): use krb5_rd_cred2 instead of krb5_rd_cred
d272 1
a272 1
2001-01-05  Johan Danielsson  <joda@@pdc.kth.se>
d274 1
a274 1
	* kuser/kinit.c: call a time `time', and not `seconds'
d276 1
a276 2
	* lib/krb5/init_creds.c: not much point in setting the anonymous
	flag here
d278 1
a278 1
	* lib/krb5/krb5_appdefault.3: document appdefault_time
d280 1
a280 1
2001-01-04  Johan Danielsson  <joda@@pdc.kth.se>
d282 1
a282 2
	* lib/krb5/verify_user.c: use
	krb5_get_init_creds_opt_set_default_flags
d284 3
a286 1
	* kuser/kinit.c: use krb5_get_init_creds_opt_set_default_flags
d288 1
a288 3
	* lib/krb5/init_creds.c: new function
	krb5_get_init_creds_opt_set_default_flags to set options from
	krb5.conf
d290 187
a476 1
	* lib/krb5/rd_cred.c: make this match the MIT function
d478 2
a479 3
	* lib/krb5/appdefault.c (krb5_appdefault_string): handle NULL
	def_val
	(krb5_appdefault_time): new function
d481 1
a481 1
2001-01-03  Assar Westerlund  <assar@@sics.se>
d483 1
a483 1
	* kdc/hpropd.c (main): handle EOF when reading from stdin
d485 1
@


1.1.1.1
log
@Import of heimdal-0.3e
@
text
@@


1.1.1.2
log
@Import of heimdal-0.3f

Lots of changes, highlights include:

 * change default keytab to ANY:FILE:/etc/krb5.keytab,krb4:/etc/srvtab,
   the new keytab type that tries both of these in order (SRVTAB is
   also an alias for krb4:)

 * improve error reporting and error handling (error messages should
   be more detailed and more useful)

 * the API is closer to what MIT krb5 is using

 * more compatible with windows 2000

 * removed some memory leaks

 * bug fixes
@
text
@a0 330
2001-05-17  Assar Westerlund  <assar@@sics.se>

	* Release 0.3f

2001-05-17  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/Makefile.am: bump version to 16:0:0
	* lib/hdb/Makefile.am: bump version to 7:1:0
	* lib/asn1/Makefile.am: bump version to 5:0:0
	* lib/krb5/keytab_krb4.c: add SRVTAB as an alias for krb4
	* lib/krb5/codec.c: remove dead code

2001-05-15  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/rd_error.c (krb5_error_from_rd_error): use correct
	parenthesis

	* lib/krb5/eai_to_heim_errno.c (krb5_eai_to_heim_errno): add
	`errno' (called system_error) to allow callers to make sure they
	pass the current and relevant value.  update callers

2001-05-14  Johan Danielsson  <joda@@pdc.kth.se>

	* kdc/kerberos5.c: pass context to krb5_domain_x500_decode

2001-05-14  Assar Westerlund  <assar@@sics.se>

	* kpasswd/kpasswdd.c: adapt to new address functions
	* kdc/kerberos5.c: adapt to changing address functions use LR_TYPE
	* kdc/connect.c: adapt to changing address functions
	* kdc/config.c: new krb5_config_parse_file
	* kdc/524.c: new krb5_sockaddr2address
	* lib/krb5/*: add some krb5_{set,clear}_error_string

	* lib/asn1/k5.asn1 (LR_TYPE): add
	* lib/asn1/Makefile.am (gen_files): add asn1_LR_TYPE.x

2001-05-11  Assar Westerlund  <assar@@sics.se>

	* kdc/kerberos5.c (tsg_rep): fix typo in variable name

	* kpasswd/kpasswd-generator.c (nop_prompter): update prototype
	* lib/krb5/init_creds_pw.c: update to new prompter, use prompter
	types and send two prompts at once when changning password
	* lib/krb5/prompter_posix.c (krb5_prompter_posix): add name
	* lib/krb5/krb5.h (krb5_prompt): add type
	(krb5_prompter_fct): add anem

	* lib/krb5/cache.c (krb5_cc_next_cred): transpose last two
	paramaters to krb5_cc_next_cred (as MIT does, and not as they
	document).  From "Jacques A. Vidrine" <n@@nectar.com>

2001-05-11  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/Makefile.am: store-test

	* lib/krb5/store-test.c: simple bit storage test

	* lib/krb5/store.c: add more byteorder storage flags
	
	* lib/krb5/krb5.h: add more byteorder storage flags
	
	* kdc/kerberos5.c: don't use NULL where we mean 0

	* kdc/kerberos5.c: put referral test code in separate function,
	and test for KRB5_NT_SRV_INST

2001-05-10  Assar Westerlund  <assar@@sics.se>

	* admin/list.c (do_list): do not close the keytab if opening it
	failed
	* admin/list.c (do_list): always print complete names.  print
	everything to stdout.
	* admin/list.c: print both v5 and v4 list by default
	* admin/remove.c (kt_remove): reorganize some.  open the keytab
	(defaulting to the modify one).
	* admin/purge.c (kt_purge): reorganize some.  open the keytab
	(defaulting to the modify one). correct usage strings
	* admin/list.c (kt_list): reorganize some.  open the keytab
	* admin/get.c (kt_get): reorganize some.  open the keytab
	(defaulting to the modify one)
	* admin/copy.c (kt_copy): default to modify key name.  re-organise
	* admin/change.c (kt_change): reorganize some.  open the keytab
	(defaulting to the modify one)
	* admin/add.c (kt_add): reorganize some.  open the keytab
	(defaulting to the modify one)
	* admin/ktutil.c (main): do not open the keytab, let every
	sub-function handle it

	* kdc/config.c (configure): call free_getarg_strings

	* lib/krb5/get_in_tkt.c (krb5_get_in_cred): set error strings for
	a few more errors

	* lib/krb5/get_host_realm.c (krb5_get_host_realm_int): make
	`use_dns' parameter boolean

	* lib/krb5/krb5.h (krb5_context_data): add default_keytab_modify
	* lib/krb5/context.c (init_context_from_config_file): set
	default_keytab_modify
	* lib/krb5/krb5_locl.h (KEYTAB_DEFAULT): change to
	ANY:FILE:/etc/krb5.keytab,krb4:/etc/srvtab
	(KEYTAB_DEFAULT_MODIFY): add
	* lib/krb5/keytab.c (krb5_kt_default_modify_name): add
	(krb5_kt_resolve): set error string for failed keytab type

2001-05-08  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/crypto.c (encryption_type): make field names more
	consistent
	(create_checksum): separate usage and type
	(krb5_create_checksum): add a separate type parameter
	(encrypt_internal): only free once on mismatched checksum length

	* lib/krb5/send_to_kdc.c (krb5_sendto_kdc2): try to tell what
	realm we didn't manage to reach any KDC for in the error string

	* lib/krb5/generate_seq_number.c (krb5_generate_seq_number): free
	the entire subkey.  from <tmartin@@mirapoint.com>

2001-05-07  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/keytab_keyfile.c (akf_start_seq_get): return
	KT_NOTFOUND if the file is empty

2001-05-07  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/fcache.c: call krb5_set_error_string when open fails
	fatally
	* lib/krb5/keytab_file.c: call krb5_set_error_string when open
	fails fatally

	* lib/krb5/warn.c (_warnerr): print error_string in context in
	preference to error string derived from error code
	* kuser/kinit.c (main): try to print the error string
	* lib/krb5/get_in_tkt.c (krb5_get_in_cred): set some sensible
	error strings for errors

	* lib/krb5/krb5.h (krb5_context_data): add error_string and
	error_buf
	* lib/krb5/Makefile.am (libkrb5_la_SOURCES): add error_string.c
	* lib/krb5/error_string.c: new file

2001-05-02  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/time.c: krb5_string_to_deltat

	* lib/krb5/sock_principal.c: one less data copy

	* lib/krb5/eai_to_heim_errno.c: conversion function for h_errno's

	* lib/krb5/get_default_principal.c: change this slightly

	* lib/krb5/crypto.c: make checksum_types into an array of pointers

	* lib/krb5/convert_creds.c: make sure we always use a des-cbc-crc
	ticket

2001-04-29  Assar Westerlund  <assar@@sics.se>

	* kdc/kerberos5.c (tgs_rep2): return a reference to a krbtgt for
	the right realm if we fail to find a non-krbtgt service in the
	database and the second component does a succesful non-dns lookup
	to get the real realm (which has to be different from the
	originally-supplied realm).  this should help windows 2000 clients
	that always start their lookups in `their' realm and do not have
	any idea of how to map hostnames into realms
	* kdc/kerberos5.c (is_krbtgt): rename to get_krbtgt_realm

2001-04-27  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/get_host_realm.c (krb5_get_host_realm_int): add extra
	parameter to request use of dns or not

2001-04-25  Assar Westerlund  <assar@@sics.se>

	* admin/get.c (kt_get): allow specification of encryption types
	* lib/krb5/verify_init.c (krb5_verify_init_creds): do not try to
	close an unopened ccache, noted by <marc@@mit.edu>

	* lib/krb5/krb5.h (krb5_any_ops): add declaration
	* lib/krb5/context.c (init_context_from_config_file): register
	krb5_any_ops

	* lib/krb5/keytab_any.c: new file, implementing union of keytabs
	* lib/krb5/Makefile.am (libkrb5_la_SOURCES): add keytab_any.c
	
	* lib/krb5/init_creds_pw.c (get_init_creds_common): handle options
	== NULL.  noted by <marc@@mit.edu>

2001-04-19  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/rd_cred.c: set ret_creds to NULL before doing anything
	else, from Jacques Vidrine

2001-04-18  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/hdb/libasn1.h: asn1.h -> krb5_asn1.h

	* lib/asn1/Makefile.am: add asn1_ENCTYPE.x

	* lib/krb5/krb5.h: adapt to asn1 changes

	* lib/asn1/k5.asn1: move enctypes here

	* lib/asn1/libasn1.h: rename asn1.h to krb5_asn1.h to avoid
	conflicts

	* lib/asn1/Makefile.am: rename asn1.h to krb5_asn1.h to avoid
	conflicts

	* lib/asn1/lex.l: use strtol to parse constants

2001-04-06  Johan Danielsson  <joda@@pdc.kth.se>

	* kuser/kinit.c: add simple support for running commands

2001-03-26  Assar Westerlund  <assar@@sics.se>

	* lib/hdb/hdb-ldap.c: change order of includes to allow it to work
	with more versions of openldap

	* kdc/kerberos5.c (tgs_rep2): try to set sec and usec in error
	replies
	(*): update callers of krb5_km_error
	(check_tgs_flags): handle renews requesting non-renewable tickets

	* lib/krb5/mk_error.c (krb5_mk_error): allow specifying both ctime
	and cusec

	* lib/krb5/krb5.h (krb5_checksum, krb5_keyusage): add
	compatibility names

	* lib/krb5/crypto.c (create_checksum): change so that `type == 0'
	means pick from the `crypto' (context) and otherwise use that
	type.  this is not a large change in practice and allows callers
	to specify the exact checksum algorithm to use

2001-03-13  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/get_cred.c (get_cred_kdc): add support for falling back
	to KRB5_KU_AP_REQ_AUTH when KRB5_KU_TGS_REQ_AUTH gives `bad
	integrity'.  this helps for talking to old (pre 0.3d) KDCs

2001-03-12  Assar Westerlund  <assar@@pdc.kth.se>

	* lib/krb5/crypto.c (krb5_derive_key): new function, used by
	derived-key-test.c
	* lib/krb5/string-to-key-test.c: add new test vectors posted by
	Ken Raeburn <raeburn@@mit.edu> in <tx1bsra8919.fsf@@raeburn.org> to
	ietf-krb-wg@@anl.gov
	* lib/krb5/n-fold-test.c: more test vectors from same source
	* lib/krb5/derived-key-test.c: more tests from same source

2001-03-06  Assar Westerlund  <assar@@sics.se>

	* acconfig.h: include roken_rename.h when appropriate

2001-03-06  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/krb5.h (krb5_enctype): remove trailing comma

2001-03-04  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/krb5.h (krb5_enctype): add ENCTYPE_* aliases for
	compatibility with MIT krb5

2001-03-02  Assar Westerlund  <assar@@sics.se>

	* kuser/kinit.c (main): only request a renewable ticket when
	explicitly requested.  it still gets a renewable one if the renew
	life is specified
	* kuser/kinit.c (renew_validate): treat -1 as flags not being set

2001-02-28  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/context.c (krb5_init_ets): use krb5_add_et_list

2001-02-27  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/get_cred.c: implement krb5_get_cred_from_kdc_opt

2001-02-25  Assar Westerlund  <assar@@sics.se>

	* configure.in: do not use -R when testing for des functions

2001-02-14  Assar Westerlund  <assar@@sics.se>

	* configure.in: test for lber.h when trying to link against
 	openldap to handle openldap v1, from Sumit Bose
 	<sumit.bose@@suse.de>

2001-02-19  Assar Westerlund  <assar@@sics.se>

	* lib/asn1/libasn1.h: add string.h (for memset)

2001-02-15  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/warn.c (_warnerr): add printf attributes
	* lib/krb5/send_to_kdc.c (krb5_sendto): loop over all address
	returned by getaddrinfo before trying the next kdc.  from
	thorpej@@netbsd.org

	* lib/krb5/krb5.conf.5: fix default_realm in example

	* kdc/connect.c: fix a few kdc_log format types

	* configure.in: try to handle libdes/libcrypto ont requiring -L

2001-02-10  Assar Westerlund  <assar@@sics.se>

	* lib/asn1/gen_decode.c (generate_type_decode): zero the data at
	the beginning of the generated function, and add a label `fail'
	that the code jumps to in case of errors that frees all allocated
	data

2001-02-07  Assar Westerlund  <assar@@sics.se>

	* configure.in: aix dce: fix misquotes, from Ake Sandgren
	<ake@@cs.umu.se>

	* configure.in (dpagaix_LDFLAGS): try to add export file

2001-02-05  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/krb5_keytab.3: new man page, contributed by
	<lha@@stacken.kth.se>

	* kdc/kaserver.c: update to new db_fetch4

@


1.1.1.3
log
@Import of heimdal-0.4e
@
text
@a0 511
2001-09-03  Assar Westerlund  <assar@@sics.se>

	* Release 0.4e

2001-09-02  Johan Danielsson  <joda@@pdc.kth.se>

	* kuser/Makefile.am: install kauth as a symlink to kinit

	* kuser/kinit.c: get v4_tickets by default

	* lib/asn1/Makefile.am: fix for broken automake

2001-08-31  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/hdb/hdb-ldap.c: some pretty much untested changes from Luke
	Howard

	* kuser/kinit.1: remove references to kauth

	* kuser/Makefile.am: kauth is no more

	* kuser/kinit.c: use appdefaults for everything. defaults are now
	as in kauth.

	* lib/krb5/appdefault.c: also check libdefaults, and realms/realm

	* lib/krb5/context.c (krb5_free_context): free more stuff

2001-08-30  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/verify_krb5_conf.c: do some checks of the values in the
	file

	* lib/krb5/krb5.conf.5: remove srv_try_txt, fix spelling

	* lib/krb5/context.c: don't init srv_try_txt, since it isn't used
	anymore

2001-08-29  Jacques Vidrine  <n@@nectar.com>

	* configure.in: Check for already-installed com_err.

2001-08-28  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/Makefile.am (libkrb5_la_LDFLAGS): set versoin to 18:2:1

2001-08-24  Assar Westerlund  <assar@@sics.se>

	* kuser/Makefile.am: remove CHECK_LOCAL - non bin programs require
	no special treatment now

	* kuser/generate-requests.c: parse arguments in a useful way
	* kuser/kverify.c: add --help/--verify

2001-08-22  Assar Westerlund  <assar@@sics.se>

	* configure.in: bump prereq to 2.52 remove unused test_LIB_KRB4

	* configure.in: re-write the handling of crypto libraries.  try to
	use the one of openssl's libcrypto or krb4's libdes that has all
	the required functionality (md4, md5, sha1, des, rc4).  if there
	is no such library, the included lib/des is built.

	* kdc/headers.h: include libutil.h if it exists
	* kpasswd/kpasswd_locl.h: include libutil.h if it exists
	* kdc/kerberos4.c (get_des_key): check for null keys even if
	is_server

2001-08-21  Assar Westerlund  <assar@@sics.se>

	* lib/asn1/asn1_print.c: print some size_t correctly
	* configure.in: remove extra space after -L check for libutil.h

2001-08-17  Johan Danielsson  <joda@@pdc.kth.se>

	* kdc/kdc_locl.h: fix prototype for get_des_key

	* kdc/kaserver.c: fix call to get_des_key

	* kdc/524.c: fix call to get_des_key

	* kdc/kerberos4.c (get_des_key): if getting a key for a server,
	return any des-key not just keys that can be string-to-keyed by
	the client

2001-08-10  Assar Westerlund  <assar@@sics.se>

	* Release 0.4d

2001-08-10  Assar Westerlund  <assar@@sics.se>

	* configure.in: check for openpty
	* lib/hdb/Makefile.am (libhdb_la_LDFLAGS): update to 7:4:0

2001-08-08  Assar Westerlund  <assar@@sics.se>

	* configure.in: just add -L (if required) from krb4 when testing
	for libdes/libcrypto

2001-08-04  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/Makefile.am (man_MANS): add some missing man pages
	* fix-export: fix the sed expression for finding the man pages

2001-07-31  Assar Westerlund  <assar@@sics.se>

	* kpasswd/kpasswd-generator.c (main): implement --version and
	--help

	* lib/krb5/Makefile.am (libkrb5_la_LDFLAGS): update version to
	18:1:1

2001-07-27  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/context.c (init_context_from_config_file): check
	parsing of addresses

2001-07-26  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/sock_principal.c (krb5_sock_to_principal): rename
	sa_len -> salen to avoid the macro that's defined on irix.  noted
	by "Jacques A. Vidrine" <n@@nectar.com>

2001-07-24  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/addr_families.c: add support for type
	KRB5_ADDRESS_ADDRPORT

	* lib/krb5/addr_families.c (krb5_address_order): complain about
	unsuppored address types

2001-07-23  Johan Danielsson  <joda@@pdc.kth.se>

	* admin/get.c: don't open connection to server until we loop over
	the principals, at that time we know the realm of the (first)
	principal and we can default to that admin server

	* admin: add a rename command

2001-07-19  Assar Westerlund  <assar@@sics.se>

	* kdc/hprop.c (usage): clarify a tiny bit

2001-07-19  Assar Westerlund  <assar@@sics.se>

	* Release 0.4c

2001-07-19  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/Makefile.am (libkrb5_la_LDFLAGS): bump version to
	18:0:1

	* lib/krb5/get_for_creds.c (krb5_fwd_tgt_creds): make it behave
	the same way as the MIT function

	* lib/hdb/Makefile.am (libhdb_la_LDFLAGS): update to 7:3:0
	* lib/krb5/sock_principal.c (krb5_sock_to_principal): use
	getnameinfo

	* lib/krb5/krbhst.c (srv_find_realm): handle port numbers
	consistenly in local byte order

	* lib/krb5/get_default_realm.c (krb5_get_default_realm): set an
	error string

	* kuser/kinit.c (renew_validate): invert condition correctly.  get
	v4 tickets if we succeed renewing
	* lib/krb5/principal.c (krb5_principal_get_type): add
	(default_v4_name_convert): add "smtp"

2001-07-13  Assar Westerlund  <assar@@sics.se>

	* configure.in: remove make-print-version from LIBOBJS, it's no
	longer in lib/roken but always built in lib/vers

2001-07-12  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/hdb/mkey.c: more set_error_string

2001-07-12  Assar Westerlund  <assar@@sics.se>

	* lib/hdb/Makefile.am (libhdb_la_LIBADD): add required library
	dependencies

	* lib/asn1/Makefile.am (libasn1_la_LIBADD): add required library
	dependencies

2001-07-11  Johan Danielsson  <joda@@pdc.kth.se>

	* kdc/hprop.c: remove v4 master key handling; remove old v4-db and
	ka-db flags; add defaults for v4_realm and afs_cell

2001-07-09  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/sock_principal.c (krb5_sock_to_principal): copy hname
	before calling krb5_sname_to_principal.  from "Jacques A. Vidrine"
	<n@@nectar.com>

2001-07-08  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/context.c: use krb5_copy_addresses instead of
	copy_HostAddresses

2001-07-06  Assar Westerlund  <assar@@sics.se>

	* configure.in (LIB_des_a, LIB_des_so): add these so that they can
	be used by lib/auth/sia

	* kuser/kinit.c: re-do some of the v4 fallbacks: look at
	get-tokens flag do not print extra errors do not try to do 524 if
	we got tickets from a v4 server

2001-07-03  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/replay.c (krb5_get_server_rcache): cast argument to
	printf

	* lib/krb5/get_addrs.c (find_all_addresses): call free_addresses
	on ignore_addresses correctly
	* lib/krb5/init_creds.c
	(krb5_get_init_creds_opt_set_default_flags): change to take a
	const realm

	* lib/krb5/principal.c (krb5_425_conv_principal_ext): if the
	instance is the first component of the local hostname, the
	converted host should be the long hostname.  from
	<shadow@@dementia.org>

2001-07-02  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/Makefile.am: address.c is no more; add a couple of
	manpages

	* lib/krb5/krb5_timeofday.3: new manpage

	* lib/krb5/krb5_get_all_client_addrs.3: new manpage

	* lib/krb5/get_in_tkt.c (init_as_req): treat no addresses as
	wildcard

	* lib/krb5/get_cred.c (get_cred_kdc_la): treat no addresses as
	wildcard

	* lib/krb5/get_addrs.c: don't include client addresses that match
	ignore_addresses

	* lib/krb5/context.c: initialise ignore_addresses

	* lib/krb5/addr_families.c: add new `arange' fake address type,
	that matches more than one address; this required some internal
	changes to many functions, so all of address.c got moved here
	(wasn't much left there)

	* lib/krb5/krb5.h: add list of ignored addresses to context

2001-07-03  Assar Westerlund  <assar@@sics.se>

	* Release 0.4b

2001-07-03  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/Makefile.am (libkrb5_la_LDFLAGS): set version to 17:0:0
	* lib/hdb/Makefile.am (libhdb_la_LDFLAGS): set version to 7:2:0

2001-07-03  Assar Westerlund  <assar@@sics.se>

	* Release 0.4a

2001-07-02  Johan Danielsson  <joda@@pdc.kth.se>

	* kuser/kinit.c: make this compile without krb4 support

	* lib/krb5/write_message.c: remove priv parameter from
	write_safe_message; don't know why it was there in the first place

	* doc/install.texi: remove kaserver switches, it's always compiled
	in now

	* kdc/hprop.c: always include kadb support

	* kdc/kaserver.c: always include kaserver support

2001-07-02  Assar Westerlund  <assar@@sics.se>

	* kpasswd/kpasswdd.c (doit): make failing to bind a socket a
	non-fatal error, and abort if no sockets were bound

2001-07-01  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/krbhst.c: remember the real port number when falling
	back from kpasswd -> kadmin, and krb524 -> kdc

2001-06-29  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/get_for_creds.c (krb5_get_forwarded_creds): if
	no_addresses is set, do not add any local addresses to KRB_CRED

	* kuser/kinit.c: remove extra clearing of password and some
	redundant code

2001-06-29  Johan Danielsson  <joda@@pdc.kth.se>

	* kuser/kinit.c: move ticket conversion code to separate function,
	and call that from a couple of places, like when renewing a
	ticket; also add a flag for just converting a ticket

	* lib/krb5/init_creds_pw.c: set renew-life to some sane value

	* kdc/524.c: don't send more data than required

2001-06-24  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/store_fd.c (krb5_storage_from_fd): check malloc returns

	* lib/krb5/keytab_any.c (any_resolve); improving parsing of ANY:
	(any_start_seq_get): remove a double free
	(any_next_entry): iterate over all (sub) keytabs and avoid leave data
	around to be freed again

	* kdc/kdc_locl.h: add a define for des_new_random_key when using
	openssl's libcrypto

	* configure.in: move v6 tests down

	* lib/krb5/krb5.h (krb5_context_data): remove srv_try_rfc2052

	* update to libtool 1.4 and autoconf 2.50

2001-06-22  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/hdb/hdb.c: use krb5_add_et_list

2001-06-21  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/hdb/Makefile.am: add generation number
	* lib/hdb/common.c: add generation number code
	* lib/hdb/hdb.asn1: add generation number
	* lib/hdb/print.c: use krb5_storage to make it more dynamic

2001-06-21  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/krb5.conf.5: update to changed names used by
	krb5_get_init_creds_opt_set_default_flags
	* lib/krb5/init_creds.c
	(krb5_get_init_creds_opt_set_default_flags): make the appdefault
	keywords have the same names

	* configure.in: only add -L and -R to the krb4 libdir if we are
	actually using it

	* lib/krb5/krbhst.c (fallback_get_hosts): do not copy trailing
	dot of hostname add some comments
	* lib/krb5/krbhst.c: use getaddrinfo instead of dns_lookup when
	testing for kerberos.REALM.  this allows reusing that information
	when actually contacting the server and thus avoids one DNS lookup

2001-06-20  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/krb5.h: include k524_err.h

	* lib/krb5/convert_creds.c (krb524_convert_creds_kdc): don't test
	for keytype, the server will do this for us if it has anything to
	complain about

	* lib/krb5/context.c: add protocol compatible krb524 error codes

	* lib/krb5/Makefile.am: add protocol compatible krb524 error codes

	* lib/krb5/k524_err.et: add protocol compatible krb524 error codes

	* lib/krb5/krb5_principal_get_realm.3: manpage

	* lib/krb5/principal.c: add functions `krb5_principal_get_realm'
	and `krb5_principal_get_comp_string' that returns parts of a
	principal; this is a replacement for the internal
	`krb5_princ_realm' and `krb5_princ_component' macros that everyone
	seem to use

2001-06-19  Assar Westerlund  <assar@@sics.se>

	* kuser/kinit.c (main): dereference result from krb5_princ_realm.
	from Thomas Nystrom <thn@@saeab.se>

2001-06-18  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/mk_req.c (krb5_mk_req_exact): free creds when done
	* lib/krb5/crypto.c (krb5_string_to_key_derived): fix memory leak
	* lib/krb5/krbhst.c (config_get_hosts): free hostlist
	* kuser/kinit.c: free principal

2001-06-18  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/send_to_kdc.c (krb5_sendto): remove an extra
	freeaddrinfo

	* lib/krb5/convert_creds.c (krb524_convert_creds_kdc_ccache):
	remove some unused variables

	* lib/krb5/krbhst.c (admin_get_next): spell kerberos correctly
	* kdc/kerberos5.c: update to new krb5_auth_con* names
	* kdc/hpropd.c: update to new krb5_auth_con* names
	* lib/krb5/rd_req.c (krb5_rd_req): use krb5_auth_con* functions
	and remove some comments
	* lib/krb5/rd_safe.c (krb5_rd_safe): pick the keys in the right
	order: remote - local - session
	* lib/krb5/rd_rep.c (krb5_rd_rep): save the remote sub key in the
	auth_context
	* lib/krb5/rd_priv.c (krb5_rd_priv): pick keys in the correct
	order: remote - local - session
	* lib/krb5/mk_safe.c (krb5_mk_safe): pick keys in the right order,
	local - remote - session

2001-06-18  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/convert_creds.c: use starttime instead of authtime,
	from Chris Chiappa

	* lib/krb5/convert_creds.c: make krb524_convert_creds_kdc match
	the MIT function by the same name; add
	krb524_convert_creds_kdc_ccache that does what the old version did

	* admin/list.c (do_list): make sure list of keys is NULL
	terminated; similar to patch sent by Chris Chiappa

2001-06-18  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/mcache.c (mcc_remove_cred): use
	krb5_free_creds_contents

	* lib/krb5/auth_context.c: name function krb5_auth_con more
	consistenly
	* lib/krb5/rd_req.c (krb5_verify_authenticator_checksum): use
	renamed krb5_auth_con_getauthenticator

	* lib/krb5/convert_creds.c (krb524_convert_creds_kdc): update to
	use krb5_krbhst API
	* lib/krb5/changepw.c (krb5_change_password): update to use
	krb5_krbhst API
	* lib/krb5/send_to_kdc.c: update to use krb5_krbhst API
	* lib/krb5/krbhst.c (krb5_krbhst_get_addrinfo): add set def_port
	in krb5_krbhst_info
	(krb5_krbhst_free): free everything

	* lib/krb5/krb5.h (KRB5_VERIFY_NO_ADDRESSES): add
	(krb5_krbhst_info): add def_port (default port for this service)

	* lib/krb5/krbhst-test.c: make it more verbose and useful
	* lib/krb5/krbhst.c: remove some more memory leaks do not try any
	dns operations if there is local configuration admin: fallback to
	kerberos.REALM 524: fallback to kdcs kpasswd: fallback to admin
	add some comments

	* configure.in: remove initstate and setstate, they should be in
	cf/roken-frag.m4

	* lib/krb5/Makefile.am (noinst_PROGRAMS): add krbhst-test
	* lib/krb5/krbhst-test.c: new program for testing krbhst
	* lib/krb5/krbhst.c (common_init): remove memory leak
	(main): move test program into krbhst-test

2001-06-17  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/krb5_krbhst_init.3: manpage

	* lib/krb5/krb5_get_krbhst.3: manpage

2001-06-16  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/krb5.h: add opaque krb5_krbhst_handle type

	* lib/krb5/krbhst.c: change void* to krb5_krbhst_handle

	* lib/krb5/krb5.h: types for new krbhst api

	* lib/krb5/krbhst.c: implement a new api that looks up one host at
	a time, instead of making a list of hosts

2001-06-09  Johan Danielsson  <joda@@pdc.kth.se>

	* configure.in: test for initstate and setstate

	* lib/krb5/krbhst.c: remove rfc2052 support

2001-06-08  Johan Danielsson  <joda@@pdc.kth.se>

	* fix some manpages for broken mdoc.old grog test

2001-05-28  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/krb5.conf.5: add [appdefaults]
	* lib/krb5/init_creds_pw.c: remove configuration reading that is
	now done in krb5_get_init_creds_opt_set_default_flags
	* lib/krb5/init_creds.c
	(krb5_get_init_creds_opt_set_default_flags): add reading of
	libdefaults versions of these and add no_addresses

	* lib/krb5/get_in_tkt.c (krb5_get_in_cred): clear error string
	when preauth was required and we retry

2001-05-25  Assar Westerlund  <assar@@sics.se>

	* lib/krb5/convert_creds.c (krb524_convert_creds_kdc): call
	krb5_get_krb524hst
	* lib/krb5/krbhst.c (krb5_get_krb524hst): add and restructure the
	support functions

2001-05-22  Assar Westerlund  <assar@@sics.se>

	* kdc/kerberos5.c (tgs_rep2): alloc and free csec and cusec
	properly

a12 4
2001-05-17  Johan Danielsson  <joda@@pdc.kth.se>

	* kdc/config.c: actually check the ticket addresses

a22 4

	* lib/krb5/verify_user.c: krb5_verify_user_opt

	* lib/krb5/krb5.h: verify_opt
@


1.1.1.4
log
@Import of heimdal-0.6rc1
@
text
@d1 1
a1 1
2003-04-28  Love Hrnquist strand  <lha@@it.su.se>
d3 1
a3 2
	* kdc/v4_dump.c: 1.4->1.5: (v4_prop_dump): limit strings length,
	from openbsd
d5 1
a5 1
2003-04-24  Love Hrnquist strand  <lha@@it.su.se>
d7 1
a7 2
	* doc/programming.texi: 1.2-1.3: s/managment/management/, from jmc
	<jmc@@prioris.mini.pw.edu.pl>
d9 1
a9 1
2003-04-22  Love Hrnquist strand  <lha@@it.su.se>
d11 1
a11 2
	* lib/krb5/krbhst.c: 1.43->1.44: copy NUL too, from janj@@wenf.org
	via openbsd
d13 1
a13 1
2003-04-17  Love Hrnquist strand  <lha@@it.su.se>
d15 349
a363 11
	* lib/asn1/der_copy.c (copy_general_string): use strdup
	* lib/asn1/der_put.c: remove sprintf
	* lib/asn1/gen.c: remove strcpy/sprintf
	
	* lib/krb5/name-45-test.c: use a more unique name then ratatosk so
	that other (me) have such hosts in the local domain and the tests
	fails, to take hokkigai.pdc.kth.se instead
	
	* lib/krb5/test_alname.c: add --version and --help
	
2003-04-16  Love Hrnquist strand  <lha@@it.su.se>
d365 1
a365 10
	* lib/krb5/krb5_warn.3: add krb5_get_err_text
	
	* lib/krb5/transited.c: use strlcat/strlcpy, from openbsd
	* lib/krb5/krbhst.c (srv_find_realm): use strlcpy, from openbsd
	* lib/krb5/aname_to_localname.c (krb5_aname_to_localname): use
	strlcpy, from openbsd
	* kdc/hpropd.c: s/strcat/strlcat/, inspired from openbsd
	* appl/kf/kfd.c: use strlcpy, from openbsd
	
2003-04-16  Johan Danielsson  <joda@@pdc.kth.se>
d367 1
a367 3
	* configure.in: fix for large file support in AIX, _LARGE_FILES
	needs to be defined on the command line, since lex likes to
	include stdio.h before we get to config.h
d369 1
a369 7
2003-04-16  Love Hrnquist strand  <lha@@it.su.se>
	
	* lib/krb5/*.3: Change .Fd #include <header.h> to .In header.h,
	from Thomas Klausner <wiz@@netbsd.org>
	
	* lib/krb5/krb5.conf.5: spelling, from Thomas Klausner
	<wiz@@netbsd.org>
d371 1
a371 1
2003-04-15  Love Hrnquist strand  <lha@@it.su.se>
d373 5
a377 3
	* kdc/kerberos5.c: fix some more memory leaks
	
2003-04-11  Love Hrnquist strand  <lha@@it.su.se>
d379 1
a379 3
	* appl/kf/kf.1: spelling, from jmc <jmc@@prioris.mini.pw.edu.pl>
	
2003-04-08  Love Hrnquist strand  <lha@@it.su.se>
d381 2
a382 3
	* admin/ktutil.8: typos, from jmc <jmc@@acn.waw.pl>
	
2003-04-06  Love Hrnquist strand  <lha@@it.su.se>
d384 1
a384 9
	* lib/krb5/krb5.3: s/kerberos/Kerberos/
	* lib/krb5/krb5_data.3: s/kerberos/Kerberos/
	* lib/krb5/krb5_address.3: s/kerberos/Kerberos/
	* lib/krb5/krb5_ccache.3: s/kerberos/Kerberos/
	* lib/krb5/krb5.conf.5: s/kerberos/Kerberos/
	* kuser/kinit.1: s/kerberos/Kerberos/
	* kdc/kdc.8: s/kerberos/Kerberos/
	
2003-04-01  Love Hrnquist strand  <lha@@it.su.se>
d386 4
a389 5
	* lib/krb5/test_alname.c: more krb5_aname_to_localname tests
	
	* lib/krb5/aname_to_localname.c (krb5_aname_to_localname): when
	converting too root, make sure user is ok according to
	krb5_kuserok before allowing it.
d391 1
a391 15
	* lib/krb5/Makefile.am (noinst_PROGRAMS): += test_alname
	
	* lib/krb5/test_alname.c: add test for krb5_aname_to_localname
	
	* lib/krb5/crypto.c (krb5_DES_AFS3_CMU_string_to_key): used p1
	instead of the "illegal" salt #~, same change as kth-krb did
	1999. Problems occur with crypt() that behaves like AT&T crypt
	(openssl does this). Pointed out by Marcus Watts.

	* admin/change.c (kt_change): collect all principals we are going
	to change, and pick the highest kvno and use that to guess what
	kvno the resulting kvno is going to be. Now two ktutil change in a
	row works. XXX fix the protocol to pass the kvno back.
	
2003-03-31  Love Hrnquist strand  <lha@@it.su.se>
d393 2
a394 3
	* appl/kf/kf.1: afs->AFS, from jmc <jmc@@acn.waw.pl>
	
2003-03-30  Love Hrnquist strand  <lha@@it.su.se>
d396 2
a397 2
	* doc/setup.texi: add description on how to turn on v4, 524 and
	kaserver support
d399 13
a411 1
2003-03-29  Love Hrnquist strand  <lha@@it.su.se>
d413 1
a413 2
	* lib/krb5/verify_krb5_conf.c (appdefaults_entries): add afslog
	and afs-use-524
d415 2
a416 1
2003-03-28  Love Hrnquist strand  <lha@@it.su.se>
d418 3
a420 2
	* kdc/kerberos5.c (as_rep): when the second enctype_to_string
	failes, remember to free memory from the first enctype_to_string
d422 2
a423 3
	* lib/krb5/crypto.c (usage2arcfour): map KRB5_KU_TICKET to 2,
	from Harald Joerg <harald.joerg@@fujitsu-siemens.com>
	(enctype_arcfour_hmac_md5): disable checksum_hmac_md5_enc
d425 1
a425 4
	* lib/hdb/mkey.c (hdb_unseal_keys_mkey): truncate key to the key
	length when key is longer then expected length, its probably
	longer since the encrypted data was padded, reported by Aidan
	Cully <aidan@@kublai.com>
d427 2
a428 4
	* lib/krb5/crypto.c (krb5_enctype_keysize): return key size of
	encyption type, inspired by Aidan Cully <aidan@@kublai.com>
	
2003-03-27  Love Hrnquist strand  <lha@@it.su.se>
d430 4
a433 5
	* lib/krb5/keytab.c (krb5_kt_get_entry): avoid printing 0
	(wildcard kvno) after principal when the keytab entry isn't found,
	reported by Chris Chiappa <chris@@chiappa.net>
	
2003-03-26  Love Hrnquist strand  <lha@@it.su.se>
d435 8
a442 2
	* doc/misc.texi: update 2b example to match reality (from
	mattiasa@@e.kth.se)
d444 2
a445 2
	* doc/misc.texi: spelling and add `Configuring AFS clients'
	subsection
d447 5
a451 1
2003-03-25  Love Hrnquist strand  <lha@@it.su.se>
d453 2
a454 4
	* lib/krb5/krb5.3: add krb5_free_data_contents.3
	
	* lib/krb5/data.c: add krb5_free_data_contents for compat with MIT
	API
d456 4
a459 7
	* lib/krb5/krb5_data.3: add krb5_free_data_contents for compat
	with MIT API
	
	* lib/krb5/krb5_verify_user.3: write more about how the ccache
	argument should be inited when used
	
2003-03-25  Johan Danielsson  <joda@@pdc.kth.se>
d461 1
a461 3
	* lib/krb5/addr_families.c (krb5_print_address): make sure
	print_addr is defined for the given address type; make addrports
	printable
d463 1
a463 1
	* kdc/string2key.c: print the used enctype for kerberos 5 keys
d465 1
a465 1
2003-03-25  Love Hrnquist strand  <lha@@it.su.se>
d467 1
a467 3
	* lib/krb5/aes-test.c: add another arcfour test
	
2003-03-22  Love Hrnquist strand  <lha@@it.su.se>
d469 1
a469 5
	* lib/krb5/aes-test.c: sneek in a test for arcfour-hmac-md5
	
2003-03-20  Love Hrnquist strand  <lha@@it.su.se>
	
	* lib/krb5/krb5_ccache.3: update .Dd
d471 1
a471 1
	* lib/krb5/krb5.3: sort in krb5_data functions
d473 1
a473 1
	* lib/krb5/Makefile.am (man_MANS): += krb5_data.3
d475 2
a476 1
	* lib/krb5/krb5_data.3: document krb5_data
d478 1
a478 4
	* lib/krb5/init_creds_pw.c (krb5_get_init_creds_password): if
	prompter is NULL, don't try to ask for a password to
	change. reported by Iain Moffat @@ ufl.edu via Howard Chu
	<hyc@@highlandsun.com>
d480 1
a480 1
2003-03-19  Love Hrnquist strand  <lha@@it.su.se>
d482 1
a482 2
	* lib/krb5/krb5_keytab.3: spelling, from
	<jmc@@prioris.mini.pw.edu.pl>
d484 1
a484 4
	* lib/krb5/krb5.conf.5: . means new line
	
	* lib/krb5/krb5.conf.5: spelling, from
	<jmc@@prioris.mini.pw.edu.pl>
d486 1
a486 2
	* lib/krb5/krb5_auth_context.3: spelling, from
	<jmc@@prioris.mini.pw.edu.pl>
d488 1
a488 1
2003-03-18  Love Hrnquist strand  <lha@@it.su.se>
d490 6
a495 5
	* kuser/Makefile.am: INCLUDES: -I$(srcdir)/../lib/krb5
	
	* lib/krb5/convert_creds.c: add _krb5_krb_life_to_time
	
	* lib/krb5/krb5-v4compat.h: add _krb5_krb_life_to_time
d497 2
a498 7
	* kdc/kdc_locl.h: 524 is independent of kerberos 4, so move out
	#ifdef KRB4 from enable_v4_cross_realm since 524 needs it
	
	* kdc/config.c: 524 is independent of kerberos 4, so move out
	enable_v4_cross_realm from #ifdef KRB4 since 524 needs it
	
2003-03-17  Assar Westerlund  <assar@@kth.se>
d500 1
a500 7
	* kdc/kdc.8: document --kerberos4-cross-realm
	* kdc/kerberos4.c: pay attention to enable_v4_cross_realm
	* kdc/kdc_locl.h (enable_v4_cross_realm): add
	* kdc/524.c (encode_524_response): check the enable_v4_cross_realm
	flag before giving out v4 tickets for foreign v5 principals
	* kdc/config.c: add --enable-kerberos4-cross-realm option (default
	to off)
d502 4
a505 1
2003-03-17  Love Hrnquist strand  <lha@@it.su.se>
d507 1
a507 4
	* lib/krb5/Makefile.am (man_MANS) += krb5_aname_to_localname.3
	
	* lib/krb5/krb5_aname_to_localname.3: manpage for
	krb5_aname_to_localname
d509 2
a510 3
	* lib/krb5/krb5_kuserok.3: s/KRB5_USEROK/KRB5_KUSEROK/
	
2003-03-16  Love Hrnquist strand  <lha@@it.su.se>
d512 1
a512 1
	* lib/krb5/Makefile.am (man_MANS): add krb5_set_default_realm.3
d514 1
a514 1
	* lib/krb5/krb5.3: add manpages from krb5_set_default_realm.3
d516 1
a516 4
	* lib/krb5/krb5_set_default_realm.3: Manpage for
	krb5_free_host_realm, krb5_get_default_realm,
	krb5_get_default_realms, krb5_get_host_realm, and
	krb5_set_default_realm.
d518 5
a522 2
	* admin/ktutil.8: s/entype/enctype/, from Igor Sobrado
	<sobrado@@acm.org> via NetBSD
d524 1
a524 11
	* lib/krb5/krb5_keytab.3: add documention for krb5_kt_get_type
	
	* lib/krb5/keytab.c (krb5_kt_get_type): get prefix/type of keytab
	
	* lib/krb5/krb5.h (KRB5_KT_PREFIX_MAX_LEN): max length of prefix
	
	* lib/krb5/krb5_ccache.3: document krb5_cc_get_ops, add more
	types, add krb5_fcc_ops and krb5_mcc_ops
	
	* lib/krb5/cache.c (krb5_cc_get_ops): new function, return ops for
	a id
d526 1
a526 1
2003-03-15  Love Hrnquist strand  <lha@@it.su.se>
d528 1
a528 2
	* doc/intro.texi: add reference to source code, binaries and the
	manual
d530 2
a531 3
	* lib/krb5/krb5.3: krb5.h isn't in krb5 directory in heimdal
	
2003-03-14  Love Hrnquist strand  <lha@@it.su.se>
d533 3
a535 1
	* kdc/kdc.8: better/difrent english
d537 1
a537 3
	* kdc/kdc.8: . -> .\n, copyright/license
	
	* kdc/kdc.8: changed configuration file -> restart kdc
d539 1
a539 2
	* kdc/kerberos4.c: add krb4 into the most error messages written
	to the logfile
d541 1
a541 2
	* lib/krb5/krb5_ccache.3: add missing name of argument
	(krb5_context) to most functions
d543 1
a543 1
2003-03-13  Love Hrnquist strand  <lha@@it.su.se>
d545 1
a545 3
	* lib/krb5/kuserok.c (krb5_kuserok): preserve old behviour of
	function and return FALSE when there isn't a local account for
	`luser'.
d547 6
a552 2
	* lib/krb5/krb5_kuserok.3: fix prototype, spelling and more text
	describing the function
d554 2
a555 1
2003-03-12  Love Hrnquist strand  <lha@@it.su.se>
d557 1
a557 2
	* lib/krb5/cache.c (krb5_cc_default): if krb5_cc_default_name
	returned memory, don't return ENOMEM
d559 1
a559 1
2003-03-11  Love Hrnquist strand  <lha@@it.su.se>
d561 6
a566 8
	* lib/krb5/krb5.3: add krb5_address stuff and sort
	
	* lib/krb5/krb5_address.3: fix krb5_addr2sockaddr description
	
	* lib/krb5/Makefile.am (man_MANS): += krb5_address.3
	
	* lib/krb5/krb5_address.3: document types krb5_address and
	krb5_addresses and their helper functions
d568 3
a570 1
2003-03-10  Love Hrnquist strand  <lha@@it.su.se>
d572 1
a572 1
	* lib/krb5/Makefile.am (man_MANS): += krb5_kuserok.3
d574 1
a574 1
	* lib/krb5/krb5_kuserok.3: spelling, from cizzi@@it.su.se
d576 1
a576 1
	* lib/krb5/Makefile.am (man_MANS): += krb5_ccache.3
d578 1
a578 1
	* lib/krb5/krb5_ccache.3: spelling, from cizzi@@it.su.se
d580 1
a580 1
	* lib/krb5/krb5.3: add more functions
d582 4
a585 2
	* lib/krb5/krb5_ccache.3: document krb5_ccache and krb5_cc
	functions
d587 1
a587 4
	* lib/krb5/krb5_kuserok.3: document krb5_kuserok
	
	* lib/krb5/krb5_verify_user.3: document
	krb5_verify_opt_set_flags(opt, KRB5_VERIFY_LREALMS) behavior
d589 19
a607 2
	* lib/krb5/krb5_verify_user.3: document krb5_verify_opt* and
	krb5_verify_user_opt
d609 1
a609 1
	* lib/krb5/*.[0-9]: add copyright/licenses on more manpages
d611 2
a612 2
	* kuser/kdestroy.c (main): handle that krb5_cc_default_name can
	return NULL
d614 2
a615 2
	* lib/krb5/Makefile.am (libkrb5_la_LDFLAGS): bump minor
	(TESTS): add test_cc
d617 1
a617 3
	* lib/krb5/test_cc.c: test some
	krb5_cc_default_name/krb5_cc_set_default_name combinations
	
d619 22
a640 2
	default_cc_name to NULL
	(krb5_free_context): free default_cc_name if set
d642 2
a643 2
	* lib/krb5/cache.c (krb5_cc_set_default_name): new function
	(krb5_cc_default_name): use krb5_cc_set_default_name
d645 61
a705 1
	* lib/krb5/krb5.h (krb5_context_data): add default_cc_name
d707 45
a751 1
2003-02-25  Love Hrnquist strand  <lha@@it.su.se>
d753 141
a893 3
	* appl/kf/kf.1: s/securly/securely/ from NetBSD
	
2003-02-18  Love Hrnquist strand  <lha@@it.su.se>
d895 3
a897 2
	* kdc/connect.c: s/intialize/initialize, from
	<jmc@@prioris.mini.pw.edu.pl>
d899 1
a899 1
2003-02-17  Love Hrnquist strand  <lha@@it.su.se>
d901 2
a902 3
	* configure.in: add AM_MAINTAINER_MODE
	
2003-02-16  Love Hrnquist strand  <lha@@it.su.se>
d904 3
a906 1
	* **/*.[0-9]: add copyright/licenses on all manpages
d908 1
a908 1
2003-14-16  Jacques Vidrine  <nectar@@kth.se>
d910 2
a911 3
	* lib/krb5/get_in_tkt.c (init_as_req): Send only a single
	PA-ENC-TIMESTAMP in the AS-REQ, using the first encryption
	type specified by the KDC.
d913 1
a913 1
2003-02-15  Love Hrnquist strand  <lha@@it.su.se>
d915 2
a916 6
	* fix-export: some autoconf put their version number in
	autom4te.cache, so remove autom4te*.cache
	
	* fix-export: make sure $1 is a directory
	
2003-02-04  Love Hrnquist strand  <lha@@it.su.se>
d918 1
a918 1
	* kpasswd/kpasswdd.8: spelling, from jmc <jmc@@prioris.mini.pw.edu.pl>
d920 1
a920 3
	* kdc/kdc.8: spelling, from jmc <jmc@@prioris.mini.pw.edu.pl>
	
2003-01-31  Love Hrnquist strand  <lha@@it.su.se>
d922 2
a923 1
	* kdc/hpropd.8: s/databases/a database/ s/Not/not/
d925 1
a925 3
	* kdc/hprop.8: add missing .
	
2003-01-30  Love Hrnquist strand  <lha@@it.su.se>
d927 2
a928 4
	* lib/krb5/krb5.conf.5: documentation for of boolean, etypes,
	address, write out encryption type in sentences, s/Host/host
	
2003-01-26  Love Hrnquist strand  <lha@@it.su.se>
d930 1
a930 3
	* lib/asn1/check-gen.c: add checks for Authenticator too
	
2003-01-25  Love Hrnquist strand  <lha@@it.su.se>
d932 2
a933 2
	* doc/setup.texi: in the hprop example, use hprop and the first
	component, not host
d935 2
a936 3
	* lib/krb5/get_addrs.c (find_all_addresses): address-less
	point-to-point might not have an address, just ignore
	those. Reported by Harald Barth.
d938 2
a939 1
2003-01-23  Love Hrnquist strand  <lha@@it.su.se>
d941 1
a941 2
	* lib/krb5/verify_krb5_conf.c (check_section): when key isn't
	found, don't print out all known keys
d943 1
a943 3
	* lib/krb5/verify_krb5_conf.c (syslogvals): mark up where severity
	and facility start resp
	(check_log): find_value() returns -1 when key isn't found
d945 1
a945 4
	* lib/krb5/crypto.c (_krb5_aes_cts_encrypt): make key argument a
	'const void *' to avoid AES_KEY being exposed in krb5-private.h
	
	* lib/krb5/krb5.conf.5: add [kdc]use_2b
d947 2
a948 10
	* kdc/524.c (encode_524_response): its 2b not b2
	
	* doc/misc.texi: quote @@ where missing
	
	* lib/asn1/Makefile.am: add check-gen
	
	* lib/asn1/check-gen.c: add Principal check
	
	* lib/asn1/check-common.h: move generic asn1/der functions from
	check-der.c to here
d950 2
a951 2
	* lib/asn1/check-common.c: move generic asn1/der functions from
	check-der.c to here
d953 4
a956 2
	* lib/asn1/check-der.c: move out the generic asn1/der functions to
	a common file
d958 5
a962 1
2003-01-22  Love Hrnquist strand  <lha@@it.su.se>
d964 1
a964 2
	* doc/misc.texi: more text about afs, how to get get your KeyFile,
	and how to start use 2b tokens
d966 1
a966 4
	* lib/krb5/krb5.conf.5: spelling, from Jason McIntyre
	<jmc@@cvs.openbsd.org>
	
2003-01-21  Jacques Vidrine  <nectar@@kth.se>
d968 1
a968 2
	* kuser/kuser_locl.h: include crypto-headers.h for
	des_read_pw_string prototype
d970 2
a971 1
2003-01-16  Love Hrnquist strand  <lha@@it.su.se>
d973 1
a973 1
	* admin/ktutil.8: document -v, --verbose
d975 1
a975 2
	* admin/get.c (kt_get): make getarg usage consistent with other
	other parts of ktutil
d977 1
a977 4
	* admin/copy.c (kt_copy): remove adding verbose_flag to args
	struct, since it will overrun the args array (from Sumit Bose)
	
2003-01-15  Love Hrnquist strand  <lha@@it.su.se>
d979 1
a979 2
	* lib/krb5/krb5.conf.5: write more about [realms] REALM = { kdc =
	... }
d981 2
a982 3
	* lib/krb5/aes-test.c: test vectors in aes-draft
	
	* lib/krb5/Makefile.am: add aes-test.c
d984 1
a984 21
	* lib/krb5/crypto.c: Add support for AES
	(draft-raeburn-krb-rijndael-krb-02), not enabled by default.
	(HMAC_SHA1_DES3_checksum): rename to SP_HMAC_SHA1_checksum and modify
	to support checksumtype that are have a shorter wireformat then
	their output block size.
	
	* lib/krb5/crypto.c (struct encryption_type): split the blocksize
	into blocksize and padsize, padsize is the minimum padding
	size. they are the same for now
	(enctype_*): add padsize
	(encrypt_internal): use padsize
	(encrypt_internal_derived): use padsize
	(wrapped_length): use padsize
	(wrapped_length_dervied): use padsize

	* lib/krb5/crypto.c: add extra `opaque' argument to string_to_key
	function for each enctype in preparation enctypes that uses
	`Encryption and Checksum Specifications for Kerberos 5' draft
	
	* lib/asn1/k5.asn1: add checksum and enctype for AES from
	draft-raeburn-krb-rijndael-krb-02.txt
d986 1
a986 2
	* lib/krb5/krb5.h (krb5_keytype): add KEYTYPE_AES128,
	KEYTYPE_AES256
d988 2
a989 1
2003-01-14  Love Hrnquist strand  <lha@@it.su.se>
d991 1
a991 2
	* lib/hdb/common.c (_hdb_fetch): handle error code from
	hdb_value2entry
d993 3
a995 2
	* kdc/Makefile.am: always include kerberos4.c and 524.c in
	kdc_SOURCES to support 524
d997 1
a997 1
	* kdc/524.c: always compile in support for 524
d999 7
a1005 12
	* kdc/kdc_locl.h: move out krb/524 protos from under #ifdef KRB4
	
	* kdc/config.c: always compile in support for 524
	
	* kdc/connect.c: always compile in support for 524
	
	* kdc/kerberos4.c: export encode_v4_ticket() and get_des_key()
	even when we build without kerberos 4, 524 needs them
	
	* lib/krb5/convert_creds.c, lib/krb5/krb5-v4compat.h: Split out
	Kerberos 4 help functions/structures so other parts of the source
	tree can use it (like the KDC)
@


1.1.1.5
log
@Import of heimdal-0.6, released earlier today.
@
text
@a0 37
2003-05-08  Johan Danielsson  <joda@@ratatosk.pdc.kth.se>

	* Release 0.6

2003-05-08  Love Hrnquist strand  <lha@@it.su.se>

	* kuser/klist.c: 1.68->1.69: print tokens even if there isn't v4
	support

	* kuser/kdestroy.c: 1.14->1.15: destroy tokens even if there isn't
	v4 support

	* kuser/kinit.c: 1.90->1.91: print tokens even if there isn't v4
	support

2003-05-06  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/name-45-test.c: need to use empty krb5.conf for some
	tests

	* lib/asn1/check-gen.c: there is no \e escape sequence; replace
	everything with hex-codes, and cast to unsigned char* to make some
	compilers happy

2003-05-06  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/get_in_tkt.c (make_pa_enc_timestamp): make sure first
	argument to krb5_us_timeofday have correct type
	
2003-05-05  Assar Westerlund  <assar@@kth.se>

	* include/make_crypto.c (main): include aes.h if ENABLE_AES

2003-05-05  Love Hrnquist strand  <lha@@it.su.se>

	* NEWS: 1.108->1.110: fix text about gssapi compat
	
@


1.1.1.6
log
@Import of heimdal-0.6.3
@
text
@a0 343
2004-09-13  Johan Danielsson  <joda@@pdc.kth.se>

	* Release 0.6.3
	
2004-09-05  Love Hrnquist strand  <lha@@it.su.se>

	* lib/asn1/der_get.c (decode_enumerated): check that the tag
	length isn't longer the the length

2004-08-31  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/init_creds_pw.c (krb5_get_init_creds_password):
	kdc_reply can be set in case of failure too, clean on entry and
	free the exit unconditionally to avoid memory leak
	
2004-08-20  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/context.c: 1.93: (krb5_get_err_text): if neither of
	com_right nor strerror finds the error-code, return Unknown error.

2004-08-13  Love Hrnquist strand  <lha@@it.su.se>

	* kdc/kerberos5.c: based on 1.162: (get_pa_etype_info): check for
	dup enctypes from the client and filter them out.
	
2004-06-21  Love Hrnquist strand  <lha@@it.su.se>

	* admin/get.c: 1.23: (kt_get): catch errors from krb5_parse_name
	
2004-06-21  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/Makefile.am: man_MANS += krb5_set_password.3
	
	* lib/krb5/krb5_set_password.3: 1.1-1.3: change password manpage
	
	* lib/krb5/changepw.c: 1.49: implement
	krb5_set_password_using_ccache 1.47: add tcp support to the set
	protocol, should be cleaned up to enable sharing code with
	krb5_sendto 1.46: (process_reply): log into result_string if
	something goes bad, return 0 (even on failure), not the KPASSWD
	protocol error code 1.45: krb5_princ_realm ->
	krb5_principal_get_realm 1.44: (setpw_send_request): free
	ap_req_data on failure 1.41: ooops, remove cut and paste error
	1.40: draft-ietf-cat-kerb-chg-password-02 and rfc3244 share the
	response packet sure more constants now that they exists 1.39:
	implement rfc3244, partly from shadow@@dementia.org
	
	* lib/krb5/krb5.h: 1.211: some defines for rfc3244
	
	* lib/asn1/Makefile.am: 1.71: (gen_files):
	asn1_ChangePasswdDataMS.x for RFC3244
	
	* lib/asn1/k5.asn1: 1.30: add ChangePasswdDataMS, for RFC3244
	
	* kuser/kinit.c: 1.114: move "setpag if (argc < 1)" to common path
	
2004-05-06  Johan Danielsson  <joda@@pdc.kth.se>

	* Release 0.6.2

2004-04-02  Love Hrnquist strand  <lha@@it.su.se>

	* kdc/connect.c: case size_t to unsigned long for LP64 platforms
	
2004-04-01  Johan Danielsson  <joda@@pdc.kth.se>

	* Release 0.6.1

2004-03-30  Love Hrnquist strand  <lha@@it.su.se>

	* kdc/kerberos4.c: 1.46: stop the client from renewing tickets
	into the future From: Jeffrey Hutzelman <jhutz@@cmu.edu>
	
2004-03-10  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/fcache.c: 1.43: (fcc_store_cred): NULL terminate
	krb5_config_get_bool_default' arglist
	
2004-03-09  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/krb5.conf.5: 1.44: document
	[libdefaults]fcc-mit-ticketflags=boolean 1.43: don't use path's in
	first .Nm, it confuses some locate.updatedb, use FILES section to
	describe where the file is instead.
	
	* lib/krb5/fcache.c (fcc_store_cred): default to use old format
	
	* lib/krb5/fcache.c: 1.42: (fcc_store_cred): use
	[libdefaults]fcc-mit-ticketflags=boolean to decide what format to
	write the fcc in. Default to mit format (aka heimdal 0.7 format)
	1.41: (_krb5_xlock): handle that everything was ok, and don't put
	an error in the error strings then
	
	* lib/krb5/store.c: 1.43: add _krb5_store_creds_heimdal_0_7 and
	_krb5_store_creds_heimdal_pre_0_7 that store the creds in just
	that format make krb5_store_creds default to mit format 1.42:
	(krb5_ret_creds): Runtime detect the what is the higher bits of
	the bitfield 1.41: (krb5_store_creds): add disabled code that
	store the ticket flags in reverse order (bitswap32): new function
	1.40: (krb5_ret_creds): if the higher ticket flags are set, its a
	mit cache, reverse the bits, bug pointed out by Sergio Gelato
	<Sergio.Gelato@@astro.su.se>
	
	delta modfied to not change the behavior of krb5_store_creds
	
2004-03-07  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/mk_safe.c (krb5_mk_safe): fix assignment of usec2
	
2004-03-06  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/mcache.c: patch based on 1.17 and 1.18 but with
	threading code pulled out;
	
	1.18: (mcc_get_principal): also check for primary_principal ==
	NULL now that that isn't used as dead flag 1.17: don't overload
	the primary_principal == NULL as dead since that doesn't always
	work Based on patch from Jeffrey Hutzelman <jhutz@@cmu.edu>, but
	tweek by me

	* lib/krb5/crypto.c: 1.94: (decrypt_internal_special): do not not
	modify the original data test case from Ronnie Sahlberg
	<ronnie_sahlberg@@ozemail.com.au>

2004-02-13  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/verify_krb5_conf.c: 1.22->1.23: (check_host): don't
	check for EAI_NODATA, because its depricated in RFC3493 Pointed
	out by Hajimu UMEMOTO <ume@@mahoroba.org> on heimdal-discuss
	
	* lib/krb5/eai_to_heim_errno.c: 1.3->1.4: EAI_ADDRFAMILY and
	EAI_NODATA is deprecated in RFC3493

2004-02-09  Love Hrnquist strand  <lha@@it.su.se>

	* lib/asn1/der_length.c: 1.16: Fix len_unsigned for certain
	negative integers, it got the length wrong, fix from Panasas, Inc.
	
	* lib/asn1/der_locl.h: 1.5: add _heim_len_unsigned, _heim_len_int
	
2004-01-26  Love Hrnquist strand  <lha@@it.su.se>

	* lib/asn1/gen_length.c: 1.14: (length_type): TSequenceOf: add up
	the size of all the elements, don't use just the size of the last
	element.

	* lib/krb5/fcache.c: 1.40: (_krb5_xlock): catch EINVAL and assume
	that it means that the filesystem doesn't support locking 1.39:
	(_krb5_xlock): fix compile error in last commit 1.38: internally
	export x{,un}lock and thus prefix them with _krb5_
	
2004-01-13  Love Hrnquist strand  <lha@@it.su.se>

	* kuser/kinit.c: 1.106: (renew_validate): if renewable_flag and
	not time specifed, use "1 month"
	1.105: make -9 work again

2004-01-09  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/get_for_creds.c: 1.36: (add_addrs): don't increase
	addr->len until in contains interesting data, use right iteration
	counter when clearing the addresses 1.39: krb5_princ_realm ->
	krb5_principal_get_realm 1.38: (krb5_get_forwarded_creds): use
	KRB5_AUTH_CONTEXT_DO_TIME if we want timestamp in forwarded
	krb-cred 1.39: (krb5_get_forwarded_creds): If tickets are
	address-less, forward address-less tickets.  1.40:
	(krb5_get_forwarded_creds): try to handle errors better for
	previous commit 1.41: (add_addrs): don't add same address multiple
	times
	
	* lib/krb5/get_cred.c: 1.96->1.97: rename get_krbtgt to
	_krb5_get_krbtgt and export it

2003-12-14  Love Hrnquist strand  <lha@@it.su.se>

	* kdc/kerberos5.c: part of 1.146->1.147: handle NULL client/server
	names

2003-12-03  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/crypto.c: 1.90->1.91: require cipher-text to be padded
	to padsize 1.91->1.92: (decrypt_internal_derived): move up padsize
	check to avoid memory leak
	
2003-12-01  Love Hrnquist strand  <lha@@it.su.se>

	* kuser/kinit.c: 1.103->1.104: (main): return the return value
	from simple_execvp

2003-10-22  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/transited.c: 1.13->1.14: (krb5_domain_x500_encode):
	always zero out encoding to make sure it have a defined value on
	failure

	* lib/krb5/transited.c: 1.12->1.13: (krb5_domain_x500_encode): if
	num_realms == 0, set encoding and return (avoids malloc(0)) check
	return value from malloc
	
2003-10-21  Love Hrnquist strand  <lha@@it.su.se>

	* doc/setup.texi: 1.35->1.36: spelling
	
	* kdc/kdc_locl.h: 1.58->1.59: add flag to always check transited
	policy

	* doc/setup.texi: 1.27->1.35: many changes
	
	* lib/krb5/get_cred.c: 1.95->1.96: get capath info from [capaths]
	section

	* lib/krb5/rd_req.c: 1.50->1.51: (krb5_decrypt_ticket): try to
	verify transited realms, unless the transited-policy-checked flag
	is set

	* lib/krb5/transited.c:
	1.12: (krb5_domain_x500_decode): set *num_realms to zero not num_realms
	1.11: (krb5_domain_x500_decode): handle zero length tr data;
	(krb5_check_transited): new function that does more useful stuff

	* kdc/kdc.8: 1.23->1.24: document enforce-transited-policy
	
	* kdc/config.c: 1.47->1.48: add flag to always check transited
	policy

	* kdc/kerberos5.c:
	1.150: (fix_transited_encoding): also verify with policy,
	unless asked not to
	1.151: always check transited policy if flag set either globally
	(on principal part of patch not pulled up)
	1.152: (fix_transited_encoding): set transited type
	1.153: (fix_transited_encoding): always print cross-realm information

2003-10-06  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/config_file.c: 1.48->1.49:
	(krb5_config_parse_file_debug): punt if there is binding before a
	section declaration.
	Bug found by Arkadiusz Miskiewicz <arekm@@pld-linux.org>

	* kdc/kaserver.c: 1.21->1.23:
	(do_getticket): if times data is shorter then 8 bytes, request is
	malformed.
	(do_authenticate): if request length is less then 8 bytes, its a
	bad request and fail. Pointed out by Marco Foglia <marco@@foglia.org>

2003-09-22  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/verify_krb5_conf.c: 1.17->1.18: add missing " within
	#if 0 From: stefan sokoll <stefansokoll@@yahoo.de>
	
2003-09-19  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/rd_req.c:
	1.47->1.48: (krb5_rd_req): allow caller to pass in a key
	in the auth_context, they way processes that doesn't use the
	keytab can still pass in the key of the service (matches behavior
	of MIT Kerberos).
	
2003-09-18  Love Hrnquist strand  <lha@@it.su.se>
	
	* lib/krb5/crypto.c: 
	1.87->1.88: (usage2arcfour): simplify, only
	include special cases From: Luke Howard <lukeh@@PADL.COM>
	1.86->1.87: (arcfour_checksum_p): return true when is arcfour,
	not when its not pointed out by Luke Howard
	1.82->1.83: Do the arcfour checksum mapping for
	krb5_create_checksum and krb5_verify_checksum, From: Luke Howard
	<lukeh@@PADL.COM>
	1.81->1.82: (hmac): make it return an error
	when out of memory, update callsites to either return error or use
	krb5_abortx
	(krb5_hmac): expose hmac
	* lib/krb5/mk_req_ext.c: 1.26->1.27: (krb5_mk_req_internal):
	when using arcfour-hmac-md5, use an unkeyed checksum
	(rsa-md5), since Microsoft calculates the keyed checksum with
	the subkey of the authenticator.

	* lib/krb5/get_cred.c:
	1.93->1.94 (init_tgs_req): make generation of subkey
	optional on configuration parameter
	[realms]realm={tgs_require_subkey=bool}
	defaults to off. The RFC1510 weakly defines the correct behavior,
	so old DCE secd apparently required the subkey to be there, and MS
	will use it when its there. But the request isn't encrypted in the
	subkey, so you get to choose if you want to talk to a MS mdc or a
	old DCE secd.

	partly 1.91->1.92: (init_tgs_req): in case of error, don't
	free in	the req_body addresses since they where pass in by caller

	lib/krb5/get_in_tkt.c:
	1.108->1.1.09: (krb5_get_in_tkt): for compatibility with with
	the mit implemtation, don't free `creds' argument when done, its up
	the the caller to do that, also allow a NULL ccache.

	* doc/ack.texi
	1.16->1.17: update Luke Howard email address

	* lib/hdb/hdb-ldap.c:
	1.13->1.14: code rewrite from Luke Howard <lukeh@@PADL.COM>
	1.12->1.13: (LDAP_store): log what principal/dn failed
	1.11->1.12: use int2HDBFlags/HDBFlags2int
	From: Alberto Patino <jalbertop@@aranea.com.mx>, 
	Luke Howard <lukeh@@PADL.COM>
	Pointed out by Andrew Bartlett of Samba
	1.10->1.11: (LDAP__connect): bind sasl "EXTERNAL" to ldap connection
	(LDAP_store): remove superfluous argument to asprintf
	From Alberto Patino <jalbertop@@aranea.com.mx>

	* lib/krb5/krb5.h:
	1.214->1.2015: add KEYTYPE_ARCFOUR_56
	
2003-09-12  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/config_file.c: fix prototypes Fredrik Ljungberg
	<flag@@pobox.se>
	
2003-09-11  Love Hrnquist strand  <lha@@it.su.se>

	* lib/hdb/hdb_locl.h: 1.18->1.19: include <limits.h> for ULONG_MAX
	noted by Wissler Magnus <M.Wissler@@abalon.se> on heimdal-discuss
	
2003-08-29  Love Hrnquist strand  <lha@@it.su.se>

	* lib/hdb/db3.c: 1.8->1.9: patch for working with DB4 on
	heimdal-discuss From: Luke Howard <lukeh@@PADL.COM> 1.9->1.10: try
	to include more db headers
	
2003-08-25  Love Hrnquist strand  <lha@@it.su.se>

	* kdc/connect.c: 1.92->1.93 (handle_tcp): handle recvfrom
	returning 0 (connection closed) 1.91->1.92: (grow_descr):
	increment the size after we succeed to allocate the space
	
2003-08-15  Love Hrnquist strand  <lha@@it.su.se>

	* lib/krb5/principal.c: 1.83->1.85: (unparse_name): len can't be
	zero, so, don't check for that
	(unparse_name): make sure there are space for a NUL, set *name to NULL
	when there is a failure (so caller can't get hold of a freed
	pointer)

@


1.1.1.7
log
@Import of heimdal-0.7.2
@
text
@d1 1
a1 1
2006-02-03  Love Hörnquist Åstrand  <lha@@it.su.se>
d3 6
a8 1
	* Release 0.7.2
d10 5
a14 1
	* lib/krb5/Makefile.am: install krb5_set_password.3
d16 1
a16 1
	* tools/krb5-config.in: Depend on LIB_dlopen
d18 2
a19 1
	* tools/Makefile.am: Depend on LIB_dlopen
d21 1
a21 2
	* lib/krb5/rd_req.c: 1.60: (krb5_verify_ap_re2): check timestamp
	in authenticator
d23 4
a26 3
	* kcm/connect.c: 1.18: (kcm_loop): Use HAVE_DOOR_CREATE, not
	HAVE_DOORS.  1.17: (update_client_creds): in case there is no
	UCRED_VERSION, skip LOCAL_PEERCRED
d28 1
a28 3
	* lib/krb5/keytab_memory.c: 1.8: (mkt_remove_entry): realloc can
	return NULL on success in the case 0 entries are allocated, From
	Andrew Bartlet
d30 1
a30 1
2005-11-02  Love Hörnquist Åstrand  <lha@@it.su.se>
d32 1
a32 1
	* kcm/headers.h: 1.7: Maybe include <sys/param.h>.
d34 1
a34 1
2005-10-30  Love Hörnquist Åstrand  <lha@@it.su.se>
d36 11
a46 1
	* configure.in: 1.378: Check for <sys/ucred.h>.
d48 1
a48 2
	* kcm/headers.h: 1.6: Maybe include <sys/param.h>.  1.5: include
	<sys/ucred.h>
d50 2
a51 4
2005-10-26  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/krb5_encrypt.3: 1.16: Fix mdoc for
	krb5_encrypt_EncryptedData, Johnny Lam <jlam@@pkgsrc.org>
d53 1
a53 5
2005-10-22  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/rd_cred.c: 1.26: (krb5_rd_cred): try both the session
	key and the sender subkey. Both RFC1510 and RFC4120 say that you
	have to use the session key, Heimdal uses subkey.
d55 1
a55 5
2005-10-21  Love Hörnquist Åstrand  <lha@@it.su.se>

	* kcm/connect.c: 1.16: * kcm/connect.c: fix arguments to kcm_log()
	when reporting sendmsg() error * kcm/connect.c: don't send socket
	address in msghdr, it returns an already connected error on Linux
d57 1
a57 1
2005-10-12  Love Hörnquist Åstrand  <lha@@it.su.se>
d59 1
a59 1
	* lib/krb5/init_creds_pw.c: Rename private to opt_private.
d61 1
a61 1
	* lib/krb5/init_creds.c: Rename private to opt_private.
d63 1
a63 3
	* lib/krb5/krb5.h: 1.238: (krb5_get_init_creds_opt): rename
	element private to opt_private to make c++ picky compilers less
	upset.
d65 1
a65 3
2005-09-09  Love Hörnquist Åstrand  <lha@@it.su.se>
	
	* Release 0.7.1
d67 1
a67 2
	* lib/krb5/kuserok.c: 1.14: (check_directory): use passed
	directory name
d69 1
a69 1
2005-08-11  Love Hörnquist Åstrand  <lha@@it.su.se>
d71 4
a74 3
	* lib/krb5/crypto.c: 1.124: (wrapped_length): the underived
	encrypted types checksum are all unkeyed (matches the code in
	encrypt_internal() and encrypt_internal_special())
d76 4
a79 1
2005-08-09  Love Hörnquist Åstrand  <lha@@it.su.se>
d81 26
a106 4
	* lib/hdb/db3.c: 1.16: (DB_open): catch errors from the d->open
	calls instead of letting them slip though to d->cursor. Bug
	repport from Andrew Bartlett <abartlet@@samba.org> 1.15: (DB_open):
	in case of error, close database
d108 3
a110 28
2005-08-08  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/hdb/mkey.c (hdb_seal_key_mkey): if mknvo isn't set, the
	caller want the latest mkvno, go search for it.

2005-07-26  Love Hörnquist Åstrand  <lha@@it.su.se>

	* kdc/524.c: 1.32: Always include <krb5-v4compat.h>.

2005-07-13  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/get_cred.c: 1.108: (krb5_get_credentials_with_flags):
	only call krb5_cc_retrieve_cred once, and plug memory leak.

	* lib/krb5/rd_cred.c (krb5_rd_cred): don't leak memory

2005-06-15  Love Hörnquist Åstrand  <lha@@it.su.se>

	* Release 0.7

	* kdc/kerberos5.c (make_etype_info2_entry): NUL terminate the
	string

	* lib/krb5/cache.c: 1.70: (_krb5_expand_default_cc_name): replace
	strndup with inline copy

	* kdc/kerberos5.c: 1.176: replace strndup with inline copy, free
	data on failure
d112 2
a113 4
2005-06-14  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/Makefile.am: TESTS += test_mem libkrb5_la_SOURCES +=
	kcm.h
d115 5
a119 20
	* kuser/kinit.c (main): catch KRB5_CONFIG_BADFORMAT from
	krb5_init_context

	* kdc/main.c (main): catch KRB5_CONFIG_BADFORMAT from
	krb5_init_context

	* lib/krb5/verify_krb5_conf.c (main): catch KRB5_CONFIG_BADFORMAT
	from krb5_init_context From: Mathias Feiler
	<feiler@@uni-hohenheim.de>

	* lib/krb5/verify_krb5_conf.c: Add more missig entires, from
	Mathias Feiler <feiler@@uni-hohenheim.de>

2005-06-11  Love Hörnquist Åstrand  <lha@@it.su.se>

	* kdc/pkinit.c (pk_principal_from_X509): remember to free
	KRB5PrincipalName

	* lib/krb5/log.c (krb5_closelog): free all content in
	krb5_log_facility
d121 3
a123 1
2005-06-08  Love Hörnquist Åstrand  <lha@@it.su.se>
d125 1
a125 1
	* kdc/524.c: init kvno to please gcc
d127 3
a129 6
	* kdc/kaserver.c (do_authenticate): check return value from
	unparse_auth_args

2005-06-07  Dave Love  <fx@@gnu.org>

	* doc/setup.texi: Spelling.
d131 2
a132 9
	* doc/programming.texi: Spelling.

2005-06-02  Dave Love  <fx@@gnu.org>

	* kcm/connect.c (kcm_door_server): Make static.

	* kcm/kcm_locl.h (disallow_getting_krbtgt): Declare.

2005-06-02  Love Hörnquist Åstrand  <lha@@it.su.se>
d134 1
a134 2
	* kdc/mit_dump.c (mit_prop_dump): cast argument to
	krb5_parse_principal to avoid warning
d136 2
a137 10
	* kdc/mit_dump.c: rename KRB5_TL_MOD_PRINC to
	mit_KRB5_TL_MOD_PRINC to hint its a constant originating from mit
	codebase

2005-06-01  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/store.c: If we are allocating 0 entires, avoid failing
	if ALLOC returns NULL

	* lib/krb5/verify_krb5_conf.c: Check for [kdc]v4-realm
d139 1
a139 12
	* lib/krb5/cache.c: When returning a new error code, set error
	string.

2005-05-31  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/keytab_file.c: Adapt to changed signature of
	_krb5_xunlock, clear more error string where needed.

	* lib/krb5/fcache.c (_krb5_xunlock): catch the error and turn it
	into something sensable

2005-05-30  Love Hörnquist Åstrand  <lha@@it.su.se>
d141 1
a141 2
	* kdc/kerberos5.c (tgs_make_reply): copy ok-as-delegate flag from
	server entry to encrypted ticket flags
d143 3
a145 1
2005-05-30  Johan Danielsson  <joda@@pdc.kth.se>
d147 4
a150 5
	* kdc/connect.c: rename sendlength to prependlength (which
	hopefully better represents its purpose), and change type to
	krb5_boolean

	* kdc/connect.c: log signal causing exit
d152 1
a152 6
	* kdc/main.c (sigterm): set exit_flag to signal causing exit;
	(main): trap SIGXCPU

2005-05-30  Love Hörnquist Åstrand  <lha@@it.su.se>

	* kcm/kcm.8: document --disallow-getting-krbtgt and --door-path
d154 3
a156 2
	* kcm/protocol.c (kcm_op_retrieve): check server for krbtgt, not
	client
d158 1
a158 1
	* kcm/main.c: ignore SIGPIPE
d160 10
a169 2
	* kcm/protocol.c: Add option to disallow getting krbtgt out from
	from KCM. KCM will do the fetching part itself.
d171 2
a172 2
	* kcm/config.c: Add option to disallow getting krbtgt out from
	from KCM. KCM will do the fetching part itself.
d174 1
a174 1
2005-05-30  Luke Howard <lukeh@@padl.com>
d176 2
a177 2
	* kcm/events.c: if credentials have expired when attempting
	to renew, attempt to reacquire them using initial creds
d179 1
a179 1
2005-05-29  Love Hörnquist Åstrand  <lha@@it.su.se>
d181 3
a183 1
	* lib/krb5/krb5_principal.3: Spelling, from Björn Sandell
d185 1
a185 1
	* doc/setup.texi: spelling, from Björn Sandell
d187 2
a188 3
	* lib/krb5/name-45-test.c: XXX don't run the test unless the
	machine is in kth.se or su.se because it depends on local resolver
	configuration.
d190 1
a190 2
	* lib/hdb/hdb.c: provde RTLD_NOW and RTLD_GLOBAL if they don't
	exists
d192 3
a194 1
	* kcm/connect.c: fix doors support, fix signedness warnings
d196 3
a198 1
	* kcm/config.c: add --door-path=
d200 1
a200 11
	* configure.in: comment what the "detect doors on solaris"
	fragment tries to do

	* kcm/acquire.c (generate_random_pw): fix signed-ness warnings

	* kcm/connect.c (update_client_creds): fix compile error in the
	getpeerucred case

	* lib/krb5/test_cc.c: change format for expantion variables in
	default_cc_name to %{variable} to not confuse them with shell
	ditto
d202 1
a202 5
	* kcm/headers.h: Maybe include <door.h>.

	* kcm/kcm_locl.h: add extern door_path;

	* configure.in: detect doors using door_create
d204 2
a205 7
	* kcm/Makefile.am: add dependcy on kcm_protos.h add lib depency on
	LIB_door_create

	* lib/krb5/kcm.h: add _PATH_KCM_DOOR, default path to kcm door

	* lib/krb5/kcm.c: use [libdefaults]kcm_door to find the door to
	kcm
d207 1
a207 1
	* lib/krb5/Makefile.am: libkrb5_la_LIBADD += LIB_door_create
d209 2
a210 2
	* lib/krb5/krb5_locl.h: Maybe include <sys/mman.h>, maybe include
	<door.h>.
d212 3
a214 2
	* lib/krb5/kcm.c (kcm_send_request): add support for doing a door
	call to kcm
d216 4
a219 2
	* lib/asn1: prefix Der_class with ASN1_C_ to avoid problems with
	system headerfiles that pollute the name space
d221 1
a221 11
	* kcm/kcm.8: change format for expantion variables in
	default_cc_name to %{variable} to not confuse them with shell
	ditto

	* lib/krb5/krb5.conf.5: change format for expantion variables in
	default_cc_name to %{variable} to not confuse them with shell
	ditto

	* lib/krb5/cache.c (_krb5_expand_default_cc_name): change format
	for expantion variables to %{variable} to not confuse them with
	shell ditto
d223 2
a224 1
	* kcm/connect.c: add LOCAL_PEERCRED and experimental doors support
d226 7
a232 1
2005-05-27  Love Hörnquist Åstrand  <lha@@it.su.se>
d234 1
a234 1
	* appl/kf/kfd.c: case uid_t to unsigned long in printf format
d236 4
a239 1
2005-05-25  Love Hörnquist Åstrand  <lha@@it.su.se>
d241 5
a245 1
	* lib/krb5/krb5_auth_context.3: remove trailing space
d247 1
a247 1
2005-05-24  Love Hörnquist Åstrand  <lha@@it.su.se>
d249 2
a250 3
	* kcm/connect.c (do_request): use sendmsg to send the reply
	
	* fix-export: add make_proto for kcm/kcm_protos.h
d252 1
a252 18
	* kcm/kcm_locl.h: remove prototypes and add <kcm_protos.h>

	* kcm/Makefile.am (kcm_SOURCES): add headerfiles
	(kcm_protos.h): generate prototypes

	* kcm/protocol.c: fix error in last commit, use right function

	* kcm/headers.h: include <ucred.h> if we have getpeerucred

	* configure.in: check for functions getpeerucred and getpeereid

	* kcm/connect.c (update_client_creds): add support for
	getpeerucred and getpeereid

	* lib/krb5/kcm.c (kcm_alloc): allow kcm socket to be configured by
	[libdefaults]kcm_socket=/path

2005-05-24  David Love  <fx@@gnu.org>
d254 5
a258 12
	* kcm/kcm.8: KRB5CCNAME needs an literal uid, not ${uid}, spelling

2005-05-23  Love Hörnquist Åstrand  <lha@@it.su.se>

	* kcm/protocol.c: Merge the description and function jumptables
	into one structure.  Use the length of the array when checking if
	opcode is value, not a constant.

	* kcm/kcm_locl.h: struct kcm_op: jumptable structure

	* kcm/main.c: move declaration of detach_from_console away from
	here to kcm_locl.h, Don't test HAVE_DAEMON since roken supplies it.
d260 1
a260 1
	* kcm/kcm_locl.h: move declaration of detach_from_console here
d262 16
a277 3
	* kdc/config.c: Don't test HAVE_DAEMON since roken supplies it.
	
2005-05-23  Dave Love  <fx@@gnu.org>
d279 9
a287 1
	* kcm/config.c: Don't test HAVE_DAEMON since roken supplies it.
d289 2
a290 1
	* kdc/main.c: Don't test HAVE_DAEMON since roken supplies it.
d292 4
a295 1
2005-05-23  Love Hörnquist Åstrand  <lha@@it.su.se>
d297 2
a298 1
	* lib/krb5/krb5_keytab.3: document WRFILE and JAVA14
d300 10
a309 1
2005-05-20  Love Hörnquist Åstrand  <lha@@it.su.se>
d311 4
a314 2
	* lib/krb5/krbhst.c (srv_get_hosts): if srv_get_hosts failes,
	return and ignore the error
d316 2
a317 2
	* lib/krb5/krbhst.c (srv_find_realm): make sure `res' and `count'
	have good values
d319 4
a322 1
	* lib/krb5/test_keytab.c: tests all keytab format
d324 1
a324 1
2005-05-19  Love Hörnquist Åstrand  <lha@@it.su.se>
d326 5
a330 9
	* lib/krb5/pkinit.c (_krb5_pk_rd_pa_reply): non non asn1 decoding
	errors, fail. Make sure we free memory on error.
	(pk_verify_chain_standard): make sure we provide good errors.

	* lib/krb5/verify_krb5_conf.c: add missing options, prompted by
	James F. Hranicky mail to heimdal-discuss

	* lib/krb5/verify_krb5_conf.c: add pkinit and password quailty
	check options
d332 3
a334 2
	* lib/krb5/pkinit.c (pk_verify_chain_standard): store better error
	message in the context for certificate errors.
d336 1
a336 3
	* lib/krb5/keytab.c (krb5_kt_free_entry): zero out content of all
	krb5_free_x_content like functions to make sure data doesnt get
	reused, idea from Wynn Wilkes <wwilkes@@vintela.com>
d338 5
a342 2
	* configure.in: depend on automake 1.8, we don't test anything
	older
d344 1
a344 5
	* lib/krb5/init_creds_pw.c (process_pa_data_to_md): add comment
	that the caller always free out_md; remove comment about memory,
	it doesn't happen.
	(init_cred_loop): free ctx->as_req.padata when its reset (From Wynn
	Wilkes <wwilkes@@vintela.com>), move a comment close the the code
d346 1
a346 2
	* lib/krb5/keytab_krb4.c (fkt_remove_entry): need to call
	krb5_kt_free_entry after each krb5_kt_next_entry.
d348 1
a348 3
	* lib/krb5/keytab_file.c (fkt_remove_entry): need to call
	krb5_kt_free_entry after each fkt_next_entry_int. From: Wynn
	Wilkes <wwilkes@@vintela.com>
d350 2
a351 1
2005-05-18  Love Hörnquist Åstrand  <lha@@it.su.se>
d353 2
a354 1
	* lib/krb5/Makefile.am: TESTS += test_keytab
d356 2
a357 2
	* lib/krb5/keytab_krb4.c (krb4_kt_remove_entry): plug memory leaks,
	avoid crashing on empty keytab
d359 1
a359 2
	* lib/krb5/krb5_keytab.3: document behavior of
	krb5_kt_remove_entry
d361 2
a362 6
	* lib/krb5/keytab_memory.c (mkt_remove_entry): check if there
	isn't any entries in the keytab before removing any since that
	leads to bad pointer arithmetic and crashing. From: Wynn Wilkes
	<wwilkes@@vintela.com>.  Make the function return KRB5_KT_NOTFOUND
	if the entry wasn't in the keytab (just like the filebased
	keytab).
d364 3
a366 1
	* lib/krb5/test_keytab.c: test memory corruption in MEMORY keytab
d368 1
a368 4
	* lib/krb5{addr_families,context,creds,free,keyblock,
	mit_glue,rd_error}.c:zero out content of all krb5_free_x_content
	like functions to make sure data doesnt get reused, idea from
	Wynn Wilkes <wwilkes@@vintela.com>
d370 2
a371 1
	* lib/krb5/krb5_get_credentials.3: document KRB5_GC_EXPIRED_OK
d373 1
a373 1
	* lib/krb5/krb5.3: add krb5_cc_new_unique
d375 1
a375 1
2005-05-17  Love Hörnquist Åstrand  <lha@@it.su.se>
d377 1
a377 3
	* lib/krb5/fcache.c (fcc_get_first): check return value from
	malloc, memset the structure, make sure cursor doesn't point to
	freed memory on failure.  From: Wynn Wilkes <wwilkes@@vintela.com>
d379 3
a381 2
	* lib/krb5/krb5_auth_context.3: document
	KRB5_AUTH_CONTEXT_CLEAR_FORWARDED_CRED
d383 2
a384 3
	* lib/krb5/get_cred.c: Remove expired credentials, based on
	patches and comments from Anders Magnusson <ragge@@ltu.se> and Wynn
	Wilkes <wwilkes@@vintela.com>
d386 1
a386 6
	* lib/krb5/get_for_creds.c (krb5_get_forwarded_creds): honor
	KRB5_AUTH_CONTEXT_CLEAR_FORWARDED_CRED and create unencrypted
	(ENCTYPE_NULL) credentials. for use with old mit server and java based
	ones as they can't handle encrypted KRB-CRED. Note that the option
	needs to turned on because if the consumer sends the KRB-CRED in
	clear bad things will happen.
d388 2
a389 1
	* lib/krb5/context.c (krb5_init_context): register krb5_javakt_ops
d391 1
a391 5
	* lib/krb5/krb5.h: KRB5_GC_EXPIRED_OK: expired credentials is ok
	to return from krb5_get_credentials.
	KRB5_AUTH_CONTEXT_CLEAR_FORWARDED_CRED: make forward credentials
	be unencrypted, for compatibility with mit kerberos and java
	kerberos. krb5_javakt_ops: export
d393 2
a394 1
2005-05-16  Love Hörnquist Åstrand  <lha@@it.su.se>
d396 1
a396 3
	* lib/krb5/keytab_file.c: Add new keytab file format JAVA14 that
	doesn't the use extended kvnos, as hinted, this is needed for
	Java's Kerberos implementation.
d398 3
a400 4
2005-05-10  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/pkinit.c: handle pkinit-9, pkinit-19, and pkinit-25
	enckey, still no DH
d402 3
a404 18
	* kdc/pkinit.c: handle pkinit-9, pkinit-19, and pkinit-25 enckey,
	still no DH

	* kdc/kerberos5.c (as_rep): search for pkinit-9, pkinit-19, and
	pkinit-25 pa-data, return empty pkinit pa-data in the
	PREAUTH_REQUIRED krb-error

	* doc/ack.texi: add pkinit people

	* lib/krb5/krb5_storage.3: document krb5_storage_is_flags

	* lib/krb5/{krb5_compare_creds.3,krb5_get_init_creds.3,
	krb5_krbhst_init.3,krb5_storage.3}:
	make more pretty, from Björn Sandell

2005-05-09  Dave Love  <fx@@gnu.org>

	* doc/setup.texi: Fix and clarify password quality check examples.
d406 1
a406 14
2005-05-09  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/kuserok.c (krb5_kuserok): use POSIX_GETPWNAM_R instead
	of HAVE_GETPWNAM_R From: Dave Love <d.love@@dl.ac.uk>

2005-05-07  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/addr_families.c (krb5_print_address): catch when the
	unknown adress don't fit. From Björn Sandell <biorn@@dce.chalmers.se>

2005-05-05  Dave Love  <d.love@@dl.ac.uk>

	* configure.in: fix type right test, include <termios.h> for
	sys/strtty.h, not sys/ptyvar.h
d408 1
a408 3
2005-05-05  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/krb5.conf.5: spelling
d410 1
a410 3
2005-05-04  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/krb5.conf.5: expand on what "trailing component" means
d412 6
a417 3
2005-05-04  Johan Danielsson  <joda@@pdc.kth.se>

	* lib/krb5/rd_cred.c: put address comparison in separate function
d419 1
a419 3
	* lib/krb5/krb5_kuserok.3: check the user's ~/.k5login.d directory
	for access files, all of which is handled like the regular
	~/.k5login
d421 3
a423 4
	* lib/krb5/kuserok.c: check the user's ~/.k5login.d directory for
	access files, all of which is handled like the regular ~/.k5login
	
2005-05-03  Love Hörnquist Åstrand  <lha@@it.su.se>
d425 1
a425 2
	* doc/ack.texi: Clearify what version of libdes we are using and
	who's code in it we are using.
d427 2
a428 1
	* kcm/kcm.8: more text about usage
d430 2
a431 1
	* kcm/Makefile.am: man_MANS += kcm.8
d433 1
a433 1
	* kcm/kcm.8: initial manpage
d435 1
a435 2
	* configure.in: if we have a $srcdir/lib/asn1/pkcs12.asn1, define
	PKINIT
d437 1
a437 3
2005-05-02  Dave Love  <fx@@gnu.org>

	* configure.in: sys/tty.h (for sys/ptyvar.h) might need termios.h.
d439 1
a439 3
2005-05-02  Love Hörnquist Åstrand  <lha@@it.su.se>

	* tools/krb5-config.in: add com_err to required libs
d441 1
a441 2
	* lib/krb5/pkinit.c (krb5_ui_method_read_string): use the fill in
	length
d443 1
a443 4
	* lib/krb5/init_creds_pw.c: Now that we fixed the signed-ness of
	nonce for windows, remove the code that removed the signed
	bit. Instead add comment that they still need to be the same
	(Kerberos protocol nonce and pk-init nonce) for Windows.
d445 1
a445 1
2005-05-02  David Love  <fx@@gnu.org>
d447 7
a453 2
	* lib/krb5/crypto.c: Don't declare des_salt &c as static with
	incomplete type (invalid in c89, at least).
d455 1
a455 5
2005-05-02  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/krb5_locl.h: include <crypt.h>

2005-05-02  David Love  <fx@@gnu.org>
d457 1
a457 9
	* kcm/connect.c (init_socket): rename variable sun to un to avoid
	namespace collision.
	(handle_stream): Cast arg of krb5_warnx.

2005-04-30  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/init_creds_pw.c: if we are using PKINIT, strip of the
	highest bit to make windows PK-INIT happy. Also make the nonces
	the same, again for windows, they are using pk-init-9.
d459 3
a461 2
	XXX check if it isn't the that nonce is an unsigned variable so
	its just a asn1 mismatch.
d463 1
a463 1
	* kdc/pkinit.c: pass a NULL prompter data to _krb5_pk_load_openssl_id
d465 1
a465 1
	* kuser/kinit.c: krb5_get_init_creds_opt_set_pkinit
d467 4
a470 4
	* lib/krb5/pkinit.c: Pass prompter data to the prompter function,
	implement a UI prompter function wrapping the kerberos prompter
	function so that the the OpenSSL ENGINE can ask for a password
	when loading the private key. From: Douglas E. Engert
d472 4
a475 3
	* lib/krb5: add <err.h> in test programs
	
	* configure.in: sys/ptyvar.h might need <sys/tty.h>
d477 1
a477 1
	* lib/krb5/Makefile.am: use LIB_com_err for libkrb5.la
d479 1
a479 3
2005-04-29  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/asn1/Makefile.am: use $(LIB_com_err)
d481 1
a481 5
2005-04-28  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/context.c (krb5_set_config_files): ignore permission
	denied on configuration files, user might not be allowed to read
	/var/heimdal/kdc.conf
d483 2
a484 1
2005-04-26  Dave Love  <fx@@gnu.org>
d486 1
a486 2
	* lib/krb5/krb5_locl.h: define _POSIX_PTHREAD_SEMANTICS so we get
	posix getpwnam_r
d488 2
a489 1
2005-04-25  Love Hörnquist Åstrand  <lha@@it.su.se>
d491 1
a491 4
	* lib/asn1/gen_glue.c: switch the units variable to a
	function. gcc-4.1 needs the size of the structure if its defined
	as extern struct units foo_units[] an we don't want to include
	<parse_units.h> in the generate headerfile
d493 2
a494 1
2005-04-25  Love Hörnquist Åstrand  <lha@@it.su.se>
d496 3
a498 2
	* lib/hdb/hdb.schema: add EQUALITY rule for krb5ValidStart,
	krb5ValidEnd, krb5PasswordEnd From Howard Chu
d500 4
a503 1
2005-04-24  Love Hörnquist Åstrand  <lha@@it.su.se>
d505 2
a506 3
	* doc/whatis.texi: comment out docbook stuff for now
	
	* kuser/klist.c: use strlcpy
d508 1
a508 8
	* doc/ack.texi: we no longer use eay libdes, make acknowledgment
	still be there, but claim that we no longer use it. Mark editline
	to be a modified version as required by the license.
	
	* lib/krb5/pkinit.c: use the unexported oid_to_enctype function
	
	* lib/krb5/crypto.c: unexport the oid_to_enctype function, not for
	external consumers
d510 3
a512 1
	* kdc/Makefile.am: always add kaserver
d514 1
a514 1
	* lib/krb5/krb5_ccache.3: document krb5_cc_new_unique
d516 2
a517 2
	* lib/krb5/cache.c (krb5_cc_new_unique): new function to create a
	new credential cache
d519 2
a520 1
	* kdc/headers.h: don't include kerberos 4 headers here
d522 1
a522 1
	* kdc/hpropd.c: include kerberos 4 headers here
d524 1
a524 2
	* kdc/connect.c: add kaserver support independ of having krb4
	support
d526 2
a527 3
	* kdc/config.c: add kaserver support unconditionally, make kdc
	only fail to start when there are no v4 realm configured and
	krb4/kaserver is turned on
d529 2
a530 2
	* kdc/kaserver.c: Use the new Kerberos 4 functions in libkrb5 and
	so kaserver support is always compiled in (still default disabled)
d532 2
a533 3
	* lib/krb5/v4_glue.c: simplify error handling

	* doc/whatis.texi: add docbook version macro of @@sub
d535 1
a535 11
	* doc/heimdal.texi: change the wrapping around the Top node to
	ifnottex, make html generation work

	* lib/krb5/krb5_krbhst_init.3: spelling, from Björn Sandell
	<biorn@@dce.chalmers.se>

	* lib/krb5/krb5_get_krbhst.3: spelling, from Björn Sandell
	<biorn@@dce.chalmers.se>

	* lib/krb5/krb5_data.3: spelling, from Björn Sandell
	<biorn@@dce.chalmers.se>
d537 3
a539 2
	* lib/krb5/krb5_aname_to_localname.3: spelling, from Björn Sandell
	<biorn@@dce.chalmers.se>
d541 1
a541 2
	* lib/krb5/krb5_address.3: spelling, from Björn Sandell
	<biorn@@dce.chalmers.se>
d543 1
a543 1
2005-04-23  Love Hörnquist Åstrand  <lha@@it.su.se>
d545 1
a545 7
	* kdc/config.c: Use the new Kerberos 4 functions in libkrb5 and so
	kerberos 4 is always compiled in (still default disabled)

	* kdc/kerberos4.c: Use the new Kerberos 4 functions in libkrb5 and
	so kerberos 4 is always compiled in (still default disabled)

	* lib/krb5/krb5_locl.h: forward declaration of _krb5_krb_auth_data
d547 1
a547 2
	* lib/krb5/convert_creds.c: Move the kerberos v4 replacement
	functions to v4_glue.c
d549 1
a549 2
	* lib/krb5/v4_glue.c: Implement enough of kerberos 4 protocol to
	be a KDC, move the v4 bits over here
d551 1
a551 1
	* lib/krb5/krb5-v4compat.h: add more v4 defines
d553 1
a553 1
2005-04-22  Love Hörnquist Åstrand  <lha@@it.su.se>
d555 1
a555 3
	* kpasswd/kpasswdd.c: Support multi-realms databases, requires
	that all the realms are configured on the KDC in krb5.conf with
	[libdefaults]default_realm stanzas.
d557 1
a557 1
2005-04-21  Love Hörnquist Åstrand  <lha@@it.su.se>
d559 1
a559 1
	* kdc/kerberos5.c: spell succeeded correctly, From Sean Chittenden
d561 4
a564 3
	* lib/krb5/addr_families.c: catch two more snprintf problems
	
2005-04-20  Love Hörnquist Åstrand  <lha@@it.su.se>
d566 1
a566 2
	* lib/hdb/Makefile.am: this lib include com_err, add -com_err to
	CHECK_SYMBOLS
d568 2
a569 2
	* appl/test/http_client.c: cast ssize_t to unsigned long, fix
	printf format
d571 4
a574 1
2005-04-19  Love Hörnquist Åstrand  <lha@@it.su.se>
d576 2
a577 8
	* lib/krb5/kuserok.c: use asprintf to avoid truncating pathnames
	
	* lib/krb5/get_host_realm.c: check return value of snprintf
	
	* lib/krb5/test_addr.c: check address truncation
	
	* lib/krb5/addr_families.c: check return values from snprintf and
	clean up semantics of ret_len
d579 1
a579 2
	* lib/krb5/krb5_address.3: clarify what ret_len is in
	krb5_print_address
d581 1
a581 1
	* lib/krb5/test_kuserok.c: add --version and --help
d583 3
a585 7
	* lib/krb5/kuserok.c: use getpwnamn_r if it exists

	* lib/krb5/Makefile.am: noinst_PROGRAMS += test_kuserok

	* lib/krb5/test_kuserok.c: test program for krb5_kuserok

2005-04-18  Love Hörnquist Åstrand  <lha@@it.su.se>
d587 2
a588 4
	* lib/krb5/acache.c (acc_resolve): if open_default_ccache failed
	with ccErrCCacheNotFound try again with create_default_ccache,
	this fixes the problem where the security server apperenly haven't
	started yet on Mac OS X
d590 2
a591 3
	* lib/krb5/get_default_principal.c
	(_krb5_get_default_principal_local): add, for use of functions
	that in ccache layer to avoid recursive calls.
d593 1
a593 2
	* lib/hdb/hdb-ldap.c: drop <ctype.h>, no longer use any of the is*
	macros in this file
d595 7
a601 2
	* include/make_crypto.c: cast to unsigned char to make sure its
	not negative when passing it to is* functions
d603 1
a603 1
2005-04-15  Love Hörnquist Åstrand  <lha@@it.su.se>
d605 1
a605 6
	* doc/programming.texi: remove manpage macro, add some more
	references to manpages

	* doc/heimdal.texi: define manpage macro
	
	* doc/setup.texi: document new password policy code
d607 2
a608 2
	* kpasswd/kpasswdd.c: add verifier libraries with
	kadm5_add_passwd_quality_verifier
d610 1
a610 1
	* lib/krb5/krb5_keyblock.3: document krb5_keyblock_init
d612 1
a612 1
2005-04-14  Love Hörnquist Åstrand  <lha@@it.su.se>
d614 1
a614 4
	* kdc/kaserver.c: AUTHENTICATE and AUTHENTICATE_V2 is almost the
	same, and clients
	(klog) can deal with that the kaserver returns the same thing for
	both
d616 1
a616 4
	* lib/krb5/keyblock.c: Add krb5_keyblock_init to allocate an fill
	in a keyblock from key data.
	
2005-04-12  Love Hörnquist Åstrand  <lha@@it.su.se>
d618 4
a621 1
	* configure.in: rk_WIN32_EXPORT for roken
d623 2
a624 9
2005-04-10  Love Hörnquist Åstrand  <lha@@it.su.se>
	
	* appl/test/gssapi_server.c: print out client principla of
	delegated credential

2005-04-07  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/init_creds_pw.c (process_pa_data_to_key): also check
	for KRB5_PADATA_PK_AS_REP_19, From: Douglas Engert
d626 1
a626 1
2005-04-07  Love Hörnquist Åstrand  <lha@@it.su.se>
d628 1
a628 1
	* .cvsignore: ignore more generate files
d630 1
a630 4
2005-04-04  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/asn1/check-der.c: use size_t, print size_t by casting to
	unsigned long
d632 2
a633 1
	* lib/krb5/test_crypto.c: print size_t by casting to unsigned long
d635 4
a638 3
	* lib/krb5/acache.c: Argument to create_new_ccache is a principal,
	not a credential cache name.  Clean up lossage related to this
	problem.
d640 2
a641 5
	* lib/hdb/Makefile.am: CHECK_SYMBOLS += HDBFlags2int
	
	* lib/krb5/addr_families.c
	(krb5_address_prefixlen_boundary,krb5_free_address):
	use find_atype when we are dealing with a kerberos address type
d643 1
a643 1
	* lib/krb5/aes-test.c: size_t vs int + fix printf
d645 1
a645 3
	* lib/krb5/pkinit.c: Since the decode can't make out the diffrence
	between PA-PK-AS-REP-19 and PA-PK-AS-REQ-Win2k, try harder to
	verify both cases
d647 1
a647 1
2005-04-03  Love Hörnquist Åstrand  <lha@@it.su.se>
d649 1
a649 1
	* appl/test/uu_client.c: print size_t by casting to unsigned long
d651 1
a651 1
2005-04-01 Johan Danielsson <joda@@pdc.kth.se>
d653 2
a654 5
	* kdc/kerberos4.c (do_version4): check client and server max_life
	
	* kdc/kaserver.c (do_getticket): check client max_life
	
2005-03-31  Love  <lha@@kth.se>
d656 2
a657 1
	* lib/krb5/verify_krb5_conf.c: const poison
d659 1
a659 1
	* lib/krb5/test_alname.c: const poison
d661 3
a663 1
	* lib/asn1/main.c: const poison
d665 2
a666 1
	* lib/krb5/test_addr.c: test parse IPv6 RANGE addresses
d668 1
a668 1
	* lib/krb5/addr_families.c: implement mask boundary for IPv6
d670 2
a671 2
	* lib/asn1/gen.c: avoid const string warnings steming from
	writeable-string
d673 1
a673 1
2005-03-28  Love Hörnquist Åstrand  <lha@@it.su.se>
d675 3
a677 3
	* lib/krb5/Makefile.am: TESTS += test_addr

	* lib/krb5/test_addr.c: simple test for addresses
d679 1
a679 19
	* lib/krb5/addr_families.c: make RANGE parse prefixlen style
	addresses too, fix printing of RANGE addresses, add
	krb5_address_prefixlen_boundary

	* lib/krb5/krb5_keytab.3: stop memory leak in example, expand on
	wildcards

2005-03-26  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/krb5_principal.3: spelling, from Tomas Olsson

	* lib/krb5/krb5_warn.3: spelling, from Tomas Olsson

2005-03-19  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/acache.c: add mutex for global variables, clean up
	returned error codes, implement storing addresses into the ccapi

	* appl/test/gssapi_server.c: free memory, make error strings match
d681 2
a682 2
	* appl/test/gssapi_server.c: use print_gss_name, print server name
	too
d684 1
a684 2
	* appl/test/gss_common.h (print_gss_name): common code for
	printing gss name
d686 1
a686 2
	* appl/test/gss_common.c (print_gss_name): common code for
	printing gss name
d688 1
a688 2
	* appl/test/http_client.c: Make constent with rest of the gssapi
	test programs
d690 1
a690 1
2005-03-17  Love Hörnquist Åstrand  <lha@@it.su.se>
d692 1
a692 1
	* lib/hdb/keys.c: AES is enabled by default, remove ifdefs
d694 1
a694 1
	* lib/krb5/crypto.c: AES is enabled by default, remove ifdefs
d696 2
a697 6
	* lib/krb5/aes-test.c: use hex encoder from roken AES is enabled
	by default, remove ifdefs

	* kdc/kerberos5.c: AES is enabled by default, remove ifdefs

2005-03-16  Love Hörnquist Åstrand  <lha@@it.su.se>
d699 1
a699 1
	* doc/setup.texi: Add some text about modifying the database
d701 2
a702 1
2005-03-15  Love Hörnquist Åstrand  <lha@@it.su.se>
d704 2
a705 3
	* kuser/kinit.c: widen lifetime/renewal warning text field, also
	make use of unparse_time_approx, no need to be specific to the
	second when ticket needs to be renewed or their lifetime.
d707 1
a707 2
	* doc/heimdal.texi: copyright maintenance, drop eay, use updated
	UCB license
d709 2
a710 1
	* lib/krb5/crypto.c: more static and unsigned issues
d712 2
a713 2
	* lib/krb5/crypto.c: fix signedness issues, prompted by report of
	Magnus Ahltorp
d715 6
a720 4
2005-03-13  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/krb5_keytab.3: more text about how to free returned
	resources
d722 2
a723 1
2005-03-10  Love Hörnquist Åstrand  <lha@@it.su.se>
d725 1
a725 5
	* lib/krb5/pkinit.c: handle the -25 generation path

	* lib/krb5/pkinit.c: use KRB5_PADATA_PK_AS_REQ_19
	
	* lib/krb5/pkinit.c: fold in pk-init-25 asn1 changes
d727 1
a727 1
2005-03-09  Love Hörnquist Åstrand  <lha@@it.su.se>
d729 1
a729 1
	* kdc/pkinit.c: use generated oid's
d731 1
a731 3
	* lib/krb5/pkinit.c: use generated oid's
	
2005-03-08  Love Hörnquist Åstrand  <lha@@it.su.se>
d733 2
a734 1
	* kdc/pkinit.c: update to the asn1 structures used in -25's
d736 1
a736 1
	* lib/krb5/pkinit.c: update to the asn1 structures used in -25's
d738 1
a738 1
2005-03-04  Love Hörnquist Åstrand  <lha@@it.su.se>
d740 1
a740 2
	* lib/hdb/hdb-ldap.c: use the newly written hex function from
	roken and remove the old implementation
d742 1
a742 1
2005-03-01  Love Hörnquist Åstrand  <lha@@it.su.se>
d744 1
a744 1
	* appl/test/http_client.c: allow specifing port to connect to
d746 3
a748 1
2005-02-24  Love Hörnquist Åstrand  <lha@@it.su.se>
d750 1
a750 1
	* lib/krb5/Makefile.am: bump version to 21:0:4
d752 4
a755 1
	* lib/hdb/Makefile.am: bump version to 8:0:1
d757 1
a757 1
	* lib/asn1/Makefile.am: bump version to 7:0:1
d759 1
a759 1
2005-02-23  Love Hörnquist Åstrand  <lha@@it.su.se>
d761 3
a763 2
	* lib/krb5/crypto.c (DES_string_to_key_int): must check for weak
	keys after doing the DES_cbc_cksum
d765 1
a765 1
2005-02-19  Luke Howard  <lukeh@@padl.com>
d767 3
a769 3
	* lib/krb5/krbhst.c: set KD_CONFIG after calling
	  config_get_hosts() in kpasswd_get_next()
	  From: Wynn Wilkes <wynnw@@vintela.com>
d771 4
a774 1
2005-02-15  Love Hörnquist Åstrand  <lha@@it.su.se>
d776 3
a778 2
	* lib/hdb/db3.c (DB_open): correct the check for O_RDONLY
	From: Chaskiel M Grundman <cg2v@@andrew.cmu.edu>
d780 2
a781 1
2005-02-09  Love Hörnquist Åstrand  <lha@@it.su.se>
d783 3
a785 2
	* lib/krb5/crypto.c (krb5_random_to_key): cast size_t to int to
	make %d work
d787 1
a787 1
2005-02-08  Love Hörnquist Åstrand  <lha@@it.su.se>
d789 2
a790 3
	* lib/krb5/keytab.c (krb5_kt_get_entry): tell what enctype the
	caller requested to provide the user with a glue what the caller
	was asking for.
d792 3
a794 1
2005-02-05  Luke Howard  <lukeh@@padl.com>
d796 4
a799 1
	* lib/krb5/kcm.c: add _krb5_kcm_is_running, _krb5_kcm_noop
d801 5
a805 13
	* kcm/acquire.c: don't leak salt if keyproc called multiple
	  times

	* kcm/config.c: allow KCM system ccache to be configured from
	  krb5.conf, in the system_ccache stanza of [kcm]

2005-02-03  Love Hörnquist Åstrand  <lha@@it.su.se>

	* kcm/protocol.c: use -1 as the invalid pid number

	* kcm/connect.c: support SCM_CREDS (for NetBSD)

	* kcm/Makefile.am: LDADD += LIB_pidfile
d807 1
a807 4
	* kcm/connect.c: make it possible to build on systems without
	SO_PEERCRED (still doesn't work)

	* kcm/config.c: cast argument to isdigit to unsigned char
d809 2
a810 1
	* lib/krb5/krb5.conf.5: document large_msg_size
d812 2
a813 2
	* lib/krb5/context.c (init_context_from_config_file): init
	large_msg_size to 6000
d815 2
a816 3
	* lib/krb5/krb5.h (krb5_context_data): add large_msg_size,
	threshold where we start to use transport protocols without tiny
	max data transport sizes.
d818 1
a818 2
	* lib/krb5/kcm.h: drop prototypes, they all live in krb5-private.h
	by now
d820 2
a821 1
2005-02-02  Luke Howard  <lukeh@@padl.com>
d823 4
a826 1
	* configure.in: generate kcm/Makefile
d828 2
a829 1
	* Makefile.am: recurse into kcm/ if KCM defined
d831 1
a831 1
	* kcm: add KCM daemon
d833 1
a833 1
2005-02-02  Love Hörnquist Åstrand  <lha@@it.su.se>
d835 2
a836 1
	* lib/krb5/send_to_kdc.c (send_and_recv_udp): make private again
d838 4
a841 2
	* lib/krb5/kcm.c: use AF_UNIX like the rest of the codebase, add
	some more error strings
d843 2
a844 1
2005-02-02  Luke Howard  <lukeh@@padl.com>
d846 3
a848 2
	* configure.in: add --enable-kcm option for Kerberos
	  Credentials Manager (KCM)
d850 14
a863 39
	* lib/krb5/Makefile.am: add kcm.c

	* lib/krb5/cache.c: use cc_retrieve_cred if present rather
	  than enumerating ccache

	* lib/krb5/context.c: register KCM cc_ops

	* lib/krb5/get_cred.c: pass all options to cc_retrieve_cred

	* lib/krb5/init_creds_pw.c: add krb5_get_init_creds_keyblock

	* lib/krb5/kcm.[ch]: add initial implementation of KCM
	  client library

	* lib/krb5/krb5.h: fix cc_retrieve prototype, add KCM cc_ops

	* lib/krb5/send_to_kdc.c: add _krb5_send_and_recv_tcp

	* lib/krb5/store.c: add krb5_store_creds_tag, krb5_ret_creds_tag

2005-01-24  Luke Howard  <lukeh@@padl.com>

	* lib/krb5/init_creds_pw.c: allow NULL in_options to be passed
	  krb5_get_init_creds_password()

	* kdc/kerberos5.c: don't crash when logging no server etype
	  support if client == NULL

2005-01-17  Love Hörnquist Åstrand  <lha@@it.su.se>

	* kdc/kstash.c: s/random_key/random_key_flag/, From Dave Love
	<d.love@@dl.ac.uk>

2005-01-12  Love Hörnquist Åstrand  <lha@@it.su.se>

	* doc/apps.texi: Texinfo fixes. Text about irix 6.5 using
	PAM. From: Dave Love <d.love@@dl.ac.uk>

2005-01-08  Love Hörnquist Åstrand  <lha@@it.su.se>
d865 3
a867 21
	* lib/krb5/verify_krb5_conf.c: cast argument to isdigit to
	unsigned char

	* lib/krb5/keytab_keyfile.c: cast argument to toupper to unsigned
	char

	* lib/asn1/hash.c (hashcaseadd): cast argument to toupper to
	unsigned char

	* appl/kf/kfd.c (kfd_match_version): cast argument to islower to
	unsigned char

	* lib/krb5/krb5.3: drop krb5_{checksum,enctype}_is_disabled

	* lib/krb5/krb5_encrypt.3: drop krb5_enctype_is_disabled, more
	text about krb5_enctype_valid

	* lib/krb5/krb5_create_checksum.3: drop
	krb5_checksum_is_disabled

	* lib/krb5/crypto.c: drop krb5_{checksum,enctype}_isdisabled
d869 2
a870 3
	* lib/krb5/context.c: krb5_enctype_is_disabled is the same thing
	as krb5_enctype_valid, so use the later since its older and the
	api doesn't really need another entry point
d872 2
a873 3
	* lib/krb5/rd_req.c: krb5_enctype_is_disabled is the same thing as
	krb5_enctype_valid, so use the later since its older and the api
	doesn't really need another entry point
d875 1
a875 3
	* kdc/kerberos5.c: krb5_enctype_is_disabled is the same thing as
	krb5_enctype_valid, so use the later since its older and the api
	doesn't really need another entry point
d877 2
a878 1
2005-01-05  Love Hörnquist Åstrand  <lha@@it.su.se>
d880 2
a881 2
	* kpasswd/kpasswdd.8: document --addresses, controls what
	addresses kpasswd should listen too
d883 1
a883 12
	* kpasswd/kpasswdd.c: add --addresses, controls what addresses
	kpasswd should listen too

	* lib/krb5/addr_families.c (krb5_parse_address): filter out dup
	addresses from getaddrinfo

	* kpasswd/kpasswd.1: document -c

	* kpasswd/kpasswd.c: allow specifying a credential cache to use
	for the admin principal

	* include/bits.c: constify to avoid warning with -Wwrite-string
d885 1
a885 1
	* NEWS: add 0.6.2 and 0.6.3 items
d887 1
a887 5
	* lib/krb5/krb5_keyblock.3: document krb5_generate_subkey_extended

	* lib/krb5/krb5_is_thread_safe.3: document function

	* lib/krb5/Makefile.am (man_MANS) += krb5_is_thread_safe.3
d889 1
a889 4
	* lib/krb5/context.c (krb5_is_thread_safe): return TRUE is the
	library was compiled with multithreading support. If not,
	application must global lock the library, it it uses threads that
	call kerberos functions at the same time.
d891 2
a892 31
2005-01-05  Luke Howard  <lukeh@@padl.com>

	* lib/krb5/auth_context.c: use krb5_generate_subkey_extended()

	* lib/krb5/appdefault.c: remove redundant KRB5_LIB_FUNCTION

	* lib/krb5/build_auth.c: support for enctype negotiation
	  (client sends EtypeList in Authenticator authz data)

	* lib/krb5/context.c: mutex should be destroyed last in
	  krb5_free_context()

	* lib/krb5/generate_subkey.c: add krb5_generate_subkey_extended(),
	  set *subkey to NULL if key geneartion fails

	* lib/krb5/krb5.h: add KRB5_KU_PA_SERVER_REFERRAL_DATA

	* lib/krb5/mk_req_ext.c: support ETYPE_ARCFOUR_HMAC_MD5_56

	* lib/krb5/rd_req.c: support for enctype negotiation
	  (client sends EtypeList in Authenticator authz data)

2005-01-04  Luke Howard  <lukeh@@padl.com>

	* lib/asn1/k5.asn1: add authorization data types for enctype
	negotiation implementation

2005-01-04  Love Hörnquist Åstrand  <lha@@it.su.se>

	* lib/krb5/changepw.c (change_password_loop): on failing to find a
	kdc, set result_code to KRB5_KPASSWD_HARDERROR
d894 3
a896 1
2005-01-01  Love Hörnquist Åstrand  <lha@@it.su.se>
a897 2
	* doc/heimdal.texi: Happy New Year
	
@


