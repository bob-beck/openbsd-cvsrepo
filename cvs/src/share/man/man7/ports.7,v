head	1.110;
access;
symbols
	OPENBSD_6_1:1.110.0.4
	OPENBSD_6_1_BASE:1.110
	OPENBSD_6_0:1.109.0.2
	OPENBSD_6_0_BASE:1.109
	OPENBSD_5_9:1.106.0.2
	OPENBSD_5_9_BASE:1.106
	OPENBSD_5_8:1.102.0.4
	OPENBSD_5_8_BASE:1.102
	OPENBSD_5_7:1.101.0.2
	OPENBSD_5_7_BASE:1.101
	OPENBSD_5_6:1.98.0.6
	OPENBSD_5_6_BASE:1.98
	OPENBSD_5_5:1.98.0.4
	OPENBSD_5_5_BASE:1.98
	OPENBSD_5_4:1.95.0.2
	OPENBSD_5_4_BASE:1.95
	OPENBSD_5_3:1.93.0.2
	OPENBSD_5_3_BASE:1.93
	OPENBSD_5_2:1.89.0.2
	OPENBSD_5_2_BASE:1.89
	OPENBSD_5_1_BASE:1.88
	OPENBSD_5_1:1.88.0.2
	OPENBSD_5_0:1.85.0.2
	OPENBSD_5_0_BASE:1.85
	OPENBSD_4_9:1.83.0.2
	OPENBSD_4_9_BASE:1.83
	OPENBSD_4_8:1.82.0.2
	OPENBSD_4_8_BASE:1.82
	OPENBSD_4_7:1.79.0.2
	OPENBSD_4_7_BASE:1.79
	OPENBSD_4_6:1.76.0.4
	OPENBSD_4_6_BASE:1.76
	OPENBSD_4_5:1.73.0.2
	OPENBSD_4_5_BASE:1.73
	OPENBSD_4_4:1.72.0.4
	OPENBSD_4_4_BASE:1.72
	OPENBSD_4_3:1.72.0.2
	OPENBSD_4_3_BASE:1.72
	OPENBSD_4_2:1.70.0.2
	OPENBSD_4_2_BASE:1.70
	OPENBSD_4_1:1.67.0.2
	OPENBSD_4_1_BASE:1.67
	OPENBSD_4_0:1.56.0.2
	OPENBSD_4_0_BASE:1.56
	OPENBSD_3_9:1.53.0.2
	OPENBSD_3_9_BASE:1.53
	OPENBSD_3_8:1.52.0.2
	OPENBSD_3_8_BASE:1.52
	OPENBSD_3_7:1.50.0.2
	OPENBSD_3_7_BASE:1.50
	OPENBSD_3_6:1.44.0.2
	OPENBSD_3_6_BASE:1.44
	OPENBSD_3_5:1.41.0.2
	OPENBSD_3_5_BASE:1.41
	OPENBSD_3_4:1.40.0.2
	OPENBSD_3_4_BASE:1.40
	OPENBSD_3_3:1.31.0.2
	OPENBSD_3_3_BASE:1.31
	OPENBSD_3_2:1.26.0.2
	OPENBSD_3_2_BASE:1.26
	OPENBSD_3_1:1.23.0.2
	OPENBSD_3_1_BASE:1.23
	OPENBSD_3_0:1.21.0.2
	OPENBSD_3_0_BASE:1.21
	OPENBSD_2_9:1.18.0.2
	OPENBSD_2_9_BASE:1.18
	OPENBSD_2_8:1.14.0.2
	OPENBSD_2_8_BASE:1.14
	OPENBSD_2_7:1.10.0.2
	OPENBSD_2_7_BASE:1.10
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.4.0.2
	OPENBSD_2_5_BASE:1.4
	OPENBSD_2_4:1.2.0.2
	OPENBSD_2_4_BASE:1.2;
locks; strict;
comment	@.\" @;


1.110
date	2016.09.02.12.17.33;	author tb;	state Exp;
branches;
next	1.109;
commitid	Z6hUPnAcS0GtAGum;

1.109
date	2016.04.25.19.24.42;	author tedu;	state Exp;
branches;
next	1.108;
commitid	nrtZxsobBLCi86f5;

1.108
date	2016.04.07.20.43.50;	author tb;	state Exp;
branches;
next	1.107;
commitid	6qpk0WjhlhA0McZm;

1.107
date	2016.04.07.07.50.55;	author jmc;	state Exp;
branches;
next	1.106;
commitid	SisWav06MPsDHjVp;

1.106
date	2015.11.24.21.27.03;	author sthen;	state Exp;
branches;
next	1.105;
commitid	mhyXj4f5PQVUkzPc;

1.105
date	2015.09.21.21.43.23;	author schwarze;	state Exp;
branches;
next	1.104;
commitid	2dAsOTUx09v6rC9l;

1.104
date	2015.09.21.21.27.51;	author schwarze;	state Exp;
branches;
next	1.103;
commitid	ZJIJYqn0LQIjerP3;

1.103
date	2015.08.24.12.57.14;	author bentley;	state Exp;
branches;
next	1.102;
commitid	A5unBJhd9SWMIv6y;

1.102
date	2015.07.30.08.03.50;	author jmc;	state Exp;
branches;
next	1.101;
commitid	jvvdSOl8gxNBg4aJ;

1.101
date	2015.02.17.16.29.16;	author bentley;	state Exp;
branches;
next	1.100;
commitid	0B9BCHUNxiDVeLia;

1.100
date	2014.11.08.21.06.43;	author brad;	state Exp;
branches;
next	1.99;
commitid	8NDDpwmv8zls9MkR;

1.99
date	2014.09.08.01.27.55;	author schwarze;	state Exp;
branches;
next	1.98;
commitid	cPoapLAXYNe1fcgV;

1.98
date	2014.01.20.05.07.49;	author schwarze;	state Exp;
branches;
next	1.97;

1.97
date	2013.11.26.17.53.50;	author sthen;	state Exp;
branches;
next	1.96;

1.96
date	2013.11.11.21.14.29;	author zhuk;	state Exp;
branches;
next	1.95;

1.95
date	2013.06.19.08.59.02;	author espie;	state Exp;
branches;
next	1.94;

1.94
date	2013.03.14.16.05.19;	author ajacoutot;	state Exp;
branches;
next	1.93;

1.93
date	2013.01.08.09.42.16;	author rpe;	state Exp;
branches;
next	1.92;

1.92
date	2013.01.07.11.09.33;	author espie;	state Exp;
branches;
next	1.91;

1.91
date	2012.12.24.13.58.53;	author espie;	state Exp;
branches;
next	1.90;

1.90
date	2012.08.12.17.01.35;	author schwarze;	state Exp;
branches;
next	1.89;

1.89
date	2012.06.08.14.58.50;	author espie;	state Exp;
branches;
next	1.88;

1.88
date	2011.12.03.22.22.04;	author espie;	state Exp;
branches;
next	1.87;

1.87
date	2011.11.25.11.05.54;	author espie;	state Exp;
branches;
next	1.86;

1.86
date	2011.09.23.18.59.38;	author espie;	state Exp;
branches;
next	1.85;

1.85
date	2011.07.03.15.25.10;	author schwarze;	state Exp;
branches;
next	1.84;

1.84
date	2011.06.24.08.29.29;	author jasper;	state Exp;
branches;
next	1.83;

1.83
date	2010.10.23.12.25.21;	author landry;	state Exp;
branches;
next	1.82;

1.82
date	2010.07.29.17.38.13;	author steven;	state Exp;
branches;
next	1.81;

1.81
date	2010.06.20.07.59.53;	author espie;	state Exp;
branches;
next	1.80;

1.80
date	2010.05.01.10.30.41;	author espie;	state Exp;
branches;
next	1.79;

1.79
date	2009.10.11.21.07.06;	author steven;	state Exp;
branches;
next	1.78;

1.78
date	2009.08.21.08.07.51;	author jmc;	state Exp;
branches;
next	1.77;

1.77
date	2009.08.21.06.56.22;	author espie;	state Exp;
branches;
next	1.76;

1.76
date	2009.05.16.19.46.25;	author jmc;	state Exp;
branches;
next	1.75;

1.75
date	2009.05.15.22.30.03;	author espie;	state Exp;
branches;
next	1.74;

1.74
date	2009.03.25.11.42.21;	author sthen;	state Exp;
branches;
next	1.73;

1.73
date	2009.01.24.11.34.36;	author espie;	state Exp;
branches;
next	1.72;

1.72
date	2008.01.12.14.17.33;	author espie;	state Exp;
branches;
next	1.71;

1.71
date	2007.08.22.06.57.06;	author jmc;	state Exp;
branches;
next	1.70;

1.70
date	2007.08.15.14.20.54;	author espie;	state Exp;
branches;
next	1.69;

1.69
date	2007.05.31.19.19.58;	author jmc;	state Exp;
branches;
next	1.68;

1.68
date	2007.04.07.09.58.35;	author espie;	state Exp;
branches;
next	1.67;

1.67
date	2006.12.23.15.30.28;	author espie;	state Exp;
branches;
next	1.66;

1.66
date	2006.12.05.11.11.36;	author bernd;	state Exp;
branches;
next	1.65;

1.65
date	2006.12.04.08.49.40;	author jmc;	state Exp;
branches;
next	1.64;

1.64
date	2006.11.26.22.03.55;	author jmc;	state Exp;
branches;
next	1.63;

1.63
date	2006.11.26.17.54.25;	author espie;	state Exp;
branches;
next	1.62;

1.62
date	2006.11.02.16.48.11;	author jmc;	state Exp;
branches;
next	1.61;

1.61
date	2006.11.02.09.58.09;	author espie;	state Exp;
branches;
next	1.60;

1.60
date	2006.11.01.18.48.09;	author jmc;	state Exp;
branches;
next	1.59;

1.59
date	2006.11.01.13.06.48;	author espie;	state Exp;
branches;
next	1.58;

1.58
date	2006.09.26.18.49.48;	author jmc;	state Exp;
branches;
next	1.57;

1.57
date	2006.09.17.22.09.12;	author espie;	state Exp;
branches;
next	1.56;

1.56
date	2006.08.16.13.18.15;	author jmc;	state Exp;
branches;
next	1.55;

1.55
date	2006.08.16.09.54.45;	author espie;	state Exp;
branches;
next	1.54;

1.54
date	2006.05.08.11.16.20;	author steven;	state Exp;
branches;
next	1.53;

1.53
date	2005.09.04.18.21.38;	author pvalchev;	state Exp;
branches;
next	1.52;

1.52
date	2005.04.19.08.56.03;	author espie;	state Exp;
branches;
next	1.51;

1.51
date	2005.03.31.21.15.58;	author pvalchev;	state Exp;
branches;
next	1.50;

1.50
date	2005.03.03.10.28.08;	author jmc;	state Exp;
branches;
next	1.49;

1.49
date	2005.03.02.20.52.07;	author pvalchev;	state Exp;
branches;
next	1.48;

1.48
date	2005.02.06.15.02.47;	author jmc;	state Exp;
branches;
next	1.47;

1.47
date	2004.11.17.11.06.25;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2004.10.27.03.10.24;	author jaredy;	state Exp;
branches;
next	1.45;

1.45
date	2004.10.14.04.35.25;	author pvalchev;	state Exp;
branches;
next	1.44;

1.44
date	2004.07.20.10.33.34;	author jmc;	state Exp;
branches;
next	1.43;

1.43
date	2004.07.20.05.44.35;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	2004.04.16.21.23.08;	author jmc;	state Exp;
branches;
next	1.41;

1.41
date	2004.01.22.21.07.10;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	2003.09.03.09.10.30;	author jmc;	state Exp;
branches;
next	1.39;

1.39
date	2003.08.15.00.32.33;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	2003.08.15.00.28.05;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2003.07.28.20.02.44;	author sturm;	state Exp;
branches;
next	1.36;

1.36
date	2003.07.28.17.37.11;	author sturm;	state Exp;
branches;
next	1.35;

1.35
date	2003.06.22.13.21.50;	author sturm;	state Exp;
branches;
next	1.34;

1.34
date	2003.06.06.13.44.30;	author jmc;	state Exp;
branches;
next	1.33;

1.33
date	2003.04.15.07.02.40;	author david;	state Exp;
branches;
next	1.32;

1.32
date	2003.04.13.11.20.47;	author jmc;	state Exp;
branches;
next	1.31;

1.31
date	2003.03.16.16.36.47;	author avsm;	state Exp;
branches;
next	1.30;

1.30
date	2003.03.15.18.19.53;	author avsm;	state Exp;
branches;
next	1.29;

1.29
date	2003.02.27.00.41.20;	author david;	state Exp;
branches;
next	1.28;

1.28
date	2003.01.14.18.28.21;	author espie;	state Exp;
branches;
next	1.27;

1.27
date	2002.11.17.12.03.37;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2002.08.29.07.34.31;	author wcobb;	state Exp;
branches;
next	1.25;

1.25
date	2002.05.08.19.34.13;	author millert;	state Exp;
branches;
next	1.24;

1.24
date	2002.04.17.17.12.59;	author espie;	state Exp;
branches;
next	1.23;

1.23
date	2002.04.04.20.54.08;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2002.01.24.22.52.27;	author jsyn;	state Exp;
branches;
next	1.21;

1.21
date	2001.10.09.20.55.26;	author espie;	state Exp;
branches;
next	1.20;

1.20
date	2001.08.03.15.21.16;	author mpech;	state Exp;
branches;
next	1.19;

1.19
date	2001.06.26.06.48.53;	author dugsong;	state Exp;
branches;
next	1.18;

1.18
date	2001.03.06.23.03.46;	author brad;	state Exp;
branches
	1.18.2.1;
next	1.17;

1.17
date	2001.03.01.16.11.22;	author aaron;	state Exp;
branches;
next	1.16;

1.16
date	2001.02.09.09.42.26;	author reinhard;	state Exp;
branches;
next	1.15;

1.15
date	2000.12.27.18.23.16;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2000.10.13.04.09.21;	author aaron;	state Exp;
branches;
next	1.13;

1.13
date	2000.09.12.14.45.47;	author todd;	state Exp;
branches;
next	1.12;

1.12
date	2000.07.17.16.52.27;	author danh;	state Exp;
branches;
next	1.11;

1.11
date	2000.07.14.18.13.43;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2000.04.19.01.39.58;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2000.03.19.19.25.37;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	2000.01.29.20.22.30;	author espie;	state Exp;
branches;
next	1.7;

1.7
date	2000.01.27.19.45.33;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	99.07.09.13.35.37;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	99.05.23.14.11.09;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	99.04.02.16.21.38;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	98.11.28.03.38.02;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	98.09.05.17.41.49;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	98.06.24.18.15.08;	author marc;	state Exp;
branches;
next	;

1.18.2.1
date	2001.08.02.13.59.56;	author espie;	state Exp;
branches;
next	;


desc
@@


1.110
log
@move links from http to https://www.openbsd.org/

ok beck
@
text
@.\"
.\" Copyright (c) 1997 David E. O'Brien
.\"
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE DEVELOPERS ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE DEVELOPERS BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\" $OpenBSD: ports.7,v 1.109 2016/04/25 19:24:42 tedu Exp $
.\" $FreeBSD: ports.7,v 1.7 1998/06/23 04:38:50 hoek Exp $
.\"
.Dd $Mdocdate: April 25 2016 $
.Dt PORTS 7
.Os
.Sh NAME
.Nm ports
.Nd contributed applications
.Sh DESCRIPTION
The
.Ox
Ports Collection
is the infrastructure used to create binary packages for third party
applications.
.Pp
For normal usage refer to
.Xr packages 7 ,
as most ports produce binary packages which are available from
the official CD-ROM, or on a neighborly FTP mirror.
.Pp
Each port contains any patches necessary to make the original
application source code compile and run on
.Ox .
Compiling an application is as simple as typing
.Ic make
in the port directory!
The
.Pa Makefile
automatically fetches the
application source code, either from a local disk or via ftp, unpacks it
on the local system, applies the patches, and compiles it.
If all goes well, simply type
.Ic doas make install
to install the application.
.Pp
For more information about using ports, see
The
.Ox
Ports System
.Pq Lk https://www.openbsd.org/faq/faq15.html#Ports .
For information about creating new ports, see
the
.Ox
Porter's Handbook
.Pq Lk https://www.openbsd.org/faq/ports/ .
.Pp
For a detailed description of the build process, see
.Xr bsd.port.mk 5 .
.Sh PORTS MASTER MAKEFILE
The ports master Makefile, normally located in
.Pa /usr/ports/Makefile
(but see
.Ev PORTSDIR
below)
offers a few useful targets.
.Bl -tag -width configure
.It Cm index
rebuild the ports complete index,
.Pa /usr/ports/INDEX
.It Cm pkglocatedb
build a
.Xr pkg_mklocatedb 1
database file and place it in
.Pa ${PORTSDIR}/packages/${MACHINE_ARCH}/ftp ,
for use by
.Xr locate 1 ,
.It Cm print-index
display the contents of the index in a user-friendly way,
.It Cm search
invoked with a key, e.g.,
.Ic make search key=foo ,
retrieve information relevant to a given port (obsolescent).
.El
.Pp
Starting in
.Ox 4.0 ,
there is a port,
.Pa databases/sqlports
that builds an sqlite database containing most information relevant to
every port in the ports tree.
This database can be searched using any tool able to manipulate such
databases, for instance sqlitebrowser, or a script language with an
sqlite interface, e.g., perl, python, ocaml, lua, php5.
.Sh SELECTING A SET OF PORTS
One can define
.Ev SUBDIRLIST
to point to a file that contains a list of
.Ev FULLPKGPATHs ,
one per line, to build stuff only in some directories.
.Pp
If
.Pa /usr/ports/INDEX
is up to date, it is possible to select subsets by setting the following
variables on the command line:
.Bl -tag -width category
.It Va key
package name matching the given key,
.It Va category
port belonging to category,
.It Va maintainer
port maintained by a given person.
.El
.Pp
For instance, to invoke
.Cm clean
on all ports in the x11 category, one can say:
.Bd -literal -offset indent
$ make category=x11 clean
.Ed
.Pp
The index search is done by a perl script, so all regular expressions from
.Xr perlre 1
apply.
.Sh TARGETS
Individual ports are controlled through a few documented targets.
Some of these targets work recursively through subdirectories, so that
someone can, for example, install all of the net
ports.
.Pp
The variable
.Ev SKIPDIR
can hold a set of package directories to avoid during recursion.
These are always specified relative to the root of the ports tree,
and can contain a flavor or subpackage part
.Po
see
.Xr packages-specs 7
.Pc .
.Ev SKIPDIR
is handled by a
.Ic case
statement, and so can contain simple wildcards
.Po
see
.Xr sh 1
.Dq File name patterns
.Pc ,
e.g., SKIPDIR='editors/openoffice*' .
.Pp
The variable
.Ev STARTDIR
can hold the path to a starting directory.
The recursion will skip all directories up to that package path.
This can be used to resume a full build at some specific point without having
to go through thousands of directories first.
.Pp
The variable
.Ev STARTAFTER
can hold the path to a starting directory.
The recursion will skip all directories up to and including that package path.
This can be used to resume a full build after some specific point without having
to go through thousands of directories first.
.Pp
In case of failure in a subdirectory, the shell fragment held in
.Ev REPORT_PROBLEM
is executed.
Default behavior is to call exit, but this can be overridden on the command
line, e.g., to avoid stopping after each problem.
.Bd -literal -offset indent
$ make REPORT_PROBLEM=true
.Ed
.Pp
If
.Ev REPORT_PROBLEM_LOGFILE
is non empty, then
.Ev REPORT_PROBLEM
will default to:
.Bd -literal -offset indent
echo $$subdir ($@@) >>$${REPORT_PROBLEM_LOGFILE}
.Ed
.Pp
That is, any failure will append the faulty directory name together
with the target that failed to
.Pa ${REPORT_PROBLEM_LOGFILE}
and proceed.
.Pp
Some targets that do this are
.Cm all , build , checksum , clean ,
.Cm configure , extract , fake ,
.Cm fetch , install , distclean ,
.Cm deinstall , reinstall , package , prepare ,
.Cm link-categories , unlink-categories ,
.Cm describe , show , regress ,
.Cm lib-depends-check , homepage-links , manpages-check ,
.Cm license-check , all-dir-depends , build-dir-depends ,
.Cm run-dir-depends
and
.Cm readmes .
.Pp
Target names starting with
.Sq _
are private to the ports infrastructure,
should not be invoked directly, and are liable to change without notice.
.Pp
In the following list, each target will run the preceding targets
in order automatically.
That is,
.Cm build
will be run
.Pq if necessary
by
.Cm install ,
and so on all the way to
.Cm fetch .
In typical use, one will only run
.Cm install
explicitly (as normal user, with
.Ev SUDO
defined in
.Pa /etc/mk.conf ) ,
or
.Cm build
(as user), then
.Cm install
(as root).
.Bl -tag -width configure
.It Cm fetch
Fetch all of the files needed to build this port from the site(s)
listed in
.Ev MASTER_SITES .
See
.Ev FETCH_CMD
and
.Ev MASTER_SITE_OVERRIDE .
Use
.Xr dpb 1
with option
.Fl F
to quickly fetch distfiles for a subtree.
.It Cm checksum
Verify that the fetched distfile matches the one the port was tested against.
Defining
.Ev NO_CHECKSUM
to
.Dv Yes
will skip this step.
Sometimes, distfiles change without warning.
The main
.Ox
mirror should still hold a copy of old distfiles, indexed by checksum.
Using
.Bd -literal -offset indent
$ make checksum REFETCH=true
.Ed
.Pp
will try to get a set of distfiles that match the recorded checksum.
.It Cm prepare
Install
any build dependencies of the current port.
Defining
.Ev NO_DEPENDS
to
.Dv Yes
will skip this step.
.It Cm extract
Expand the distfile into a work directory.
.It Cm patch
Apply any patches that are necessary for the port.
.It Cm configure
Configure the port.
Some ports will ask questions during this stage.
See
.Ev INTERACTIVE
and
.Ev BATCH .
.It Cm build
Build the port.
This is the same as calling the
.Cm all
target.
.It Cm fake
Pretend to install the port under a subdirectory of the work directory.
.It Cm package
Create a binary package from the fake installation.
The package is a .tgz file that can be used to
install the port with
.Xr pkg_add 1 .
.It Cm install
Install the resulting package.
.El
.Pp
The following targets are not run during the normal install process.
.Bl -tag -width fetch-list
.It Cm print-build-depends , print-run-depends
Print an ordered list of all the compile and run dependencies.
.It Cm clean
Remove the expanded source code.
This does not recurse to dependencies unless
.Ev CLEANDEPENDS
is defined to
.Dv Yes .
.It Cm distclean
Remove the port's distfile(s).
This does not recurse to dependencies.
.It Cm regress
Runs the ports regression tests.
Usually needs a completed build.
.It Cm reinstall
Use this to restore a port after using
.Xr pkg_delete 1 .
.It Cm update
Alternative target to
.Cm install .
Does not install new packages, but updates existing ones.
.It Cm link-categories
Populate the ports tree with symbolic links for each category the port
belongs to.
.It Cm unlink-categories
Remove the symbolic links created by
.Cm link-categories .
.It Cm homepage-links
creates an html list of links for each port
.Ev HOMEPAGE .
.El
.Sh LOCK INFRASTRUCTURE
The ports tree can be used concurrently for building several ports at the
same time, thanks to a locking mechanism.
By default, locks are stored under
.Pa /tmp/portslocks .
Defining
.Ev LOCKDIR
will point them elsewhere, or disable the mechanism if set to an empty value.
.Pp
All locks will be stored in
.Pa ${LOCKDIR} .
.Ev LOCK_CMD
should be used to acquire a lock, and
.Ev UNLOCK_CMD
should be used to release it.
.Pp
Locks are named
.Pa ${LOCKDIR}/${FULLPKGNAME}.lock ,
or
.Pa ${LOCKDIR}/${DISTFILE}.lock
for distfiles fetching.
.Pp
The default values of
.Ev LOCK_CMD
and
.Ev UNLOCK_CMD
are appropriate for most uses.
.Pp
The locking protocol follows a big-lock model: each top-level target
in a port directory will acquire the corresponding lock, complete its job,
then release the lock, e.g., running
.Bd -literal -offset indent
$ make build
.Ed
.Pp
will acquire the lock, run the port
through
.Cm fetch ,
.Cm checksum ,
.Cm extract ,
.Cm patch ,
.Cm configure ,
.Cm build ,
then release the lock.
If dependencies are involved, they will invoke top-level targets in other
directories, and thus acquire some other locks as well.
.Pp
The infrastructure contains some protection against acquiring the same lock
twice, thus recursive locking is not needed for
.Ev LOCK_CMD .
.Pp
Starting with
.Ox 4.3 ,
the infrastructure supports manual locking: the targets
.Cm lock
and
.Cm unlock
can be used to acquire and release individual locks.
Both these targets output a shell command that must be used to update
environment variables.
Manual locking can be used to protect a directory against interference
by an automated build job, while the user is looking at or modifying a
given port.
.Sh UPDATING PACKAGES
Instead of deinstalling each package and rebuilding from scratch, the
ports tree can be used to update installed packages.
The
.Cm update
target will replace an installed package using
.Xr pkg_add 1
in replacement mode.
If
.Ev FORCE_UPDATE
is set to
.Dv Yes ,
dependencies will also be updated first, and packages will always be updated,
even if there is no difference between the old and the new packages.
.Pp
Updates use a mechanism similar to bulk cookies and deposit cookies in
the
.Ev UPDATE_COOKIES_DIR .
See the next section for more details, since most of the fine points of
bulk package building also apply to updates.
.Pp
There are bugs in the ports tree, most related to libtool, which make some
updates prefer the already installed libraries instead of the newly built
ones.
This shows up as undefined references in libraries, in which case there
is no choice but to proceed the old way: deinstall the offending package
and everything built on top of it, build and install new packages.
.Sh BULK PACKAGE BUILDING
Building any significant number of packages from the ports tree should use
.Xr dpb 1 ,
a tool located inside the ports tree proper
.Po
normally as
.Pa /usr/ports/infrastructure/bin/dpb
.Pc .
In particular, it can take advantage of machine clusters (same architecture
and same installation), and of multi-core machines.
.Pp
A few remarks may save a lot of time:
.Bl -bullet
.It
The default limits in
.Xr login.conf 5
are inappropriate for bulk builds.
.Va maxproc , openfiles , datasize
should be cranked way up, especially for parallel builds.
For instance, a lot of C++-based ports will require a
.Va datasize
over 1G.
.It
Cluster builds should have shared
.Ev PORTSDIR
and local
.Ev WRKOBJDIR .
If possible, dedicated
.Ev WRKOBJDIR
partitions mounted
.Sq noatime,async
will help.
.It
As far as possible, the log directory should be local to the machine running
.Xr dpb 1 .
.It
A full bulk will fetch over 20G of distfiles and create over 17G of packages.
The largest work directories are about 10G each.
.It
Take notice of
.Ev CHECKSUM_PACKAGES
in
.Xr bsd.port.mk 5 .
This can be set to
.Sq ftp
during official package builds to compute partial sha256 checksum files.
.Pp
At the end of the build, just
.Bd -literal -offset indent
cd ${PORTSDIR}/packages/${MACHINE_ARCH}/cksums && cat * >sha256
.Ed
.El
.Sh NETWORK CONFIGURATION
The variables pertaining to network access have been marshalled into
.Pa ${PORTSDIR}/infrastructure/templates/network.conf.template .
.Pp
To customize that setup, copy that file into
.Pa ${PORTSDIR}/infrastructure/db/network.conf
and edit it.
.Bl -tag -width MASTER_SITES
.It Ev MASTER_SITE_OPENBSD
If set to
.Dv Yes ,
include the master
.Ox
site when fetching files.
.It Ev MASTER_SITE_FREEBSD
If set to
.Dv Yes ,
include the master
.Fx
site when fetching files.
.It Ev MASTER_SITE_OVERRIDE
Go to this site first for all files.
.El
.Sh FLAVORS
The
.Ox
ports tree comes with a mechanism called
.Ic FLAVORS .
Thanks to this mechanism, users can select specific options provided by
a given port.
.Pp
If a port is
.Qq flavored ,
there should be a terse description of available flavors in the
.Pa pkg/DESCR
file.
.Pp
For example, the
.Pa misc/screen
port comes with a flavor called
.Ic static .
This changes the building process so a statically compiled version of
the program will be built.
To avoid confusion with other packages or flavors,
the package name will be extended with a dash-separated list of
the selected flavors.
.Pp
In this instance, the corresponding package will be called
.Ic screen-4.0.2-static .
.Pp
To see the flavors of a port, use the
.Cm show
target:
.Bd -literal -offset indent
$ make show=FLAVORS
.Ed
.Pp
To build a port with a specific flavor, just pass
.Ev FLAVOR
in the environment of the
.Xr make 1
command:
.Bd -literal -offset indent
$ env FLAVOR="static" make package
.Ed
.Pp
and of course, use the same settings for the subsequent invocations of make:
.Bd -literal -offset indent
$ env FLAVOR="static" make install
$ env FLAVOR="static" make clean
.Ed
.Pp
More than one flavor may be specified:
.Bd -literal -offset indent
$ cd /usr/ports/mail/exim
$ env FLAVOR="mysql ldap" make package
.Ed
.Pp
Specifying a flavor that does not exist is an error.
Additionally, some ports impose some further restrictions on flavor
combinations, when such combinations do not make sense.
.Pp
Lots of ports can be built without X11 requirement and accordingly
have a
.Ic no_x11
flavor.
.Pp
Flavor settings are not propagated to dependencies.
If a specific combination is needed, careful hand-building of the
required set of packages is still necessary.
.Sh MULTI_PACKAGES
The
.Ox
ports tree comes with a mechanism called
.Ic MULTI_PACKAGES .
This mechanism is used when a larger package is broken down into
several smaller components referred to as subpackages.
.Pp
If a port is
.Qq subpackaged ,
each subpackage will have a corresponding description in the
.Pa pkg/DESCR-subpackage
file.
.Pp
For example, the
.Pa databases/mariadb
port comes with subpackages called
.Ic -main ,
.Ic -tests
and
.Ic -server .
.Pp
In this instance, the build will yield multiple packages, one
corresponding to each subpackage.
In the case of our mariadb example,
the packages will be called
.Ic mariadb-client-<version> ,
.Ic mariadb-tests-<version> ,
and
.Ic mariadb-server-<version> .
.Pp
To install/deinstall a specific subpackage of a port, you may
.Xr pkg_add 1
them manually, or alternatively, you may set
.Ev SUBPACKAGE
in the environment of the
.Xr make 1
command during the install/deinstall phase:
.Bd -literal -offset indent
$ env SUBPACKAGE="-server" make install
$ env SUBPACKAGE="-server" make deinstall
.Ed
.Sh PORT VARIABLES
These can be changed in the environment, or in
.Pa /etc/mk.conf
for persistence.
They can also be set on make's command line, e.g.,
.Ic make VAR_FOO Ns = Ns Dv foo
.Pp
Boolean variables should be set to
.Dv Yes
instead of simply being defined, for uniformity and future compatibility.
.Pp
Variable names starting with
.Sq _
are private to the ports infrastructure,
should not be changed by the user, and are liable to change without notice.
.Bl -tag -width MASTER_SITES
.It Ev PORTSDIR
Location of the ports tree
(usually
.Pa /usr/ports ) .
.It Ev DISTDIR
Where to find/put distfiles, normally
.Pa ${PORTSDIR}/distfiles .
.It Ev PACKAGE_REPOSITORY
Used only for the
.Cm package
target; the base directory for the packages tree, normally
.Pa ${PORTSDIR}/packages .
If this directory exists, the package tree will be (partially) constructed.
.It Ev BULK_COOKIES_DIR
During bulk package building, used to store cookies for already built
packages to avoid rebuilding them, since the actual
working directory will already have been cleaned out.
Defaults to
.Pa ${PORTSDIR}/bulk/${MACHINE_ARCH} .
.It Ev UPDATE_COOKIES_DIR
Used to store cookies for package updates, defaults to
.Pa ${PORTSDIR}/update/${MACHINE_ARCH} .
If set to empty, it will revert to a file under
.Pa ${WRKDIR} .
.It Ev LOCALBASE
Where to install things in general
(usually
.Pa /usr/local ) .
.It Ev MASTER_SITES
Primary sites for distribution files if not found locally.
.It Ev CLEANDEPENDS
If set to
.Dv Yes ,
let
.Cm clean
recurse to dependencies.
.It Ev FETCH_CMD
Command to use to fetch files.
Normally
.Xr ftp 1 .
.It Ev FETCH_PACKAGES
If set to
.Dv Yes ,
try to use
.Xr pkg_add 1
to install the missing packages from
.Ev PKG_PATH .
.It Ev PATCH_DEBUG
If defined, display verbose output when applying each patch.
.It Ev INTERACTIVE
If defined, only operate on a port if it requires interaction.
.It Ev BATCH
If defined, only operate on a port if it can be installed 100% automatically.
.El
.Sh USING A READ-ONLY PORTS TREE
Select read-write partition(s) that can accommodate working directories, the
distfiles repository, and the built packages.
Set
.Ev WRKOBJDIR ,
.Ev PACKAGE_REPOSITORY ,
.Ev BULK_COOKIES_DIR ,
.Ev UPDATE_COOKIES_DIR ,
.Ev DISTDIR ,
and
.Ev PLIST_DB
in
.Pa /etc/mk.conf
accordingly.
.Sh FILES
.Bl -tag -width /usr/ports/xxxxxxxx -compact
.It Pa /usr/ports
The default ports directory.
.It Pa /usr/ports/Makefile
Ports master Makefile.
.It Pa /usr/ports/INDEX
Ports index.
.It Pa /usr/ports/infrastructure/mk/bsd.port.mk
The ports main engine.
.It Pa /usr/ports/infrastructure/templates/network.conf.template
Network configuration defaults.
.It Pa /usr/ports/infrastructure/db/network.conf
Local network configuration.
.It Pa /usr/ports/infrastructure/db/user.list
List of users and groups created by ports.
.El
.Sh SEE ALSO
.Xr dpb 1 ,
.Xr make 1 ,
.Xr pkg_add 1 ,
.Xr pkg_create 1 ,
.Xr pkg_delete 1 ,
.Xr pkg_info 1 ,
.Xr bsd.port.mk 5 ,
.Xr port-modules 5 ,
.Xr mirroring-ports 7 ,
.Xr packages 7
.Pp
The
.Ox
Ports System:
.Lk https://www.openbsd.org/faq/faq15.html#Ports
.Pp
The
.Ox
Porter's Handbook:
.Lk https://www.openbsd.org/faq/ports/
.Sh HISTORY
.Nm The Ports Collection
appeared in
.Fx 1.0 .
It was introduced in
.Ox
by Ejovi Nuwere, with much initial effort by Angelos D. Keromytis.
Maintenance passed then to Marco S. Hyman, and then to Christopher Turan.
It is currently managed by Marc Espie, Christian Weisgerber,
along with a host of others found at
.Mt ports@@openbsd.org .
.Sh AUTHORS
This man page was originated by
.An David O'Brien ,
from the
.Fx
project.
@


1.109
log
@remove systrace
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.108 2016/04/07 20:43:50 tb Exp $
d29 1
a29 1
.Dd $Mdocdate: April 7 2016 $
d66 1
a66 1
.Pq Lk http://www.openbsd.org/faq/faq15.html#Ports .
d71 1
a71 1
.Pq Lk http://www.openbsd.org/faq/ports/ .
d731 1
a731 1
.Lk http://www.openbsd.org/faq/faq15.html#Ports
d736 1
a736 1
.Lk http://www.openbsd.org/faq/ports/
@


1.108
log
@Link to faq15.html#Ports instead of just faq15.html. This matches the
DESCRIPTION section that sthen@@ fixed in November and reflects the
content of the former faq/ports/ports.html better.

discussed with jmc@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.107 2016/04/07 07:50:55 jmc Exp $
a683 13
.It Ev USE_SYSTRACE
Set to
.Dv Yes
to protect the
.Cm configure , build ,
and
.Cm fake
targets with
.Xr systrace 1 .
This way it is ensured that ports do not make any network connections
during build or write outside some well defined directories.
The filter list is stored in
.Pa ${PORTSDIR}/infrastructure/db/systrace.filter .
a712 2
.It Pa /usr/ports/infrastructure/db/systrace.filter
Filter list for systrace.
@


1.107
log
@update the ports link; from solene rapenne
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.106 2015/11/24 21:27:03 sthen Exp $
d29 1
a29 1
.Dd $Mdocdate: November 24 2015 $
d746 1
a746 1
.Lk http://www.openbsd.org/faq/faq15.html
@


1.106
log
@Fix a link that got broken by a recent change that was made to the web pages.
Pointed out by Jan Stary, but I used the faq15 URL because the suggested one
is linked a couple of lines below already.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.105 2015/09/21 21:43:23 schwarze Exp $
d29 1
a29 1
.Dd $Mdocdate: September 21 2015 $
d746 1
a746 1
.Lk http://www.openbsd.org/faq/ports/ports.html
@


1.105
log
@punctuation and upper case fixes; Michael Reed <m dot reed at mykolab dot com>
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.104 2015/09/21 21:27:51 schwarze Exp $
d66 1
a66 1
.Pq Lk http://www.openbsd.org/faq/ports/ports.html .
@


1.104
log
@Mark up login.conf(5) variable names as .Va, not .Ar,
like in the login.conf(5) manual itself.
Patch from Michael Reed <m dot reed at mykolab dot com>.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.103 2015/08/24 12:57:14 bentley Exp $
d29 1
a29 1
.Dd $Mdocdate: August 24 2015 $
d442 1
a442 1
A few remarks may save a lot of time
d454 1
a454 1
cluster builds should have shared
d464 1
a464 1
as far as possible, the log directory should be local to the machine running
d467 1
a467 1
a full bulk will fetch over 20G of distfiles, create over 17G of packages.
d637 1
a637 1
.Pa ${PORTSDIR}/distfiles
@


1.103
log
@Mark up command arguments properly using Cm.

From Michael Reed.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.102 2015/07/30 08:03:50 jmc Exp $
d29 1
a29 1
.Dd $Mdocdate: July 30 2015 $
d448 1
a448 1
.Ar maxproc , openfiles , datasize
d451 1
a451 1
.Ar datasize
@


1.102
log
@switch references from sudo to doas;
ok deraadt
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.101 2015/02/17 16:29:16 bentley Exp $
d29 1
a29 1
.Dd $Mdocdate: February 17 2015 $
d83 1
a83 1
.It Ar index
d86 1
a86 1
.It Ar pkglocatedb
d93 1
a93 1
.It Ar print-index
d95 1
a95 1
.It Ar search
d131 1
a131 1
.Ar clean
d134 1
a134 1
	$ make category=x11 clean
d204 9
a212 9
.Ar all , build , checksum , clean ,
.Ar configure , extract , fake ,
.Ar fetch , install , distclean ,
.Ar deinstall , reinstall , package , prepare ,
.Ar link-categories , unlink-categories ,
.Ar describe , show , regress ,
.Ar lib-depends-check , homepage-links , manpages-check ,
.Ar license-check , all-dir-depends , build-dir-depends ,
.Ar run-dir-depends
d214 1
a214 1
.Ar readmes .
d224 1
a224 1
.Ar build
d228 1
a228 1
.Ar install ,
d230 1
a230 1
.Ar fetch .
d232 1
a232 1
.Ar install
d238 1
a238 1
.Ar build
d240 1
a240 1
.Ar install
d243 1
a243 1
.It Ar fetch
d256 1
a256 1
.It Ar checksum
d273 1
a273 1
.It Ar prepare
d281 1
a281 1
.It Ar extract
d283 1
a283 1
.It Ar patch
d285 1
a285 1
.It Ar configure
d292 1
a292 1
.It Ar build
d295 1
a295 1
.Ar all
d297 1
a297 1
.It Ar fake
d299 1
a299 1
.It Ar package
d304 1
a304 1
.It Ar install
d310 1
a310 1
.It Ar print-build-depends , print-run-depends
d312 1
a312 1
.It Ar clean
d318 1
a318 1
.It Ar distclean
d321 1
a321 1
.It Ar regress
d324 1
a324 1
.It Ar reinstall
d327 1
a327 1
.It Ar update
d329 1
a329 1
.Ar install .
d331 1
a331 1
.It Ar link-categories
d334 1
a334 1
.It Ar unlink-categories
d336 2
a337 2
.Ar link-categories .
.It Ar homepage-links
d378 6
a383 6
.Ar fetch ,
.Ar checksum ,
.Ar extract ,
.Ar patch ,
.Ar configure ,
.Ar build ,
d395 1
a395 1
.Ar lock
d397 1
a397 1
.Ar unlock
d408 1
a408 1
.Ar update
d534 1
a534 1
.Ar show
d640 1
a640 1
.Ar package
d665 1
a665 1
.Ar clean
d688 1
a688 1
.Ar configure , build ,
d690 1
a690 1
.Ar fake
@


1.101
log
@Mark up email addresses semantically with Mt.

ok schwarze@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.100 2014/11/08 21:06:43 brad Exp $
d29 1
a29 1
.Dd $Mdocdate: November 8 2014 $
d59 1
a59 1
.Ic sudo make install
@


1.100
log
@Replace mysql with mariadb.

From Kaspars Bankovskis <kaspars at bankovskis dot net>
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.99 2014/09/08 01:27:55 schwarze Exp $
d29 1
a29 1
.Dd $Mdocdate: September 8 2014 $
d761 2
a762 1
along with a host of others found at ports@@openbsd.org.
@


1.99
log
@obvious cases of missing .An;
found with the new mandoc(1) MANDOCERR_AN_MISSING warning;
no text changes
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.98 2014/01/20 05:07:49 schwarze Exp $
d29 1
a29 1
.Dd $Mdocdate: January 20 2014 $
d588 1
a588 1
.Pa database/mysql
d597 1
a597 1
In the case of our mysql example,
d599 2
a600 2
.Ic mysql-client-<version> ,
.Ic mysql-tests-<version> ,
d602 1
a602 1
.Ic mysql-server-<version> .
@


1.98
log
@Obvious .Xr fixes, found while testing mandocdb(8).
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.97 2013/11/26 17:53:50 sthen Exp $
d29 1
a29 1
.Dd $Mdocdate: November 26 2013 $
d764 2
a765 1
David O'Brien, from the
@


1.97
log
@mirror-maker has gone, replace the entry talking about this with an Xr to
mirroring-ports(7). ok espie@@ jmc@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.96 2013/11/11 21:14:29 zhuk Exp $
d29 1
a29 1
.Dd $Mdocdate: November 11 2013 $
d252 1
a252 1
.Xr dpb
@


1.96
log
@Fix REPORT_PROBLEM_LOGFILE description.

okay espie@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.95 2013/06/19 08:59:02 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: June 19 2013 $
a85 3
.It Ar mirror-maker
see
.Xr mirroring-ports 7 ,
d740 1
@


1.95
log
@refer to dpb for bulk fetch
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.94 2013/03/14 16:05:19 ajacoutot Exp $
d29 1
a29 1
.Dd $Mdocdate: March 14 2013 $
d198 1
a198 1
echo $$d ($@@) >$${REPORT_PROBLEM_LOGFILE}
@


1.94
log
@Kill unused ACCEPT_JRL_LICENSE.

ok kurt@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.93 2013/01/08 09:42:16 rpe Exp $
d29 1
a29 1
.Dd $Mdocdate: January 8 2013 $
d254 5
@


1.93
log
@- add a hint to sh(1) for patterns in SKIPDIR
- add example to show the flavors of a ports
- change like "packages in PORTSDIR" to ${PORTSDIR}/packages
- some other minor cleanups/corrections

consistently use ...
- .Ar for make targets
- .Dv for values of variables (e.g. Yes)
- .Ev for environment vars
- .Pa for filenames/paths and ports
- .Qq instead of literal ""
- .Sq for quoting _ (underscore) within text

ok espie@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.92 2013/01/07 11:09:33 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: January 7 2013 $
a450 7
.It
.Pa devel/jdk/1.6
requires manually fetching distfiles, and setting up
.Ev ACCEPT_JRL_LICENSE Ns = Ns Dv Yes
in
.Pa /etc/mk.conf .
Not building it will take out a sizeable chunk of the ports tree.
@


1.92
log
@more hints for efficient bulks
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.91 2012/12/24 13:58:53 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: December 24 2012 $
d71 1
a71 1
.Lk http://www.openbsd.org/faq/ports/ .
d133 3
a135 1
For instance, to invoke clean on all ports in the x11 category, one can say:
d159 9
a167 2
is handled by a case statement, and so can contain simple wildcards, e.g.,
SKIPDIR='editors/openoffice*' .
d219 3
a221 1
Target names starting with _ are private to the ports infrastructure,
d300 1
a300 1
install the port on several machines with
d308 1
a308 1
.It Ar print-build-depends print-run-depends
d355 5
a359 2
Locks are named ${LOCKDIR}/${FULLPKGNAME}.lock,
or ${LOCKDIR}/${DISTFILE}.lock for distfiles fetching.
d413 1
a413 1
.Sq Yes ,
d454 1
a454 1
.Ev ACCEPT_JRL_LICENSE Ns = Ns Va Yes
d459 3
a461 1
cluster builds should have shared portsdir and local
d479 1
a479 1
this can be set to
d519 3
a521 2
If a port is "flavored", there should be a terse description of
available flavors in the
d525 3
a527 1
For example, the misc/screen port comes with a flavor called
d538 7
d586 3
a588 2
If a port is "subpackaged", each subpackage will have
a corresponding description in the
d592 3
a594 1
For example, the database/mysql port comes with subpackages called
d625 1
a625 1
.Ic make VAR_FOO=foo
d631 3
a633 1
Variable names starting with _ are private to the ports infrastructure,
d642 1
a642 3
.Pa distfiles/
in
.Ev PORTSDIR .
d647 1
a647 3
.Pa packages
in
.Ev PORTSDIR .
d653 2
a654 2
Defaults to bulk/${MACHINE_ARCH} under
.Ev PORTSDIR .
d656 4
a659 4
Used to store cookies for package updates, defaults to update/${MACHINE_ARCH}
under
.Ev PORTSDIR .
If set to empty, it will revert to a file under ${WRKDIR}.
d670 1
a670 1
.Sq clean
d678 1
a678 1
.Dq Yes ,
d691 1
a691 1
.Sq Yes
@


1.91
log
@add some clues for people who want to run full bulks
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.90 2012/08/12 17:01:35 schwarze Exp $
d29 1
a29 1
.Dd $Mdocdate: August 12 2012 $
d447 8
@


1.90
log
@Use .Lk for HTTP hyperlinks, not .Pa.
Most of the patch from Arto Jonsson <ajonsson at kapsi dot fi>.
jmc@@ agrees in principle that .Lk is the right macro to use.

While here, update a few broken links,
and add missing markup at a few places.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.89 2012/06/08 14:58:50 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: June 8 2012 $
d426 25
d463 1
@


1.89
log
@CHECKSUM_PACKAGES howto
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.88 2011/12/03 22:22:04 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: December 3 2011 $
d66 1
a66 1
.Pq Pa http://www.openbsd.org/faq/ports/ports.html .
d71 1
a71 1
.Pa http://www.openbsd.org/faq/ports/ .
d689 1
a689 1
.Pa http://www.openbsd.org/faq/ports/ports.html
d694 1
a694 1
.Pa http://www.openbsd.org/faq/ports/
@


1.88
log
@document prepare instead of depends
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.87 2011/11/25 11:05:54 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: November 25 2011 $
d425 13
@


1.87
log
@homepage-links
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.86 2011/09/23 18:59:38 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: September 23 2011 $
d197 1
a197 1
The targets that do this are
d201 1
a201 1
.Ar deinstall , reinstall , package ,
d260 1
a260 1
.It Ar depends
d262 1
a262 10
.Pq or package if only compilation is necessary
any dependencies of the current port.
When called by the
.Ar extract , install
or
.Ar fetch
targets, this is run in scattered pieces as
.Ar lib-depends , build-depends
and
.Ar run-depends .
@


1.86
log
@tell people to use dpb for bulk builds
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.85 2011/07/03 15:25:10 schwarze Exp $
d29 1
a29 1
.Dd $Mdocdate: July 3 2011 $
d333 3
@


1.85
log
@The BUGS that MANPS and MANZ are not supported in ports
were fixed by removing MANPS and MANZ everywhere else, too.
More power to fewer knobs!
Change prodded by jmc@@.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.84 2011/06/24 08:29:29 jasper Exp $
d29 1
a29 1
.Dd $Mdocdate: June 24 2011 $
d422 9
a430 34
The ports tree contains some mechanisms to save space when building
large collections of packages.
If
.Ev TRUST_PACKAGES
and
.Ev BULK
are set to
.Sq Yes
for a package build, some shortcuts are taken to allow cleaning up working
directories on the fly.
.Pp
Some important caveats apply:
the packages already built in the package repository are assumed to be
up-to-date, the database of installed packages is assumed
to be accurate (TRUST_PACKAGES), and the bulk cookies are assumed to be
up-to-date (BULK).
.Pp
This means that newer iterations of package buildings should make sure
those conditions are met, which entails erasing old package repository,
removing packages that need to be rebuilt from the base of installed
packages, and cleaning up old bulk cookies.
.Pp
If any of these conditions is not met, the package build may run into weird
problems.
.Pp
Some experimental framework allows for building a new set of packages
without first uninstalling the old ones: move the old packages away,
remove all bulk cookies and update cookies, and use the
.Ar update
target with
.Ev FORCE_UPDATE
set to
.Sq Yes
for the build.
d669 1
@


1.84
log
@- add PLIST_DB to the list of variables that need to be adjusted when using
a read-only ports tree.

suggested by Myk Taylor in pr 6618
"sure" aja@@ and reads fine to landry@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.83 2010/10/23 12:25:21 landry Exp $
d29 1
a29 1
.Dd $Mdocdate: October 23 2010 $
a726 6
.Sh BUGS
Use of the
.Dv MANPS
and
.Dv MANZ
variables is not supported.
@


1.83
log
@Remove the BUGS section that points to FreeBSD ports handbook.
agreed by espie@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.82 2010/07/29 17:38:13 steven Exp $
d29 1
a29 1
.Dd $Mdocdate: July 29 2010 $
d667 2
a668 1
.Ev UPDATE_COOKIES_DIR
d670 1
a670 1
.Ev DISTDIR
@


1.82
log
@change URLs to point to the more recent porter's handbook;
mention the use of packages first.

ok sthen@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.80 2010/05/01 10:30:41 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: June 20 2010 $
d719 1
a719 1
It is currently managed by Marc Espie, Brad Smith, and Christian Weisgerber,
a726 15
Ports documentation is split over several places ---
.Xr bsd.port.mk 5 ,
the
.Dq Ports Collection
section of the
.Fx
handbook, the
.Dq Porting Existing Software
section of the
.Fx
handbook,
and some man pages.
.Ox
adds a few web pages to further confuse the issue.
.Pp
@


1.81
log
@Document locks mechanism changes to default.
@
text
@d29 1
a29 1
.Dd $Mdocdate: May 1 2010 $
d65 2
a66 6
Ports Mechanism
.Pq Pa http://www.openbsd.org/ports.html
and the
.Ox
FAQ
.Pq Pa http://www.openbsd.org/faq/ .
d70 2
a71 2
Porting Checklist
.Pa http://www.openbsd.org/checklist.html .
d704 2
a705 2
Ports Mechanism:
.Pa http://www.openbsd.org/ports.html
d709 2
a710 2
Porting Checklist:
.Pa http://www.openbsd.org/checklist.html
@


1.80
log
@document STARTAFTER
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.79 2009/10/11 21:07:06 steven Exp $
d29 1
a29 1
.Dd $Mdocdate: October 11 2009 $
d341 2
a342 1
By default, this mechanism is disabled.
d345 1
a345 1
to a proper value will activate it.
@


1.79
log
@Xr port-modules(5)

ok jasper
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.77 2009/08/21 06:56:22 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: August 21 2009 $
d169 7
@


1.78
log
@zap trailing whitespace;
@
text
@d695 1
@


1.77
log
@Document SUBDIRLIST at least minimally (as noticed by matthieu@@)
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.76 2009/05/16 19:46:25 jmc Exp $
d29 1
a29 1
.Dd $Mdocdate: May 16 2009 $
d118 1
a118 1
One can define 
@


1.76
log
@sentences shall end in a full stop;
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.75 2009/05/15 22:30:03 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: May 15 2009 $
d118 6
@


1.75
log
@well, PATCH_SITES has been dead for years...
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.74 2009/03/25 11:42:21 sthen Exp $
d29 1
a29 1
.Dd $Mdocdate: March 25 2009 $
d581 2
a582 4
.Po
usually
.Pa /usr/ports
.Pc
d609 2
a610 4
.Po
usually
.Pa /usr/local
.Pc
@


1.74
log
@clarify wording of examples for subpackages, pointed out by Lajos Boróczki
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.73 2009/01/24 11:34:36 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: January 24 2009 $
d229 1
a229 3
.Ev MASTER_SITES
and
.Ev PATCH_SITES .
a616 3
.It Ev PATCH_SITES
Primary location(s) for distribution patch files if not found
locally.
@


1.73
log
@slightly better documentation for SKIPDIR
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.72 2008/01/12 14:17:33 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: January 12 2008 $
d542 2
a543 2
.Ic main ,
.Ic tests
d545 1
a545 1
.Ic server .
d550 1
a550 1
the subpackages will be called
@


1.72
log
@document manual locking: how it works, why it's there.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.71 2007/08/22 06:57:06 jmc Exp $
d29 1
a29 1
.Dd $Mdocdate: August 22 2007 $
d154 3
@


1.71
log
@kill trailing whitespace;
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.70 2007/08/15 14:20:54 espie Exp $
d29 1
a29 1
.Dd $Mdocdate: May 31 2007 $
d370 13
@


1.70
log
@Simplify locking description: most things have nice default values these
days, the casual user doesn't need more than defining LOCKDIR to get
locks working on the ports tree.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.69 2007/05/31 19:19:58 jmc Exp $
d329 1
a329 1
.Ev LOCKDIR 
@


1.69
log
@convert to new .Dd format;
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.68 2007/04/07 09:58:35 espie Exp $
d29 1
a29 1
.Dd $Mdocdate$
d329 2
a330 5
.Ev LOCKDIR ,
.Ev LOCK_CMD ,
and
.Ev UNLOCK_CMD
to proper values will activate it.
d341 6
@


1.68
log
@document STARTDIR
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.67 2006/12/23 15:30:28 espie Exp $
d29 1
a29 1
.Dd January 25, 1998
@


1.67
log
@mark regress as a top-level target, even though it's usually not run
by normal users.

Even your average src/ developers does not know about make regress, it
looks like ;-)
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.66 2006/12/05 11:11:36 bernd Exp $
d154 7
@


1.66
log
@- Fix typos.
- Document UPDATE_COOKIES_DIR.
- UPDATE_COOKIES_DIR needs to be set for using a read-only ports tree.

ok espie@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.65 2006/12/04 08:49:40 jmc Exp $
d300 3
@


1.65
log
@document FETCH_PACKAGES; from marcus popp
ok espie
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.64 2006/11/26 22:03:55 jmc Exp $
d142 1
a142 1
someone can, for examples, install all of the net
d163 1
d172 1
d374 1
a374 1
.Ev UPDATE_COOKIE_DIR .
d577 5
d635 3
a637 2
.Ev PKGREPOSITORYBASE ,
.Ev BULK_COOKIES_DIR
@


1.64
log
@- kill trailing space
- new sentence, new line
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.63 2006/11/26 17:54:25 espie Exp $
d596 7
@


1.63
log
@there's no longer a `special' main packages in MULTI_PACKAGES ports
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.62 2006/11/02 16:48:11 jmc Exp $
d505 1
a505 1
If a port is "subpackaged", each subpackage will have 
d522 1
a522 1
and 
@


1.62
log
@kill trailing space;
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.61 2006/11/02 09:58:09 espie Exp $
d505 2
a506 2
If a port is "subpackaged", in addition to the main package, each
subpackage will have a corresponding description in the
d511 1
d520 4
a523 1
.Ic mysql-tests-<version> and mysql-server-<version> .
@


1.61
log
@say goodbye to BIN_PACKAGES
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.60 2006/11/01 18:48:09 jmc Exp $
d386 1
a386 1
.Ev TRUST_PACKAGES 
@


1.60
log
@tweaks;
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.59 2006/11/01 13:06:48 espie Exp $
d386 1
a386 2
.Ev BIN_PACKAGES ,
.Ev TRUST_PACKAGES ,
d396 1
a396 1
up-to-date (BIN_PACKAGES), the database of installed packages is assumed
@


1.59
log
@be more directive, assume people really want binary packages, and will
resort to ports as a last resort.

Also, unconfuse the part about sudo and make install.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.58 2006/09/26 18:49:48 jmc Exp $
d42 1
a42 1
For normal usage, refer to
d44 2
a45 2
as most ports produce binary packages which are available from 
the official CD-Rom, or on a neighborly ftp mirror.
@


1.58
log
@use .Pa for urls and avoid broken links;

problem noticed by frederic culot (pr #5243)
ok deraadt pval
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.57 2006/09/17 22:09:12 espie Exp $
d39 8
a46 4
(shamelessly stolen from the
.Fx
Ports Collection) offers a simple way
for users and administrators to install applications.
d202 1
a202 1
Typical use only runs
d204 1
a204 1
explicitly (if root or
d206 1
a206 1
is defined in
@


1.57
log
@fix documentation
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.56 2006/08/16 13:18:15 jmc Exp $
d62 2
a63 1
(http://www.openbsd.org/ports.html) and the
d65 2
a66 1
FAQ (http://www.openbsd.org/faq/).
d70 2
a71 1
Porting Checklist (http://www.openbsd.org/checklist.html).
d651 2
a652 1
Ports Mechanism: http://www.openbsd.org/ports.html
d656 2
a657 1
Porting Checklist: http://www.openbsd.org/checklist.html
@


1.56
log
@fix an .Xr;
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.55 2006/08/16 09:54:45 espie Exp $
d345 2
a346 3
At no moment should a given invocation of
.Xr make 1
acquire the same lock twice, thus recursive locking is not needed for
d551 1
a551 1
.It Ev PKGREPOSITORYBASE
d555 1
a555 1
.Pa packages/${MACHINE_ARCH}
a558 8
This directory does not have to exist; if it doesn't, packages will be
placed into the current directory, or define one of
.Bl -tag -width PKGREPOSITORY
.It Ev PKGREPOSITORY
Directory to put the package in.
.It Ev PKGFILE
The full path to the package.
.El
@


1.55
log
@document updating ports, mention sqlports, update documentation for
REPORT_PROBLEMS.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.54 2006/05/08 11:16:20 steven Exp $
d355 1
a355 1
.Xr pkg_add 7
@


1.54
log
@we no longer have a static flavor for bash, replace the example with screen.
change a duplicate `make package' to `make install' while here.

ok espie@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.53 2005/09/04 18:21:38 pvalchev Exp $
d100 10
d162 1
a162 1
echo $$d >$${REPORT_PROBLEM_LOGFILE}
d164 2
a165 1
That is, any failure will append the faulty directory name to
d294 4
d349 27
@


1.53
log
@pkglocatedb is no longer compressed
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.52 2005/04/19 08:56:03 espie Exp $
d406 1
a406 1
For example, the shells/bash port comes with a flavor called
d415 1
a415 1
.Ic bash-1.14.7p1-static .
d428 1
a428 1
$ env FLAVOR="static" make package
@


1.52
log
@document REPORT_PROBLEM_LOGFILE, nitpick jmc@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.51 2005/03/31 21:15:58 pvalchev Exp $
d87 1
a87 1
build a compressed
d91 2
@


1.51
log
@point to correct variable for read-only ports tree; from Bernd Ahlers
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.50 2005/03/03 10:28:08 jmc Exp $
d144 11
@


1.50
log
@don't mark up punctuation;
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.49 2005/03/02 20:52:07 pvalchev Exp $
d565 1
a565 1
.Ev PACKAGES ,
@


1.49
log
@add pkglocatedb target description to "ports master makefile" target list
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.48 2005/02/06 15:02:47 jmc Exp $
d441 1
a441 1
.Ic MULTI_PACKAGES.
@


1.48
log
@MANPS/MANZ not supported;

from diana eichert (pr #4087);
ok henning@@;
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.47 2004/11/17 11:06:25 espie Exp $
d86 5
@


1.47
log
@document the new update framework for bulk builds.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.46 2004/10/27 03:10:24 jaredy Exp $
d632 6
@


1.46
log
@make distclean does not run make clean.  from Christian Jones
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.45 2004/10/14 04:35:25 pvalchev Exp $
d342 10
@


1.45
log
@typo; rd@@thrush.com
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.44 2004/07/20 10:33:34 jmc Exp $
d260 1
a260 3
Remove the port's distfile(s) and perform the
.Ar clean
operation.
@


1.44
log
@- fix macro args
- remove .Pp before .Sh
- whitespace
- new sentence, new line
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.43 2004/07/20 05:44:35 espie Exp $
d346 1
a346 1
.Pa ${PORTSDIR}/infrastructure/template/network.conf.template .
@


1.43
log
@Document locking infrastructure
ok naddy@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.42 2004/04/16 21:23:08 jmc Exp $
d278 1
a278 1
Defining 
d287 1
a287 1
.Ev LOCK_CMD 
d289 2
a290 1
.Ev UNLOCK_CMD should be used to release it.
d292 1
a292 1
Locks are named ${LOCKDIR}/${FULLPKGNAME}.lock, 
d296 2
a297 2
in a port directory will acquire the corresponding lock, complete its job, 
then release the lock, e.g., running 
d299 1
a299 1
$ make build 
d303 1
a303 1
through 
d314 1
a314 1
At no moment should a given invocation of 
d316 1
a316 1
acquire the same lock twice, thus recursive locking is not needed for 
d443 2
a444 1
corresponding to each subpackage. In the case of our mysql example,
a458 1
.Pp
@


1.42
log
@list/display fixes, and whitespace;
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.41 2004/01/22 21:07:10 espie Exp $
d274 43
@


1.41
log
@MULTI_PACKAGES for users.
from Michael Coulter <mjc@@bitz.ca>, thanks!
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.40 2003/09/03 09:10:30 jmc Exp $
d137 1
a137 1
	$ make REPORT_PROBLEM=true
d201 1
a201 1
	$ make checksum REFETCH=true
a306 1
.Pp
a351 1
.Pp
a409 1
.Pp
a427 1
.Pp
@


1.40
log
@- remove trailing whitespace
- fix an .Ar macro with too many args
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.39 2003/08/15 00:32:33 espie Exp $
d382 36
@


1.39
log
@Document SKIPDIR
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.38 2003/08/15 00:28:05 espie Exp $
d124 1
a124 1
These are always specified relative to the root of the ports tree, 
d141 5
a145 4
.Ar all , build , checksum , clean , configure ,
.Ar extract , fake , fetch , install ,
.Ar distclean , deinstall , reinstall , 
.Ar package , link-categories , unlink-categories ,
@


1.38
log
@match reality
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.37 2003/07/28 20:02:44 sturm Exp $
d120 10
@


1.37
log
@remove some withespace at EOL

noticed by jmc@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.36 2003/07/28 17:37:11 sturm Exp $
d131 1
a131 1
.Ar build , checksum , clean , configure ,
d133 6
a138 3
.Ar distclean , deinstall , reinstall , mirror-distfiles ,
.Ar obj , package , cdrom-packages , link-categories ,
.Ar unlink-categories ,
d140 1
a140 1
.Ar ftp-packages .
d203 1
a203 1
.Ar fetch-depends , lib-depends , build-depends , run-depends
d205 1
a205 1
.Ar misc-depends .
d240 1
a240 1
.It Ar depends-list package-depends
d397 1
a397 1
.It Ev PACKAGES
a435 6
.It Ev NOCLEANDEPENDS
If defined, don't let
.Sq clean
recurse to dependencies (deprecated, use
.Ev CLEANDEPENDS
instead).
a439 5
.It Ev FORCE_PKG_REGISTER
If set, overwrite any existing package registration on the system.
.Po
Not recommended.
.Pc
@


1.36
log
@document systrace related variables

espie@@ ok
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.35 2003/06/22 13:21:50 sturm Exp $
d457 2
a458 2
to protect the 
.Ar configure , build , 
@


1.35
log
@in FILES add a hint to db/user.list

espie@@ ok
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.34 2003/06/06 13:44:30 jmc Exp $
d454 13
d494 2
@


1.34
log
@- section reorder
- macro fixes
- kill whitespace at EOL
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.33 2003/04/15 07:02:40 david Exp $
d481 2
@


1.33
log
@missing space after mdoc macro argument
ok jmc@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.32 2003/04/13 11:20:47 jmc Exp $
d131 5
a135 3
.Ar build , checksum , clean , configure , extract , fake, fetch ,
.Ar install , distclean , deinstall, reinstall, mirror-distfiles, obj ,
.Ar package , cdrom-packages , link-categories, unlink-categories ,
d269 1
a269 1
.Sq Yes 
d274 3
a276 3
the packages already built in the package repository are assumed to be 
up-to-date (BIN_PACKAGES), the database of installed packages is assumed 
to be accurate (TRUST_PACKAGES), and the bulk cookies are assumed to be 
d314 1
a314 1
.Ic FLAVORS.
d318 1
a318 1
If a port is "flavored", there should be a terse description of 
d324 1
a324 1
.Ic static.
d326 2
a327 2
the program will be built. 
To avoid confusion with other packages or flavors, 
d334 1
a334 1
To build a port with a specific flavor, just pass 
d363 1
a363 1
flavor. 
d386 1
a386 1
usually 
d411 4
a414 4
During bulk package building, used to store cookies for already built 
packages to avoid rebuilding them, since the actual  
working directory will already have been cleaned out. 
Defaults to bulk/${MACHINE_ARCH} under 
a497 5
.Sh AUTHORS
This man page was originated by
David O'Brien, from the
.Fx
project.
d508 5
@


1.32
log
@try to use the X Window System, X11 or XFree86 consistently.

diffs from Paul Weismann, via mickey@@
aided, abetted and ok'd matthieu@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.31 2003/03/16 16:36:47 avsm Exp $
d194 1
a194 1
.Ar extract, install
@


1.31
log
@- BSD -> Ox
- Point people to our documentation and not the freebsd/netbsd handbooks
- Add checklist.html to the See Also section

ok pvalchev@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.30 2003/03/15 18:19:53 avsm Exp $
d358 1
a358 1
Lots of ports can be built without X Windows requirement and accordingly
@


1.30
log
@- Reference to php4 flavors replaced with exim (php uses subpackages now)

- Dont encourage 'env FLAVOR=blah make install', since this breaks with a
  lot of subpackaged ports; instead replace 'install' with 'package'

- Remove some of the freebsd/netbsd references which are obsolete now

- /usr/share/mk/bsd.port.mk doesnt exist, so Xr bsd.port.mk(5) instead

ok pvalchev@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.29 2003/02/27 00:41:20 david Exp $
d44 2
a45 1
application source code compile and run on BSD.
d62 3
a64 1
(http://www.openbsd.org/ports.html).
d66 1
a66 3
.\" .Xr porting 7
.\" and
Building an
d68 1
a68 8
Port (http://www.openbsd.org/porting.html).
Other excellent resources are the ports and porting sections of the
.Fx
Handbook (http://www.freebsd.org/handbook/ports.html and
http://www.freebsd.org/handbook/porting.html) as well as the
.Nx
Package System documentation
(ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/Packages.txt).
d491 1
a491 1
Porting Checklist: http://www.openbsd.org/checklist.html
d494 2
a495 2
.Fx
handbook.
@


1.29
log
@update link to NetBSD Package System docs
reported by pwillia@@scnc.chelsea.k12.mi.us in PR 3111
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.28 2003/01/14 18:28:21 espie Exp $
d350 1
a350 1
$ env FLAVOR="static" make install
d356 2
a357 2
$ cd /usr/ports/www/php4
$ env FLAVOR="imap ldap recode" make install
d388 3
a390 2
Location of the ports tree.
This is
d392 1
a392 8
on
.Fx
and
.Ox
and
.Pa /usr/pkgsrc
on
.Nx .
d474 1
a474 9
The default ports directory (
.Fx
and
.Ox
).
.It Pa /usr/pkgsrc
The default ports directory (
.Nx
).
d480 1
a480 3
The ports main engine (
.Ox
).
d482 1
a482 3
Network configuration defaults (
.Ox
).
d484 1
a484 3
Local network configuration (
.Ox
).
d519 1
a519 1
.Pa /usr/share/mk/bsd.port.mk ,
@


1.28
log
@Document read-only ports tree usage under new WRKOBJDIR rules.
Add description of BULK_COOKIES_DIR, since that must also be moved
for bulk packages building in ro portsdir mode.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.27 2002/11/17 12:03:37 espie Exp $
d74 1
a74 1
(http://www.netbsd.org/Documentation/netbsd/Packages.txt).
@


1.27
log
@spelling
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.26 2002/08/29 07:34:31 wcobb Exp $
d408 1
a408 1
.Pa packages/${ARCH}
d420 6
d470 2
a471 1
.Ev PACKAGES
a476 5
do a
.Li "cd /usr/ports && make obj"
to create working directories stubs.
.Pa /usr/ports
may now be remounted read-only.
@


1.26
log
@- replace empty lines by .Pp where appropriate.
- no empty lines at end of file.
ok mpech@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.25 2002/05/08 19:34:13 millert Exp $
d266 1
a266 1
large collection of packages.
@


1.25
log
@Add http://www.openbsd.org/checklist.html to SEE ALSO; espie@@ OK
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.24 2002/04/17 17:12:59 espie Exp $
d112 1
a112 1

d117 1
a117 1

d135 1
a135 1

d193 1
a193 1

d293 1
a293 1

@


1.24
log
@Document bulk package building.

Stress important conditions that should be met for bugs to be avoided.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.23 2002/04/04 20:54:08 espie Exp $
d512 4
@


1.23
log
@document flavors. Based on comments by several people.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.22 2002/01/24 22:52:27 jsyn Exp $
d264 26
@


1.22
log
@update ports system history; ok espie@@
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.21 2001/10/09 20:55:26 espie Exp $
d115 1
a115 1
	make category=x11 clean
d133 1
a133 1
	make REPORT_PROBLEM=true
d191 1
a191 1
	make checksum REFETCH=true
d288 58
@


1.21
log
@Oops, merge from stable...
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.20 2001/08/03 15:21:16 mpech Exp $
d444 3
a446 4
Maintenance passed then to Marco S Hyman,
it is currently managed by Christopher Turan,
with much help from Marc Espie, Kevin Lo, Brad Smith, Christian Weisgerber,
and a host of others found at ports@@openbsd.org.
@


1.20
log
@o) We don't like .Pp before/after .Sh;
o) .Nm always has argument in .Sh SYNOPSIS;
o) We always closes .Bl and .Bd tags;

millert@@ ok
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.19 2001/06/26 06:48:53 dugsong Exp $
d336 1
a336 1
.It Ev PREFIX
d365 3
a367 2
.It Ev MOTIFLIB
Location of libXm.{a,so}.
@


1.19
log
@speling, from jsyn@@nthought.com
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.18 2001/03/06 23:03:46 brad Exp $
d418 1
@


1.18
log
@OpenBSD -> .Ox
NetBSD -> .Nx
FreeBSD -> .Fx
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.17 2001/03/01 16:11:22 aaron Exp $
d441 2
a442 2
by Ejowi Nuwere, with much initial effort by Angelos D. Keromytis.
Maintainance passed then to Marco S Hyman,
@


1.18.2.1
log
@Reflect reality:
- LOCALBASE is what you set to install the ports tree elsewhere.
Setting PREFIX in /etc/mk.conf is a bad idea.
- MOTIF_LIB is no longer needed, thanks to the openmotif port.
- FORCE_PKG_REGISTER becomes more and more dangerous as binary packages
integration becomes better.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.18 2001/03/06 23:03:46 brad Exp $
d336 1
a336 1
.It Ev LOCALBASE
d365 2
a366 3
.Po
Not recommended.
.Pc
@


1.17
log
@A slew of share/ man page fixes; nordin@@cse.ogi.edu. These have been sitting
in my INBOX since Nov 6, 2000, probably forgot about them since the tree was
frozen at that time.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.16 2001/02/09 09:42:26 reinhard Exp $
d37 2
a38 1
.Nm OpenBSD Ports Collection
d43 1
a43 3
Each
.Em port
contains any patches necessary to make the original
d58 3
a60 1
.Nm The OpenBSD Ports Mechanism
d65 3
a67 2
.Nm Building an OpenBSD Port
(http://www.openbsd.org/porting.html).
d69 4
a72 2
FreeBSD Handbook (http://www.freebsd.org/handbook/ports.html and
http://www.freebsd.org/handbook/porting.html) as well as the NetBSD
d186 3
a188 2
The main OpenBSD mirror should still hold a copy of old distfiles, indexed
by checksum.
d276 3
a278 1
include the master OpenBSD site when fetching files.
d282 3
a284 1
include the master FreeBSD site when fetching files.
d308 1
a308 2
.\" .Fx
FreeBSD
d310 1
a310 2
.\" .Ox ,
OpenBSD
d393 5
a397 1
The default ports directory (FreeBSD and OpenBSD).
d399 3
a401 1
The default ports directory (NetBSD).
d407 3
a409 1
The ports main engine (OpenBSD).
d411 3
a413 1
Network configuration defaults (OpenBSD).
d415 3
a417 1
Local network configuration (OpenBSD).
d427 3
a429 1
The FreeBSD handbook.
@


1.16
log
@o) ${PORTSDIR}/infrastructure
o) naddy prefers to be called Christian
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.15 2000/12/27 18:23:16 espie Exp $
d126 1
a126 1
Default behavior is to call exit, but this can be overriden on the command
d142 1
a142 1
In the following list, each target will run the preceeding targets
@


1.15
log
@Reality-check: install goes through fake/package now (most often).
Document link-categories, unlink-categories.
Point to bsd.port.mk(5) as a more comprehensive document.
More accurate history.
Use .Fx/.Ox where I can.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.14 2000/10/13 04:09:21 aaron Exp $
d261 1
a261 1
.Pa ${PORTSDIR}/template/network.conf.template .
d264 1
a264 1
.Pa ${PORTSDIR}/db/network.conf
d423 1
a423 1
with much help from Marc Espie, Kevin Lo, Brad Smith, Christopher Weisgerber,
@


1.14
log
@Remove unwanted trailing whitespace.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.13 2000/09/12 14:45:47 todd Exp $
d38 3
a40 1
(shamelessly stolen from the FreeBSD Ports Collection) offers a simple way
d72 2
d133 1
a133 1
.Ar build , checksum , clean , configure , extract , fetch , fetch-list ,
d135 1
a135 1
.Ar list-distfiles , package , cdrom-packages
d154 5
a158 1
explicitly (if root), or
d192 1
a192 1
.Pq or compile if only compilation is necessary
d223 7
d231 1
a231 1
Install the port and register it with the package system.
a235 3
.It Ar fetch-list
Build a script that lists the files needing to be fetched in order to
build the port.
d252 6
a257 13
.It Ar package
Make a binary package for the port.
The port will be installed if it hasn't already been.
The package is a .tgz file that can be used to
install the port on other machines with
.Xr pkg_add 1 .
If the directory specified by
.Ev PACKAGES
does not exist the package will be put into the current directory.
See
.Ev PKGREPOSITORY
and
.Ev PKGFILE .
d405 1
d411 3
a413 8
David O'Brien.
The FreeBSD ports collection is maintained by Satoshi Asami
and the awesome ports team.
The OpenBSD ports collection has been maintained by
Marco S Hyman in the past.
It is currently managed by Christopher Turan,
with much help from Brad Smith
and a host of others found at ports@@openbsd.org.
d416 9
a424 1
appeared in FreeBSD 1.0.
d426 1
a426 1
Ports documentation is split over four places ---
d430 3
a432 1
section of the FreeBSD handbook, the
d434 6
a439 3
section of the FreeBSD handbook, and
.Xr ports 7 .
OpenBSD adds a few web pages to further confuse the issue.
@


1.13
log
@no longer do ports populate /usr/X11R6
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.12 2000/07/17 16:52:27 danh Exp $
d191 1
a191 1
.Ar fetch-depends , lib-depends , build-depends , run-depends 
@


1.12
log
@fixed incorrect reference to mirroring-distfiles(7) to mirroring-ports(7).
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.11 2000/07/14 18:13:43 espie Exp $
a328 2
or
.Pa /usr/X11R6
@


1.11
log
@Document REFETCH, network configuration,
using a read-only ports tree.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.10 2000/04/19 01:39:58 espie Exp $
d83 1
a83 1
.Xr mirroring-distfiles 7 ,
@


1.10
log
@Document the way distfiles are mirrored.
Document a few things that changed in the ports tree.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.9 2000/03/19 19:25:37 aaron Exp $
d60 2
d173 9
d191 3
a193 1
.Ar fetch-depends , lib-depends , build-depends , run-depends , misc-depends .
d254 20
a287 8
.Ss NETWORK CONFIGURATION
The variables pertaining to network access have been marshalled into
.Pa ${PORTSDIR}/template/network.conf.template .

To customize that setup, copy that file into
.Pa ${PORTSDIR}/db/network.conf
and edit it.
.Pp
d312 1
a312 1
.Pa packages/
a336 10
.It Ev MASTER_SITE_OPENBSD
If set to
.Dv Yes ,
go to the master OpenBSD site for all files.
.It Ev MASTER_SITE_FREEBSD
If set to
.Dv Yes ,
go to the master FreeBSD site for all files.
.It Ev MASTER_SITE_OVERRIDE
Try going to this site for all files and patches, first.
d352 1
a352 1
.Xr fetch 1 .
d364 16
d401 2
a402 1
.Xr pkg_info 1
@


1.9
log
@Various cleanups.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.8 2000/01/29 20:22:30 espie Exp $
d70 2
a71 2
.Pa /usr/ports/Makefile 
(but see 
d79 3
d83 1
a83 1
display the contents of the index in a user-friendly way.
d85 1
a85 1
invoked with a key, e.g., 
d87 24
a110 1
retrieve information relevant to a given port.
d116 10
d127 1
a127 1
.Ar build , checksum , clean , configure , extract , fetch , fetch-list , 
d129 1
a129 1
.Ar list-distfiles 
d131 1
a131 1
.Ar package .
d146 1
a146 1
Typical use only runs 
d148 1
a148 1
explicitly (if root), or 
d151 1
a151 1
.Ar install 
d183 1
a183 1
to 
d209 1
a209 1
Build a script that lists the files needing to be fetched in order to 
d242 1
a242 1
These can be changed in the environment, or in 
d248 1
a248 1
Boolean variables should be set to 
d314 1
a314 1
.Dv Yes , 
d318 1
a318 1
.Dv Yes , 
d323 1
a323 1
If set to 
d325 2
a326 2
let 
.Sq clean 
d331 2
a332 2
recurse to dependencies (deprecated, use 
.Ev CLEANDEPENDS 
@


1.8
log
@* try to incite user NOT to build ports as root,
* make _target and _VAR explicitly off-limits,
* remove instances of you, inappropriate for manpages,
* turn some gibberish into a better approximation of english.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.7 2000/01/27 19:45:33 espie Exp $
d43 2
a44 2
application source code compile and run on BSD.  Compiling an
application is as simple as typing
d46 2
a47 1
in the port directory!  The
d51 2
a52 2
on the local system, applies the patches, and compiles it.  If all goes well,
simply type
d89 2
a90 1
ports.  The targets that do this are
d97 1
a97 1
Target names starting with _  are private to the ports infrastructure,
d101 2
a102 1
in order automatically.  That is,
d138 2
a139 1
any dependencies of the current port.  When called by the
d155 3
a157 2
Configure the port.  Some ports will ask questions during
this stage.  See
d162 2
a163 1
Build the port.  This is the same as calling the
d167 1
a167 1
Install the port and register it with the package system.  
d178 2
a179 1
Remove the expanded source code.  This does not recurse to dependencies unless
d186 2
a187 1
operation.  This does not recurse to dependencies.
d192 3
a194 2
Make a binary package for the port.  The port will be installed if it
hasn't already been.  The package is a .tgz file that can be used to
d208 2
a209 1
for persistence.  They can also be set on make's command line, e.g.,
d229 2
a230 1
Location of the ports tree.  This is
d299 2
a300 1
Command to use to fetch files.  Normally
d341 4
a344 2
and the awesome ports team.  The OpenBSD ports collection has been maintained by
Marco S Hyman in the past. It is currently managed by Christopher Turan,
@


1.7
log
@Reflect current practice somewhat better.
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.6 1999/07/09 13:35:37 aaron Exp $
d50 1
a50 1
on your system, applies the patches, and compiles it.  If all goes well,
d52 1
a52 1
.Ic make install
d86 2
a87 2
Some of these targets work recursively through subdirectories.
This lets you, for example, install all of the net
d95 5
a99 2
The following targets will be run automatically by each proceeding
target in order.  That is,
d107 7
a113 2
You will usually only target
.Ar install .
d151 1
a151 1
Configure the port.  Some ports will ask you questions during
d161 1
a161 2
Install the port and register it with the package system.  This
is all you really need to do.
d185 1
a185 1
hasn't already been.  The package is a .tgz file that you can use to
d199 1
a199 1
for persistence.  You can also set them on make's command line, e.g.,
d206 3
d244 2
a245 2
This directory does not have to exist; if it doesn't packages will be
placed into the current directory, or you can define one of
d312 1
a312 1
The ports main engine.
d314 1
a314 1
Network configuration defaults.
d316 1
a316 1
Local network configuration.
@


1.6
log
@- remove all trailing whitespace
     * except when it is escaped with a `\' at the end of the line
- fix remaining .Nm usage as well
- this is from a patch I received from kwesterback@@home.com, who has been
  working on some scripts for fixing formatting errors in mdoc'd man pages

Ok, so there could be a cost/benefit debate with this commit, but since I have
the patch we might as well commit it...
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.5 1999/05/23 14:11:09 aaron Exp $
d67 17
d85 2
a86 1
Some of the targets work recursively through subdirectories.
d89 3
a91 1
.Ar build , checksum , clean , configure , extract , fetch , install ,
d121 2
d128 1
a128 1
.Ar extract
d131 3
a133 4
targets, this is run in piecemeal as
.Ar fetch-depends ,
.Ar build-depends ,
etc.  Defining
d135 2
d160 2
a161 1
Show list of files needed to be fetched in order to build the port.
d163 1
a163 2
Print a list of all the compile and run dependencies, and dependencies
of those dependencies.
d165 4
a168 3
Remove the expanded source code.  This recurses to dependencies unless
.Ev NOCLEANDEPENDS
is defined.
d172 1
a172 8
operation.  The
.Sq clean
portion recurses to dependencies unless
.Ev NOCLEANDEPENDS
is defined, but the
.Sq distclean
portion never recurses
.Pq this is perhaps a bug .
d189 18
a206 2
.Sh ENVIRONMENT VARIABLES
You can change all of these.
d256 3
a258 1
If set, go to the master OpenBSD site for all files.
d260 3
a262 1
If set, go to the master FreeBSD site for all files.
d265 6
d274 3
a276 1
recurse to dependencies.
d292 1
a292 1
.Bl -tag -width /usr/ports/xxxx -compact
d297 10
a306 2
.It Pa /usr/share/mk/bsd.port.mk
The big Kahuna.
d317 6
a322 5
.An David O'Brien .
The FreeBSD ports collection is maintained by
.An Satoshi Asami
and the awesome ports team.  The OpenBSD ports collection is maintained by
Marco S Hyman and a host of others found at ports@@openbsd.org.
a335 2
.Pp
This man page is too long.
@


1.5
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.4 1999/04/02 16:21:38 aaron Exp $
d40 1
a40 1
Each 
d46 1
a46 1
in the port directory!  The 
@


1.4
log
@.Pp macros do not belong immiedately after .Sh section header lines
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.3 1998/11/28 03:38:02 aaron Exp $
d31 1
a31 1
.Os OpenBSD 2.3
@


1.3
log
@share/man/man7/ man page repairs
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.2 1998/09/05 17:41:49 deraadt Exp $
a67 1
.Pp
@


1.2
log
@more man page repairs; aaron@@ug.cs.dal.ca
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.1 1998/06/24 18:15:08 marc Exp $
d47 1
a47 1
.Ql Pa Makefile
d90 5
a94 1
listed in MASTER_SITES and PATCH_SITES.  See
d260 1
a260 1
.Xr pkg_info 1 .
@


1.1
log
@add ports.7, stolen from freebsd
@
text
@d26 1
a26 1
.\" $OpenBSD: ports.7,v 1.7 1998/06/23 04:38:50 hoek Exp $
d123 1
a123 1
Build the the port.  This is the same as calling the
d127 1
a127 1
Install the the port and register it with the package system.  This
@

