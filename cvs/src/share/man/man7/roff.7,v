head	1.65;
access;
symbols
	OPENBSD_6_1:1.56.0.6
	OPENBSD_6_1_BASE:1.56
	VERSION_1_13:1.56.0.2
	OPENBSD_6_0:1.55.0.4
	OPENBSD_6_0_BASE:1.55
	OPENBSD_5_9:1.55.0.2
	OPENBSD_5_9_BASE:1.55
	OPENBSD_5_8:1.52.0.4
	OPENBSD_5_8_BASE:1.52
	OPENBSD_5_7:1.50.0.2
	OPENBSD_5_7_BASE:1.50
	OPENBSD_5_6:1.34.0.4
	OPENBSD_5_6_BASE:1.34
	OPENBSD_5_5:1.27.0.4
	OPENBSD_5_5_BASE:1.27
	OPENBSD_5_4:1.21.0.2
	OPENBSD_5_4_BASE:1.21
	OPENBSD_5_3:1.19.0.2
	OPENBSD_5_3_BASE:1.19
	OPENBSD_5_2:1.18.0.4
	OPENBSD_5_2_BASE:1.18
	OPENBSD_5_1_BASE:1.18
	OPENBSD_5_1:1.18.0.2
	OPENBSD_5_0:1.12.0.2
	OPENBSD_5_0_BASE:1.12
	OPENBSD_4_9:1.11.0.2
	OPENBSD_4_9_BASE:1.11;
locks; strict;
comment	@.\" @;


1.65
date	2017.06.06.15.00.56;	author schwarze;	state Exp;
branches;
next	1.64;
commitid	LdhzICSunbnL2oyB;

1.64
date	2017.06.04.22.43.50;	author schwarze;	state Exp;
branches;
next	1.63;
commitid	HuVlLkzV75UMAm6A;

1.63
date	2017.06.04.00.08.56;	author schwarze;	state Exp;
branches;
next	1.62;
commitid	utobDj41l6WSbX2y;

1.62
date	2017.06.02.19.21.03;	author schwarze;	state Exp;
branches;
next	1.61;
commitid	P297MbnOCh21x0GC;

1.61
date	2017.06.01.19.05.15;	author schwarze;	state Exp;
branches;
next	1.60;
commitid	dWvl4SBMkA0iJYZz;

1.60
date	2017.05.08.15.33.43;	author schwarze;	state Exp;
branches;
next	1.59;
commitid	wam7mxa5wtd9m7Af;

1.59
date	2017.05.08.03.55.09;	author schwarze;	state Exp;
branches;
next	1.58;
commitid	5MAaXECCtigft0PW;

1.58
date	2017.05.05.15.54.28;	author schwarze;	state Exp;
branches;
next	1.57;
commitid	YzKMRzpzlDZJgsRR;

1.57
date	2017.05.05.02.31.23;	author schwarze;	state Exp;
branches;
next	1.56;
commitid	4OU6Sh1kJFMje9Jc;

1.56
date	2017.02.21.23.44.39;	author schwarze;	state Exp;
branches;
next	1.55;
commitid	V9l6uUv5n0QkIhrP;

1.55
date	2015.09.23.09.23.49;	author sobrado;	state Exp;
branches;
next	1.54;
commitid	41zFUL6nXZi2JIur;

1.54
date	2015.08.29.22.39.59;	author schwarze;	state Exp;
branches;
next	1.53;
commitid	uZ3q71CI3hhNH9ko;

1.53
date	2015.08.29.21.37.11;	author schwarze;	state Exp;
branches;
next	1.52;
commitid	W2KOqVilZJ9avCRg;

1.52
date	2015.05.31.23.12.16;	author schwarze;	state Exp;
branches;
next	1.51;
commitid	LI7iM1p3QpsGk8nB;

1.51
date	2015.04.29.18.32.57;	author schwarze;	state Exp;
branches;
next	1.50;
commitid	Jraw3F5Czk5tAif5;

1.50
date	2015.02.17.17.16.11;	author schwarze;	state Exp;
branches;
next	1.49;
commitid	OFJD5u0rlv8RzJvR;

1.49
date	2015.01.29.00.33.14;	author schwarze;	state Exp;
branches;
next	1.48;
commitid	9zTrpiF37UnMIPmt;

1.48
date	2015.01.23.20.17.25;	author schwarze;	state Exp;
branches;
next	1.47;
commitid	RaU9eiJgbWR4z9Sc;

1.47
date	2015.01.23.07.41.16;	author jmc;	state Exp;
branches;
next	1.46;
commitid	pxDXjVZSfh6R0x34;

1.46
date	2015.01.23.00.38.42;	author schwarze;	state Exp;
branches;
next	1.45;
commitid	nzPhVsQa0WQJ7Tyu;

1.45
date	2015.01.21.23.48.05;	author jmc;	state Exp;
branches;
next	1.44;
commitid	3QW4eFSkR3GxLTuw;

1.44
date	2015.01.21.20.20.49;	author schwarze;	state Exp;
branches;
next	1.43;
commitid	oPCJQka1zVKJ04b2;

1.43
date	2015.01.20.22.34.15;	author jmc;	state Exp;
branches;
next	1.42;
commitid	bo1vi8nyRSYf3Y3p;

1.42
date	2015.01.20.21.12.46;	author schwarze;	state Exp;
branches;
next	1.41;
commitid	yL1piccWr1moLOpy;

1.41
date	2015.01.20.18.54.33;	author tedu;	state Exp;
branches;
next	1.40;
commitid	s3Le5lNxQdP1lfC1;

1.40
date	2014.12.25.17.18.40;	author schwarze;	state Exp;
branches;
next	1.39;
commitid	x8yeuHYTp1C1IKJI;

1.39
date	2014.12.02.10.07.17;	author schwarze;	state Exp;
branches;
next	1.38;
commitid	G1dK13T4nePhhgx3;

1.38
date	2014.11.19.01.20.18;	author schwarze;	state Exp;
branches;
next	1.37;
commitid	K22eowDUnG23Ymz9;

1.37
date	2014.09.07.00.21.23;	author schwarze;	state Exp;
branches;
next	1.36;
commitid	7q4cteBLaUEM9Gca;

1.36
date	2014.08.14.20.06.41;	author jmc;	state Exp;
branches;
next	1.35;
commitid	0CITFxbG9YOfpH6k;

1.35
date	2014.08.13.22.09.28;	author schwarze;	state Exp;
branches;
next	1.34;
commitid	HYRKgiWZb4BQrCNL;

1.34
date	2014.07.07.11.34.41;	author schwarze;	state Exp;
branches;
next	1.33;
commitid	SxiKID1BRkm7SsXU;

1.33
date	2014.04.08.01.36.50;	author schwarze;	state Exp;
branches;
next	1.32;

1.32
date	2014.04.07.15.05.12;	author schwarze;	state Exp;
branches;
next	1.31;

1.31
date	2014.04.05.20.33.38;	author schwarze;	state Exp;
branches;
next	1.30;

1.30
date	2014.03.30.21.27.59;	author schwarze;	state Exp;
branches;
next	1.29;

1.29
date	2014.03.30.19.47.32;	author schwarze;	state Exp;
branches;
next	1.28;

1.28
date	2014.03.08.04.43.38;	author schwarze;	state Exp;
branches;
next	1.27;

1.27
date	2014.02.14.23.50.49;	author schwarze;	state Exp;
branches;
next	1.26;

1.26
date	2013.12.26.02.43.12;	author schwarze;	state Exp;
branches;
next	1.25;

1.25
date	2013.12.15.21.18.00;	author schwarze;	state Exp;
branches;
next	1.24;

1.24
date	2013.10.22.20.37.54;	author schwarze;	state Exp;
branches;
next	1.23;

1.23
date	2013.10.14.01.42.25;	author schwarze;	state Exp;
branches;
next	1.22;

1.22
date	2013.08.08.20.07.24;	author schwarze;	state Exp;
branches;
next	1.21;

1.21
date	2013.07.13.19.44.14;	author schwarze;	state Exp;
branches;
next	1.20;

1.20
date	2013.04.27.17.15.01;	author jmc;	state Exp;
branches;
next	1.19;

1.19
date	2012.07.29.12.57.45;	author schwarze;	state Exp;
branches;
next	1.18;

1.18
date	2011.12.11.00.38.08;	author schwarze;	state Exp;
branches;
next	1.17;

1.17
date	2011.11.23.02.12.22;	author schwarze;	state Exp;
branches;
next	1.16;

1.16
date	2011.11.21.23.29.03;	author schwarze;	state Exp;
branches;
next	1.15;

1.15
date	2011.09.26.23.07.20;	author schwarze;	state Exp;
branches;
next	1.14;

1.14
date	2011.09.18.15.54.48;	author schwarze;	state Exp;
branches;
next	1.13;

1.13
date	2011.09.18.10.38.57;	author schwarze;	state Exp;
branches;
next	1.12;

1.12
date	2011.06.07.23.40.10;	author schwarze;	state Exp;
branches;
next	1.11;

1.11
date	2011.01.25.01.09.51;	author schwarze;	state Exp;
branches;
next	1.10;

1.10
date	2011.01.25.00.37.39;	author schwarze;	state Exp;
branches;
next	1.9;

1.9
date	2011.01.24.23.13.56;	author schwarze;	state Exp;
branches;
next	1.8;

1.8
date	2011.01.09.15.24.57;	author schwarze;	state Exp;
branches;
next	1.7;

1.7
date	2010.12.09.23.01.18;	author schwarze;	state Exp;
branches;
next	1.6;

1.6
date	2010.12.09.20.56.30;	author schwarze;	state Exp;
branches;
next	1.5;

1.5
date	2010.11.30.22.40.13;	author jmc;	state Exp;
branches;
next	1.4;

1.4
date	2010.11.30.21.17.52;	author schwarze;	state Exp;
branches;
next	1.3;

1.3
date	2010.11.29.00.12.02;	author schwarze;	state Exp;
branches;
next	1.2;

1.2
date	2010.11.28.01.00.41;	author schwarze;	state Exp;
branches;
next	1.1;

1.1
date	2010.11.27.21.57.23;	author schwarze;	state Exp;
branches;
next	;


desc
@@


1.65
log
@Minimal implementation of the roff(7) .ce request (center a number
of input lines without filling).
Contrary to groff, high-level macros abort .ce mode for now.
@
text
@.\"	$OpenBSD: roff.7,v 1.64 2017/06/04 22:43:50 schwarze Exp $
.\"
.\" Copyright (c) 2010, 2011, 2012 Kristaps Dzonsons <kristaps@@bsd.lv>
.\" Copyright (c) 2010,2011,2013-2015,2017 Ingo Schwarze <schwarze@@openbsd.org>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd $Mdocdate: June 4 2017 $
.Dt ROFF 7
.Os
.Sh NAME
.Nm roff
.Nd roff language reference for mandoc
.Sh DESCRIPTION
The
.Nm roff
language is a general purpose text formatting language.
Since traditional implementations of the
.Xr mdoc 7
and
.Xr man 7
manual formatting languages are based on it,
many real-world manuals use small numbers of
.Nm
requests and escape sequences intermixed with their
.Xr mdoc 7
or
.Xr man 7
code.
To properly format such manuals, the
.Xr mandoc 1
utility supports a tiny subset of
.Nm
requests and escapes.
Only these requests and escapes supported by
.Xr mandoc 1
are documented in the present manual,
together with the basic language syntax shared by
.Nm ,
.Xr mdoc 7 ,
and
.Xr man 7 .
For complete
.Nm
manuals, consult the
.Sx SEE ALSO
section.
.Pp
Input lines beginning with the control character
.Sq \&.
are parsed for requests and macros.
Such lines are called
.Dq request lines
or
.Dq macro lines ,
respectively.
Requests change the processing state and manipulate the formatting;
some macros also define the document structure and produce formatted
output.
The single quote
.Pq Qq \(aq
is accepted as an alternative control character,
treated by
.Xr mandoc 1
just like
.Ql \&.
.Pp
Lines not beginning with control characters are called
.Dq text lines .
They provide free-form text to be printed; the formatting of the text
depends on the respective processing context.
.Sh LANGUAGE SYNTAX
.Nm
documents may contain only graphable 7-bit ASCII characters, the space
character, and, in certain circumstances, the tab character.
The backslash character
.Sq \e
indicates the start of an escape sequence, used for example for
.Sx Comments ,
.Sx Special Characters ,
.Sx Predefined Strings ,
and
user-defined strings defined using the
.Sx ds
request.
For a listing of escape sequences, consult the
.Sx ESCAPE SEQUENCE REFERENCE
below.
.Ss Comments
Text following an escaped double-quote
.Sq \e\(dq ,
whether in a request, macro, or text line, is ignored to the end of the line.
A request line beginning with a control character and comment escape
.Sq \&.\e\(dq
is also ignored.
Furthermore, request lines with only a control character and optional
trailing whitespace are stripped from input.
.Pp
Examples:
.Bd -literal -offset indent -compact
\&.\e\(dq This is a comment line.
\&.\e\(dq The next line is ignored:
\&.
\&.Sh EXAMPLES \e\(dq This is a comment, too.
\&example text \e\(dq And so is this.
.Ed
.Ss Special Characters
Special characters are used to encode special glyphs and are rendered
differently across output media.
They may occur in request, macro, and text lines.
Sequences begin with the escape character
.Sq \e
followed by either an open-parenthesis
.Sq \&(
for two-character sequences; an open-bracket
.Sq \&[
for n-character sequences (terminated at a close-bracket
.Sq \&] ) ;
or a single one character sequence.
.Pp
Examples:
.Bl -tag -width Ds -offset indent -compact
.It Li \e(em
Two-letter em dash escape.
.It Li \ee
One-letter backslash escape.
.El
.Pp
See
.Xr mandoc_char 7
for a complete list.
.Ss Text Decoration
Terms may be text-decorated using the
.Sq \ef
escape followed by an indicator: B (bold), I (italic), R (regular), or P
(revert to previous mode).
A numerical representation 3, 2, or 1 (bold, italic, and regular,
respectively) may be used instead.
.Pp
The two-character indicator
.Sq BI
requests a font that is both bold and italic.
It may not be portable to old roff implementations.
.Pp
Examples:
.Bl -tag -width Ds -offset indent -compact
.It Li \efBbold\efR
Write in \fBbold\fP, then switch to regular font mode.
.It Li \efIitalic\efP
Write in \fIitalic\fP, then return to previous font mode.
.It Li \ef(BIbold italic\efP
Write in \f(BIbold italic\fP, then return to previous font mode.
.El
.Pp
Text decoration is
.Em not
recommended for
.Xr mdoc 7 ,
which encourages semantic annotation.
.Ss Predefined Strings
Predefined strings, like
.Sx Special Characters ,
mark special output glyphs.
Predefined strings are escaped with the slash-asterisk,
.Sq \e* :
single-character
.Sq \e*X ,
two-character
.Sq \e*(XX ,
and N-character
.Sq \e*[N] .
.Pp
Examples:
.Bl -tag -width Ds -offset indent -compact
.It Li \e*(Am
Two-letter ampersand predefined string.
.It Li \e*q
One-letter double-quote predefined string.
.El
.Pp
Predefined strings are not recommended for use,
as they differ across implementations.
Those supported by
.Xr mandoc 1
are listed in
.Xr mandoc_char 7 .
Manuals using these predefined strings are almost certainly not portable.
.Ss Whitespace
Whitespace consists of the space character.
In text lines, whitespace is preserved within a line.
In request and macro lines, whitespace delimits arguments and is discarded.
.Pp
Unescaped trailing spaces are stripped from text line input unless in a
literal context.
In general, trailing whitespace on any input line is discouraged for
reasons of portability.
In the rare case that a blank character is needed at the end of an
input line, it may be forced by
.Sq \e\ \e& .
.Pp
Literal space characters can be produced in the output
using escape sequences.
In macro lines, they can also be included in arguments using quotation; see
.Sx MACRO SYNTAX
for details.
.Pp
Blank text lines, which may include whitespace, are only permitted
within literal contexts.
If the first character of a text line is a space, that line is printed
with a leading newline.
.Ss Scaling Widths
Many requests and macros support scaled widths for their arguments.
The syntax for a scaled width is
.Sq Li [+-]?[0-9]*.[0-9]*[:unit:] ,
where a decimal must be preceded or followed by at least one digit.
Negative numbers, while accepted, are truncated to zero.
.Pp
The following scaling units are accepted:
.Pp
.Bl -tag -width Ds -offset indent -compact
.It c
centimetre
.It i
inch
.It P
pica (~1/6 inch)
.It p
point (~1/72 inch)
.It f
scale
.Sq u
by 65536
.It v
default vertical span
.It m
width of rendered
.Sq m
.Pq em
character
.It n
width of rendered
.Sq n
.Pq en
character
.It u
default horizontal span for the terminal
.It M
mini-em (~1/100 em)
.El
.Pp
Using anything other than
.Sq m ,
.Sq n ,
or
.Sq v
is necessarily non-portable across output media.
See
.Sx COMPATIBILITY .
.Pp
If a scaling unit is not provided, the numerical value is interpreted
under the default rules of
.Sq v
for vertical spaces and
.Sq u
for horizontal ones.
.Pp
Examples:
.Bl -tag -width ".Bl -tag -width 2i" -offset indent -compact
.It Li \&.Bl -tag -width 2i
two-inch tagged list indentation in
.Xr mdoc 7
.It Li \&.HP 2i
two-inch tagged list indentation in
.Xr man 7
.It Li \&.sp 2v
two vertical spaces
.El
.Ss Sentence Spacing
Each sentence should terminate at the end of an input line.
By doing this, a formatter will be able to apply the proper amount of
spacing after the end of sentence (unescaped) period, exclamation mark,
or question mark followed by zero or more non-sentence closing
delimiters
.Po
.Sq \&) ,
.Sq \&] ,
.Sq \&' ,
.Sq \&"
.Pc .
.Pp
The proper spacing is also intelligently preserved if a sentence ends at
the boundary of a macro line.
.Pp
Examples:
.Bd -literal -offset indent -compact
Do not end sentences mid-line like this.  Instead,
end a sentence like this.
A macro would end like this:
\&.Xr mandoc 1 \&.
.Ed
.Sh REQUEST SYNTAX
A request or macro line consists of:
.Pp
.Bl -enum -compact
.It
the control character
.Sq \&.
or
.Sq \(aq
at the beginning of the line,
.It
optionally an arbitrary amount of whitespace,
.It
the name of the request or the macro, which is one word of arbitrary
length, terminated by whitespace,
.It
and zero or more arguments delimited by whitespace.
.El
.Pp
Thus, the following request lines are all equivalent:
.Bd -literal -offset indent
\&.ig end
\&.ig    end
\&.   ig end
.Ed
.Sh MACRO SYNTAX
Macros are provided by the
.Xr mdoc 7
and
.Xr man 7
languages and can be defined by the
.Sx \&de
request.
When called, they follow the same syntax as requests, except that
macro arguments may optionally be quoted by enclosing them
in double quote characters
.Pq Sq \(dq .
Quoted text, even if it contains whitespace or would cause
a macro invocation when unquoted, is always considered literal text.
Inside quoted text, pairs of double quote characters
.Pq Sq Qq
resolve to single double quote characters.
.Pp
To be recognised as the beginning of a quoted argument, the opening
quote character must be preceded by a space character.
A quoted argument extends to the next double quote character that is not
part of a pair, or to the end of the input line, whichever comes earlier.
Leaving out the terminating double quote character at the end of the line
is discouraged.
For clarity, if more arguments follow on the same input line,
it is recommended to follow the terminating double quote character
by a space character; in case the next character after the terminating
double quote character is anything else, it is regarded as the beginning
of the next, unquoted argument.
.Pp
Both in quoted and unquoted arguments, pairs of backslashes
.Pq Sq \e\e
resolve to single backslashes.
In unquoted arguments, space characters can alternatively be included
by preceding them with a backslash
.Pq Sq \e\~ ,
but quoting is usually better for clarity.
.Pp
Examples:
.Bl -tag -width Ds -offset indent -compact
.It Li .Fn strlen \(dqconst char *s\(dq
Group arguments
.Qq const char *s
into one function argument.
If unspecified,
.Qq const ,
.Qq char ,
and
.Qq *s
would be considered separate arguments.
.It Li .Op \(dqFl a\(dq
Consider
.Qq \&Fl a
as literal text instead of a flag macro.
.El
.Sh REQUEST REFERENCE
The
.Xr mandoc 1
.Nm
parser recognises the following requests.
For requests marked as "ignored" or "unsupported", any arguments are
ignored, and the number of arguments is not checked.
.Bl -tag -width Ds
.It Ic \&ab Op Ar message
Abort processing.
Currently unsupported.
.It Ic \&ad Op Cm b | c | l | n | r
Set line adjustment mode for subsequent text.
Currently ignored.
.It Ic \&af Ar registername format
Assign an output format to a number register.
Currently ignored.
.It Ic \&aln Ar newname oldname
Create an alias for a number register.
Currently unsupported.
.It Ic \&als Ar newname oldname
Create an alias for a request, string, macro, or diversion.
Currently unsupported.
.It Ic \&am Ar macroname Op Ar endmacro
Append to a macro definition.
The syntax of this request is the same as that of
.Ic \&de .
.It Ic \&am1 Ar macroname Op Ar endmacro
Append to a macro definition, switching roff compatibility mode off
during macro execution (groff extension).
The syntax of this request is the same as that of
.Ic \&de1 .
Since
.Xr mandoc 1
does not implement
.Nm
compatibility mode at all, it handles this request as an alias for
.Ic \&am .
.It Ic \&ami Ar macrostring Op Ar endstring
Append to a macro definition, specifying the macro name indirectly
(groff extension).
The syntax of this request is the same as that of
.Ic \&dei .
.It Ic \&ami1 Ar macrostring Op Ar endstring
Append to a macro definition, specifying the macro name indirectly
and switching roff compatibility mode off during macro execution
(groff extension).
The syntax of this request is the same as that of
.Ic \&dei1 .
Since
.Xr mandoc 1
does not implement
.Nm
compatibility mode at all, it handles this request as an alias for
.Ic \&ami .
.It Ic \&as Ar stringname Op Ar string
Append to a user-defined string.
The syntax of this request is the same as that of
.Sx \&ds .
If a user-defined string with the specified name does not yet exist,
it is set to the empty string before appending.
.It Ic \&as1 Ar stringname Op Ar string
Append to a user-defined string, switching roff compatibility mode off
during macro execution (groff extension).
The syntax of this request is the same as that of
.Ic \&ds1 .
Since
.Xr mandoc 1
does not implement
.Nm
compatibility mode at all, it handles this request as an alias for
.Ic \&as .
.It Ic \&asciify Ar divname
Fully unformat a diversion.
Currently unsupported.
.It Ic \&backtrace
Print a backtrace of the input stack.
This is a groff extension and currently ignored.
.It Ic \&bd Ar font Oo Ar curfont Oc Op Ar offset
Artificially embolden by repeated printing with small shifts.
Currently ignored.
.It Ic \&bleedat Ar left top width height
Set the BleedBox page parameter for PDF generation.
This is a Heirloom extension and currently ignored.
.It Ic \&blm Ar macroname
Set a blank line trap.
Currently unsupported.
.It Ic \&box Ar divname
Begin a diversion without including a partially filled line.
Currently unsupported.
.It Ic \&boxa Ar divname
Add to a diversion without including a partially filled line.
Currently unsupported.
.It Ic \&bp Oo Cm + Ns | Ns Cm - Oc Ns Ar pagenumber
Begin a new page.
Currently ignored.
.It Ic \&BP Ar source height width position offset flags label
Define a frame and place a picture in it.
This is a Heirloom extension and currently unsupported.
.It Ic \&br
Break the output line.
.It Ic \&break
Break out of a
.Ic \&while
loop.
Currently unsupported.
.It Ic \&breakchar Ar char ...
Optional line break characters.
This is a Heirloom extension and currently ignored.
.It Ic \&brnl Ar N
Break output line after the next
.Ar N
input lines.
This is a Heirloom extension and currently ignored.
.It Ic \&brp
Break and spread output line.
Currently, this is implemented as an alias for
.Ic \&br .
.It Ic \&brpnl Ar N
Break and spread output line after the next
.Ar N
input lines.
This is a Heirloom extension and currently ignored.
.It Ic \&c2 Op Ar char
Change the no-break control character.
Currently unsupported.
.It Ic \&cc Op Ar char
Change the control character.
If
.Ar char
is not specified, the control character is reset to
.Sq \&. .
Trailing characters are ignored.
.It Ic \&ce Op Ar N
Center the next
.Ar N
input lines without filling.
.Ar N
defaults to 1.
An argument of 0 or less ends centering.
Currently, high level macros abort certering.
.It Ic \&cf Ar filename
Output the contents of a file.
Ignored because insecure.
.It Ic \&cflags Ar flags char ...
Set character flags.
This is a groff extension and currently ignored.
.It Ic \&ch Ar macroname Op Ar dist
Change a trap location.
Currently ignored.
.It Ic \&char Ar glyphname Op Ar string
Define a new glyph.
Currently unsupported.
.It Ic \&chop Ar stringname
Remove the last character from a macro, string, or diversion.
Currently unsupported.
.It Ic \&class Ar classname char ...
Define a character class.
This is a groff extension and currently ignored.
.It Ic \&close Ar streamname
Close an open file.
Ignored because insecure.
.It Ic \&CL Ar color text
Print text in color.
This is a Heirloom extension and currently unsupported.
.It Ic \&color Op Cm 1 | 0
Activate or deactivate colors.
This is a groff extension and currently ignored.
.It Ic \&composite Ar from to
Define a name component for composite glyph names.
This is a groff extension and currently unsupported.
.It Ic \&continue
Immediately start the next iteration of a
.Ic \&while
loop.
Currently unsupported.
.It Ic \&cp Op Cm 1 | 0
Switch
.Nm
compatibility mode on or off.
Currently ignored.
.It Ic \&cropat Ar left top width height
Set the CropBox page parameter for PDF generation.
This is a Heirloom extension and currently ignored.
.It Ic \&cs Ar font Op Ar width Op Ar emsize
Constant character spacing mode.
Currently ignored.
.It Ic \&cu Op Ar N
Underline next
.Ar N
input lines including whitespace.
Currently ignored.
.It Ic \&da Ar divname
Append to a diversion.
Currently unsupported.
.It Ic \&dch Ar macroname Op Ar dist
Change a trap location in the current diversion.
This is a Heirloom extension and currently unsupported.
.It Ic \&de Ar macroname Op Ar endmacro
Define a
.Nm
macro.
Its syntax can be either
.Bd -literal -offset indent
.Pf . Ic \&de Ar macroname
.Ar definition
\&..
.Ed
.Pp
or
.Bd -literal -offset indent
.Pf . Ic \&de Ar macroname Ar endmacro
.Ar definition
.Pf . Ar endmacro
.Ed
.Pp
Both forms define or redefine the macro
.Ar macroname
to represent the
.Ar definition ,
which may consist of one or more input lines, including the newline
characters terminating each line, optionally containing calls to
.Nm
requests,
.Nm
macros or high-level macros like
.Xr man 7
or
.Xr mdoc 7
macros, whichever applies to the document in question.
.Pp
Specifying a custom
.Ar endmacro
macro works in the same way as for
.Ic \&ig ;
namely, the call to
.Sq Pf . Ar endmacro
first ends the
.Ar definition ,
and after that, it is also evaluated as a
.Nm
request or
.Nm
macro, but not as a high-level macro.
.Pp
The macro can be invoked later using the syntax
.Pp
.D1 Pf . Ar macroname Op Ar argument Op Ar argument ...
.Pp
Regarding argument parsing, see
.Sx MACRO SYNTAX
above.
.Pp
The line invoking the macro will be replaced
in the input stream by the
.Ar definition ,
replacing all occurrences of
.No \e\e$ Ns Ar N ,
where
.Ar N
is a digit, by the
.Ar N Ns th Ar argument .
For example,
.Bd -literal -offset indent
\&.de ZN
\efI\e^\e\e$1\e^\efP\e\e$2
\&..
\&.ZN XtFree .
.Ed
.Pp
produces
.Pp
.D1 \efI\e^XtFree\e^\efP.
.Pp
in the input stream, and thus in the output: \fI\^XtFree\^\fP.
Each occurrence of \e\e$* is replaced with all the arguments,
joined together with single blank characters.
.Pp
Since macros and user-defined strings share a common string table,
defining a macro
.Ar macroname
clobbers the user-defined string
.Ar macroname ,
and the
.Ar definition
can also be printed using the
.Sq \e*
string interpolation syntax described below
.Ic ds ,
but this is rarely useful because every macro definition contains at least
one explicit newline character.
.Pp
In order to prevent endless recursion, both groff and
.Xr mandoc 1
limit the stack depth for expanding macros and strings
to a large, but finite number, and
.Xr mandoc 1
also limits the length of the expanded input line.
Do not rely on the exact values of these limits.
.It Ic \&de1 Ar macroname Op Ar endmacro
Define a
.Nm
macro that will be executed with
.Nm
compatibility mode switched off during macro execution.
This is a groff extension.
Since
.Xr mandoc 1
does not implement
.Nm
compatibility mode at all, it handles this request as an alias for
.Ic \&de .
.It Ic \&defcolor Ar newname scheme component ...
Define a color name.
This is a groff extension and currently ignored.
.It Ic \&dei Ar macrostring Op Ar endstring
Define a
.Nm
macro, specifying the macro name indirectly (groff extension).
The syntax of this request is the same as that of
.Ic \&de .
The effect is the same as:
.Pp
.D1 Pf . Cm \&de No \e* Ns Bo Ar macrostring Bc Op \e* Ns Bq Ar endstring
.It Ic \&dei1 Ar macrostring Op Ar endstring
Define a
.Nm
macro that will be executed with
.Nm
compatibility mode switched off during macro execution,
specifying the macro name indirectly (groff extension).
Since
.Xr mandoc 1
does not implement
.Nm
compatibility mode at all, it handles this request as an alias for
.Ic \&dei .
.It Ic \&device Ar string ...
.It Ic \&devicem Ar stringname
These two requests only make sense with the groff-specific intermediate
output format and are unsupported.
.It Ic \&di Ar divname
Begin a diversion.
Currently unsupported.
.It Ic \&do Ar command Op Ar argument ...
Execute
.Nm
request or macro line with compatibility mode disabled.
Currently unsupported.
.It Ic \&ds Ar stringname Op Oo \(dq Oc Ns Ar string
Define a user-defined string.
The
.Ar stringname
and
.Ar string
arguments are space-separated.
If the
.Ar string
begins with a double-quote character, that character will not be part
of the string.
All remaining characters on the input line form the
.Ar string ,
including whitespace and double-quote characters, even trailing ones.
.Pp
The
.Ar string
can be interpolated into subsequent text by using
.No \e* Ns Bq Ar stringname
for a
.Ar stringname
of arbitrary length, or \e*(NN or \e*N if the length of
.Ar stringname
is two or one characters, respectively.
Interpolation can be prevented by escaping the leading backslash;
that is, an asterisk preceded by an even number of backslashes
does not trigger string interpolation.
.Pp
Since user-defined strings and macros share a common string table,
defining a string
.Ar stringname
clobbers the macro
.Ar stringname ,
and the
.Ar stringname
used for defining a string can also be invoked as a macro,
in which case the following input line will be appended to the
.Ar string ,
forming a new input line passed to the
.Nm
parser.
For example,
.Bd -literal -offset indent
\&.ds badidea .S
\&.badidea
H SYNOPSIS
.Ed
.Pp
invokes the
.Ic SH
macro when used in a
.Xr man 7
document.
Such abuse is of course strongly discouraged.
.It Ic \&ds1 Ar stringname Op Oo \(dq Oc Ns Ar string
Define a user-defined string that will be expanded with
.Nm
compatibility mode switched off during string expansion.
This is a groff extension.
Since
.Xr mandoc 1
does not implement
.Nm
compatibility mode at all, it handles this request as an alias for
.Ic \&ds .
.It Ic \&dwh Ar dist macroname
Set a location trap in the current diversion.
This is a Heirloom extension and currently unsupported.
.It Ic \&dt Op Ar dist macroname
Set a trap within a diversion.
Currently unsupported.
.It Ic \&ec Op Ar char
Enable the escape mechanism and change the escape character.
The
.Ar char
argument defaults to the backslash
.Pq Sq \e .
.It Ic \&ecr
Restore the escape character.
Currently unsupported.
.It Ic \&ecs
Save the escape character.
Currently unsupported.
.It Ic \&el Ar body
The
.Dq else
half of an if/else conditional.
Pops a result off the stack of conditional evaluations pushed by
.Ic \&ie
and uses it as its conditional.
If no stack entries are present (e.g., due to no prior
.Ic \&ie
calls)
then false is assumed.
The syntax of this request is similar to
.Ic \&if
except that the conditional is missing.
.It Ic \&em Ar macroname
Set a trap at the end of input.
Currently unsupported.
.It Ic \&EN
End an equation block.
See
.Ic \&EQ .
.It Ic \&eo
Disable the escape mechanism completely.
.It Ic \&EP
End a picture started by
.Ic \&BP .
This is a Heirloom extension and currently unsupported.
.It Ic \&EQ
Begin an equation block.
See
.Xr eqn 7
for a description of the equation language.
.It Ic \&errprint Ar message
Print a string like an error message.
This is a Heirloom extension and currently ignored.
.It Ic \&ev Op Ar envname
Switch to another environment.
Currently unsupported.
.It Ic \&evc Op Ar envname
Copy an environment into the current environment.
Currently unsupported.
.It Ic \&ex
Abort processing and exit.
Currently unsupported.
.It Ic \&fallback Ar curfont font ...
Select the fallback sequence for a font.
This is a Heirloom extension and currently ignored.
.It Ic \&fam Op Ar familyname
Change the font family.
This is a groff extension and currently ignored.
.It Ic \&fc Op Ar delimchar Op Ar padchar
Define a delimiting and a padding character for fields.
Currently unsupported.
.It Ic \&fchar Ar glyphname Op Ar string
Define a fallback glyph.
Currently unsupported.
.It Ic \&fcolor Ar colorname
Set the fill color for \eD objects.
This is a groff extension and currently ignored.
.It Ic \&fdeferlig Ar font string ...
Defer ligature building.
This is a Heirloom extension and currently ignored.
.It Ic \&feature Cm + Ns | Ns Cm - Ns Ar name
Enable or disable an OpenType feature.
This is a Heirloom extension and currently ignored.
.It Ic \&fi
Switch to fill mode.
See
.Xr man 7 .
Ignored in
.Xr mdoc 7 .
.It Ic \&fkern Ar font minkern
Control the use of kerning tables for a font.
This is a Heirloom extension and currently ignored.
.It Ic \&fl
Flush output.
Currently ignored.
.It Ic \&flig Ar font string char ...
Define ligatures.
This is a Heirloom extension and currently ignored.
.It Ic \&fp Ar position font Op Ar filename
Assign font position.
Currently ignored.
.It Ic \&fps Ar mapname ...
Mount a font with a special character map.
This is a Heirloom extension and currently ignored.
.It Ic \&fschar Ar font glyphname Op Ar string
Define a font-specific fallback glyph.
This is a groff extension and currently unsupported.
.It Ic \&fspacewidth Ar font Op Ar afmunits
Set a font-specific width for the space character.
This is a Heirloom extension and currently ignored.
.It Ic \&fspecial Ar curfont Op Ar font ...
Conditionally define a special font.
This is a groff extension and currently ignored.
.It Ic \&ft Op Ar font
Change the font.
The following
.Ar font
arguments are supported:
.Bl -tag -width 4n -offset indent
.It Cm B , BI , 3 , 4
switches to
.Sy bold
font
.It Cm I , 2
switches to
.Em underlined
font
.It Cm R , CW , 1
switches to normal font
.It Cm P No "or no argument"
switches back to the previous font
.El
.Pp
This request takes effect only locally and may be overridden
by macros and escape sequences.
.It Ic \&ftr Ar newname Op Ar oldname
Translate font name.
This is a groff extension and currently ignored.
.It Ic \&fzoom Ar font Op Ar permille
Zoom font size.
Currently ignored.
.It Ic \&gcolor Op Ar colorname
Set glyph color.
This is a groff extension and currently ignored.
.It Ic \&hc Op Ar char
Set the hyphenation character.
Currently ignored.
.It Ic \&hcode Ar char code ...
Set hyphenation codes of characters.
Currently ignored.
.It Ic \&hidechar Ar font char ...
Hide characters in a font.
This is a Heirloom extension and currently ignored.
.It Ic \&hla Ar language
Set hyphenation language.
This is a groff extension and currently ignored.
.It Ic \&hlm Op Ar number
Set maximum number of consecutive hyphenated lines.
Currently ignored.
.It Ic \&hpf Ar filename
Load hyphenation pattern file.
This is a groff extension and currently ignored.
.It Ic \&hpfa Ar filename
Load hyphenation pattern file, appending to the current patterns.
This is a groff extension and currently ignored.
.It Ic \&hpfcode Ar code code ...
Define mapping values for character codes in hyphenation patterns.
This is a groff extension and currently ignored.
.It Ic \&hw Ar word ...
Specify hyphenation points in words.
Currently ignored.
.It Ic \&hy Op Ar mode
Set automatic hyphenation mode.
Currently ignored.
.It Ic \&hylang Ar language
Set hyphenation language.
This is a Heirloom extension and currently ignored.
.It Ic \&hylen Ar nchar
Minimum word length for hyphenation.
This is a Heirloom extension and currently ignored.
.It Ic \&hym Op Ar length
Set hyphenation margin.
This is a groff extension and currently ignored.
.It Ic \&hypp Ar penalty ...
Define hyphenation penalties.
This is a Heirloom extension and currently ignored.
.It Ic \&hys Op Ar length
Set hyphenation space.
This is a groff extension and currently ignored.
.It Ic \&ie Ar condition body
The
.Dq if
half of an if/else conditional.
The result of the conditional is pushed into a stack used by subsequent
invocations of
.Ic \&el ,
which may be separated by any intervening input (or not exist at all).
Its syntax is equivalent to
.Ic \&if .
.It Ic \&if Ar condition body
Begin a conditional.
This request can also be written as follows:
.Bd -unfilled -offset indent
.Pf . Ic \&if Ar condition No \e{ Ns Ar body
.Ar body ... Ns \e}
.Ed
.Bd -unfilled -offset indent
.Pf . Ic \&if Ar condition No \e{\e
.Ar body ...
.Pf . No \e}
.Ed
.Pp
The
.Ar condition
is a boolean expression.
Currently,
.Xr mandoc 1
supports the following subset of roff conditionals:
.Bl -bullet
.It
If
.Sq \&!
is prefixed to
.Ar condition ,
it is logically inverted.
.It
If the first character of
.Ar condition
is
.Sq n
.Pq nroff mode
or
.Sq o
.Pq odd page ,
it evaluates to true.
.It
If the first character of
.Ar condition
is
.Sq c
.Pq character available ,
.Sq d
.Pq string defined ,
.Sq e
.Pq even page ,
.Sq t
.Pq troff mode ,
or
.Sq v
.Pq vroff mode ,
it evaluates to false.
.It
If the first character of
.Ar condition
is
.Sq r ,
it evaluates to true if the rest of
.Ar condition
is the name of an existing number register;
otherwise, it evaluates to false.
.It
If the
.Ar condition
starts with a parenthesis or with an optionally signed
integer number, it is evaluated according to the rules of
.Sx Numerical expressions
explained below.
It evaluates to true if the result is positive,
or to false if the result is zero or negative.
.It
Otherwise, the first character of
.Ar condition
is regarded as a delimiter and it evaluates to true if the string
extending from its first to its second occurrence is equal to the
string extending from its second to its third occurrence.
.It
If
.Ar condition
cannot be parsed, it evaluates to false.
.El
.Pp
If a conditional is false, its children are not processed, but are
syntactically interpreted to preserve the integrity of the input
document.
Thus,
.Pp
.D1 \&.if t .ig
.Pp
will discard the
.Sq \&.ig ,
which may lead to interesting results, but
.Pp
.D1 \&.if t .if t \e{\e
.Pp
will continue to syntactically interpret to the block close of the final
conditional.
Sub-conditionals, in this case, obviously inherit the truth value of
the parent.
.Pp
If the
.Ar body
section is begun by an escaped brace
.Sq \e{ ,
scope continues until the end of the input line containing the
matching closing-brace escape sequence
.Sq \e} .
If the
.Ar body
is not enclosed in braces, scope continues until the end of the line.
If the
.Ar condition
is followed by a
.Ar body
on the same line, whether after a brace or not, then requests and macros
.Em must
begin with a control character.
It is generally more intuitive, in this case, to write
.Bd -unfilled -offset indent
.Pf . Ic \&if Ar condition No \e{\e
.Pf . Ar request
.Pf . No \e}
.Ed
.Pp
than having the request or macro follow as
.Pp
.D1 Pf . Ic \&if Ar condition Pf \e{. Ar request
.Pp
The scope of a conditional is always parsed, but only executed if the
conditional evaluates to true.
.Pp
Note that the
.Sq \e}
is converted into a zero-width escape sequence if not passed as a
standalone macro
.Sq \&.\e} .
For example,
.Pp
.D1 \&.Fl a \e} b
.Pp
will result in
.Sq \e}
being considered an argument of the
.Sq \&Fl
macro.
.It Ic \&ig Op Ar endmacro
Ignore input.
Its syntax can be either
.Bd -literal -offset indent
.Pf . Cm \&ig
.Ar ignored text
\&..
.Ed
.Pp
or
.Bd -literal -offset indent
.Pf . Cm \&ig Ar endmacro
.Ar ignored text
.Pf . Ar endmacro
.Ed
.Pp
In the first case, input is ignored until a
.Sq \&..
request is encountered on its own line.
In the second case, input is ignored until the specified
.Sq Pf . Ar endmacro
is encountered.
Do not use the escape character
.Sq \e
anywhere in the definition of
.Ar endmacro ;
it would cause very strange behaviour.
.Pp
When the
.Ar endmacro
is a roff request or a roff macro, like in
.Pp
.D1 \&.ig if
.Pp
the subsequent invocation of
.Ic \&if
will first terminate the
.Ar ignored text ,
then be invoked as usual.
Otherwise, it only terminates the
.Ar ignored text ,
and arguments following it or the
.Sq \&..
request are discarded.
.It Ic \&in Op Oo Cm + Ns | Ns Cm - Oc Ns Ar width
Change indentation.
See
.Xr man 7 .
Ignored in
.Xr mdoc 7 .
.It Ic \&index Ar register stringname substring
Find a substring in a string.
This is a Heirloom extension and currently unsupported.
.It Ic \&it Ar expression macro
Set an input line trap.
The named
.Ar macro
will be invoked after processing the number of input text lines
specified by the numerical
.Ar expression .
While evaluating the
.Ar expression ,
the unit suffixes described below
.Sx Scaling Widths
are ignored.
.It Ic \&it Ar expression macro
Set an input line trap, not counting lines ending with \ec.
Currently unsupported.
.It Ic \&IX Ar class keystring
To support the generation of a table of contents,
.Xr pod2man 1
emits this user-defined macro, usually without defining it.
To avoid reporting large numbers of spurious errors,
.Xr mandoc 1
ignores it.
.It Ic \&kern Op Cm 1 | 0
Switch kerning on or off.
Currently ignored.
.It Ic \&kernafter Ar font char ... afmunits ...
Increase kerning after some characters.
This is a Heirloom extension and currently ignored.
.It Ic \&kernbefore Ar font char ... afmunits ...
Increase kerning before some characters.
This is a Heirloom extension and currently ignored.
.It Ic \&kernpair Ar font char ... font char ... afmunits
Add a kerning pair to the kerning table.
This is a Heirloom extension and currently ignored.
.It Ic \&lc Op Ar glyph
Define a leader repetition character.
Currently unsupported.
.It Ic \&lc_ctype Ar localename
Set the
.Dv LC_CTYPE
locale.
This is a Heirloom extension and currently unsupported.
.It Ic \&lds Ar macroname string
Define a local string.
This is a Heirloom extension and currently unsupported.
.It Ic \&length Ar register string
Count the number of input characters in a string.
Currently unsupported.
.It Ic \&letadj Ar lspmin lshmin letss lspmax lshmax
Dynamic letter spacing and reshaping.
This is a Heirloom extension and currently ignored.
.It Ic \&lf Ar lineno Op Ar filename
Change the line number for error messages.
Ignored because insecure.
.It Ic \&lg Op Cm 1 | 0
Switch the ligature mechanism on or off.
Currently ignored.
.It Ic \&lhang Ar font char ... afmunits
Hang characters at left margin.
This is a Heirloom extension and currently ignored.
.It Ic \&linetabs Op Cm 1 | 0
Enable or disable line-tabs mode.
This is a groff extension and currently unsupported.
.It Ic \&ll Op Oo Cm + Ns | Ns Cm - Oc Ns Ar width
Change the output line length.
If the
.Ar width
argument is omitted, the line length is reset to its previous value.
The default setting for terminal output is 78n.
If a sign is given, the line length is added to or subtracted from;
otherwise, it is set to the provided value.
Using this request in new manuals is discouraged for several reasons,
among others because it overrides the
.Xr mandoc 1
.Fl O Cm width
command line option.
.It Ic \&lnr Ar register Oo Cm + Ns | Ns Cm - Oc Ns Ar value Op Ar increment
Set local number register.
This is a Heirloom extension and currently unsupported.
.It Ic \&lnrf Ar register Oo Cm + Ns | Ns Cm - Oc Ns Ar value Op Ar increment
Set local floating-point register.
This is a Heirloom extension and currently unsupported.
.It Ic \&lpfx Ar string
Set a line prefix.
This is a Heirloom extension and currently unsupported.
.It Ic \&ls Op Ar factor
Set line spacing.
It takes one integer argument specifying the vertical distance of
subsequent output text lines measured in v units.
Currently ignored.
.It Ic \&lsm Ar macroname
Set a leading spaces trap.
This is a groff extension and currently unsupported.
.It Ic \&lt Op Oo Cm + Ns | Ns Cm - Oc Ns Ar width
Set title line length.
Currently ignored.
.It Ic \&mc Ar glyph Op Ar dist
Print margin character in the right margin.
The
.Ar dist
is currently ignored; instead, 1n is used.
.It Ic \&mediasize Ar media
Set the device media size.
This is a Heirloom extension and currently ignored.
.It Ic \&minss Ar width
Set minimum word space.
This is a Heirloom extension and currently ignored.
.It Ic \&mk Op Ar register
Mark vertical position.
Currently ignored.
.It Ic \&mso Ar filename
Load a macro file using the search path.
Ignored because insecure.
.It Ic \&na
Disable adjusting without changing the adjustment mode.
Currently ignored.
.It Ic \&ne Op Ar height
Declare the need for the specified minimum vertical space
before the next trap or the bottom of the page.
Currently ignored.
.It Ic \&nf
Switch to no-fill mode.
See
.Xr man 7 .
Ignored by
.Xr mdoc 7 .
.It Ic \&nh
Turn off automatic hyphenation mode.
Currently ignored.
.It Ic \&nhychar Ar char ...
Define hyphenation-inhibiting characters.
This is a Heirloom extension and currently ignored.
.It Ic \&nm Op Ar start Op Ar inc Op Ar space Op Ar indent
Print line numbers.
Currently unsupported.
.It Ic \&nn Op Ar number
Temporarily turn off line numbering.
Currently unsupported.
.It Ic \&nop Ar body
Execute the rest of the input line as a request or macro line.
Currently unsupported.
.It Ic \&nr Ar register Oo Cm + Ns | Ns Cm - Oc Ns Ar expression
Define or change a register.
A register is an arbitrary string value that defines some sort of state,
which influences parsing and/or formatting.
For the syntax of
.Ar expression ,
see
.Sx Numerical expressions
below.
If it is prefixed by a sign, the register will be
incremented or decremented instead of assigned to.
.Pp
The following
.Ar register
is handled specially:
.Bl -tag -width Ds
.It Cm nS
If set to a positive integer value, certain
.Xr mdoc 7
macros will behave in the same way as in the
.Em SYNOPSIS
section.
If set to 0, these macros will behave in the same way as outside the
.Em SYNOPSIS
section, even when called within the
.Em SYNOPSIS
section itself.
Note that starting a new
.Xr mdoc 7
section with the
.Ic \&Sh
macro will reset this register.
.El
.It Xo
.Ic \&nrf Ar register Oo Cm + Ns | Ns Cm - Oc Ns Ar expression
.Op Ar increment
.Xc
Define or change a floating-point register.
This is a Heirloom extension and currently unsupported.
.It Ic \&nroff
Force nroff mode.
This is a groff extension and currently ignored.
.It Ic \&ns
Turn on no-space mode.
Currently ignored.
.It Ic \&nx Op Ar filename
Abort processing of the current input file and process another one.
Ignored because insecure.
.It Ic \&open Ar stream file
Open a file for writing.
Ignored because insecure.
.It Ic \&opena Ar stream file
Open a file for appending.
Ignored because insecure.
.It Ic \&os
Output saved vertical space.
Currently ignored.
.It Ic \&output Ar string
Output directly to intermediate output.
Not supported.
.It Ic \&padj Op Cm 1 | 0
Globally control paragraph-at-once adjustment.
This is a Heirloom extension and currently ignored.
.It Ic \&papersize Ar media
Set the paper size.
This is a Heirloom extension and currently ignored.
.It Ic \&pc Op Ar char
Change the page number character.
Currently ignored.
.It Ic \&pev
Print environments.
This is a groff extension and currently ignored.
.It Ic \&pi Ar command
Pipe output to a shell command.
Ignored because insecure.
.It Ic \&PI
Low-level request used by
.Ic \&BP .
This is a Heirloom extension and currently unsupported.
.It Ic \&pl Op Oo Cm + Ns | Ns Cm - Oc Ns Ar height
Change page length.
Currently ignored.
.It Ic \&pm
Print names and sizes of macros, strings, and diversions
to standard error output.
Currently ignored.
.It Ic \&pn Oo Cm + Ns | Ns Cm - Oc Ns Ar number
Change the page number of the next page.
Currently ignored.
.It Ic \&pnr
Print all number registers on standard error output.
Currently ignored.
.It Ic \&po Op Oo Cm + Ns | Ns Cm - Oc Ns Ar offset
Set horizontal page offset.
Currently ignored.
.It Ic \&ps Op Oo Cm + Ns | Ns Cm - Oc Ns size
Change point size.
Currently ignored.
.It Ic \&psbb Ar filename
Retrieve the bounding box of a PostScript file.
Currently unsupported.
.It Ic \&pshape Ar indent length ...
Set a special shape for the current paragraph.
This is a Heirloom extension and currently unsupported.
.It Ic \&pso Ar command
Include output of a shell command.
Ignored because insecure.
.It Ic \&ptr
Print the names and positions of all traps on standard error output.
This is a groff extension and currently ignored.
.It Ic \&pvs Op Oo Cm + Ns | Ns Cm - Oc Ns Ar height
Change post-vertical spacing.
This is a groff extension and currently ignored.
.It Ic \&rchar Ar glyph ...
Remove glyph definitions.
Currently unsupported.
.It Ic \&rd Op Ar prompt Op Ar agument ...
Read from standard input.
Currently ignored.
.It Ic \&recursionlimit Ar maxrec maxtail
Set the maximum stack depth for recursive macros.
This is a Heirloom extension and currently ignored.
.It Ic \&return Op Ar twice
Exit a macro and return to the caller.
Currently unsupported.
.It Ic \&rfschar Ar font glyph ...
Remove font-specific fallback glyph definitions.
Currently unsupported.
.It Ic \&rhang Ar font char ... afmunits
Hang characters at right margin.
This is a Heirloom extension and currently ignored.
.It Ic \&rj Op Ar N
Justify the next
.Ar N
input lines to the right margin without filling.
Currently ignored.
.It Ic \&rm Ar macroname
Remove a request, macro or string.
.It Ic \&rn Ar oldname newname
Rename a request, macro, diversion, or string.
Currently unsupported.
.It Ic \&rnn Ar oldname newname
Rename a number register.
Currently unsupported.
.It Ic \&rr Ar register
Remove a register.
.It Ic \&rs
End no-space mode.
Currently ignored.
.It Ic \&rt Op Ar dist
Return to marked vertical position.
Currently ignored.
.It Ic \&schar Ar glyph Op Ar string
Define global fallback glyph.
This is a groff extension and currently unsupported.
.It Ic \&sentchar Ar char ...
Define sentence-ending characters.
This is a Heirloom extension and currently ignored.
.It Ic \&shc Op Ar glyph
Change the soft hyphen character.
Currently ignored.
.It Ic \&shift Op Ar number
Shift macro arguments.
Currently unsupported.
.It Ic \&sizes Ar size ...
Define permissible point sizes.
This is a groff extension and currently ignored.
.It Ic \&so Ar filename
Include a source file.
The file is read and its contents processed as input in place of the
.Ic \&so
request line.
To avoid inadvertent inclusion of unrelated files,
.Xr mandoc 1
only accepts relative paths not containing the strings
.Qq ../
and
.Qq /.. .
.Pp
This request requires
.Xr man 1
to change to the right directory before calling
.Xr mandoc 1 ,
per convention to the root of the manual tree.
Typical usage looks like:
.Pp
.Dl \&.so man3/Xcursor.3
.Pp
As the whole concept is rather fragile, the use of
.Ic \&so
is discouraged.
Use
.Xr ln 1
instead.
.It Ic \&sp Op Ar height
Break the output line and emit vertical space.
The argument follows the syntax of
.Sx Scaling Widths
and defaults to one blank line
.Pq Li 1v .
.It Ic \&spacewidth Op Cm 1 | 0
Set the space width from the font metrics file.
This is a Heirloom extension and currently ignored.
.It Ic \&special Op Ar font ...
Define a special font.
This is a groff extension and currently ignored.
.It Ic \&spreadwarn Op Ar width
Warn about wide spacing between words.
Currently ignored.
.It Ic \&ss Ar wordspace Op Ar sentencespace
Set space character size.
Currently ignored.
.It Ic \&sty Ar position style
Associate style with a font position.
This is a groff extension and currently ignored.
.It Ic \&substring Ar stringname startpos Op Ar endpos
Replace a user-defined string with a substring.
Currently unsupported.
.It Ic \&sv Op Ar height
Save vertical space.
Currently ignored.
.It Ic \&sy Ar command
Execute shell command.
Ignored because insecure.
.It Ic \&T&
Re-start a table layout, retaining the options of the prior table
invocation.
See
.Sx \&TS .
.It Ic \&ta Op Ar width ... Op Cm T Ar width ...
Set tab stops.
Each
.Ar width
argument follows the syntax of
.Sx Scaling Widths .
If prefixed by a plus sign, it is relative to the previous tab stop.
The arguments after the
.Cm T
marker are used repeatedly as often as needed; for each reuse,
they are taken relative to the last previously established tab stop.
When
.Ic \&ta
is called without arguments, all tab stops are cleared.
.It Ic \&tc Op Ar glyph
Change tab repetition character.
Currently unsupported.
.It Ic \&TE
End a table context.
See
.Sx \&TS .
.It Ic \&ti Oo Cm + Ns | Ns Cm - Oc Ns Ar width
Break the output line and indent the next output line by
.Ar width .
If a sign is specified, the temporary indentation is calculated
relative to the current indentation; otherwise, it is absolute.
The argument follows the syntax of
.Sx Scaling Widths
and the default scaling unit is
.Cm m .
.It Ic \&tkf Ar font minps width1 maxps width2
Enable track kerning for a font.
Currently ignored.
.It Ic \&tl No \& Ap Ar left Ap Ar center Ap Ar right Ap
Print a title line.
Currently unsupported.
.It Ic \&tm Ar string
Print to standard error output.
Currently ignored.
.It Ic \&tm1 Ar string
Print to standard error output, allowing leading blanks.
This is a groff extension and currently ignored.
.It Ic \&tmc Ar string
Print to standard error output without a trailing newline.
This is a groff extension and currently ignored.
.It Ic \&tr Ar glyph glyph ...
Output character translation.
The first glyph in each pair is replaced by the second one.
Character escapes can be used; for example,
.Pp
.Dl tr \e(xx\e(yy
.Pp
replaces all invocations of \e(xx with \e(yy.
.It Ic \&track Ar font minps width1 maxps width2
Static letter space tracking.
This is a Heirloom extension and currently ignored.
.It Ic \&transchar Ar char ...
Define transparent characters for sentence-ending.
This is a Heirloom extension and currently ignored.
.It Ic \&trf Ar filename
Output the contents of a file, disallowing invalid characters.
This is a groff extension and ignored because insecure.
.It Ic \&trimat Ar left top width height
Set the TrimBox page parameter for PDF generation.
This is a Heirloom extension and currently ignored.
.It Ic \&trin Ar glyph glyph ...
Output character translation, ignored by
.Ic \&asciify .
Currently unsupported.
.It Ic \&trnt Ar glyph glyph ...
Output character translation, ignored by \e!.
Currently unsupported.
.It Ic \&troff
Force troff mode.
This is a groff extension and currently ignored.
.It Ic \&TS
Begin a table, which formats input in aligned rows and columns.
See
.Xr tbl 7
for a description of the tbl language.
.It Ic \&uf Ar font
Globally set the underline font.
Currently ignored.
.It Ic \&ul Op Ar N
Underline next
.Ar N
input lines.
Currently ignored.
.It Ic \&unformat Ar divname
Unformat spaces and tabs in a diversion.
Currently unsupported.
.It Ic \&unwatch Ar macroname
Disable notification for string or macro.
This is a Heirloom extension and currently ignored.
.It Ic \&unwatchn Ar register
Disable notification for register.
This is a Heirloom extension and currently ignored.
.It Ic \&vpt Op Cm 1 | 0
Enable or disable vertical position traps.
This is a groff extension and currently ignored.
.It Ic \&vs Op Oo Cm + Ns | Ns Cm - Oc Ns Ar height
Change vertical spacing.
Currently ignored.
.It Ic \&warn Ar flags
Set warning level.
Currently ignored.
.It Ic \&warnscale Ar si
Set the scaling indicator used in warnings.
This is a groff extension and currently ignored.
.It Ic \&watch Ar macroname
Notify on change of string or macro.
This is a Heirloom extension and currently ignored.
.It Ic \&watchlength Ar maxlength
On change, report the contents of macros and strings
up to the specified length.
This is a Heirloom extension and currently ignored.
.It Ic \&watchn Ar register
Notify on change of register.
This is a Heirloom extension and currently ignored.
.It Ic \&wh Ar dist Op Ar macroname
Set a page location trap.
Currently unsupported.
.It Ic \&while Ar condition body
Repeated execution while a condition is true.
Currently unsupported.
.It Ic \&write Oo \(dq Oc Ns Ar string
Write to an open file.
Ignored because insecure.
.It Ic \&writec Oo \(dq Oc Ns Ar string
Write to an open file without appending a newline.
Ignored because insecure.
.It Ic \&writem Ar macroname
Write macro or string to an open file.
Ignored because insecure.
.It Ic \&xflag Ar level
Set the extension level.
This is a Heirloom extension and currently ignored.
.El
.Ss Numerical expressions
The
.Sx \&nr ,
.Sx \&if ,
and
.Sx \&ie
requests accept integer numerical expressions as arguments.
These are always evaluated using the C
.Vt int
type; integer overflow works the same way as in the C language.
Numbers consist of an arbitrary number of digits
.Sq 0
to
.Sq 9
prefixed by an optional sign
.Sq +
or
.Sq - .
Each number may be followed by one optional scaling unit described below
.Sx Scaling Widths .
The following equations hold:
.Bd -literal -offset indent
1i = 6v = 6P = 10m = 10n = 72p = 1000M = 240u = 240
254c = 100i = 24000u = 24000
1f = 65536u = 65536
.Ed
.Pp
The following binary operators are implemented.
Unless otherwise stated, they behave as in the C language:
.Pp
.Bl -tag -width 2n -compact
.It Ic +
addition
.It Ic -
subtraction
.It Ic *
multiplication
.It Ic /
division
.It Ic %
remainder of division
.It Ic <
less than
.It Ic >
greater than
.It Ic ==
equal to
.It Ic =
equal to, same effect as
.Ic ==
(this differs from C)
.It Ic <=
less than or equal to
.It Ic >=
greater than or equal to
.It Ic <>
not equal to (corresponds to C
.Ic != ;
this one is of limited portability, it is supported by Heirloom roff,
but not by groff)
.It Ic &
logical and (corresponds to C
.Ic && )
.It Ic \&:
logical or (corresponds to C
.Ic \&|| )
.It Ic <?
minimum (not available in C)
.It Ic >?
maximum (not available in C)
.El
.Pp
There is no concept of precedence; evaluation proceeds from left to right,
except when subexpressions are enclosed in parentheses.
Inside parentheses, whitespace is ignored.
.Sh ESCAPE SEQUENCE REFERENCE
The
.Xr mandoc 1
.Nm
parser recognises the following escape sequences.
Note that the
.Nm
language defines more escape sequences not implemented in
.Xr mandoc 1 .
In
.Xr mdoc 7
and
.Xr man 7
documents, using escape sequences is discouraged except for those
described in the
.Sx LANGUAGE SYNTAX
section above.
.Pp
A backslash followed by any character not listed here
simply prints that character itself.
.Ss \e<newline>
A backslash at the end of an input line can be used to continue the
logical input line on the next physical input line, joining the text
on both lines together as if it were on a single input line.
.Ss \e<space>
The escape sequence backslash-space
.Pq Sq \e\ \&
is an unpaddable space-sized non-breaking space character; see
.Sx Whitespace .
.Ss \e\(dq
The rest of the input line is treated as
.Sx Comments .
.Ss \e%
Hyphenation allowed at this point of the word; ignored by
.Xr mandoc 1 .
.Ss \e&
Non-printing zero-width character; see
.Sx Whitespace .
.Ss \e\(aq
Acute accent special character; use
.Sq \e(aa
instead.
.Ss \e( Ns Ar cc
.Sx Special Characters
with two-letter names, see
.Xr mandoc_char 7 .
.Ss \e*[ Ns Ar name ]
Interpolate the string with the
.Ar name ;
see
.Sx Predefined Strings
and
.Sx ds .
For short names, there are variants
.No \e* Ns Ar c
and
.No \e*( Ns Ar cc .
.Ss \e,
Left italic correction (groff extension); ignored by
.Xr mandoc 1 .
.Ss \e-
Special character
.Dq mathematical minus sign .
.Ss \e/
Right italic correction (groff extension); ignored by
.Xr mandoc 1 .
.Ss \e[ Ns Ar name ]
.Sx Special Characters
with names of arbitrary length, see
.Xr mandoc_char 7 .
.Ss \e^
One-twelfth em half-narrow space character, effectively zero-width in
.Xr mandoc 1 .
.Ss \e`
Grave accent special character; use
.Sq \e(ga
instead.
.Ss \e{
Begin conditional input; see
.Sx if .
.Ss \e\(ba
One-sixth em narrow space character, effectively zero-width in
.Xr mandoc 1 .
.Ss \e}
End conditional input; see
.Sx if .
.Ss \e~
Paddable non-breaking space character.
.Ss \e0
Digit width space character.
.Ss \eA\(aq Ns Ar string Ns \(aq
Anchor definition; ignored by
.Xr mandoc 1 .
.Ss \eB\(aq Ns Ar string Ns \(aq
Interpolate
.Sq 1
if
.Ar string
conforms to the syntax of
.Sx Numerical expressions
explained above and
.Sq 0
otherwise.
.Ss \eb\(aq Ns Ar string Ns \(aq
Bracket building function; ignored by
.Xr mandoc 1 .
.Ss \eC\(aq Ns Ar name Ns \(aq
.Sx Special Characters
with names of arbitrary length.
.Ss \ec
When encountered at the end of an input text line,
the next input text line is considered to continue that line,
even if there are request or macro lines in between.
No whitespace is inserted.
.Ss \eD\(aq Ns Ar string Ns \(aq
Draw graphics function; ignored by
.Xr mandoc 1 .
.Ss \ed
Move down by half a line; ignored by
.Xr mandoc 1 .
.Ss \ee
Backslash special character.
.Ss \eF[ Ns Ar name ]
Switch font family (groff extension); ignored by
.Xr mandoc 1 .
For short names, there are variants
.No \eF Ns Ar c
and
.No \eF( Ns Ar cc .
.Ss \ef[ Ns Ar name ]
Switch to the font
.Ar name ,
see
.Sx Text Decoration .
For short names, there are variants
.No \ef Ns Ar c
and
.No \ef( Ns Ar cc .
.Ss \eg[ Ns Ar name ]
Interpolate the format of a number register; ignored by
.Xr mandoc 1 .
For short names, there are variants
.No \eg Ns Ar c
and
.No \eg( Ns Ar cc .
.Ss \eH\(aq Ns Oo +|- Oc Ns Ar number Ns \(aq
Set the height of the current font; ignored by
.Xr mandoc 1 .
.Ss \eh\(aq Ns Ar width Ns \(aq
Horizontal motion relative to the current position.
The default scaling unit is
.Cm m .
.Ss \ek[ Ns Ar name ]
Mark horizontal input place in register; ignored by
.Xr mandoc 1 .
For short names, there are variants
.No \ek Ns Ar c
and
.No \ek( Ns Ar cc .
.Ss \eL\(aq Ns Ar number Ns Oo Ar c Oc Ns \(aq
Vertical line drawing function; ignored by
.Xr mandoc 1 .
.Ss \el\(aq Ns Ar width Ns Oo Ar c Oc Ns \(aq
Draw a horizontal line of
.Ar width
using the glyph
.Ar c .
.Ss \eM[ Ns Ar name ]
Set fill (background) color (groff extension); ignored by
.Xr mandoc 1 .
For short names, there are variants
.No \eM Ns Ar c
and
.No \eM( Ns Ar cc .
.Ss \em[ Ns Ar name ]
Set glyph drawing color (groff extension); ignored by
.Xr mandoc 1 .
For short names, there are variants
.No \em Ns Ar c
and
.No \em( Ns Ar cc .
.Ss \eN\(aq Ns Ar number Ns \(aq
Character
.Ar number
on the current font.
.Ss \en[ Ns Ar name ]
Interpolate the number register
.Ar name .
For short names, there are variants
.No \en Ns Ar c
and
.No \en( Ns Ar cc .
.Ss \eo\(aq Ns Ar string Ns \(aq
Overstrike, writing all the characters contained in the
.Ar string
to the same output position.
In terminal and HTML output modes,
only the last one of the characters is visible.
.Ss \eR\(aq Ns Ar name Oo +|- Oc Ns Ar number Ns \(aq
Set number register; ignored by
.Xr mandoc 1 .
.Ss \eS\(aq Ns Ar number Ns \(aq
Slant output; ignored by
.Xr mandoc 1 .
.Ss \es\(aq Ns Oo +|- Oc Ns Ar number Ns \(aq
Change point size; ignored by
.Xr mandoc 1 .
Alternative forms
.No \es Ns Oo +|- Oc Ns Ar n ,
.No \es Ns Oo +|- Oc Ns \(aq Ns Ar number Ns \(aq ,
.No \es Ns [ Oo +|- Oc Ns Ar number ] ,
and
.No \es Ns Oo +|- Oc Ns [ Ar number Ns ]
are also parsed and ignored.
.Ss \et
Horizontal tab; ignored by
.Xr mandoc 1 .
.Ss \eu
Move up by half a line; ignored by
.Xr mandoc 1 .
.Ss \eV[ Ns Ar name ]
Interpolate an environment variable; ignored by
.Xr mandoc 1 .
For short names, there are variants
.No \eV Ns Ar c
and
.No \eV( Ns Ar cc .
.Ss \ev\(aq Ns Ar number Ns \(aq
Vertical motion; ignored by
.Xr mandoc 1 .
.Ss \ew\(aq Ns Ar string Ns \(aq
Interpolate the width of the
.Ar string .
The
.Xr mandoc 1
implementation assumes that after expansion of user-defined strings, the
.Ar string
only contains normal characters, no escape sequences, and that each
character has a width of 24 basic units.
.Ss \eX\(aq Ns Ar string Ns \(aq
Output
.Ar string
as device control function; ignored in nroff mode and by
.Xr mandoc 1 .
.Ss \ex\(aq Ns Ar number Ns \(aq
Extra line space function; ignored by
.Xr mandoc 1 .
.Ss \eY[ Ns Ar name ]
Output a string as a device control function; ignored in nroff mode and by
.Xr mandoc 1 .
For short names, there are variants
.No \eY Ns Ar c
and
.No \eY( Ns Ar cc .
.Ss \eZ\(aq Ns Ar string Ns \(aq
Print
.Ar string
with zero width and height; ignored by
.Xr mandoc 1 .
.Ss \ez
Output the next character without advancing the cursor position.
.Sh COMPATIBILITY
The
.Xr mandoc 1
implementation of the
.Nm
language is intentionally incomplete.
Unimplemented features include:
.Pp
.Bl -dash -compact
.It
For security reasons,
.Xr mandoc 1
never reads or writes external files except via
.Sx \&so
requests with safe relative paths.
.It
There is no automatic hyphenation, no adjustment to the right margin,
and no centering; the output is always set flush-left.
.It
Support for setting tabulator positions
and tabulator and leader characters is missing,
and support for manually changing indentation is limited.
.It
The
.Sq u
scaling unit is the default terminal unit.
In traditional troff systems, this unit changes depending on the
output media.
.It
Width measurements are implemented in a crude way
and often yield wrong results.
Explicit movement requests and escapes are ignored.
.It
There is no concept of output pages, no support for floats,
graphics drawing, and picture inclusion;
terminal output is always continuous.
.It
Requests regarding color, font families, and glyph manipulation
are ignored.
Font support is very limited.
Kerning is not implemented, and no ligatures are produced.
.It
The
.Qq \(aq
macro control character does not suppress output line breaks.
.It
Diversions are not implemented,
and support for traps is very incomplete.
.It
While recursion is supported,
.Sx \&while
loops are not.
.El
.Pp
The special semantics of the
.Cm nS
number register is an idiosyncracy of
.Ox
manuals and not supported by other
.Xr mdoc 7
implementations.
.Sh SEE ALSO
.Xr mandoc 1 ,
.Xr eqn 7 ,
.Xr man 7 ,
.Xr mandoc_char 7 ,
.Xr mdoc 7 ,
.Xr tbl 7
.Rs
.%A Joseph F. Ossanna
.%A Brian W. Kernighan
.%I AT&T Bell Laboratories
.%T Troff User's Manual
.%R Computing Science Technical Report
.%N 54
.%C Murray Hill, New Jersey
.%D 1976 and 1992
.%U http://www.kohala.com/start/troff/cstr54.ps
.Re
.Rs
.%A Joseph F. Ossanna
.%A Brian W. Kernighan
.%A Gunnar Ritter
.%T Heirloom Documentation Tools Nroff/Troff User's Manual
.%D September 17, 2007
.%U http://heirloom.sourceforge.net/doctools/troff.pdf
.Re
.Sh HISTORY
The RUNOFF typesetting system, whose input forms the basis for
.Nm ,
was written in MAD and FAP for the CTSS operating system by Jerome E.
Saltzer in 1964.
Doug McIlroy rewrote it in BCPL in 1969, renaming it
.Nm .
Dennis M. Ritchie rewrote McIlroy's
.Nm
in PDP-11 assembly for
.At v1 ,
Joseph F. Ossanna improved roff and renamed it nroff
for
.At v2 ,
then ported nroff to C as troff, which Brian W. Kernighan released with
.At v7 .
In 1989, James Clarke re-implemented troff in C++, naming it groff.
.Sh AUTHORS
.An -nosplit
This
.Nm
reference was written by
.An Kristaps Dzonsons Aq Mt kristaps@@bsd.lv
and
.An Ingo Schwarze Aq Mt schwarze@@openbsd.org .
@


1.64
log
@Implement the roff(7) .mc (right margin character) request.
The Tcl/Tk manual pages use this extensively.
Delete the TERM_MAXMARGIN hack, it breaks .mc inside .nf;
instead, implement a proper TERMP_BRNEVER flag.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.63 2017/06/04 00:08:56 schwarze Exp $
d528 4
a531 1
Currently ignored.
@


1.63
log
@Pure preprocessor implementation of the roff(7) .ec and .eo requests
(escape character control), touching nothing after the preprocessing
stage and keeping even the state variable local to the preprocessor.
Since the escape character is also used for line continuation, this
requires pulling the implementation of line continuation from the
input reader to the preprocessor, which also considerably shortens
the code required for that.

When the escape character is changed, simply let the preprocessor
replace bare by escaped backslashes and instances of the non-standard
escape character with bare backslashes - that's all we need.

Oh, and if anybody dares to use these requests in OpenBSD manuals,
sending a medium-sized pack of axe-murderes after them might be a
worthwhile part of the punishment, but probably insuffient on its own.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.62 2017/06/02 19:21:03 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: June 2 2017 $
d1297 3
a1299 1
Currently ignored.
@


1.62
log
@Partial implementation of \h (horizontal line drawing function).
A full implementation would require access to output device properties
and state variables (both only available after the main parser has
finalized the parse tree) before numerical expansions in the roff
preprocessor (i.e., before the main parser is even started).

Not trying to pull that stunt right now because the static-width
implementation committed here is sufficient for tcl-style manual pages
and already more complicated than i would have suspected.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.61 2017/06/01 19:05:15 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: June 1 2017 $
d809 5
a813 2
Change the escape character.
Currently unsupported.
a842 1
Currently unsupported.
@


1.61
log
@Minimal implementation of the \h (horizontal motion) escape sequence.
Good enough to cope with the average DocBook insanity.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.60 2017/05/08 15:33:43 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: May 8 2017 $
d1940 5
a1944 3
.Ss \el\(aq Ns Ar number Ns Oo Ar c Oc Ns \(aq
Horizontal line drawing function; ignored by
.Xr mandoc 1 .
@


1.60
log
@Basic implementation of the roff(7) .ti (temporary indent) request.
Needed by about four dozen ports (thanks to naddy@@ for the research).
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.59 2017/05/08 03:55:09 schwarze Exp $
d1926 4
a1929 3
.Ss \eh\(aq Ns Ar number Ns \(aq
Horizontal motion; ignored by
.Xr mandoc 1 .
@


1.59
log
@Convert REQUEST REFERENCE from using .Ss to .Bl -tag, allowing to
specify request arguments and supporting tag searching in less(1).
Improve some entries and document .ta.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.58 2017/05/05 15:54:28 schwarze Exp $
d4 1
a4 1
.\" Copyright (c) 2010, 2011, 2013-2015 Ingo Schwarze <schwarze@@openbsd.org>
d18 1
a18 1
.Dd $Mdocdate: May 5 2017 $
d1586 9
a1594 3
.It Ic \&tii Oo Cm + Ns | Ns Cm - Oc Ns Ar width
Temporary indent.
Currently unsupported.
@


1.58
log
@Shorten the description of .sp and move it to roff(7).
If is not a macro but a low-level roff request
and not recommended for use in manual pages.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.57 2017/05/05 02:31:23 schwarze Exp $
d398 2
a399 1
.Ss \&ab
d402 2
a403 4
.Ss \&ad
Set line adjustment mode.
It takes one argument to select normal, left, right,
or center adjustment for subsequent text.
d405 1
a405 1
.Ss \&af
d408 1
a408 1
.Ss \&aln
d411 1
a411 1
.Ss \&als
d414 1
a414 1
.Ss \&am
d417 2
a418 2
.Sx \&de .
.Ss \&am1
d422 1
a422 1
.Sx \&de1 .
d428 2
a429 2
.Sx \&am .
.Ss \&ami
d433 2
a434 2
.Sx \&dei .
.Ss \&ami1
d439 1
a439 1
.Sx \&dei1 .
d445 2
a446 2
.Sx \&ami .
.Ss \&as
d452 1
a452 1
.Ss \&as1
d456 1
a456 1
.Sx \&ds1 .
d462 2
a463 2
.Sx \&as .
.Ss \&asciify
d466 1
a466 1
.Ss \&backtrace
d469 1
a469 1
.Ss \&bd
d472 1
a472 1
.Ss \&bleedat
d475 1
a475 1
.Ss \&blm
d478 1
a478 1
.Ss \&box
d481 1
a481 1
.Ss \&boxa
d484 2
a485 2
.Ss \&bp
Begin new page.
d487 1
a487 1
.Ss \&BP
d490 1
a490 1
.Ss \&br
d492 1
a492 1
.Ss \&break
d494 1
a494 1
.Sx \&while
d497 1
a497 1
.Ss \&breakchar
d500 4
a503 2
.Ss \&brnl
Break output line after next N input lines.
d505 1
a505 1
.Ss \&brp
d508 5
a512 3
.Sx \&br .
.Ss \&brpnl
Break and spread output line after next N input lines.
d514 1
a514 1
.Ss \&c2
d517 1
a517 1
.Ss \&cc
a518 5
Its syntax is as follows:
.Bd -literal -offset indent
.Pf . Cm \&cc Op Ar c
.Ed
.Pp
d520 1
a520 1
.Ar c
d524 4
a527 3
.Ss \&ce
Center some lines.
It takes one integer argument, specifying how many lines to center.
d529 1
a529 1
.Ss \&cf
d532 1
a532 1
.Ss \&cflags
d535 1
a535 1
.Ss \&ch
d538 1
a538 1
.Ss \&char
d541 1
a541 1
.Ss \&chop
d544 1
a544 1
.Ss \&class
d547 1
a547 1
.Ss \&close
d550 1
a550 1
.Ss \&CL
d553 1
a553 1
.Ss \&color
d556 1
a556 1
.Ss \&composite
d559 1
a559 1
.Ss \&continue
d561 1
a561 1
.Sx \&while
d564 1
a564 1
.Ss \&cp
d569 1
a569 1
.Ss \&cropat
d572 1
a572 1
.Ss \&cs
d575 4
a578 2
.Ss \&cu
Underline including whitespace.
d580 1
a580 1
.Ss \&da
d583 1
a583 1
.Ss \&dch
d586 1
a586 1
.Ss \&de
d592 2
a593 2
.Pf . Cm \&de Ar name
.Ar macro definition
d599 3
a601 3
.Pf . Cm \&de Ar name Ar end
.Ar macro definition
.Pf . Ar end
d605 1
a605 1
.Ar name
d607 1
a607 1
.Ar macro definition ,
d620 1
a620 1
.Ar end
d622 1
a622 1
.Sx \&ig ;
d624 1
a624 1
.Sq Pf . Ar end
d626 1
a626 1
.Ar macro definition ,
d635 1
a635 1
.D1 Pf . Ar name Op Ar argument Op Ar argument ...
d643 1
a643 1
.Ar macro definition ,
d668 1
a668 1
.Ar name
d670 1
a670 1
.Ar name ,
d672 1
a672 1
.Ar macro definition
d676 1
a676 1
.Sx ds ,
d687 1
a687 1
.Ss \&de1
d699 2
a700 2
.Sx \&de .
.Ss \&defcolor
d703 1
a703 1
.Ss \&dei
d708 2
a709 4
.Sx \&de .
The request
.Pp
.D1 Pf . Cm \&dei Ar name Op Ar end
d711 2
a712 4
has the same effect as:
.Pp
.D1 Pf . Cm \&de No \e* Ns Bo Ar name Bc Op \e* Ns Bq Ar end
.Ss \&dei1
d724 6
a729 8
.Sx \&dei .
.Ss \&device
This request only makes sense with the groff-specific intermediate
output format and is unsupported.
.Ss \&devicem
This request only makes sense with the groff-specific intermediate
output format and is unsupported.
.Ss \&di
d732 1
a732 1
.Ss \&do
d737 1
a737 1
.Ss \&ds
a738 4
Its syntax is as follows:
.Pp
.D1 Pf . Cm \&ds Ar name Oo \(dq Oc Ns Ar string
.Pp
d740 1
a740 1
.Ar name
d755 1
a755 1
.No \e* Ns Bq Ar name
d757 1
a757 1
.Ar name
d759 1
a759 1
.Ar name
d767 1
a767 1
.Ar name
d769 1
a769 1
.Ar name ,
d771 1
a771 1
.Ar name
d786 1
a786 1
.Cm SH
d791 1
a791 1
.Ss \&ds1
d801 2
a802 2
.Sx \&ds .
.Ss \&dwh
d805 1
a805 1
.Ss \&dt
d808 1
a808 1
.Ss \&ec
d811 1
a811 1
.Ss \&ecs
d814 1
a814 1
.Ss \&ecr
d817 1
a817 1
.Ss \&el
d819 1
a819 1
.Qq else
d822 1
a822 1
.Sx \&ie
d825 1
a825 1
.Sx \&ie
d829 1
a829 1
.Sx \&if
d831 1
a831 1
.Ss \&em
d834 1
a834 1
.Ss \&EN
d837 2
a838 2
.Sx \&EQ .
.Ss \&eo
d841 1
a841 1
.Ss \&EP
d843 1
a843 1
.Sx \&BP .
d845 1
a845 1
.Ss \&EQ
d850 1
a850 1
.Ss \&errprint
d853 1
a853 1
.Ss \&ev
d856 1
a856 1
.Ss \&evc
d859 1
a859 1
.Ss \&ex
d862 1
a862 1
.Ss \&fallback
d865 1
a865 1
.Ss \&fam
d867 2
a868 3
Takes one argument specifying the font family to be selected.
It is a groff extension and currently ignored.
.Ss \&fc
d871 1
a871 1
.Ss \&fchar
d874 1
a874 1
.Ss \&fcolor
d877 1
a877 1
.Ss \&fdeferlig
d880 1
a880 1
.Ss \&feature
d883 1
a883 1
.Ss \&fi
d889 1
a889 1
.Ss \&fkern
d892 1
a892 1
.Ss \&fl
d895 1
a895 1
.Ss \&flig
d898 1
a898 1
.Ss \&fp
d901 1
a901 1
.Ss \&fps
d904 1
a904 1
.Ss \&fschar
d907 1
a907 1
.Ss \&fspacewidth
d910 1
a910 1
.Ss \&fspecial
d913 1
a913 1
.Ss \&ft
a914 4
Its syntax is as follows:
.Pp
.D1 Pf . Cm \&ft Op Ar font
.Pp
d935 1
a935 1
.Ss \&ftr
d938 1
a938 1
.Ss \&fzoom
d941 1
a941 1
.Ss \&gcolor
d944 1
a944 1
.Ss \&hc
d947 1
a947 1
.Ss \&hcode
d950 1
a950 1
.Ss \&hidechar
d953 1
a953 1
.Ss \&hla
d956 1
a956 1
.Ss \&hlm
d959 1
a959 1
.Ss \&hpf
d962 1
a962 1
.Ss \&hpfa
d965 1
a965 1
.Ss \&hpfcode
d968 1
a968 1
.Ss \&hw
d971 1
a971 1
.Ss \&hy
d974 1
a974 1
.Ss \&hylang
d977 1
a977 1
.Ss \&hylen
d980 1
a980 1
.Ss \&hym
d983 1
a983 1
.Ss \&hypp
d986 1
a986 1
.Ss \&hys
d989 1
a989 1
.Ss \&ie
d991 1
a991 1
.Qq if
d995 1
a995 1
.Sx \&el ,
d998 7
a1004 10
.Sx \&if .
.Ss \&if
Begins a conditional.
This request has the following syntax:
.Bd -literal -offset indent
\&.if COND BODY
.Ed
.Bd -literal -offset indent
\&.if COND \e{BODY
BODY...\e}
d1006 4
a1009 4
.Bd -literal -offset indent
\&.if COND \e{\e
BODY...
\&.\e}
d1012 3
a1014 1
COND is a conditional statement.
d1022 3
a1024 1
is prefixed to COND, the condition is logically inverted.
d1026 3
a1028 1
If the first character of COND is
d1034 1
a1034 1
COND evaluates to true.
d1036 3
a1038 1
If the first character of COND is
d1050 1
a1050 1
COND evaluates to false.
d1052 3
a1054 1
If the first character of COND is
d1056 4
a1059 2
it evaluates to true if the rest of COND is the name of an existing
number register; otherwise, it evaluates to false.
d1061 3
a1063 1
If COND starts with a parenthesis or with an optionally signed
d1070 5
a1074 4
Otherwise, the first character of COND is regarded as a delimiter
and COND evaluates to true if the string extending from its first
to its second occurrence is equal to the string extending from its
second to its third occurrence.
d1076 3
a1078 1
If COND cannot be parsed, it evaluates to false.
d1099 3
a1101 1
If the BODY section is begun by an escaped brace
d1106 8
a1113 4
If the BODY is not enclosed in braces, scope continues until
the end of the line.
If the COND is followed by a BODY on the same line, whether after a
brace or not, then requests and macros
d1117 4
a1120 5
.Bd -literal -offset indent
\&.if COND \e{\e
\&.foo
bar
\&.\e}
d1125 1
a1125 1
.D1 \&.if COND \e{ .foo
d1144 1
a1144 1
.Ss \&ig
d1155 1
a1155 1
.Pf . Cm \&ig Ar end
d1157 1
a1157 1
.Pf . Ar end
d1164 2
a1165 2
.Sq Pf . Ar end
macro is encountered.
d1169 1
a1169 1
.Ar end ;
d1173 2
a1174 2
.Ar end
macro is a roff request or a roff macro, like in
d1179 1
a1179 1
.Sx \&if
d1188 1
a1188 1
.Ss \&in
d1194 1
a1194 1
.Ss \&index
d1197 1
a1197 1
.Ss \&it
a1198 4
Its syntax is as follows:
.Pp
.D1 Pf . Cm it Ar expression macro
.Pp
d1209 1
a1209 1
.Ss \&itc
d1212 1
a1212 1
.Ss \&IX
d1219 1
a1219 1
.Ss \&kern
d1222 1
a1222 1
.Ss \&kernafter
d1225 1
a1225 1
.Ss \&kernbefore
d1228 1
a1228 1
.Ss \&kernpair
d1231 1
a1231 1
.Ss \&lc
d1234 1
a1234 1
.Ss \&lc_ctype
d1239 1
a1239 1
.Ss \&lds
d1242 2
a1243 2
.Ss \&length
Count the number of input characters in a user-defined string.
d1245 1
a1245 1
.Ss \&letadj
d1248 1
a1248 1
.Ss \&lf
d1251 1
a1251 1
.Ss \&lg
d1254 1
a1254 1
.Ss \&lhang
d1257 1
a1257 1
.Ss \&linetabs
d1260 1
a1260 1
.Ss \&ll
a1261 4
Its syntax is as follows:
.Pp
.D1 Pf . Cm \&ll Op Oo +|- Oc Ns Ar width
.Pp
d1273 1
a1273 1
.Ss \&lnr
d1276 1
a1276 1
.Ss \&lnrf
d1279 1
a1279 1
.Ss \&lpfx
d1282 1
a1282 1
.Ss \&ls
d1287 1
a1287 1
.Ss \&lsm
d1290 1
a1290 1
.Ss \&lt
d1293 1
a1293 1
.Ss \&mc
d1296 1
a1296 1
.Ss \&mediasize
d1299 1
a1299 1
.Ss \&minss
d1302 1
a1302 1
.Ss \&mk
d1305 2
a1306 2
.Ss \&mso
Load a macro file.
d1308 1
a1308 1
.Ss \&na
d1311 1
a1311 1
.Ss \&ne
d1315 1
a1315 1
.Ss \&nf
d1321 1
a1321 1
.Ss \&nh
d1324 1
a1324 1
.Ss \&nhychar
d1327 1
a1327 1
.Ss \&nm
d1330 1
a1330 1
.Ss \&nn
d1333 1
a1333 1
.Ss \&nop
d1336 1
a1336 1
.Ss \&nr
a1339 4
Its syntax is as follows:
.Pp
.D1 Pf \. Cm \&nr Ar name Oo +|- Oc Ns Ar expression
.Pp
d1348 2
a1349 2
The following register
.Ar name
d1366 1
a1366 1
.Cm \&Sh
d1369 4
a1372 1
.Ss \&nrf
d1375 1
a1375 1
.Ss \&nroff
d1378 1
a1378 1
.Ss \&ns
d1381 1
a1381 1
.Ss \&nx
d1384 1
a1384 1
.Ss \&open
d1387 1
a1387 1
.Ss \&opena
d1390 1
a1390 1
.Ss \&os
d1393 1
a1393 1
.Ss \&output
d1396 1
a1396 1
.Ss \&padj
d1399 1
a1399 1
.Ss \&papersize
d1402 1
a1402 1
.Ss \&pc
d1405 1
a1405 1
.Ss \&pev
d1408 1
a1408 1
.Ss \&pi
d1411 1
a1411 1
.Ss \&PI
d1413 1
a1413 1
.Sx \&BP .
d1415 1
a1415 1
.Ss \&pl
a1416 1
Takes one height argument.
d1418 3
a1420 2
.Ss \&pm
Print names and sizes of macros, strings, and diversions.
d1422 2
a1423 2
.Ss \&pn
Change page number of the next page.
d1425 2
a1426 2
.Ss \&pnr
Print all number registers.
d1428 1
a1428 1
.Ss \&po
d1431 1
a1431 1
.Ss \&ps
a1432 1
Takes one numerical argument.
d1434 1
a1434 1
.Ss \&psbb
d1437 1
a1437 1
.Ss \&pshape
d1440 1
a1440 1
.Ss \&pso
d1443 2
a1444 2
.Ss \&ptr
Print the names and positions of all traps.
d1446 1
a1446 1
.Ss \&pvs
d1449 1
a1449 1
.Ss \&rchar
d1452 1
a1452 1
.Ss \&rd
d1455 1
a1455 1
.Ss \&recursionlimit
d1458 1
a1458 1
.Ss \&return
d1461 1
a1461 1
.Ss \&rfschar
d1464 1
a1464 1
.Ss \&rhang
d1467 4
a1470 2
.Ss \&rj
Justify unfilled text to the right margin.
d1472 1
a1472 1
.Ss \&rm
d1474 1
a1474 4
Its syntax is as follows:
.Pp
.D1 Pf \. Cm \&rm Ar name
.Ss \&rn
d1477 1
a1477 1
.Ss \&rnn
d1480 1
a1480 1
.Ss \&rr
d1482 1
a1482 4
Its syntax is as follows:
.Pp
.D1 Pf \. Cm \&rr Ar name
.Ss \&rs
d1485 1
a1485 1
.Ss \&rt
d1488 1
a1488 1
.Ss \&schar
d1491 1
a1491 1
.Ss \&sentchar
d1494 1
a1494 1
.Ss \&shc
d1497 1
a1497 1
.Ss \&shift
d1500 1
a1500 1
.Ss \&sizes
d1503 1
a1503 1
.Ss \&so
d1505 2
a1506 8
Its syntax is as follows:
.Pp
.D1 Pf \. Cm \&so Ar file
.Pp
The
.Ar file
will be read and its contents processed as input in place of the
.Sq \&.so
d1525 1
a1525 1
.Sx \&so
d1530 1
a1530 1
.Ss \&sp
a1531 4
Its syntax is as follows:
.Pp
.D1 Pf \. Cm \&sp Op Ar height
.Pp
d1536 1
a1536 1
.Ss \&spacewidth
d1539 1
a1539 1
.Ss \&special
d1542 1
a1542 1
.Ss \&spreadwarn
d1545 1
a1545 1
.Ss \&ss
d1548 1
a1548 1
.Ss \&sty
d1551 1
a1551 1
.Ss \&substring
d1554 1
a1554 1
.Ss \&sv
d1557 1
a1557 1
.Ss \&sy
d1560 1
a1560 1
.Ss \&T&
d1565 1
a1565 1
.Ss \&ta
d1567 13
a1579 3
Takes an arbitrary number of arguments.
Currently unsupported.
.Ss \&tc
d1582 1
a1582 1
.Ss \&TE
d1586 1
a1586 1
.Ss \&ti
d1589 1
a1589 1
.Ss \&tkf
d1592 1
a1592 1
.Ss \&tl
d1595 1
a1595 1
.Ss \&tm
d1598 1
a1598 1
.Ss \&tm1
d1601 1
a1601 1
.Ss \&tmc
d1604 1
a1604 1
.Ss \&tr
d1606 2
a1607 11
Its syntax is as follows:
.Pp
.D1 Pf \. Cm \&tr Ar [ab]+
.Pp
Pairs of
.Ar ab
characters are replaced
.Ar ( a
for
.Ar b ) .
Replacement (or origin) characters may also be character escapes; thus,
d1612 1
a1612 1
.Ss \&track
d1615 1
a1615 1
.Ss \&transchar
d1618 1
a1618 1
.Ss \&trf
d1621 1
a1621 1
.Ss \&trimat
d1624 1
a1624 1
.Ss \&trin
d1626 1
a1626 1
.Cm \&asciify .
d1628 1
a1628 1
.Ss \&trnt
d1631 1
a1631 1
.Ss \&troff
d1634 1
a1634 1
.Ss \&TS
d1639 1
a1639 1
.Ss \&uf
d1642 4
a1645 2
.Ss \&ul
Underline.
d1647 1
a1647 1
.Ss \&unformat
d1650 1
a1650 1
.Ss \&unwatch
d1653 1
a1653 1
.Ss \&unwatchn
d1656 1
a1656 1
.Ss \&vpt
d1659 1
a1659 1
.Ss \&vs
d1662 1
a1662 1
.Ss \&warn
d1665 1
a1665 1
.Ss \&warnscale
d1668 1
a1668 1
.Ss \&watch
d1671 1
a1671 1
.Ss \&watchlength
d1675 1
a1675 1
.Ss \&watchn
d1678 1
a1678 1
.Ss \&wh
d1681 1
a1681 1
.Ss \&while
d1684 1
a1684 1
.Ss \&write
d1687 1
a1687 1
.Ss \&writec
d1690 1
a1690 1
.Ss \&writem
d1693 1
a1693 1
.Ss \&xflag
d1696 1
@


1.57
log
@Clean up docs after today's .br and .ft code cleanup; simpler.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.56 2017/02/21 23:44:39 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: February 21 2017 $
d1545 10
@


1.56
log
@fix spelling error;
found by Michael <Stapelberg at debian dot org> with Lintian
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.55 2015/09/23 09:23:49 sobrado Exp $
d18 1
a18 1
.Dd $Mdocdate: September 23 2015 $
a492 4
See
.Xr man 7
and
.Xr mdoc 7 .
d947 2
a948 4
This request takes effect only locally, may be overridden by macros
and escape sequences, and is only supported in
.Xr man 7
for now.
@


1.55
log
@typos.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.54 2015/08/29 22:39:59 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: August 29 2015 $
d1781 1
a1781 1
except when subexpressions are enclosed in parantheses.
@


1.54
log
@Parse and ignore the escape sequences \, and \/ (italic corrections).
Actually using these is very stupid because they are groff extensions
and other roff(7) implementations typically print unintended characters
at the places where they are used.
Nevertheless, some manuals contain them, for example ocserv(8).
Problem reported by Kurt Jaeger <pi at FreeBSD>.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.53 2015/08/29 21:37:11 schwarze Exp $
d1069 1
a1069 1
it evalutes to true if the rest of COND is the name of an existing
d1343 1
a1343 1
Exexute the rest of the input line as a request or macro line.
d1585 1
a1585 1
Change tab repetion character.
d1685 1
a1685 1
up to the sepcified length.
d1780 1
a1780 1
There is no concept of precendence; evaluation proceeds from left to right,
@


1.53
log
@Implement the escape sequence \\$*, expanding to all arguments
of the current user-defined macro.
This is another missing feature required for ocserv(8).
Problem reported by Kurt Jaeger <pi at FreeBSD>.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.52 2015/05/31 23:12:16 schwarze Exp $
d4 1
a4 1
.\" Copyright (c) 2010, 2011, 2013, 2014 Ingo Schwarze <schwarze@@openbsd.org>
d18 1
a18 1
.Dd $Mdocdate: May 31 2015 $
d1840 3
d1846 3
@


1.52
log
@Implement the roff(7) `r' (register exists) conditional.
Missing feature found by Markus <Waldeck at gmx dot de>
in Debian's bash(1) manual page.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.51 2015/04/29 18:32:57 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: April 29 2015 $
d666 2
@


1.51
log
@Replace the kludge for the \z escape sequence by an actual
implementation.  As a side effect, minus ten lines of code.

As another side effect, this also fixes the assertion failure that
used to be triggered by "\z\o'ab'c" at the beginning of an output
line, found by jsg@@ with afl (test case 022/Apr27).
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.50 2015/02/17 17:16:11 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: February 17 2015 $
a1057 2
.Sq r
.Pq register accessed ,
d1064 5
@


1.50
log
@Let .it accept numerical expressions, not just numerical constants.
For .it, ignore scaling units in roff_getnum().
Inside parentheses, skip whitespace after a sign in roff_getnum().
Parse and ignore unary plus in roff_getnum().
As a bonus, get rid of the only call to mandoc_strntoi() in roff.c.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.49 2015/01/29 00:33:14 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: January 29 2015 $
d2029 1
a2029 4
Output the next character without advancing the cursor position;
approximated in
.Xr mandoc 1
by simply skipping the next character.
@


1.49
log
@Radical cleanup of COMPATIBILITY sections:
Remove lots of lies, dozens of irrelevant implementation details,
and all references to groff versions older than 1.17.  Move relevant
information to the pages where it belongs, and out of mandoc(1) in
particular.  Add some missing general remarks to roff(7), where it
fits the character and purpose of the page much better.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.48 2015/01/23 20:17:25 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: January 23 2015 $
d1197 1
a1197 1
.D1 Pf . Cm it Ar number macro
d1201 8
a1208 3
will be invoked after processing the specified
.Ar number
of input text lines.
@


1.48
log
@While ignoring the .ta (set tab stops) and .ti (temp indent) requests
is sometimes harmless, it often causes seriously ugly output,
so flag these requests as unsupported rather than ignoring them.
Discussed with naddy@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.47 2015/01/23 07:41:16 jmc Exp $
d2029 3
a2031 1
This section documents compatibility between mandoc and other
d2033 2
a2034 5
implementations, at this time limited to GNU troff
.Pq Qq groff .
The term
.Qq historic groff
refers to groff version 1.15.
d2038 13
d2054 1
a2054 1
In traditional troff systems, this unit would change depending on the
d2057 12
a2068 12
In mandoc, the
.Sx \&EQ ,
.Sx \&TE ,
.Sx \&TS ,
and
.Sx \&T& ,
macros are considered regular macros.
In all other
.Nm
implementations, these are special macros that must be specified without
spacing between the control character (which must be a period) and the
macro name.
d2071 2
a2072 2
.Cm nS
register is only compatible with OpenBSD's groff-1.15.
d2074 2
a2075 5
Historic groff did not accept white-space before a custom
.Ar end
macro for the
.Sx \&ig
request.
d2077 3
a2079 4
The
.Sx \&if
and family would print funny white-spaces with historic groff when
using the next-line syntax.
d2081 8
@


1.47
log
@zap trailing whitespace;
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.46 2015/01/23 00:38:42 schwarze Exp $
d1440 1
a1440 1
This is a Heirloom extension and currently ignored.
d1573 1
a1573 1
Currently ignored.
d1583 1
a1583 1
Currently ignored.
@


1.46
log
@Wonders of roff(7): Integer numbers in numerical expressions can carry
scaling units, and some manuals (e.g. in devel/grcs) actually use that,
so let's support it.  Missing feature reported by naddy@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.45 2015/01/21 23:48:05 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: January 21 2015 $
d1721 1
a1721 1
254c = 100i = 24000u = 24000 
@


1.45
log
@tweak previous; ok schwarze
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.44 2015/01/21 20:20:49 schwarze Exp $
d1716 8
@


1.44
log
@Rudimentary implementation of the roff(7) \o escape sequence (overstrike).
This is of some relevance because the pod2man(1) preamble abuses it
for the icelandic letter Thorn, instead of simply using \(TP and \(Tp.
Missing feature found by sthen@@ in DateTime::Locale::is_IS(3p).
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.43 2015/01/20 22:34:15 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: January 20 2015 $
d1949 1
a1949 1
Overstrike, that is, write all the characters contained in the
@


1.43
log
@tweak previous; ok schwarze
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.42 2015/01/20 21:12:46 schwarze Exp $
d1949 5
a1953 4
Overstrike
.Ar string ;
ignored by
.Xr mandoc 1 .
@


1.42
log
@Split the -Werror message level into -Werror (broken manual, probably
using mandoc is better than using groff) and -Wunsupp (manual using
unsupported low-level roff(7) feature, probably using groff is better
than using mandoc).  Once this feature is complete, it is intended
to help porting, making the decision whether to USE_GROFF easier.

As a first step, distinguish four classes of roff(7) requests:
1. Supported (currently 24 requests)
2. Currently ignored because unimportant (120)  ->  no message
3. Ignored for good because insecure (14)  ->  -Werror
4. Currently unsupported (68)  ->  these trigger the new -Wunsupp messages
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.41 2015/01/20 18:54:33 tedu Exp $
d1004 1
a1004 1
.Ss\&hys
d1319 1
a1319 1
.Xr mdoc 7.
d1553 1
a1553 1
.Ss\&sty
@


1.41
log
@change spelling of centre to center. consistent with other man pages,
the name of the macro being described, and look(1).
ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.40 2014/12/25 17:18:40 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: December 25 2014 $
d396 5
a400 4
Note that the
.Nm
language defines many more requests not implemented in
.Xr mandoc 1 .
d403 12
a414 4
This line-scoped request is intended to have one argument to select
normal, left, right, or center adjustment for subsequent text.
Currently, it is ignored including its arguments,
and the number of arguments is not checked.
a418 4
.Ss \&ami
Append to a macro definition, specifying the macro name indirectly.
The syntax of this request is the same as that of
.Sx \&dei .
d421 1
a421 1
during macro execution.
d430 17
d453 65
d519 1
a519 1
Changes the control character.
d532 57
a588 4
This line-scoped request is intended to take one integer argument,
specifying how many lines to center.
Currently, it is ignored including its arguments, and the number
of arguments is not checked.
d688 16
d707 1
a707 1
macro, specifying the macro name indirectly.
d717 1
a717 1
.Ss \&de1
d722 2
a723 4
compatibility mode switched off during macro execution.
This is a GNU extension not available in traditional
.Nm
implementations and not even in older versions of groff.
d729 15
a743 1
.Sx \&de .
d802 26
d842 3
d849 7
d861 15
d878 47
a924 4
This line-scoped request is intended to have one argument specifying
the font family to be selected.
It is a groff extension, and currently, it is ignored including its
arguments, and the number of arguments is not checked.
d953 33
d988 1
a988 1
This line-scoped request is currently ignored.
d991 16
a1006 1
This line-scoped request is currently ignored.
d1184 71
d1272 38
d1313 7
a1319 1
This line-scoped request is currently ignored.
d1322 13
a1334 1
This line-scoped request is currently ignored.
d1372 6
d1380 35
a1414 3
This line-scoped request is intended to take no arguments.
Currently, it is ignored including its arguments,
and the number of arguments is not checked.
d1417 14
a1430 3
This line-scoped request is intended to take one height argument.
Currently, it is ignored including its arguments,
and the number of arguments is not checked.
d1433 38
a1470 3
This line-scoped request is intended to take one numerical argument.
Currently, it is ignored including its arguments,
and the number of arguments is not checked.
d1476 6
d1487 21
d1541 29
d1572 27
a1598 2
This line-scoped request can take an arbitrary number of arguments.
Currently, it is ignored including its arguments.
d1616 22
a1637 9
.Ss \&T&
Re-start a table layout, retaining the options of the prior table
invocation.
See
.Sx \&TS .
.Ss \&TE
End a table context.
See
.Sx \&TS .
d1643 55
@


1.40
log
@Reduce memory and time consumption on certain malformed input files
by limiting the length of expanded input lines during the
(usually recursive) expansion of user defined strings.
Resource hogging found by jsg@@ with afl.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.39 2014/12/02 10:07:17 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: December 2 2014 $
d403 1
a403 1
normal, left, right, or centre adjustment for subsequent text.
@


1.39
log
@Fix the implementation and documentation of \c (continue text input line).
In particular, make it work in no-fill mode, too.
Reminded by Carsten dot Kunze at arcor dot de (Heirloom roff).
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.38 2014/11/19 01:20:18 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: November 19 2014 $
d544 4
a547 2
to a large, but finite number.
Do not rely on the exact value of this limit.
@


1.38
log
@Support the ".if v" conditional operator (vroff mode, always false)
for groff compatibility because pod2man(1) uses it that way.
Weirdly, groff documents it as "for compatibility with other
troff versions" but neither Heirloom nor Plan 9 have it.
Issue reported by giovanni@@ via sthen@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.37 2014/09/07 00:21:23 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: September 7 2014 $
d1197 4
a1200 2
Interrupt text processing to insert requests or macros; ignored by
.Xr mandoc 1 .
@


1.37
log
@Parse and ignore the .pl (page length) request;
Daniel Levai reports that Slackware Linux uses this.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.36 2014/08/14 20:06:41 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: August 14 2014 $
a747 1
or
d750 3
@


1.36
log
@double word fix-o;
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.35 2014/08/13 22:09:28 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: August 13 2014 $
d934 5
@


1.35
log
@Begin cleanup of scaling units.
Note that we use 240u := 1i for all devices, even -Tps and -Tpdf.
Big fix of -Tascii rendering of f, m, and u.
Small fix of -Tascii rendering of c.
Big fix of -Thtml rendering of u.
Big fix of -Tps rendering of m, p, and u.
Clarify -Tps rendering of c.
Correct documentation of scaling units, in particular with respect to u.
This for example improves rendering of the OpenGL manuals.
Joint work with kristaps@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d757 1
a757 1
It evaluates to true if the the result is positive,
@


1.34
log
@implement .dei and .ami
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.33 2014/04/08 01:36:50 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: April 8 2014 $
d240 1
a240 1
synonym for
d242 1
d256 1
a256 1
default horizontal span
a263 1
.Sq u ,
d1348 6
@


1.33
log
@Fully implement the \B (validate numerical expression) and
partially implement the \w (measure text width) escape sequence
in a way that makes them usable in numerical expressions and in
conditional requests, similar to how \n (interpolate number register)
and \* (expand user-defined string) are implemented.

This lets mandoc(1) handle the baroque low-level roff code
found at the beginning of the ggrep(1) manual.
Thanks to pascal@@ for the report.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.32 2014/04/07 15:05:12 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: April 7 2014 $
a409 3
It is currently ignored by
.Xr mandoc 1 ,
as are its children.
a413 3
It is currently ignored by
.Xr mandoc 1 ,
as are its children.
d419 6
a424 3
It is currently ignored by
.Xr mandoc 1 ,
as are its children.
d552 7
a558 3
It is currently ignored by
.Xr mandoc 1 ,
as are its children.
@


1.32
log
@Almost complete implementation of roff(7) numerical expressions.
Support all binary operators except ';' (scale conversion).
Fully support chained operations and nested parentheses.
Use this for the .nr, .if, and .ie requests.
While here, fix parsing of integer numbers in roff_getnum().
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.31 2014/04/05 20:33:38 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: April 5 2014 $
d1173 3
a1175 1
Test whether
d1177 5
a1181 2
is a numerical expession; ignored by
.Xr mandoc 1 .
d1305 7
a1311 3
.Ar string ;
ignored by
.Xr mandoc 1 .
@


1.31
log
@Implement the roff(7) .rr (remove register) request.
As reported by sthen@@, the perl-5.18 pod2man(1) preamble
thinks cool kids use that in manuals.  I hope *you* know better.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.30 2014/03/30 21:27:59 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: March 30 2014 $
d752 6
a757 12
If COND starts with a digit, optionally prefixed by a minus sign,
it is evaluated as a numerical expression of the form
.Ar number operator number ,
where
.Ar operator
is one of
.Sq < ,
.Sq <= ,
.Sq = ,
.Sq >= ,
or
.Sq > .
d899 1
a899 1
.D1 Pf \. Cm \&nr Ar name Oo +|- Oc Ns Ar value
d901 5
a905 3
The
.Ar value
may, at the moment, only be an integer.
d1018 67
@


1.30
log
@Support relative arguments to .ll (increase or decrease line length).
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.29 2014/03/30 19:47:32 schwarze Exp $
a898 6
.Ss \&rm
Remove a request, macro or string.
This request is intended to have one argument,
the name of the request, macro or string to be undefined.
Currently, it is ignored including its arguments,
and the number of arguments is not checked.
d944 10
@


1.29
log
@Implement the roff(7) .ll (line length) request.
Found by naddy@@ in the textproc/enchant(1) port.
Of course, do not use this in new manuals.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.28 2014/03/08 04:43:38 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: March 8 2014 $
d879 1
a879 1
.D1 Pf . Cm \&ll Op Ar width
d885 2
@


1.28
log
@Improve .if/.ie condition handling.
* Support string comparisons.
* Support negation not only for numerical, but for all conditions.
* Switch the `o' condition from false to true.
* Handle the `c', `d', and `r' conditions as false for now.
* Use int for boolean data instead of rolling our own "enum roffrule";
needed such that we can use the standard ! and == operators.

Havard Eidnes reported via the NetBSD bug tracking system that some
Tcl*(3) manuals need this, and Thomas Klausner <wiz at NetBSD>
forwarded the report to me.  This doesn't make the crazy Tcl*(3)
macrology maze happy yet, but brings us a bit closer.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.27 2014/02/14 23:50:49 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: February 14 2014 $
d875 15
@


1.27
log
@document .as and .ce
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.26 2013/12/26 02:43:12 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: December 26 2013 $
d706 67
a772 4
Right now, the conditional evaluates to true
if and only if it starts with the letter
.Sy n ,
indicating processing in nroff style as opposed to troff style.
a789 33
This request has the following syntax:
.Bd -literal -offset indent
\&.if COND \e{\e
BODY...
\&.\e}
.Ed
.Bd -literal -offset indent
\&.if COND \e{ BODY
BODY... \e}
.Ed
.Bd -literal -offset indent
\&.if COND \e{ BODY
BODY...
\&.\e}
.Ed
.Bd -literal -offset indent
\&.if COND \e
BODY
.Ed
.Pp
COND is a conditional statement.
roff allows for complicated conditionals; mandoc is much simpler.
At this time, mandoc supports only
.Sq n ,
evaluating to true;
and
.Sq t ,
.Sq e ,
and
.Sq o ,
evaluating to false.
All other invocations are read up to the next end of line or space and
evaluate as false.
d793 3
a795 2
scope continues until a closing-brace escape sequence
.Sq \.\e} .
@


1.26
log
@The roff language really has two groups of basic building blocks:
Requests and escape sequences.  Consequently, supplement the
REQUEST REFERENCE by an ESCAPE SEQUENCE REFERENCE, such that people
no longer need to guess or experiment what mandoc(1) implements,
what it parses and ignores, and what it doesn't handle at all.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.25 2013/12/15 21:18:00 schwarze Exp $
d4 1
a4 1
.\" Copyright (c) 2010, 2011, 2013 Ingo Schwarze <schwarze@@openbsd.org>
d18 1
a18 1
.Dd $Mdocdate: December 15 2013 $
d428 6
d446 6
@


1.25
log
@The "value" argument to the roff(7) .nr requests ends right before
the first non-digit character.  While here, implement and document
an optional sign, requesting increment or decrement, as documented
in the Ossanna/Kernighan/Ritter troff manual and supported by groff.

Reported by bentley@@ on discuss at mdocml.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.24 2013/10/22 20:37:54 schwarze Exp $
d3 2
a4 2
.\" Copyright (c) 2010, 2011 Kristaps Dzonsons <kristaps@@bsd.lv>
.\" Copyright (c) 2010, 2011 Ingo Schwarze <schwarze@@openbsd.org>
d18 1
a18 1
.Dd $Mdocdate: October 22 2013 $
d35 1
a35 1
requests intermixed with their
d44 2
a45 2
requests.
Only these requests supported by
d88 1
a88 1
indicates the start of an escape sequence for
d96 3
d856 1
a856 1
If it is prefixed by a sign, the register will be 
d958 243
@


1.24
log
@Parse and ignore .hw (hyphenation points in words); this is safe because
we don't do hyphenation anyway, so there is no point in throwing an ERROR
when encountering .hw.
Real-world usage of the request found by naddy@@ in sysutils/dwdiff(1).
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.23 2013/10/14 01:42:25 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: October 14 2013 $
d843 1
a843 1
Define a register.
d848 1
a848 1
.D1 Pf \. Cm \&nr Ar name Ar value
d853 4
a856 1
So far, only the following register
d858 1
a858 1
is recognised:
@


1.23
log
@Parse and ignore the .fam (font family) request.
Fixes irunner(1) in devel/ipython and uim-xim(1) in inputmethods/uim.
Thanks to naddy@@ for bringing these to my attention.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.22 2013/08/08 20:07:24 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: August 8 2013 $
d673 3
@


1.22
log
@Implement the roff(7) font-escape sequence \f(BI "bold+italic".
This improves the formatting of about 40 base manuals
and reduces groff-mandoc formatting differences in base by about 5%.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.21 2013/07/13 19:44:14 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: July 13 2013 $
d639 6
@


1.21
log
@For citing the names and email addresses of authors,
consistently use the style ".An name Aq Mt email".

Triggered by a question from Jan Stary <hans at stare dot cz>.
Somehow, i missed these two files, jmc@@ agrees with the principle.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.20 2013/04/27 17:15:01 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: April 27 2013 $
d147 5
d155 1
a155 1
Write in bold, then switch to regular font mode.
d157 3
a159 1
Write in italic, then return to previous font mode.
@


1.20
log
@- (mdoc.7) fix Xr to self
- double word fix
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.19 2012/07/29 12:57:45 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: July 29 2012 $
d1023 1
a1023 2
.An Kristaps Dzonsons ,
.Mt kristaps@@bsd.lv ;
d1025 1
a1025 2
.An Ingo Schwarze ,
.Mt schwarze@@openbsd.org .
@


1.19
log
@Two improvements from kristaps@@:
Document .cc (bsd.lv rev. 1.39)
and fix a typo (bsd.lv rev. 1.38).
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.18 2011/12/11 00:38:08 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: December 11 2011 $
d937 1
a937 1
This section documents compatibility between mandoc and other other
@


1.18
log
@Explain where .so paths are rooted, and why, and discourage its use;
feedback and ok jmc@@, suggested by and ok kristaps@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.17 2011/11/23 02:12:22 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: November 23 2011 $
d86 1
a86 1
The back-space character
d418 12
@


1.17
log
@typo reported by Steffen Daode Nurpmeso <sdaoden at googlemail dot com>
and remove a trailing blank noticed by jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.16 2011/11/21 23:29:03 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: November 21 2011 $
d873 16
@


1.16
log
@Correct several factual errors in the HISTORY section that crept in by
relying on random texts found on various websites.  Kristaps now found
out what really happened by talking to the people involved, see
http://manpages.bsd.lv/history.html for details.
from kristaps@@, and ok jmc@@ according to kristaps@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.15 2011/09/26 23:07:20 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: September 26 2011 $
d981 2
a982 2
.Nm 
in PDP-11 assmebly for
@


1.15
log
@Reorganize part of the content:

1) Move the LANGUAGE SYNTAX from mdoc(7) and man(7) to roff(7),
it's common to both and it's actually roff syntax.
2) Move the MACRO SYNTAX down to the bottom, such that the less
technical parts MANUAL STRUCTURE and MACRO OVERVIEW get to the top.

Getting everything to again fit together after the reshuffling
required various adjustments; also adjust and improve
the DESCRIPTIONS while there.

feedback and "go ahead"  jmc@@ kristaps@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.14 2011/09/18 15:54:48 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: September 18 2011 $
d974 1
a974 4
The RUNOFF typesetting system was written in PL/1 for the CTSS
operating system by Jerome ("Jerry") E. Saltzer in 1961.
It was first used as the main documentation tool by Multics since 1963.
Robert ("Bob") H. Morris ported it to the GE-635 and called it
d976 14
a989 3
Doug McIlroy rewrote it in BCPL in 1969,
Joseph F. Ossanna rewrote it in PDP-11 assembly in 1973,
and Brian W. Kernighan rewrote it in C in 1975.
@


1.14
log
@sync to version 1.11.7 from kristaps@@
main new feature: support the roff(7) .tr request
plus various bugfixes and some refactoring

regressions are so minor that it's better to get this in
and fix them in the tree
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.13 2011/09/18 10:38:57 schwarze Exp $
d3 2
a4 2
.\" Copyright (c) 2010 Kristaps Dzonsons <kristaps@@bsd.lv>
.\" Copyright (c) 2010 Ingo Schwarze <schwarze@@openbsd.org>
d28 1
a28 1
In particular, it serves as the basis for the
d32 2
a33 2
manual formatting macro languages.
This manual describes the subset of the
d35 6
a40 1
language accepted by the
d42 16
a57 1
utility.
d59 1
a59 1
Input lines beginning with the control characters
d61 3
d65 17
a81 10
.Sq \(aq
are parsed for requests and macros.
These define the document structure, change the processing state
and manipulate the formatting.
Some requests and macros also produce formatted output,
while others do not.
.Pp
All other input lines provide free-form text to be printed;
the formatting of free-form text depends on the respective
processing context.
d86 51
a136 2
To produce other characters in the output, use the escape sequences
documented in the
d138 163
a300 1
manual.
d327 5
a331 1
Macros can be defined by the
d338 6
a345 5
.Pp
A quoted argument may contain whitespace, and pairs of double quote
characters
.Pq Sq Qq
resolve to single double quote characters.
d363 18
@


1.13
log
@sync to mandoc 1.11.5:
document eqn(7) and many other improvements
from kristaps@@

no objection from deraadt@@ against adding an eqn.7 page
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.12 2011/06/07 23:40:10 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: June 7 2011 $
d615 15
a629 4
This request is intended to have one argument,
consisting of an even number of characters.
Currently, it is ignored including its arguments,
and the number of arguments is not checked.
@


1.12
log
@bring in lots of improvements from kristaps@@;
jmc@@ agrees that it's easiest to first commit it,
then tweak it in the tree
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.11 2011/01/25 01:09:51 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: January 25 2011 $
d93 1
a93 1
To be recognized as the beginning of a quoted argument, the opening
d121 1
a121 1
parser recognizes the following requests.
d129 1
a129 1
normal, left, right, or center adjustment for subsequent text.
d347 9
d644 13
d674 1
d709 1
a709 1
This partial
d712 2
a713 1
.An Kristaps Dzonsons Aq kristaps@@bsd.lv
d715 2
a716 1
.An Ingo Schwarze Aq schwarze@@openbsd.org .
@


1.11
log
@Mention .ns, .ps, .ta; related to mandoc/roff.c rev. 1.31.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.10 2011/01/25 00:37:39 schwarze Exp $
d470 1
a470 4
Note that text following an
.Sq \&.\e}
escape sequence is discarded.
Furthermore, if an explicit closing sequence
d472 8
a479 2
is specified in a free-form line, the entire line is accepted within the
scope of the prior request, not only the text preceding the close, with the
d481 3
a483 1
collapsing into a zero-width space.
d594 1
a594 1
To avoid inadvertant inclusion of unrelated files,
@


1.10
log
@As noticed by deraadt@@, it goes without saying that text files
on a UNIX system use UNIX conventions, and UNIX tools working
on them expect that.
ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.9 2011/01/24 23:13:56 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: January 24 2011 $
d568 10
d595 4
@


1.9
log
@Better explain roff(7) macro argument quoting;
ok jmc@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.8 2011/01/09 15:24:57 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: January 9 2011 $
a59 4
.Pp
All manuals must have
.Ux
line terminators.
@


1.8
log
@Add and install tbl(7);
written by kristaps@@, looked over by jmc@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.7 2010/12/09 23:01:18 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: December 9 2010 $
d89 32
d209 3
a211 6
Arguments are separated by blank characters and can be quoted
using double-quotes
.Pq Sq \(dq
to allow inclusion of blank characters into arguments.
To include the double-quote character into a quoted argument,
escape it from ending the argument by doubling it.
@


1.7
log
@Abort endless loops during roff macro and string expansion.
For now, use the simplest conceivable approach, like groff does:
Just a fixed, ugly input stack limit.
Kristaps@@ agrees.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.6 2010/12/09 20:56:30 schwarze Exp $
d566 14
d610 2
a611 1
.Xr mdoc 7
@


1.6
log
@Roff only interpolates \* strings when the leading backslash is not escaped.
Kristaps@@ agrees with the idea, even though he didn't review the final patch.
@
text
@d1 1
a1 1
.\"	$OpenBSD: roff.7,v 1.5 2010/11/30 22:40:13 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: November 30 2010 $
d220 6
@


1.5
log
@various clean up; ok schwarze
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d272 3
@


1.4
log
@General cleanup of the roff(7) manual, and install it.
Be more careful to not confuse requests, macros and escape sequences.
Add more info at various places, including new SEE ALSO and HISTORY sections.
Reads fine to jmc@@.
@
text
@d1 1
a1 1
.\"	$Id: roff.7,v 1.2 2010/11/28 01:00:41 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: November 28 2010 $
d40 1
a40 1
.Sq \.
d65 2
a66 1
A request or macro line consists of
d70 1
a70 1
.Sq \.
d359 1
a359 5
indicating processing in
.Xr nroff 1
style as opposed to
.Xr troff 1
style.
d378 1
a378 2
.Pp
.Bd -literal -offset indent -compact
d383 1
a383 1
.Bd -literal -offset indent -compact
d387 1
a387 1
.Bd -literal -offset indent -compact
d392 1
a392 1
.Bd -literal -offset indent -compact
d531 1
a531 1
.Cm Sh
@


1.3
log
@Implement the roff .ft (change font) request for man(7).
Of course, we don't want to encourage low-level physical markup,
but pod2man(1) writes such requests, so Perl manuals contain them,
and some Xenocara and lots and lots of ports manuals use them as well.
In base and Xenocara, this will reduce mandoc -Tlint ERROR noise;
in ports, it will improve rendering of many manuals.
@
text
@d23 1
a23 1
.Nd roff language reference
d27 9
a35 3
language is a general-purpose text-formatting language.  The purpose of
this document is to consistently describe those language constructs
accepted by the
d37 1
a37 1
utility.  It is a work in progress.
d39 1
a39 4
An
.Nm
document follows simple rules:  lines beginning with the control
characters
d44 8
a51 6
Other lines are interpreted within the scope of
prior macros:
.Bd -literal -offset indent
\&.xx Macro lines change control state.
Other lines are interpreted within the current state.
.Ed
d55 7
a61 2
character, and, in certain circumstances, the tab character.  All
manuals must have
d64 5
a68 3
.Sh MACRO SYNTAX
Requests and macros are arbitrary in length and begin with a control
character,
d71 12
a82 5
.Sq \(aq ,
at the beginning of the line.
An arbitrary amount of whitespace may sit between the control character
and the request or macro name.
Thus, the following are equivalent:
d84 3
a86 2
\&.if
\&.\ \ \ \&if
d89 1
a89 1
This section is a canonical reference of all requests recognized by the
d92 2
a93 2
parser.
The
d95 1
a95 1
language defines many more requests and macros not implemented in
d126 1
a126 1
Define a user-defined
d172 1
a172 1
A user-defined macro can be invoked later using the syntax
d183 1
a183 1
The line invoking the user-defined macro will be replaced
d188 1
a188 1
where 
d206 1
a206 1
Since user-defined macros and strings share a common string table,
d220 1
a220 1
Define a user-defined
d223 1
a223 1
The syntax of this macro is the same as that of
d229 1
a229 1
Define a user-defined
d241 1
a241 1
compatibility mode at all, it handles this macro as an alias for
d275 1
a275 1
clobbers the user-defined macro
d309 1
a309 1
The syntax of this macro is similar to
d368 1
a368 1
.D1 \&.if t \e .ig
d374 1
a374 1
.D1 \&.if t \e .if t \e{\e
d380 1
a380 1
This macro has the following syntax:
d417 1
a417 1
scope continues until a closing-brace macro
d419 2
a420 2
If the BODY is not enclosed in braces, scope continues until the next
macro or word.
d422 1
a422 1
brace or not, then macros
d433 1
a433 1
than having the macro follow as
d440 1
a440 1
Note that text subsequent a
d442 1
a442 1
macro is discarded.
d446 1
a446 1
scope of the prior macro, not only the text preceding the close, with the
d467 1
a467 1
macro is encountered on its own line.
d492 1
a492 1
macro are discarded.
a516 3
The
.Ar name
is defined up to the next whitespace.
d524 1
a524 1
macros will behave as if they were defined in the
d527 1
a527 1
Otherwise, this behaviour is unset (even if called within the
d529 4
a532 2
section itself).
Note that invoking a new
d534 3
a536 1
section will unset this value.
d557 1
a557 1
This macro is intended to have one argument,
d563 2
a564 1
troff implementations, at this time limited to GNU troff
d568 1
a568 4
refers to groff versions before the
.Pa doc.tmac
file re-write
.Pq somewhere between 1.15 and 1.19 .
d574 1
a574 3
request to
.Sx \&nr
is only compatible with OpenBSD's groff.
d576 3
a578 2
Historic groff did not accept white-space buffering the custom END tag
for the
d580 1
a580 1
macro.
d585 1
a585 1
depending on next-line syntax.
d587 33
@


1.2
log
@Parse and ignore the .ad, .hy, .nh, and .ne roff requests.
Ignoring these can neither cause information loss nor serious
formatting issues.  As they are frequently used by pod2man(1),
this considerably reduces ERROR noise from mandoc -Tlint
for the Perl manuals.
@
text
@d1 1
a1 1
.\"	$Id: roff.7,v 1.10 2010/11/27 17:46:46 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: November 27 2010 $
d292 28
@


1.1
log
@Move our partial roff language manual to the right place,
such that, after some more improvements, we will eventually
be able to install it.
jmc@@ agrees with the plan.
@
text
@d77 6
d292 3
d445 7
d454 1
a454 1
This macro is intended to have one argument,
@

