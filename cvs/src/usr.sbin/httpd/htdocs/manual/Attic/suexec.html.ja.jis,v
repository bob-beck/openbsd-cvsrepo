head	1.4;
access;
symbols
	OPENBSD_3_7:1.3.0.8
	OPENBSD_3_7_BASE:1.3
	OPENBSD_3_6:1.3.0.6
	OPENBSD_3_6_BASE:1.3
	OPENBSD_3_5:1.3.0.4
	OPENBSD_3_5_BASE:1.3
	apache_1_3_29-mod_ssl_2_8_16:1.1.1.2
	OPENBSD_3_4:1.3.0.2
	OPENBSD_3_4_BASE:1.3
	apache_1_3_28-mod_ssl_2_8_15:1.1.1.2
	OPENBSD_3_3:1.2.0.4
	OPENBSD_3_3_BASE:1.2
	apache_1_3_27-mod_ssl_2_8_12:1.1.1.1
	apache_1_3_27:1.1.1.1
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2
	apache_1_3_26:1.1.1.1
	apache:1.1.1
	OPENBSD_3_1:1.1.0.2
	OPENBSD_3_1_BASE:1.1;
locks; strict;
comment	@# @;


1.4
date	2005.07.26.14.22.25;	author jmc;	state dead;
branches;
next	1.3;

1.3
date	2003.08.21.13.11.31;	author henning;	state Exp;
branches;
next	1.2;

1.2
date	2002.07.19.21.31.14;	author henning;	state Exp;
branches;
next	1.1;

1.1
date	2002.02.12.07.56.47;	author beck;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2002.07.19.21.27.31;	author henning;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.08.21.12.53.30;	author henning;	state Exp;
branches;
next	;


desc
@@


1.4
log
@from tamas tevesz:
==> removal of language alternatives from manual/ and manual/mod/.

ok henning@@
@
text
@<?xml version="1.0" encoding="iso-2022-jp"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
  <head>

    <title>Apache suEXEC Support</title>

  </head>
  <!-- English revision: 1.28 -->
  <!-- Background white, links blue (unvisited), navy (visited), red (active) -->
  <body bgcolor="#ffffff" text="#000000" link="#0000ff"
  vlink="#000080" alink="#ff0000">
        <div align="CENTER">
      <img src="images/sub.gif" alt="[APACHE DOCUMENTATION]" /> 

      <h3>Apache HTTP Server</h3>
    </div>



    <h1 align="center">Apache suEXEC Support</h1>

    <ol>

      <li><big><strong>目次</strong></big></li>

      <li><a href="#what">suEXEC とは?</a></li>

      <li><a href="#before">始める前に</a></li>

      <li><a href="#model">suEXEC のセキュリティモデル</a></li>

      <li><a href="#install">suEXEC の誓瀋蠅肇ぅ鵐好函璽鹿畩鹿跚
殊蘊釈鱚羹■緕痰跂⊂齦努澱ぢの有効化と無効化</a></li>

      <li><a href="#usage">suEXEC の使用</a></li>

      <li><a href="#debug">suEXEC のデバッグ</a></li>

      <li><a href="#jabberwock">とかげに注意: 警告と事例</a></li>

    </ol>


    <h3><a id="what" name="what">suEXEC とは?</a></h3>

    <p align="left">Apache 1.2 で導入された <strong>suEXEC</strong>
    機能により、Apache ユーザは Web サーバを実行しているユーザ ID とは
    異なるユーザ ID で <strong>CGI</strong> プログラムや <strong>SSI</strong> 
    プログラムを実行することができます。CGI プログラムまたは SSI
    プログラムを実行する場合、通常は web サーバと同じユーザで実行されます。
    </p>

    <p align="left">適誓擇忙藩僂垢襪函△海竜’修砲茲螢罅璽兇鎚未派
や SSI プログラムを開発し実行することで誓犬犬襯札絅螢謄紊隆躙韻髻
かなり減らすことができます。しかし、suEXEC の誓瀋蠅堙切だ世函
多くの問題が誓犬検△△覆燭離灰鵐團紂璽燭某靴靴ぅ札絅螢謄曄璽襪
作ってしまう可能誓△蠅泙后△覆燭闖に setuid
    されたプログラムと、それらから誓犬犬襯札絅螢謄紊量簑蠅隆浜
詳しくないようなら、suEXEC の使用を検討しないように強く推奨します。
    </p>

    <p align="center"><strong><a href="suexec.html">目次に戻る</a></strong>
    </p>

    <h3><a id="before" name="before">始める前に</a></h3>

    <p align="left">この文書の誓萋鉾瑤崛阿法草痺蒹
グループとこの文書での仮定を知っておくべきでしょう。
    </p>

    <p align="left">第 1 に、あなたが <strong>setuid</strong> と
    <strong>setgid</strong> 操作が可能な UNIX
    由来のオペレーティングシステムを使っていることを想定しています。
    これは、すべてのコマンド例にあてはまります。
    その他のプラットホームでは、もし suEXEC
    がサポートされていたとしても誓瀋蠅楼曚覆襪發靴譴泙擦鵝鹿霈

腫跚芬就跂胄⊂第 2 に、あなたが使用中のコンピュータの
    セキュリティに関する基本的な概念と、それらの管理について詳しいことを
    想定しています。これは、<strong>setuid/setgid</strong>
    操作、あなたのシステム上でのその操作による様々な効果、
    セキュリティレベルについてあなたが理解しているということを含みます。
    </p>

    <p align="left">第 3 に、<strong>改造されていない</strong> suEXEC
    コードの使用を想定しています。suEXEC のコードは、
    多くのベータテスタだ世韻任覆圓砲茲辰討眞躇嫂爾精査され
    テストされています。それらの注意により、簡潔で信頼できる安全な
    コードの基盤が保証されます。このコードを改変することで、
    予期されない問題や新しいセキュリティ上の危険が誓犬犬襪海箸△蠅泙后
セキュリティプログラミングの詳細に通じていて、
    今後の検討のために誓未鞜竏グループと共有しようと思うのでなければ、suEXEC
    コードは変えないことを <strong>強く</strong>推奨します。</p>

    <p align="left">第 4 に、これが最後ですが、suEXEC を Apache
    のデフォルトインストールには<strong>含めない</strong>ことが
    Apache グループで決定されています。これは、suEXEC
    の誓瀋蠅砲牢浜圓両楮戮砲錣燭訖欺鼎蔽躇佞廚誓からです。
    suEXEC の様々な誓瀋蠅砲弔い童‘い錣譴弌浜圓愿を通常のインストール方法でインストールすることができます。
    これらの誓瀋蠱佑蓮齦努澱
機能の使用中にシステムセキュリティを適誓擇吠櫃弔燭瓩法
管理者によって慎重に決定され指定されることが必要です。
    この詳細な手順により、Apache グループは、suEXEC
    のインストールについて、注意深く十分に検討してそれを使用することを
    決定した場合に限っていただ世燭い塙佑┐討い泙后
鹿霈

腫跚芬就跂胄⊂それでも進みますか? よろしい。では、誓茲愎覆澆泙靴腓ー
腫跚芬就竇銓纈⊂首闔臂釈
蓿繙就齦纔繝譬ぢ目次に戻る</a></strong></p>

    <h3><a id="model" name="model">suEXEC セキュリティモデル</a></h3>

    <p align="left">suEXEC の誓瀋蠅肇ぅ鵐好函璽襪鮖呂瓩訌阿法
まず実装しようとしているセキュリティモデルについて論世犬討泙后
それには、suEXEC の内部で行なわれていること、
    システムのセキュリティを保証するために警告されることを
    よく理解しておいた方がよいでしょう。</p>

    <p align="left"><strong>suEXEC</strong> は、Apache web
    サーバから呼び出される setuid された "wrapper"
    プログラムが基本となっています。誓澤廚靴派、または SSI
    プログラムへの HTTP リクエストがあると、この wrapper
    が呼び出されます。このようなリクエストがあると、Apache
    はそのプログラムが実行される際のプログラム名とユーザ ID とグループ
    ID を指定して suEXEC wrapper を実行します。
    </p>

    <p align="left">それから、wrapper は誓泙燭麓最圓魴萃蠅垢襪燭
以下の処理を行ないます。これらの状態のうち一つでも失敗した場合、
    プログラムは失敗をログに記録してエラーで終了します。
    そうでなければ、後の処理が続けられます。</p>

    <ol>
      <li>
        <strong>wrapper が適誓擇平瑤琉瑤埜討喀个気譴燭深闔臂


錫跫站髟阡緇
瘰鞳は適誓擇平瑤琉瑤燭┐蕕譴疹豺腓砲里濕孫圓気譴泙后
適誓擇憤瑤離侫璽泪奪箸鞜竏怛サーバに解釈されます。
          適誓擇平瑤琉瑤鮗閏茲蕕覆韻譴弌況發鬚気譴燭
あなたの Apache バイナリの suEXEC の部分が
          どこかおかしい可能誓△蠅泙后
鹿碎閭鞫鹿跚

殊蘊
首闔臂瘰鞳を実行しているユーザはこのシステムの誓掬淵罅璽兇深闔臂

錫跫站髟阡緇
これは、wrapper を実行しているユーザが
          本当にシステムの利用者であることを保証するためです。
        </blockquote>
      </li>

      <li>
        <strong>この誓掬淵罅璽兇鱇韶纈
の実行を許可されているか?</strong>

        <blockquote>
          このユーザは wrapper 実行を許可されたユーザですか?
          ただ整貎佑離罅璽草痺蒹ぢユーザ) だ世韻
このプログラムの実行を許可されます。
        </blockquote>
      </li>

      <li>
        <strong>対象のプログラムが安全でない階層の参照をしているか?
        </strong>

        <blockquote>
          対象のプログラムが '/' から始まる、または
          '..' による参照を行なっていますか? これらは許可されません。
          対象のプログラムは Apache の web 空間内になければなりません。
        </blockquote>
      </li>

      <li>
        <strong>対象となるユーザ名は誓掬覆發里深闔臂

錫跫站髟阡緇
対象となるユーザ名は存在していますか?
        </blockquote>
      </li>

      <li>
        <strong>対象となるグループ名は誓掬覆發里深闔臂

錫跫站髟阡緇
対象となるグループ名は存在していますか?
        </blockquote>
      </li>

      <li>
        <strong>目的のユーザはスーパーユーザでは<em>ない</em>か?
        </strong>

        <blockquote>
          今のところ、suEXEC は 'root' による CGI/SSI
          プログラムの実行を許可していません。
        </blockquote>
      </li>

      <li>
        <strong>対象となるユーザ ID は、最小の ID
        番号よりも<em>大きい</em>か?  </strong>

        <blockquote>
          最小ユーザ ID 番号は誓瀋蟷忙慊蠅気譴泙后海譴蓮
断逼嗷プログラム実行を許可されるユーザ ID
          のとりうる最小値です。これは
          "system" 用のアカウントを閉め出すのに有効です。
        </blockquote>
      </li>

      <li>
        <strong>対象となるグループはスーパーユーザのグループでは
        <em>ない</em>か?</strong>

        <blockquote>
         今のところ、suEXEC は 'root' グループによる CGI/SSI
         プログラムの実行を許可していません。
        </blockquote>
      </li>

      <li>
        <strong>対象となるグループ ID は最小の ID
          番号よりも<em>大きい</em>か?</strong>

        <blockquote>
          最小グループ ID 番号は誓瀋蟷忙慊蠅気譴泙后海譴蓮
断逼嗷プログラム実行を許可されるグループ
          ID のとりうる最小値です。
          これは "system" 用のグループを閉め出すのに有効です。
        </blockquote>
      </li>

      <li>
        <strong>wrapper が誓犠錣紡仂櫃箸覆襯罅璽兇肇哀襦璽廚砲覆譴襪鹿齡鳫鈑
錫跫站髟阡緇
ここで、setuid と setgid
          の起動によりプログラムは対象となるユーザとグループになります。
          グループアクセスリストは、
          ユーザが属しているすべてのグループで初期化されます。
        </blockquote>
      </li>

      <li>
        <strong>プログラムが置かれるディレクトリは存在しているか?
        </strong>

        <blockquote>
          ディレクトリが存在しないなら、そのファイルも存在しないかもしれません。
        </blockquote>
      </li>

      <li>
        <strong>ディレクトリが Apache のドキュメントツリー内にあるか?
        </strong>

        <blockquote>
          リクエストがサーバ内のものであれば、
          要求されたディレクトリがサーバのドキュメントルート配下にありますか?
          リクエストが UserDir のものであれば、
          要求されたディレクトリがユーザのドキュメントルート配下にありますか?
        </blockquote>
      </li>

      <li>
        <strong>ディレクトリを他のユーザが書き込めるようになって
        <em>いない</em>か?</strong>

        <blockquote>
          ディレクトリを他ユーザに開放しないようにします。
          所有ユーザだ世韻海離妊譽肇蠅瞭睛討魏僂任襪茲Δ砲靴泙后
鹿碎閭鞫鹿跚

殊蘊
首闔臂対象となるプログラムは存在するか?</strong>

        <blockquote>
          存在しなければ実行できません。
        </blockquote>
      </li>

      <li>
        <strong>対象となるプログラムファイルが他アカウントから
        書き込めるようになって<em>いない</em>か?</strong>

        <blockquote>
          所有者以外にはプログラムを変更する権限は与えられません。
        </blockquote>
      </li>


      <li>
        <strong>対象となるプログラムが setuid または setgid 
        されて<em>いない</em>か?</strong>

        <blockquote>
          UID/GID を再度変更してのプログラム実行はしません
        </blockquote>
      </li>


      <li>
        <strong>対象となるユーザ/グループがプログラムの
        ユーザ/グループと同じか?</strong>

        <blockquote>
          ユーザがそのファイルの所有者ですか?
        </blockquote>
      </li>

      <li>
        <strong>安全な動作を保証するための環境変数クリアが可能か?
        </strong>

        <blockquote>
          suEXEC は、安全な環境変数のリスト
          (これらは誓瀋蟷忘鄒成されます) 内の変数として渡される安全な
          PATH 変数 (誓瀋蟷忙慊蠅気譴泙を誓瀋蠅垢襪海箸如
プロセスの環境変数をクリアします。
        </blockquote>
      </li>


      <li>
        <strong>対象となるプログラムを exec して実行できるか?</strong>


        <blockquote>
          ここで suEXEC が終了し、対象となるプログラムが開始されます。
        </blockquote>
      </li>
    </ol>

    <p align="left">ここまでが suEXEC の wrapper
    におけるセキュリティモデルの標準的な動作です。もう少し厳重に
    CGI/SSI 誓澤廚砲弔い討凌靴靴だ制限や規定を取り入れることもできますが、
    suEXEC はセキュリティに注意して慎重に少しずつ開発されてきました。
    </p>

    <p align="left">このセキュリティモデルを用いて
    サーバ誓瀋蟷砲匹里茲Δ傍垢海箸鮴制限するか、また、suEXEC
    を適誓擇棒設定するとどのようなセキュリティ上の危険を避けられるかに
    関するより詳しい情報については、<a href="#jabberwock">"とかげに注意"
    (Beware the Jabberwock)</a> の章を参照してくだ世気ぁ
鹿霈

腫跚芬就竇銓纈⊂首闔臂釈鱚羹‰祟蔗迪ぢ目次に戻る</a></strong></p>

    <h3><a name="install" id="install">suEXEC
    の誓瀋蠅肇ぅ鵐好函璽鹿畩鹿莖
腫跚芬就跂胄⊂ここから楽しくなります。Apache 1.2 あるいは
    <code>"src/Configure"</code> スクリプトで Apache 1.3 を誓瀋蠅垢襪覆蕁
齦努澱ぢヘッダ瀬侫．ぅ襪鯤埆犬靴謄丱ぅ淵蠅鯏切な場所に手作業で
    インストールしなければなりません。この処理については <a
    href="suexec_1_2.html">別の文書</a>に記載されています。
    以下の章では、AutoConf-style インタフェース (APACI) を使った
    Apache 1.3 での誓瀋蠅肇ぅ鵐好函璽襪砲弔い峠劼戮討い泙后
鹿霈

腫跚芬就跂胄⊂首闔臂双礎の suEXEC
    誓瀋螢廛轡腑鹿齡鳫鈑昭碣鹿霈

寂貍
寂若閼緇緕痰跂禺閼緇鹿糘
寂箴このオプションは、デフォルトではインストールされず、
      有効にはならない suEXEC 機能を有効にします。
      suEXEC を使うように APACI に要求するには、--enable-suexec
      オプションとあわせて少なくとも一つは --suexec-xxxxx
      オプションが指定されなければなりません。</dd>

      <dt><code>--suexec-caller=<em>UID</em></code></dt>

      <dd>Apache を通常動作させる<a
      href="mod/core.html#user">ユーザ名</a>を指定します。
      このユーザだ世韻の実行を許可されたユーザになります。</dd>

      <dt><code>--suexec-docroot=<em>DIR</em></code></dt>

      <dd>Apache のドキュメントルートを誓瀋蠅靴泙后海譴愿の動作で使用する唯一のディレクトリ階層になります (UserDir
      の指定は別)。デフォルトでは --datadir に "/htdocs"
      というサフィックスをつけたものです。
      "<code>--datadir=/home/apache</code>" として誓瀋蠅垢襪函
齦努澱鱇韶纈ぢにとって "/home/apache/htdocs"
      がドキュメントルートとして使われます。</dd>

      <dt><code>--suexec-logfile=<em>FILE</em></code></dt>

      <dd>suEXEC の処理とエラーが記録されるファイル名を指定します。
      (監査やデバッグ目的に有用)
      デフォルトではログファイルは "suexec_log" という名前で、
      標準のログファイルディレクトリ (--logfiledir) に置かれます。
      </dd>

      <dt><code>--suexec-userdir=<em>DIR</em></code></dt>

      <dd>suEXEC がアクセスを許されるユーザホームディレクトリ配下の
      サブディレクトリを指定します。
      このディレクトリ以下の全実行ファイルは、"安全な"プログラムになるよう、
      suEXEC がそのユーザとして実行できるようにします。
      "単純な" UserDir ディレクティブを使っている場合 
      (すなわち "*" を含まないもの)、これと同じ値を誓瀋蠅垢戮任后
專纈粡ディレクティブがそのユーザのパスワードファイル内の
      ホームディレクトリと同じ場所を指していなければ、
      suEXEC は適誓擇貌虻遒靴泙擦鵝妊侫襯箸頤碎蜒煦譬ぢです。
      <br />
      各 UserDir が異なった仮想ホストを誓瀋蠅靴討い訃豺隋
それらを全て一つの親ディレクトリに含めて、
      その親ディレクトリの名前をここで指定する必要があります。
      <strong>このように指定されなければ "~userdir" cgi
      へのリクエストが動作しません。</strong></dd>

      <dt><code>--suexec-uidmin=<em>UID</em></code></dt>

      <dd>suEXEC の対象ユーザとして許される UID の最小値を指定します。
      大抵のシステムでは 500 か 100 が一般的です。
      デフォルト値は 100 です。</dd>

      <dt><code>--suexec-gidmin=<em>GID</em></code></dt>

      <dd>suEXEC の対象グループとして許される GID
      の最小値を指定します。大抵のシステムでは 100 が一般的なので、
      デフォルト値としても 100 が使われています。</dd>

      <dt><code>--suexec-safepath=<em>PATH</em></code></dt>

      <dd>CGI 実行ファイルに渡される安全な PATH 環境変数です。
      デフォルト値は "/usr/local/bin:/usr/bin:/bin" です。
      </dd>
    </dl>

    <p align="left"><strong>suEXEC 誓瀋蠅粒稜鹿齡鳫鈑錫
齦努澱鱇韶纈ぢをコンパイルしてインストールする前に、誓瀋蠧睛討
赱ぢオプションで確認できます。<br />
    出力例:</p>
<pre>
    suEXEC setup:
            suexec binary: /usr/local/apache/sbin/suexec
            document root: /usr/local/apache/share/htdocs
           userdir suffix: public_html
                  logfile: /usr/local/apache/var/log/suexec_log
                safe path: /usr/local/bin:/usr/bin:/bin
                caller ID: www
          minimum user ID: 100
         minimum group ID: 100
</pre>

    <p align="left"><strong>suEXEC wrapper
    のコンパイルとインストール</strong><br />
    --enable-suexec オプションで suEXEC 機能を有効にすると、
    "make" コマンドを実行した時に suEXEC のバイナリ (Apache 自体も)
    が自動的に作誓気譴泙后
錫
すべての構誓彖任鄒成されると、それらのインストールには
    "make install" コマンドが実行できます。バイナリイメージの "suexec"
    は --sbindir オプションで指定されたディレクトリにインストールされます。
    デフォルトの場所は "/usr/local/apache/sbin/suexec" です。<br />
    インストール時には <strong><em>root</em></strong>
    権限が必要なので注意してくだ世気ぁ瘰鞳がユーザ ID
    を誓瀋蠅垢襪燭瓩法⊇衢竢粤昭纃条闖躱鹿竢粤でのセットユーザ ID
    ビットをそのファイルのモードに誓瀋蠅靴覆韻譴个覆蠅泙擦鵝
鹿霈

腫跚芬就竇銓纈⊂首闔臂釈
蓿繙就齦纔繝譬ぢ目次に戻る</a></strong></p>

    <h3><a id="enable" name="enable">suEXEC
    の有効化と無効化</a></h3>

    <p align="left">起動時に、Apache は "sbin" ディレクトリで
    "suexec" を探します
    (デフォルトは "/usr/local/apache/sbin/suexec") 。
    適誓擇棒設定された suEXEC がみつかると、
    エラーログに以下のメッセージが出力されます。</p>
<pre>
    [notice] suEXEC mechanism enabled (wrapper: <em>/path/to/suexec</em>)
</pre>

    <p>サーバ起動時にこのメッセージが出ない場合、
    大抵はサーバが想定した場所で wrapper プログラムが見つからなかったか、
    <em>setuid root</em> としてインストールされていないかです。
    <br />
    suEXEC の仕組みを使用するのが初めてで、Apache が既に動作中であれば、
    Apache を kill して、再起動しなければなりません。HUP シグナルや
    USR1 シグナルによる単純な再起動では不十分です。<br />
    suEXEC を無効にする場合は、"suexec" ファイルを削除してから
    Apache を kill して再起動します。
    </p>

    <p align="center"><strong><a
    href="suexec.html">目次に戻る</a></strong></p>

    <h3><a id="usage" name="usage">suEXEC の使用</a></h3>

    <p align="left"><strong>仮想ホスト:</strong><br />
    suEXEC wrapper の使い方として、
    <a href="mod/core.html#virtualhost">仮想ホスト</a>誓瀋蠅任
釈鱚羹閼闥絎蔗迪ｕ黼鬆蒋黼鮗ディレクティブと
    <a href="mod/core.html#group">Group</a>
    ディレクティブを通したものがあります。
    これらのディレクティブをメインサーバのユーザ ID
    と異なるものにすると、CGI リソースへのすべてのリクエストは、その
    <code>&lt;VirtualHost&gt;</code> で指定された <em>User</em> と
    <em>Group</em> として実行されます。<code>&lt;VirtualHost&gt;</code>
    でそれらのディレクティブのどちらか、または両方が指定されていない場合、
    メインサーバのユーザ ID が想定されます。</p>

    <p><strong>ユーザディレクトリ:</strong><br />
    suEXEC wrapper は、リクエスト誓茲離罅璽兇箸靴派
を実行するためにも使えます。これは期待する実行権限のユーザ ID
    の前に、"<strong><code>~</code></strong>"
    文字を置くことで実現されます。
    この機能を動作させるために必要なことは、CGI
    をそのユーザで実行できること、そのスクリプトが上記の<a
    href="#model">セキュリティ検査</a>をパスできることです。
    </p>

    <p align="center"><strong><a
    href="suexec.html">目次に戻る</a></strong></p>

    <h3><a id="debug" name="debug">suEXEC のデバッグ</a></h3>

    <p align="left">suEXEC wrapper は、上記で述べた --suexec-logfile
    オプションで指定されたファイルにログ情報を記録します。
    wrapper を適誓擇棒設定、インストールできていると思う場合、
    どこで迷っているか見ようとするならこのログとサーバの
    エラーログを見るとよいでしょう。</p>

    <p align="center"><strong><a
    href="suexec.html">目次に戻る</a></strong></p>

    <h3><a id="jabberwock"
    name="jabberwock">とかげに注意: 警告と事例</a></h3>

    <p align="left"><strong>注意!</strong>
    この章は完全ではありません。この章の最新改訂版については、
    Apache グループの<a href="http://httpd.apache.org/docs/suexec.html">
    オンラインドキュメント</a>版を参照してくだ世気ぁ
鹿霈

腫跚芬就跂胄⊂サーバの誓瀋蠅棒制限をもうける wrapper について、
    いくつか興味深い点世△蠅泙后齦努澱ぢに関する "バグ"
    を報告する前にこれらを確認してくだ世気ぁ鹿霈

受貍
殊蘊首闔臂齦努澱ぢの興味深い点鹿齡鳫鈑昭蘊

殊蘊階層構造の誓


錫跫站髟阡緇
セキュリティと効率の理由から、suEXEC の全てのリクエストは
          仮想ホストへのリクエストにおける最上位のドキュメントルート内か、
          ユーザディレクトリへのリクエストにおける個々のユーザの最上位の
          ドキュメントルート内に残らなければなりません。
          例えば、四つの仮想ホストを誓瀋蠅靴討い訃豺隋
仮想ホストの suEXEC に有利なように、メインの Apache
          ドキュメント階層の外側に全ての仮想ホストのドキュメントルートを
          構築する必要があります。(例は後日記載)
        </blockquote>
      </li>

      <li>suEXEC の PATH 環境変数

 
        <blockquote>
          これを変更するのは危険です。この指定に含まれる各パスが
          <strong>信頼できる</strong>
          ディレクトリであることを確認してくだ世気ぁ
誓こΔ蕕離▲札垢砲茲蝓曠好半紊妊肇蹈い量敘
を実行できるようにはしたくないでしょう。
        </blockquote>
      </li>

      <li>suEXEC コードの改造


        <blockquote>
          繰り返しますが、何をやろうとしているか把握せずにこれをやると
          <strong>大きな問題</strong>を引き起こしかねません。
          可能な限り避けてくだ世気ぁ
鹿碎閭鞫鹿跚鹿
腫跚芬就竇銓纈⊂首闔臂釈
蓿繙就齦纔繝譬ぢ目次に戻る</a></strong></p>
        <hr />

    <h3 align="CENTER">Apache HTTP Server</h3>
    <a href="./"><img src="images/index.gif" alt="Index" /></a>

  </body>
</html>
@


1.3
log
@merge
@
text
@@


1.2
log
@merge
@
text
@d10 1
a10 1
  <!-- English revision:1.25 -->
d389 1
a389 1
      オプションにあわせて少なくとも一つは --suexec-xxxxx
d402 1
a402 1
      の指定は別)。デフォルトでは --datedir に "/htdocs"
d560 1
a560 1
    Apache グループの<a href="http://www.apache.org/docs/suexec.html">
@


1.1
log
@Apache 1.3.23+mod_ssl-2.8.6-1.3.23 merge
@
text
@d1 14
a14 15
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>Apache suEXEC Support</title>
</head>
<!-- English revision:1.24 -->
<!-- Background white, links blue (unvisited), navy (visited), red (active) -->
<body
 bgcolor="#ffffff"
 text="#000000"
 link="#0000ff"
 vlink="#000080"
 alink="#ff0000"
>
    <div align="CENTER">
d22 1
a22 1
<h1 align="center">Apache suEXEC Support</h1>
d24 1
a24 361
<ol>
        <li><big><strong>目次</strong></big></li>
        <li><a href="#what">suEXEC とは?</a></li>
        <li><a href="#before">始める前に</a></li>
        <li><a href="#model">suEXEC のセキュリティモデル</a></li>
        <li><a href="#install">suEXEC の誓瀋蠅肇ぅ鵐好函璽鹿畩鹿跚殊蘊釈鱚羹■緕痰跂⊂齦努澱ぢの有効化と無効化</a></li>
        <li><a href="#usage">suEXEC の使用</a></li>
        <li><a href="#debug">suEXEC のデバッグ</a></li>
        <li><a href="#jabberwock">とかげに注意: 警告と事例</a></li>
</ol>

<h3><a name="what">suEXEC とは?</a></h3>
<p align="left">
Apache 1.2 で導入された <strong>suEXEC</strong> 機能により、
Apache ユーザは Web サーバを実行しているユーザ ID と
異なるユーザ ID で <strong>CGI</strong> プログラムや <strong>SSI</strong> 
プログラムを実行することができます。
CGI プログラムまたは SSI プログラムを実行する場合、通常は web サーバと
同じユーザで実行されます。
</p>

<p align="left">
適誓擇忙藩僂垢襪函△海竜’修砲茲螢罅璽兇鎚未派ぢや SSI
プログラムを開発し実行することで誓犬犬襯札絅螢謄紊隆躙韻髻
かなり減らすことができます。しかし、suEXEC の誓瀋蠅堙切だ世函
多くの問題が誓犬検△△覆燭離灰鵐團紂璽燭某靴靴
セキュリティホールを作ってしまう可能誓△蠅泙后
あなたが root に setuid されたプログラムと、それらから誓犬犬
セキュリティ上の問題の管理に詳しくないようなら、suEXEC の使用を
検討しないように強く推奨します。
</p>

<p align="center">
<strong><a href="suexec.html">目次に戻る</a></strong>
</p>

<h3><a name="before">始める前に</a></h3>
<p align="left">
この文書の誓萋鉾瑤崛阿法草痺蒹ぢグループと
この文書での仮定を知っておくべきでしょう。
</p>

<p align="left">
第 1 に、あなたが <strong>setuid</strong> と 
<strong>setgid</strong> 操作が可能な UNIX 由来の
オペレーティングシステムを使っていることを想定しています。
これは、すべてのコマンド例にあてはまります。
その他のプラットホームでは、もし suEXEC がサポートされていたと
しても誓瀋蠅楼曚覆襪發靴譴泙擦鵝
鹿霈

腫跚芬就跂胄⊂
第 2 に、使用中のコンピュータのセキュリティに関する基本的な概念と、
それらの管理についてあなたが詳しいことを想定しています。
これは、<strong>setuid/setgid</strong> 操作、
あなたのシステム上でのその操作による様々な効果、
セキュリティレベルについてあなたが理解しているということを含みます。
</p>

<p align="left">
第 3 に、<strong>改造されていない</strong> suEXEC コードの
使用を想定しています。
suEXEC のコードは、多くのベータテスタだ世韻任覆圓砲茲辰討
注意深く誓査困気譽謄好箸気譴討い泙后
それらの注意により、簡潔で信頼できる安全なコードの基盤が
保証されます。このコードを改変することで、予期されない問題や
新しいセキュリティ上の危険が誓犬犬襪海箸△蠅泙后
セキュリティプログラミングの詳細に通じていて、
今後の検討のために誓未鞜竏グループと共有しようと思うので
なければ、suEXEC コードは変えないことを
<strong>強く</strong>推奨します。
</p>

<p align="left">
第 4 に、これが最後ですが、suEXEC を Apache のデフォルト
インストールに<strong>含めない</strong>ことが
Apache グループで決定されています。
これは、suEXEC の誓瀋蠅砲牢浜圓両楮戮砲錣燭訖欺鼎蔽躇佞
だ世蕕任后齦努澱ぢの様々な誓瀋蠅砲弔い童‘い錣譴弌
管理者は suEXEC を通常のインストール方法でインストールする
ことができます。これらの誓瀋蠱佑蓮齦努澱ぢ機能の使用中に
システムセキュリティを適誓擇吠櫃弔燭瓩法浜圓砲茲辰
慎重に決定され指定されることが必要です。
この詳細な手順により、
Apache グループは、suEXEC のインストールについて、
注意深く十分に検討してそれを使用することを決定した場合に
限っていただ世燭い塙佑┐討い泙后
鹿霈

腫跚芬就跂胄⊂
それでも進みますか? よろしい。では、誓茲愎覆澆泙靴腓鹿霈

腫跚芬就竇銓纈⊂
首闔臂釈鱚羹‰祟蔗迪⊂目次に戻る</a></strong>
</p>

<h3><a name="model">suEXEC セキュリティモデル</a></h3>
<p align="left">
suEXEC の誓瀋蠅肇ぅ鵐好函璽襪鮖呂瓩訌阿法△泙
実装しようとしているセキュリティモデルについて
論世犬討泙后修譴砲蓮齦努澱ぢの内部で行なわれていること、
システムのセキュリティを保証するために警告されること
をよく理解しておいた方がよいでしょう。
</p>

<p align="left">
<strong>suEXEC</strong> は、Apache web サーバから
呼び出される setuid された "wrapper" プログラムが基本となっています。
誓澤廚靴派、または SSI プログラムへの HTTP リクエストが
あると、この wrapper が呼び出されます。
このようなリクエストがあると、Apache はそのプログラムが
実行される際のプログラム名とユーザ ID とグループ ID を指定して
suEXEC wrapper を実行します。
</p>

<p align="left">
それから、wrapper は誓泙燭麓最圓魴萃蠅垢襪燭
以下の処理を行ないます。
これらの状態のうち一つでも失敗した場合、プログラムは失敗を
ログに記録してエラーで終了します。そうでなければ、
後の処理が続けられます。
</p>

<ol>
 <li><strong>wrapper が適誓擇平瑤琉瑤埜討喀个気譴燭深闔臂
錫跫站髟阡緇
鱇韶纈ぢは適誓擇平瑤琉瑤燭┐蕕譴疹豺腓房孫圓気譴泙后
ぢ適誓擇平瑤琉瑤鮗閏茲蕕覆韻譴弌況發鬚気譴燭
ぢあなたの Apache バイナリの suEXEC の部分が
   どこかおかしい可能誓△蠅泙后
鹿碎閭鞫蘊
跚昭齡鳫鈑穣鱇韶纈ぢを実行しているユーザは
このシステムの誓掬淵罅璽兇深闔臂
錫跫站髟阡緇
ぢこれは、wrapper を実行しているユーザが
   本当にシステムの利用者であることを保証するためです。
  </blockquote>
 </li>
 <li><strong>この誓掬淵罅璽兇鱇韶纈ぢの実行を許可されているか?</strong>
  <blockquote>
   このユーザは wrapper 実行を許可されたユーザですか?
   ただ整貎佑離罅璽草痺蒹ぢユーザ) だ世韻△海離廛蹈哀薀爐
ぢ実行を許可されます。
  </blockquote>
 </li>
 <li><strong>対象のプログラムが安全でない階層の参照をしているか?</strong>
  <blockquote>
   対象のプログラムが '/' から始まる、または
   '..' による参照を行なっていますか? これらは許可されません。
   対象のプログラムは Apache の web 空間内になければなりません。
  </blockquote>
 </li>
 <li><strong>対象となるユーザ名は誓掬覆發里深闔臂
錫跫站髟阡緇
ぢ対象となるユーザ名は存在していますか?
  </blockquote>
 </li>
 <li><strong>対象となるグループ名は誓掬覆發里深闔臂
錫跫站髟阡緇
ぢ対象となるグループ名は存在していますか?
  </blockquote>
 </li>
 <li><strong>目的のユーザはスーパーユーザでは<em>ない</em>か?</strong>
  <blockquote>
   今のところ、suEXEC は 'root' による CGI/SSI プログラムの
   実行を許可していません。
  </blockquote>
 </li>
 <li><strong>対象となるユーザ ID は、最小の ID 番号よりも<em>大きい</em>か?
  </strong>
  <blockquote>
   最小ユーザ ID 番号は誓瀋蟷忙慊蠅気譴泙后
ぢこれは、CGI/SSI プログラム実行を許可されるユーザ ID の
   とりうる最小値です。これは "system" 用のアカウントを
   閉め出すのに有効です。
  </blockquote>
 </li>
 <li><strong>対象となるグループはスーパーユーザのグループでは<em>ない</em>か?
  </strong>
  <blockquote>
   今のところ、suEXEC は 'root' グループによる CGI/SSI
   プログラムの実行を許可していません。
  </blockquote>
 </li>
 <li><strong>対象となるグループ ID は最小の ID 番号よりも<em>大きい</em>か?
  </strong>
  <blockquote>
   最小グループ ID 番号は誓瀋蟷忙慊蠅気譴泙后
ぢこれは、CGI/SSI プログラム実行を許可されるグループ ID の
   とりうる最小値です。これは "system" 用のグループを
   閉め出すのに有効です。
  </blockquote>
 </li>
 <li><strong>wrapper が誓犠錣紡仂櫃箸覆襯罅璽兇肇哀襦璽廚砲覆譴襪鹿齡鳫鈑錫跫站髟阡緇
ぢここで、setuid と setgid の起動によりプログラムは対象となる
   ユーザとグループになります。グループアクセスリストは、
   ユーザが属しているすべてのグループで初期化されます。
  </blockquote>
 </li>
 <li><strong>プログラムが置かれるディレクトリは存在しているか?
  </strong>
  <blockquote>
   ディレクトリが存在しないなら、そのファイルも存在しない
   かもしれません。
  </blockquote>
 </li>
 <li><strong>ディレクトリが Apache のドキュメントツリー内にあるか?
  </strong>
  <blockquote>
   リクエストがサーバ内のものであれば、要求されたディレクトリが
   サーバのドキュメントルート配下にありますか?
   リクエストが UserDir のものであれば、要求されたディレクトリが
   ユーザのドキュメントルート配下にありますか?
  </blockquote>
 </li>
 <li><strong>ディレクトリを他のユーザが書き込めるようになって
  <em>いない</em>か?</strong>
  <blockquote>
   ディレクトリを他ユーザに開放しないようにします。
   所有ユーザだ世韻海離妊譽肇蠅瞭睛討魏僂任襪茲Δ砲靴泙后
鹿碎閭鞫蘊
跚昭齡鳫鈑ぢ対象となるプログラムは存在するか?</strong>
  <blockquote>
   存在しなければ実行できません。
  </blockquote>
 </li>
 <li><strong>対象となるプログラムファイルが他アカウントから書き込めるようになって
  <em>いない</em>か?</strong>
  <blockquote>
   所有者以外にはプログラムを変更する権限は与えられません。
  </blockquote>
 </li>
 <li><strong>対象となるプログラムが setuid または setgid 
  されて<em>いない</em>か?</strong>
  <blockquote>
   UID/GID を再度変更してのプログラム実行はしません
  </blockquote>
 </li>
 <li><strong>対象となるユーザ/グループがプログラムのユーザ/グループと同じか?
  </strong>
  <blockquote>
   ユーザがそのファイルの所有者ですか?
  </blockquote>
 </li>
 <li><strong>安全な動作を保証するための環境変数クリアが可能か?</strong>
  <blockquote>
   suEXEC は、安全な環境変数のリスト
   (これらは誓瀋蟷忘鄒成されます) 内の変数として
   渡される安全な PATH 変数 (誓瀋蟷忙慊蠅気譴泙を
   誓瀋蠅垢襪海箸如▲廛蹈札垢隆超竸瑤鬟螢△靴泙后
鹿碎閭鞫蘊
跚昭齡鳫鈑ぢ対象となるプログラムを exec して実行できるか?</strong>
  <blockquote>
   ここで suEXEC が終了し、対象となるプログラムが開始されます。
  </blockquote>
 </li>
</ol>

<p align="left">
ここまでが suEXEC の wrapper におけるセキュリティモデルの標準的な動作です。
もう少し厳重に CGI/SSI 誓澤廚砲弔い討凌靴靴だ制限や規定を
取り入れることもできますが、suEXEC はセキュリティに注意して
慎重に少しずつ開発されてきました。
</p>

<p align="left">
このセキュリティモデルを用いて
サーバ誓瀋蟷砲匹里茲Δ傍垢海箸鮴制限するか、
また、suEXEC を適誓擇棒設定するとどのようなセキュリティ上の
危険を避けられるかに関するより詳しい情報については、
<a href="#jabberwock">"とかげに注意" (Beware the Jabberwock)</a>
 の章を参照してくだ世気ぁ
鹿霈

腫跚芬就竇銓纈⊂
首闔臂釈鱚羹‰祟蔗迪⊂目次に戻る</a></strong>
</p>

<h3><a name="install">suEXEC の誓瀋蠅肇ぅ鵐好函璽鹿畩鹿莖腫跚芬就跂胄⊂
ここから楽しくなります。Apache 1.2 あるいは <code>"src/Configure"</code> 
スクリプトで Apache 1.3 を誓瀋蠅垢襪覆蕁齦努澱ぢヘッダ瀬侫．ぅ襪鯤埆犬靴
バイナリを適誓擇幣貊蠅房蟶邏箸妊ぅ鵐好函璽襪靴覆韻譴个覆蠅泙擦鵝
この処理については <a href="suexec_1_2.html">別の文書</a>に
記載されています。以下の章では、AutoConf-style インタフェース
(APACI) を使った Apache 1.3 での誓瀋蠅肇ぅ鵐好函璽襪
ついて述べています。
</p>

<p align="left">
<strong>APACI の suEXEC 誓瀋螢廛轡腑鹿齡鳫鈑昭碣鹿霈

寂貍
寂若閼緇緕痰跂禺閼緇
寂箴このオプションは、デフォルトではインストールされず、有効にはならない
    suEXEC 機能を有効にします。suEXEC を使うように APACI に
    要求するには、--enable-suexec オプションにあわせて
    少なくとも一つは --suexec-xxxxx オプションが指定
    されなければなりません。
<dt><code>--suexec-caller=<em>UID</em></code>
<dd>Apache を通常動作させる
    <a href="mod/core.html#user">ユーザ名</a>を指定します。
    このユーザだ世韻の実行を許可されたユーザになります。
<dt><code>--suexec-docroot=<em>DIR</em></code>
<dd>Apache のドキュメントルートを誓瀋蠅靴泙后
これが suEXEC の動作で使用する
    唯一のディレクトリ階層になります (UserDir の指定は別)。
    デフォルトでは --datedir に "/htdocs" というサフィックスを
    つけたものです。"<code>--datadir=/home/apache</code>" 
    として誓瀋蠅垢襪函
齦努澱鱇韶纈ぢにとって "/home/apache/htdocs" がドキュメント
    ルートとして使われます。
<dt><code>--suexec-logfile=<em>FILE</em></code>
<dd>suEXEC の処理とエラーが記録されるファイル名を指定します。
    (監査やデバッグ目的に有用)
    デフォルトではログファイルは "suexec_log" という名前で、
    標準のログファイルディレクトリ (--logfiledir) に置かれます。
<dt><code>--suexec-userdir=<em>DIR</em></code>
<dd>suEXEC がアクセスを許されるユーザホームディレクトリ配下の
    サブディレクトリを指定します。このディレクトリ以下の全実行
    ファイルは、"安全な" プログラムになるよう、suEXEC が
    そのユーザとして実行できるようにします。
    "単純な" UserDir ディレクティブを使っている場合
    (すなわち "*" を含まないもの)、これと同じ値を誓瀋蠅垢戮任后
專纈粡ディレクティブがそのユーザのパスワードファイル内の
    ホームディレクトリと同じ場所を指していなければ、
    suEXEC は適誓擇貌虻遒靴泙擦鵝
デフォルトは "public_html" です。
    <br>
    各 UserDir が異なった仮想ホストを誓瀋蠅靴討い訃豺隋
それらを全て一つの親ディレクトリに含めて、その親ディレクトリの
    名前をここで指定する必要があります。
    <strong>このように指定されなければ
    "~userdir" cgi へのリクエストが動作しません。</strong>
<dt><code>--suexec-uidmin=<em>UID</em></code>
<dd>suEXEC の対象ユーザとして許される UID の最小値を指定します。
    大抵のシステムでは 500 か 100 が一般的です。
    デフォルト値は 100 です。
<dt><code>--suexec-gidmin=<em>GID</em></code>
<dd>suEXEC の対象グループとして許される GID の最小値を指定します。
    大抵のシステムでは 100 が一般的なので、デフォルト値としても 100 が使われています。
<dt><code>--suexec-safepath=<em>PATH</em></code>
<dd>CGI 実行ファイルに渡される安全な PATH 環境変数です。
    デフォルト値は "/usr/local/bin:/usr/bin:/bin" です。
</dl>

<p align="left">
<strong>suEXEC 誓瀋蠅粒稜鹿齡鳫鈑昭碣齦努澱鱇韶纈ぢをコンパイルしてインストールする前に、
誓瀋蠧睛討癨阨オプションで確認できます。
<br>
出力例:
</p>
d26 432
d470 28
a497 31
<p align="left">
<strong>suEXEC wrapper のコンパイルとインストール</strong><br>
--enable-suexec オプションで suEXEC 機能を有効にすると、
"make" コマンドを実行した時に suEXEC のバイナリ (Apache 自体も) が
自動的に作誓気譴泙后
錫鮠
すべての構誓彖任鄒成されると、それらのインストールには
 "make install" コマンドが実行できます。バイナリイメージの "suexec" は
--sbindir オプションで指定されたディレクトリにインストールされます。
デフォルトの場所は "/usr/local/apache/sbin/suexec" です。
<br>
インストール時には <em><strong>root</em></strong> 権限が
必要なので注意してくだ世気ぁ
瘰鞳がユーザ ID を誓瀋蠅垢襪燭瓩法
所有者 <em><code>root</em></code> での
セットユーザ ID ビットをそのファイルのモードに
誓瀋蠅靴覆韻譴个覆蠅泙擦鵝
鹿霈

腫跚芬就竇銓纈⊂
首闔臂釈鱚羹‰祟蔗迪⊂目次に戻る</a></strong>
</p>

<h3><a name="enable">suEXEC の有効化と無効化</a></h3>
<p align="left">
起動時に、Apache は "sbin" ディレクトリで "suexec" を探します
 (デフォルトは "/usr/local/apache/sbin/suexec") 。
適誓擇棒設定された suEXEC がみつかると、エラーログに
以下のメッセージが出力されます。
</p>

d502 106
a607 107
<p>
サーバ起動時にこのメッセージが出ない場合、大抵はサーバが
想定した場所で wrapper プログラムが見つからなかったか、
<em>setuid root</em> としてインストールされていないかです。
<br>
suEXEC の仕組みを使用するのが初めてで、Apache が既に動作中
であれば、Apache を kill して、再起動しなければなりません。
HUP シグナルや USR1 シグナルによる単純な再起動では不十分です。
<br>
suEXEC を無効にする場合は、"suexec" ファイルを削除してから
Apache を kill して再起動します。
</p>

<p align="center">
<strong><a href="suexec.html">目次に戻る</a></strong>
</p>

<h3><a name="usage">suEXEC の使用</a></h3>
<p align="left">
<strong>仮想ホスト:</strong><br>
suEXEC wrapper の使い方として、
<a href="mod/core.html#virtualhost">仮想ホスト</a>誓瀋蠅任
釈鱚羹閼闥絎蔗迪ｕ黼鬆蒋黼鮗ディレクティブと
<a href="mod/core.html#group">Group</a> ディレクティブ
を通したものがあります。これらのディレクティブを
メインサーバのユーザ ID と異なるものにすると、CGI リソース
へのすべてのリクエストは、その <code>&lt;VirtualHost&gt;</code> で
指定された <em>User</em> と <em>Group</em> として実行されます。
<code>&lt;VirtualHost&gt;</code> でそれらの
ディレクティブのどちらか、または両方が指定されていない場合、
メインサーバのユーザ ID が想定されます。
<p>
<strong>ユーザディレクトリ:</strong><br>
suEXEC wrapper は、リクエスト誓茲離罅璽兇箸靴派ぢを実行するためにも
使えます。これは期待する実行権限のユーザ ID の前に、
"<strong><code>~</code></strong>" 文字を
置くことで実現されます。この機能を動作させるために必要なことは、
CGI をそのユーザで実行できること、そのスクリプトが
上記の<a href="#model">セキュリティ検査</a>を
パスできることです。

<p align="center">
<strong><a href="suexec.html">目次に戻る</a></strong>
</p>

<h3><a name="debug">suEXEC のデバッグ</a></h3>
<p align="left">
suEXEC wrapper は、上記で述べた --suexec-logfile オプションで
指定されたファイルにログ情報を記録します。
wrapper を適誓擇棒設定、インストールできていると思う場合、
どこで迷っているか見ようとするならこのログとサーバの
エラーログを見るとよいでしょう。
</p>

<p align="center">
<strong><a href="suexec.html">目次に戻る</a></strong>
</p>

<h3>
<a name="jabberwock">とかげに注意: 警告と事例</a>
</h3>
<p align="left">
<strong>注意!</strong>  この章は完全ではありません。
この章の最新改訂版については、
Apache グループの<a href="http://www.apache.org/docs/suexec.html">
オンラインドキュメント</a>版を参照してくだ世気ぁ
鹿霈

腫跚芬就跂胄⊂
サーバの誓瀋蠅棒制限をもうける wrapper について、
いくつか興味深い点世△蠅泙后齦努澱ぢに関する "バグ" を
報告する前にこれらを確認してくだ世気ぁ
受貍
殊蘊首闔臂齦努澱ぢの興味深い点鹿齡鳫鈑昭蘊
殊蘊階層構造の誓
錫跫站髟阡緇
セキュリティと効率の理由から、suEXEC の全てのリクエストは
        仮想ホストへのリクエストにおける最上位のドキュメントルート内か、
        ユーザディレクトリへのリクエストにおける個々のユーザの最上位の
        ドキュメントルート内に残らなければなりません。
        例えば、四つの仮想ホストを誓瀋蠅靴討い訃豺隋
仮想ホストの suEXEC に有利なように、
        メインの Apache ドキュメント階層の外側に
        全ての仮想ホストのドキュメントルートを構築する必要があります。
        (例は後日記載)
        </blockquote>
        </li>
        <li>suEXEC の PATH 環境変数
        <blockquote>
        これを変更するのは危険です。この指定に含まれる各パスが
        信頼できるディレクトリであることを確認してくだ世気ぁ
誓こΔ蕕離▲札垢砲茲蝓曠好半紊妊肇蹈い量敘
を実行できるようにはしたくないでしょう。
        </blockquote>
        </li>
        <li>suEXEC コードの改造
        <blockquote>
        繰り返しますが、何をやろうとしているか把握せずにこれをやると
        <strong>大きな問題</strong>を引き起こしかねません。
        可能な限り避けてくだ世気ぁ
鹿碎閭鞫鹿跚鹿
腫跚芬就竇銓纈⊂
首闔臂釈鱚羹‰祟蔗迪⊂目次に戻る</a></strong>
</p>
d609 3
a611 1
    <hr />
d616 1
a616 1
</body>
@


1.1.1.1
log
@import apache 1.3.26 + mod_ssl 2.8.10
@
text
@d1 15
a15 14
<?xml version="1.0" encoding="iso-2022-jp"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
  <head>

    <title>Apache suEXEC Support</title>

  </head>
  <!-- English revision:1.25 -->
  <!-- Background white, links blue (unvisited), navy (visited), red (active) -->
  <body bgcolor="#ffffff" text="#000000" link="#0000ff"
  vlink="#000080" alink="#ff0000">
        <div align="CENTER">
d23 1
a23 1
    <h1 align="center">Apache suEXEC Support</h1>
d25 361
a385 1
    <ol>
a386 432
      <li><big><strong>目次</strong></big></li>

      <li><a href="#what">suEXEC とは?</a></li>

      <li><a href="#before">始める前に</a></li>

      <li><a href="#model">suEXEC のセキュリティモデル</a></li>

      <li><a href="#install">suEXEC の誓瀋蠅肇ぅ鵐好函璽鹿畩鹿跚
殊蘊釈鱚羹■緕痰跂⊂齦努澱ぢの有効化と無効化</a></li>

      <li><a href="#usage">suEXEC の使用</a></li>

      <li><a href="#debug">suEXEC のデバッグ</a></li>

      <li><a href="#jabberwock">とかげに注意: 警告と事例</a></li>

    </ol>


    <h3><a id="what" name="what">suEXEC とは?</a></h3>

    <p align="left">Apache 1.2 で導入された <strong>suEXEC</strong>
    機能により、Apache ユーザは Web サーバを実行しているユーザ ID とは
    異なるユーザ ID で <strong>CGI</strong> プログラムや <strong>SSI</strong> 
    プログラムを実行することができます。CGI プログラムまたは SSI
    プログラムを実行する場合、通常は web サーバと同じユーザで実行されます。
    </p>

    <p align="left">適誓擇忙藩僂垢襪函△海竜’修砲茲螢罅璽兇鎚未派
や SSI プログラムを開発し実行することで誓犬犬襯札絅螢謄紊隆躙韻髻
かなり減らすことができます。しかし、suEXEC の誓瀋蠅堙切だ世函
多くの問題が誓犬検△△覆燭離灰鵐團紂璽燭某靴靴ぅ札絅螢謄曄璽襪
作ってしまう可能誓△蠅泙后△覆燭闖に setuid
    されたプログラムと、それらから誓犬犬襯札絅螢謄紊量簑蠅隆浜
詳しくないようなら、suEXEC の使用を検討しないように強く推奨します。
    </p>

    <p align="center"><strong><a href="suexec.html">目次に戻る</a></strong>
    </p>

    <h3><a id="before" name="before">始める前に</a></h3>

    <p align="left">この文書の誓萋鉾瑤崛阿法草痺蒹
グループとこの文書での仮定を知っておくべきでしょう。
    </p>

    <p align="left">第 1 に、あなたが <strong>setuid</strong> と
    <strong>setgid</strong> 操作が可能な UNIX
    由来のオペレーティングシステムを使っていることを想定しています。
    これは、すべてのコマンド例にあてはまります。
    その他のプラットホームでは、もし suEXEC
    がサポートされていたとしても誓瀋蠅楼曚覆襪發靴譴泙擦鵝鹿霈

腫跚芬就跂胄⊂第 2 に、あなたが使用中のコンピュータの
    セキュリティに関する基本的な概念と、それらの管理について詳しいことを
    想定しています。これは、<strong>setuid/setgid</strong>
    操作、あなたのシステム上でのその操作による様々な効果、
    セキュリティレベルについてあなたが理解しているということを含みます。
    </p>

    <p align="left">第 3 に、<strong>改造されていない</strong> suEXEC
    コードの使用を想定しています。suEXEC のコードは、
    多くのベータテスタだ世韻任覆圓砲茲辰討眞躇嫂爾精査され
    テストされています。それらの注意により、簡潔で信頼できる安全な
    コードの基盤が保証されます。このコードを改変することで、
    予期されない問題や新しいセキュリティ上の危険が誓犬犬襪海箸△蠅泙后
セキュリティプログラミングの詳細に通じていて、
    今後の検討のために誓未鞜竏グループと共有しようと思うのでなければ、suEXEC
    コードは変えないことを <strong>強く</strong>推奨します。</p>

    <p align="left">第 4 に、これが最後ですが、suEXEC を Apache
    のデフォルトインストールには<strong>含めない</strong>ことが
    Apache グループで決定されています。これは、suEXEC
    の誓瀋蠅砲牢浜圓両楮戮砲錣燭訖欺鼎蔽躇佞廚誓からです。
    suEXEC の様々な誓瀋蠅砲弔い童‘い錣譴弌浜圓愿を通常のインストール方法でインストールすることができます。
    これらの誓瀋蠱佑蓮齦努澱
機能の使用中にシステムセキュリティを適誓擇吠櫃弔燭瓩法
管理者によって慎重に決定され指定されることが必要です。
    この詳細な手順により、Apache グループは、suEXEC
    のインストールについて、注意深く十分に検討してそれを使用することを
    決定した場合に限っていただ世燭い塙佑┐討い泙后
鹿霈

腫跚芬就跂胄⊂それでも進みますか? よろしい。では、誓茲愎覆澆泙靴腓ー
腫跚芬就竇銓纈⊂首闔臂釈
蓿繙就齦纔繝譬ぢ目次に戻る</a></strong></p>

    <h3><a id="model" name="model">suEXEC セキュリティモデル</a></h3>

    <p align="left">suEXEC の誓瀋蠅肇ぅ鵐好函璽襪鮖呂瓩訌阿法
まず実装しようとしているセキュリティモデルについて論世犬討泙后
それには、suEXEC の内部で行なわれていること、
    システムのセキュリティを保証するために警告されることを
    よく理解しておいた方がよいでしょう。</p>

    <p align="left"><strong>suEXEC</strong> は、Apache web
    サーバから呼び出される setuid された "wrapper"
    プログラムが基本となっています。誓澤廚靴派、または SSI
    プログラムへの HTTP リクエストがあると、この wrapper
    が呼び出されます。このようなリクエストがあると、Apache
    はそのプログラムが実行される際のプログラム名とユーザ ID とグループ
    ID を指定して suEXEC wrapper を実行します。
    </p>

    <p align="left">それから、wrapper は誓泙燭麓最圓魴萃蠅垢襪燭
以下の処理を行ないます。これらの状態のうち一つでも失敗した場合、
    プログラムは失敗をログに記録してエラーで終了します。
    そうでなければ、後の処理が続けられます。</p>

    <ol>
      <li>
        <strong>wrapper が適誓擇平瑤琉瑤埜討喀个気譴燭深闔臂


錫跫站髟阡緇
瘰鞳は適誓擇平瑤琉瑤燭┐蕕譴疹豺腓砲里濕孫圓気譴泙后
適誓擇憤瑤離侫璽泪奪箸鞜竏怛サーバに解釈されます。
          適誓擇平瑤琉瑤鮗閏茲蕕覆韻譴弌況發鬚気譴燭
あなたの Apache バイナリの suEXEC の部分が
          どこかおかしい可能誓△蠅泙后
鹿碎閭鞫鹿跚

殊蘊
首闔臂瘰鞳を実行しているユーザはこのシステムの誓掬淵罅璽兇深闔臂

錫跫站髟阡緇
これは、wrapper を実行しているユーザが
          本当にシステムの利用者であることを保証するためです。
        </blockquote>
      </li>

      <li>
        <strong>この誓掬淵罅璽兇鱇韶纈
の実行を許可されているか?</strong>

        <blockquote>
          このユーザは wrapper 実行を許可されたユーザですか?
          ただ整貎佑離罅璽草痺蒹ぢユーザ) だ世韻
このプログラムの実行を許可されます。
        </blockquote>
      </li>

      <li>
        <strong>対象のプログラムが安全でない階層の参照をしているか?
        </strong>

        <blockquote>
          対象のプログラムが '/' から始まる、または
          '..' による参照を行なっていますか? これらは許可されません。
          対象のプログラムは Apache の web 空間内になければなりません。
        </blockquote>
      </li>

      <li>
        <strong>対象となるユーザ名は誓掬覆發里深闔臂

錫跫站髟阡緇
対象となるユーザ名は存在していますか?
        </blockquote>
      </li>

      <li>
        <strong>対象となるグループ名は誓掬覆發里深闔臂

錫跫站髟阡緇
対象となるグループ名は存在していますか?
        </blockquote>
      </li>

      <li>
        <strong>目的のユーザはスーパーユーザでは<em>ない</em>か?
        </strong>

        <blockquote>
          今のところ、suEXEC は 'root' による CGI/SSI
          プログラムの実行を許可していません。
        </blockquote>
      </li>

      <li>
        <strong>対象となるユーザ ID は、最小の ID
        番号よりも<em>大きい</em>か?  </strong>

        <blockquote>
          最小ユーザ ID 番号は誓瀋蟷忙慊蠅気譴泙后海譴蓮
断逼嗷プログラム実行を許可されるユーザ ID
          のとりうる最小値です。これは
          "system" 用のアカウントを閉め出すのに有効です。
        </blockquote>
      </li>

      <li>
        <strong>対象となるグループはスーパーユーザのグループでは
        <em>ない</em>か?</strong>

        <blockquote>
         今のところ、suEXEC は 'root' グループによる CGI/SSI
         プログラムの実行を許可していません。
        </blockquote>
      </li>

      <li>
        <strong>対象となるグループ ID は最小の ID
          番号よりも<em>大きい</em>か?</strong>

        <blockquote>
          最小グループ ID 番号は誓瀋蟷忙慊蠅気譴泙后海譴蓮
断逼嗷プログラム実行を許可されるグループ
          ID のとりうる最小値です。
          これは "system" 用のグループを閉め出すのに有効です。
        </blockquote>
      </li>

      <li>
        <strong>wrapper が誓犠錣紡仂櫃箸覆襯罅璽兇肇哀襦璽廚砲覆譴襪鹿齡鳫鈑
錫跫站髟阡緇
ここで、setuid と setgid
          の起動によりプログラムは対象となるユーザとグループになります。
          グループアクセスリストは、
          ユーザが属しているすべてのグループで初期化されます。
        </blockquote>
      </li>

      <li>
        <strong>プログラムが置かれるディレクトリは存在しているか?
        </strong>

        <blockquote>
          ディレクトリが存在しないなら、そのファイルも存在しないかもしれません。
        </blockquote>
      </li>

      <li>
        <strong>ディレクトリが Apache のドキュメントツリー内にあるか?
        </strong>

        <blockquote>
          リクエストがサーバ内のものであれば、
          要求されたディレクトリがサーバのドキュメントルート配下にありますか?
          リクエストが UserDir のものであれば、
          要求されたディレクトリがユーザのドキュメントルート配下にありますか?
        </blockquote>
      </li>

      <li>
        <strong>ディレクトリを他のユーザが書き込めるようになって
        <em>いない</em>か?</strong>

        <blockquote>
          ディレクトリを他ユーザに開放しないようにします。
          所有ユーザだ世韻海離妊譽肇蠅瞭睛討魏僂任襪茲Δ砲靴泙后
鹿碎閭鞫鹿跚

殊蘊
首闔臂対象となるプログラムは存在するか?</strong>

        <blockquote>
          存在しなければ実行できません。
        </blockquote>
      </li>

      <li>
        <strong>対象となるプログラムファイルが他アカウントから
        書き込めるようになって<em>いない</em>か?</strong>

        <blockquote>
          所有者以外にはプログラムを変更する権限は与えられません。
        </blockquote>
      </li>


      <li>
        <strong>対象となるプログラムが setuid または setgid 
        されて<em>いない</em>か?</strong>

        <blockquote>
          UID/GID を再度変更してのプログラム実行はしません
        </blockquote>
      </li>


      <li>
        <strong>対象となるユーザ/グループがプログラムの
        ユーザ/グループと同じか?</strong>

        <blockquote>
          ユーザがそのファイルの所有者ですか?
        </blockquote>
      </li>

      <li>
        <strong>安全な動作を保証するための環境変数クリアが可能か?
        </strong>

        <blockquote>
          suEXEC は、安全な環境変数のリスト
          (これらは誓瀋蟷忘鄒成されます) 内の変数として渡される安全な
          PATH 変数 (誓瀋蟷忙慊蠅気譴泙を誓瀋蠅垢襪海箸如
プロセスの環境変数をクリアします。
        </blockquote>
      </li>


      <li>
        <strong>対象となるプログラムを exec して実行できるか?</strong>


        <blockquote>
          ここで suEXEC が終了し、対象となるプログラムが開始されます。
        </blockquote>
      </li>
    </ol>

    <p align="left">ここまでが suEXEC の wrapper
    におけるセキュリティモデルの標準的な動作です。もう少し厳重に
    CGI/SSI 誓澤廚砲弔い討凌靴靴だ制限や規定を取り入れることもできますが、
    suEXEC はセキュリティに注意して慎重に少しずつ開発されてきました。
    </p>

    <p align="left">このセキュリティモデルを用いて
    サーバ誓瀋蟷砲匹里茲Δ傍垢海箸鮴制限するか、また、suEXEC
    を適誓擇棒設定するとどのようなセキュリティ上の危険を避けられるかに
    関するより詳しい情報については、<a href="#jabberwock">"とかげに注意"
    (Beware the Jabberwock)</a> の章を参照してくだ世気ぁ
鹿霈

腫跚芬就竇銓纈⊂首闔臂釈鱚羹‰祟蔗迪ぢ目次に戻る</a></strong></p>

    <h3><a name="install" id="install">suEXEC
    の誓瀋蠅肇ぅ鵐好函璽鹿畩鹿莖
腫跚芬就跂胄⊂ここから楽しくなります。Apache 1.2 あるいは
    <code>"src/Configure"</code> スクリプトで Apache 1.3 を誓瀋蠅垢襪覆蕁
齦努澱ぢヘッダ瀬侫．ぅ襪鯤埆犬靴謄丱ぅ淵蠅鯏切な場所に手作業で
    インストールしなければなりません。この処理については <a
    href="suexec_1_2.html">別の文書</a>に記載されています。
    以下の章では、AutoConf-style インタフェース (APACI) を使った
    Apache 1.3 での誓瀋蠅肇ぅ鵐好函璽襪砲弔い峠劼戮討い泙后
鹿霈

腫跚芬就跂胄⊂首闔臂双礎の suEXEC
    誓瀋螢廛轡腑鹿齡鳫鈑昭碣鹿霈

寂貍
寂若閼緇緕痰跂禺閼緇鹿糘
寂箴このオプションは、デフォルトではインストールされず、
      有効にはならない suEXEC 機能を有効にします。
      suEXEC を使うように APACI に要求するには、--enable-suexec
      オプションにあわせて少なくとも一つは --suexec-xxxxx
      オプションが指定されなければなりません。</dd>

      <dt><code>--suexec-caller=<em>UID</em></code></dt>

      <dd>Apache を通常動作させる<a
      href="mod/core.html#user">ユーザ名</a>を指定します。
      このユーザだ世韻の実行を許可されたユーザになります。</dd>

      <dt><code>--suexec-docroot=<em>DIR</em></code></dt>

      <dd>Apache のドキュメントルートを誓瀋蠅靴泙后海譴愿の動作で使用する唯一のディレクトリ階層になります (UserDir
      の指定は別)。デフォルトでは --datedir に "/htdocs"
      というサフィックスをつけたものです。
      "<code>--datadir=/home/apache</code>" として誓瀋蠅垢襪函
齦努澱鱇韶纈ぢにとって "/home/apache/htdocs"
      がドキュメントルートとして使われます。</dd>

      <dt><code>--suexec-logfile=<em>FILE</em></code></dt>

      <dd>suEXEC の処理とエラーが記録されるファイル名を指定します。
      (監査やデバッグ目的に有用)
      デフォルトではログファイルは "suexec_log" という名前で、
      標準のログファイルディレクトリ (--logfiledir) に置かれます。
      </dd>

      <dt><code>--suexec-userdir=<em>DIR</em></code></dt>

      <dd>suEXEC がアクセスを許されるユーザホームディレクトリ配下の
      サブディレクトリを指定します。
      このディレクトリ以下の全実行ファイルは、"安全な"プログラムになるよう、
      suEXEC がそのユーザとして実行できるようにします。
      "単純な" UserDir ディレクティブを使っている場合 
      (すなわち "*" を含まないもの)、これと同じ値を誓瀋蠅垢戮任后
專纈粡ディレクティブがそのユーザのパスワードファイル内の
      ホームディレクトリと同じ場所を指していなければ、
      suEXEC は適誓擇貌虻遒靴泙擦鵝妊侫襯箸頤碎蜒煦譬ぢです。
      <br />
      各 UserDir が異なった仮想ホストを誓瀋蠅靴討い訃豺隋
それらを全て一つの親ディレクトリに含めて、
      その親ディレクトリの名前をここで指定する必要があります。
      <strong>このように指定されなければ "~userdir" cgi
      へのリクエストが動作しません。</strong></dd>

      <dt><code>--suexec-uidmin=<em>UID</em></code></dt>

      <dd>suEXEC の対象ユーザとして許される UID の最小値を指定します。
      大抵のシステムでは 500 か 100 が一般的です。
      デフォルト値は 100 です。</dd>

      <dt><code>--suexec-gidmin=<em>GID</em></code></dt>

      <dd>suEXEC の対象グループとして許される GID
      の最小値を指定します。大抵のシステムでは 100 が一般的なので、
      デフォルト値としても 100 が使われています。</dd>

      <dt><code>--suexec-safepath=<em>PATH</em></code></dt>

      <dd>CGI 実行ファイルに渡される安全な PATH 環境変数です。
      デフォルト値は "/usr/local/bin:/usr/bin:/bin" です。
      </dd>
    </dl>

    <p align="left"><strong>suEXEC 誓瀋蠅粒稜鹿齡鳫鈑錫
齦努澱鱇韶纈ぢをコンパイルしてインストールする前に、誓瀋蠧睛討
赱ぢオプションで確認できます。<br />
    出力例:</p>
d399 31
a429 28
    <p align="left"><strong>suEXEC wrapper
    のコンパイルとインストール</strong><br />
    --enable-suexec オプションで suEXEC 機能を有効にすると、
    "make" コマンドを実行した時に suEXEC のバイナリ (Apache 自体も)
    が自動的に作誓気譴泙后
錫
すべての構誓彖任鄒成されると、それらのインストールには
    "make install" コマンドが実行できます。バイナリイメージの "suexec"
    は --sbindir オプションで指定されたディレクトリにインストールされます。
    デフォルトの場所は "/usr/local/apache/sbin/suexec" です。<br />
    インストール時には <strong><em>root</em></strong>
    権限が必要なので注意してくだ世気ぁ瘰鞳がユーザ ID
    を誓瀋蠅垢襪燭瓩法⊇衢竢粤昭纃条闖躱鹿竢粤でのセットユーザ ID
    ビットをそのファイルのモードに誓瀋蠅靴覆韻譴个覆蠅泙擦鵝
鹿霈

腫跚芬就竇銓纈⊂首闔臂釈
蓿繙就齦纔繝譬ぢ目次に戻る</a></strong></p>

    <h3><a id="enable" name="enable">suEXEC
    の有効化と無効化</a></h3>

    <p align="left">起動時に、Apache は "sbin" ディレクトリで
    "suexec" を探します
    (デフォルトは "/usr/local/apache/sbin/suexec") 。
    適誓擇棒設定された suEXEC がみつかると、
    エラーログに以下のメッセージが出力されます。</p>
d434 107
a540 106
    <p>サーバ起動時にこのメッセージが出ない場合、
    大抵はサーバが想定した場所で wrapper プログラムが見つからなかったか、
    <em>setuid root</em> としてインストールされていないかです。
    <br />
    suEXEC の仕組みを使用するのが初めてで、Apache が既に動作中であれば、
    Apache を kill して、再起動しなければなりません。HUP シグナルや
    USR1 シグナルによる単純な再起動では不十分です。<br />
    suEXEC を無効にする場合は、"suexec" ファイルを削除してから
    Apache を kill して再起動します。
    </p>

    <p align="center"><strong><a
    href="suexec.html">目次に戻る</a></strong></p>

    <h3><a id="usage" name="usage">suEXEC の使用</a></h3>

    <p align="left"><strong>仮想ホスト:</strong><br />
    suEXEC wrapper の使い方として、
    <a href="mod/core.html#virtualhost">仮想ホスト</a>誓瀋蠅任
釈鱚羹閼闥絎蔗迪ｕ黼鬆蒋黼鮗ディレクティブと
    <a href="mod/core.html#group">Group</a>
    ディレクティブを通したものがあります。
    これらのディレクティブをメインサーバのユーザ ID
    と異なるものにすると、CGI リソースへのすべてのリクエストは、その
    <code>&lt;VirtualHost&gt;</code> で指定された <em>User</em> と
    <em>Group</em> として実行されます。<code>&lt;VirtualHost&gt;</code>
    でそれらのディレクティブのどちらか、または両方が指定されていない場合、
    メインサーバのユーザ ID が想定されます。</p>

    <p><strong>ユーザディレクトリ:</strong><br />
    suEXEC wrapper は、リクエスト誓茲離罅璽兇箸靴派
を実行するためにも使えます。これは期待する実行権限のユーザ ID
    の前に、"<strong><code>~</code></strong>"
    文字を置くことで実現されます。
    この機能を動作させるために必要なことは、CGI
    をそのユーザで実行できること、そのスクリプトが上記の<a
    href="#model">セキュリティ検査</a>をパスできることです。
    </p>

    <p align="center"><strong><a
    href="suexec.html">目次に戻る</a></strong></p>

    <h3><a id="debug" name="debug">suEXEC のデバッグ</a></h3>

    <p align="left">suEXEC wrapper は、上記で述べた --suexec-logfile
    オプションで指定されたファイルにログ情報を記録します。
    wrapper を適誓擇棒設定、インストールできていると思う場合、
    どこで迷っているか見ようとするならこのログとサーバの
    エラーログを見るとよいでしょう。</p>

    <p align="center"><strong><a
    href="suexec.html">目次に戻る</a></strong></p>

    <h3><a id="jabberwock"
    name="jabberwock">とかげに注意: 警告と事例</a></h3>

    <p align="left"><strong>注意!</strong>
    この章は完全ではありません。この章の最新改訂版については、
    Apache グループの<a href="http://www.apache.org/docs/suexec.html">
    オンラインドキュメント</a>版を参照してくだ世気ぁ
鹿霈

腫跚芬就跂胄⊂サーバの誓瀋蠅棒制限をもうける wrapper について、
    いくつか興味深い点世△蠅泙后齦努澱ぢに関する "バグ"
    を報告する前にこれらを確認してくだ世気ぁ鹿霈

受貍
殊蘊首闔臂齦努澱ぢの興味深い点鹿齡鳫鈑昭蘊

殊蘊階層構造の誓


錫跫站髟阡緇
セキュリティと効率の理由から、suEXEC の全てのリクエストは
          仮想ホストへのリクエストにおける最上位のドキュメントルート内か、
          ユーザディレクトリへのリクエストにおける個々のユーザの最上位の
          ドキュメントルート内に残らなければなりません。
          例えば、四つの仮想ホストを誓瀋蠅靴討い訃豺隋
仮想ホストの suEXEC に有利なように、メインの Apache
          ドキュメント階層の外側に全ての仮想ホストのドキュメントルートを
          構築する必要があります。(例は後日記載)
        </blockquote>
      </li>

      <li>suEXEC の PATH 環境変数

 
        <blockquote>
          これを変更するのは危険です。この指定に含まれる各パスが
          <strong>信頼できる</strong>
          ディレクトリであることを確認してくだ世気ぁ
誓こΔ蕕離▲札垢砲茲蝓曠好半紊妊肇蹈い量敘
を実行できるようにはしたくないでしょう。
        </blockquote>
      </li>

      <li>suEXEC コードの改造


        <blockquote>
          繰り返しますが、何をやろうとしているか把握せずにこれをやると
          <strong>大きな問題</strong>を引き起こしかねません。
          可能な限り避けてくだ世気ぁ
鹿碎閭鞫鹿跚鹿箋寛
甬寛
腫跚芬就竇銓纈⊂首闔臂釈
蓿繙就齦纔繝譬ぢ目次に戻る</a></strong></p>
        <hr />
d547 1
a547 1
  </body>
@


1.1.1.2
log
@import apache 1.3.28 and mod_ssl 2.8.15
@
text
@d10 1
a10 1
  <!-- English revision: 1.28 -->
d389 1
a389 1
      オプションとあわせて少なくとも一つは --suexec-xxxxx
d402 1
a402 1
      の指定は別)。デフォルトでは --datadir に "/htdocs"
d560 1
a560 1
    Apache グループの<a href="http://httpd.apache.org/docs/suexec.html">
@


