head	1.5;
access;
symbols
	OPENBSD_3_7:1.4.0.8
	OPENBSD_3_7_BASE:1.4
	OPENBSD_3_6:1.4.0.6
	OPENBSD_3_6_BASE:1.4
	OPENBSD_3_5:1.4.0.4
	OPENBSD_3_5_BASE:1.4
	apache_1_3_29-mod_ssl_2_8_16:1.1.1.3
	OPENBSD_3_4:1.4.0.2
	OPENBSD_3_4_BASE:1.4
	apache_1_3_28-mod_ssl_2_8_15:1.1.1.3
	OPENBSD_3_3:1.3.0.2
	OPENBSD_3_3_BASE:1.3
	apache_1_3_27-mod_ssl_2_8_12:1.1.1.2
	apache_1_3_27:1.1.1.2
	OPENBSD_3_2:1.2.0.2
	OPENBSD_3_2_BASE:1.2
	apache_1_3_26:1.1.1.1
	apache:1.1.1
	OPENBSD_3_1:1.1.0.2
	OPENBSD_3_1_BASE:1.1;
locks; strict;
comment	@# @;


1.5
date	2005.07.27.20.03.17;	author jmc;	state dead;
branches;
next	1.4;

1.4
date	2003.08.21.13.11.33;	author henning;	state Exp;
branches;
next	1.3;

1.3
date	2002.10.07.21.04.44;	author henning;	state Exp;
branches;
next	1.2;

1.2
date	2002.07.19.21.31.15;	author henning;	state Exp;
branches;
next	1.1;

1.1
date	2002.02.12.07.56.48;	author beck;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2002.07.19.21.28.16;	author henning;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2002.10.07.19.48.09;	author henning;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2003.08.21.12.53.35;	author henning;	state Exp;
branches;
next	;


desc
@@


1.5
log
@from tamas tevesz:
more altlangs removal, missed from previous sweep;
@
text
@<?xml version="1.0" encoding="iso-2022-jp"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
  <head>
    <title>名前ベースのバーチャルホスト</title>
  </head>
  <!-- Background white, links blue (unvisited), navy (visited), red (active) -->
  <!-- English revision: 1.21 -->
  <body bgcolor="#ffffff" text="#000000" link="#0000ff"
  vlink="#000080" alink="#ff0000">
        <div align="CENTER">
      <img src="../images/sub.gif" alt="[APACHE DOCUMENTATION]" /> 

      <h3>Apache HTTP Server Version 1.3</h3>
    </div>


    <p>この文書では名前ベースのバーチャルホストをどんなとき、
    またどうやって使うのかということを誓睫誓します。</p>

    <ul>
      <li><a href="#namevip">名前ベース と IP-based
      のバーチャルホストの比較</a></li>

      <li><a href="#using">名前ベースのバーチャルホストを利用する</a></li>

      <li><a href="#compat">古いブラウザとの互換誓鹿畩鹿跚鹿
腫ぢ参考: <a href="examples.html">標準的なセットアップでの
    バーチャルホストの例</a>、 <a href="ip-based.html">IP ベースの
    バーチャルホストのサポート</a>、 <a href="details.html">
    バーチャルホストのマッチングの具体的な詳細</a> と <a
    href="mass.html">大量のバーチャルホストを動的に誓瀋蠅垢鹿畩
鹿霈
取

取仮釈篏瘢纐蜷釶辣就釶辣陟
ぢ名前ベースと IP ベースのバーチャルホストの比較</a></h2>

    <p>初期のバージョンの HTTP では (他の多くのプロトコル、例えば FTP
    と同様) 一つのサーバ上でのバーチャルホストごとに異なった IP
    アドレスが必要でした。いくつかのプラットフォームでは、このことが
    実行可能なバーチャルホストの数を限定してしまうことになりました。また、
    IP アドレスの数には限りがあるということについての懸念から、レジストラ
    (ARIN, RIPE, APNIC) はバーチャルホストごとに
    IP を割り当てるようなことは避けるよう強く要誓舛靴討い泙后鹿霈

腫ぢ名前ベースのバーチャルホストは通常単純で、
    それぞれのホスト名とそれに対応する誓騎里アドレスを DNS
    で誓瀋蠅掘曚覆襯曠好般召魘菠冥侏茲襪茲Δ鞜竏挽墅
サーバを誓瀋蠅垢襪誓けです。さらに、名前ベースのバーチャルホストは不足する
    IP アドレスの需要を緩和します。したがって、IP
    ベースのバーチャルホストを選択すべき特定の理由がなければ名前ベースの
    バーチャルホストを使うべきです。
    IP ベースのバーチャルホストを使用することを考慮する理由として、</p>

    <ul> 
      <li>名前ベースのバーチャルホストに対応していない古いクライアントがある
      名前ベースのバーチャルホストが働くためには、クライアントは
      HTTP ホストヘッダ世鯀辰討海覆韻譴个覆蠅泙擦鵝
これは HTTP/1.1 の仕様で要求されていて、すべての現代的な
      HTTP/1.0 ブラウザでも拡張として実装されています。
      とても古いクライアントをサポートしつつ、名前ベースの
      バーチャルホストを行いたい場合は、この文書の最後の方に
      書かれている解決策になるかもしれない方法を見てくだ世気ぁ鹿跚
殊蘊名前ベースのバーチャルホストは SSL プロトコルの特徴により、
      SSL セキュアサーバには使えません。</li>

      <li>オペレーティングシステムやネットワーク装置のなかには、別の IP
      アドレス上でない場合、複数のホストを別扱いできないような
      帯域管理の方法を実装しているものがあります。</li>
    </ul>

    <h2><a id="using"
    name="using">名前ベースのバーチャルホストを利用する</a></h2>

    <table border="1">
      <tr>
        <td align="top"><strong>関連ディレクティブ</strong><br />
         <br />
         <a href="../mod/core.html#documentroot">DocumentRoot</a><br />
         <a
         href="../mod/core.html#namevirtualhost">NameVirtualHost</a><br />
         <a href="../mod/core.html#serveralias">ServerAlias</a><br />
         <a href="../mod/core.html#servername">ServerName</a><br />
         <a href="../mod/core.html#serverpath">ServerPath</a><br />
         <a href="../mod/core.html#virtualhost">VirtualHost</a><br />
        </td>
      </tr>
    </table>

    <p>名前ベースのバーチャルホストを使うには、そのホストへの
    リクエストを受け付けるサーバの IP アドレス (もしかしたらポートも)
    を指定する必要があります。
    これは <a href="../mod/core.html#namevirtualhost">NameVirtualHost</a>
    ディレクティブで誓瀋蠅靴泙后Ｄ名錙若閼緇令辣帷鶯貳闢閼緇ぢで
    <code>*</code> の属誓鮖箸辰謄機璽个里垢戮討アドレスを使います。
    (<code>NameVirtualHost *</code> はバージョン 1.3.13 以降のみで動作します。)
    <code>NameVirtualHost</code> ディレクティブで IP アドレスを書いても、
    自動的にサーバがその IP アドレスをリッスンするということはないことに
    注意してくだ世気ぁ楮戮蓿繙就蜴筮蔗迪⊂草痺蒹ぢの使うアドレスと
    ポートを誓瀋蠅垢鹿畩ぢを読んでくだ世気ぁ気蕕法△海海濃慊蠅気譴
賓ぢアドレスはすべてサーバのネットワークインターフェースと関連付けられて
    いなければなりません。</p>

    <p>次は、扱いたいそれぞれのホストに対して <a
    href="../mod/core.html#virtualhost">&lt;VirtualHost&gt;</a>
    ブロックを作誓靴討誓さい。<code>&lt;VirtualHost&gt;</code>
    ディレクティブの引数は <code>NameVirtualHost</code>
    ディレクティブの引数と同じにしてくだ世気すなわち、IP
    アドレス一つやすべてのアドレスを表す <code>*</code>)。それぞれの
    <code>&lt;VirtualHost&gt;</code> ディレクティブの中には、最低限、
    どのホストが扱われるかを示す <a
    href="../mod/core.html#servername">ServerName</a> ディレクティブと、
    そのホスト用のコンテンツがファイルシステム上のどこにあるかを示す
    <a href="../mod/core.html#documentroot">DocumentRoot</a>
    ディレクティブを書く必要があります。</p>

    <p>既に存在するウェブサーバにバーチャルホストを追加する場合、
    存在するホスト用の &lt;VirtualHost&gt; ブロックを作らなければなりません。
    <code>ServerName</code> と <code>DocumentRoot</code>
    はこのバーチャルホストも含めて、それぞれグローバルな
    <code>ServerName</code> 及び <code>DocumentRoot</code>
    と同じものにするべきです。誓瀋螢侫．ぅ訝罎悩能蕕傍劼靴
このバーチャルホストは
    デフォルトのバーチャルホストとしても振る舞います。
    </p>
    <p>例えば、ドメイン <samp>www.domain.tld</samp> を運用しているところに
    バーチャルホスト <samp>www.otherdomain.tld</samp> を追加する場合で、
    両方が同じ IP アドレスを指しているとします。そのような場合は、
    <code>httpd.conf</code> に以下のようなコードを追加するだ世韻任鹿霈
腫鱚令辣帷鶯貳闢
帷鶯貳闢苳嚆鴟纈令辣闕瘟隨弟笊辣銓呰阡粹轣蜴
蜥瘡被齡

帷鶯貳闢苳嚆鴟纈令辣纈粹轣蜴趙
弟笊辣銓呰阡阡蒹鰾闕瘟蜥瘡被齡
鹿頏緇

腫昭竢粤称瘢縉蜥瘡被齡鹿竢粤及び
    <code>&lt;VirtualHost&gt;</code> のどちらの場合も、
    * の部分には明声アドレスを指定することができます。
    バージョン 1.3.12 以前では IP アドレスの指定が必要でした。</p>

    <p>複数の名前でサーバアクセスができるようにしたいことも多いでしょう。
    このようなことは、<a href="../mod/core.html#serveralias"
    ><code>ServerAlias</code></a> ディレクティブを &lt;VirtualHost&gt;
    セクションに記述することで実現できます。
    例えばこれを最初の &lt;VirtualHost&gt; ブロックに書き加えると、</p> 
<pre>
    ServerAlias domain.tld *.domain.tld
</pre>

    <p><code>domain.tld</code> ドメインへのすべてのホストへのリクエストは
    <code>www.domain.tld</code> のバーチャルホストが処理します。
    * や ? をワイルドカード文字として使用できますが、当然ながらそれだ世韻
若閼緇嚆鴟纈令辣鹿竢粤や <code>ServerAlias</code>
    の名前や場所を構誓垢襪海箸呂任泙擦鵝泙査能蕕林ぢのホスト名と
    IP アドレスをサーバにあわせて適誓擇棒設定する事が必要です</p>

    <p>最後に、<code>&lt;VirtualHost&gt;</code> コンテナの中に
    他のディレクティブを書くことで、バーチャルホストの誓瀋蠅鮑戮儿
することができます。どのディレクティブを書くことができるかは、
    ディレクティブの <a
    href="../mod/directive-dict.html#context">コンテキスト</a> を
    調べてくだ世気ぁ弱躱主サーバコンテキスト</em>
    (<code>&lt;VirtualHost&gt;</code> コンテナの外) の
    誓瀋衢僖妊譽謄屬魯弌璽船礇襯曠好箸任寮設定で上書きされていない
    ときのみ使用されます。</p>

    <p>リクエストが来ると、サーバはまず最初に <code>NameVirtualHost</code>
    にマッチする IP アドレスかどうかをチェックします。マッチすれば
    マッチした IP アドレスの <code>&lt;VirtualHost&gt;</code>
    のそれぞれのセクションの中から <code>ServerName</code> か
    <code>ServerAlias</code> に要求されたホスト名があるか探します。
    見つかればそのサーバ用の誓瀋蠅鮖箸い泙后泪奪舛垢襯弌璽船礇襯曠好
が見つからなければ、マッチした IP アドレスの 
    <strong>リストの最初にあるバーチャルホスト</strong> が使われます。</p>

    <p>結果として、リストの最初のバーチャルホストが <em>デフォルト</em> の
    バーチャルホストになります。IP アドレスが <code>NameVirtualHost</code>
    ディレクティブにマッチした場合は、<em>メインのサーバ</em> の
    <code>DocumentRoot</code> 使われ <strong>ません</strong>
    どのバーチャルホストにもマッチしないリクエストに対して、
    特別な誓瀋蠅鬚靴燭い里任△譴弌∪設定ファイル中の最初の
    <code>&lt;VirtualHost&gt;</code> にそれを記述してくだ世気ぁ鹿霈

取仮釈篏≪闕鞜槇瘢綵≪闕鞜槇ぢ古いブラウザとの互換誓鹿畩鹿莢
腫ぢ上で書いたように、名前ベースのバーチャルホストが誓気靴虻遒垢
ために必要な情報を送ってこないクライアントが依然として存在しています。
    そのようなクライアントに対しては、該当する IP アドレスについて、
    一番最初に誓瀋蠅気譴討い襯弌璽船礇襯曠好
┝竕ぢプライマリ</cite>の名前ベースのバーチャルホスト)
    からページが送り返されます。</p>

    <p><a href="../mod/core.html#serverpath"><code>ServerPath</code></a>
    ディレクティブで対処が可能です。ちょっと不格好ですけれども。</p>

    <p>誓瀋衫鹿霈
腫鱚令辣帷鶯貳闢臼窺臆凱幹

帷鶯貳闢臼窺臆凱幹
嚆鴟纈令辣闕瘟隨嚆鴟纈倚粹轣蜴
弟笊辣銓呰阡皴粹轣蜴
蜥瘡被齡
鹿頏緇

腫ぢこの例にはどういう意味があるでしょうか? これは
    "<samp>/domain</samp>" で始まる URI へのリクエストはすべて、
    バーチャルホスト <samp>www.domain.tld</samp> で処理される、
    という意味です。つまり、すべてのクライアントで
    <code>http://www.domain.tld/domain/</code> でアクセスできるページが、
    <samp>Host:</samp> ヘッダ世鯀辰討襯薀ぅ▲鵐箸任△譴
若閼緇蔗痕闕瘟隨箝鹿竢粤としてもアクセスできる、
    という意味です。</p>

    <p>これを実用的なものとするためには、
    プライマリのバーチャルホストのページに
    <samp>http://www.domain.tld/domain/</samp> へのリンクを誓瀉屬靴泙后
そして、バーチャルホストのページでは、純粋な相対リンク (<em>例:</em>
    "<samp>file.html</samp>" や "<samp>../icons/image.gif</samp>")、
    あるいは <samp>/domain/</samp> で始まるリンク (<em>例:</em>
    "<samp>http://www.domain.tld/domain/misc/file.html</samp>" や
    "<samp>/domain/misc/file.html</samp>") だ世韻鮴設置します。</p>

    <p>これには、幾分かの規律が必要となりますが、
    このようなガイドラインを忠実に守ることにより、たいていの場合、
    すべてのブラウザで ― 新しいブラウザでも古いものでも ―
    作誓靴織據璽犬┐襪箸いΔ海箸鯤歉擇靴泙后鹿霈

腫ぢ参考: <a href="examples.html#serverpath">ServerPath 誓瀋衫鹿畩鹿霈
取

取瘡蜃扈杜堙劬樵鞜竏挽墅纈帙鴦蜿窺骸馨
釈鱚羹〓昭蜊齟秉〓蜊瘍纉鈔纔蜀瘡鈔纔鹿畩
釈鱚羹〓⊂守辯鱆就轣艱鶩蓖辣蜀瘡闕紜昭
鹿硼糯鹿蔗迪

窺跫尖纈艱

誓


窺跫尖纈艱鞜竏窺凱卸

絶畊
次鈑跚鼈纐蜩蜿邵箚甦実行可能なバーチャルホストの数を限定してしまうことになりました。
    また、IP アドレスの数には限りがあるということについての懸念から、
    レジストラ (ARIN, RIPE, APNIC) はバーチャルホストごとに
d50 7
a56 6
    <p>名前ベースのバーチャルホストは通常単純で、それぞれのホスト名と
    それに対応する誓騎里アドレスを DNS で誓瀋蠅掘曚覆
ホスト名を区別出来るように Apache HTTP サーバを誓瀋蠅垢襪誓けです。
    さらに、名前ベースのバーチャルホストは不足する IP
    アドレスの需要を緩和します。したがって、IP ベースのバーチャルホストを
    選択すべき特定の理由がなければ名前ベースのバーチャルホストを使うべきです。
d72 2
a73 2
      <li>オペレーティングシステムやネットワーク装置のなかには、
      別の IP アドレス上でない場合、複数のホストを別扱いできないような
d100 1
a100 1
    <code>*</code> の属誓鮖箸辰謄機璽个料瓦討アドレスを使います。
d106 1
a106 1
    IP アドレスは全てサーバのネットワークインターフェースと関連付けられて
d110 7
a116 6
    href="../mod/core.html#virtualhost">&lt;VirtualHost&gt;</a> ブロックを
    作誓靴討誓さい。<code>&lt;VirtualHost&gt</code> ディレクティブの
    引数は <code>NameVirtualHost</code> ディレクティブの引数と
    同じにしてくだ世気すなわち、IP アドレス一つや全てのアドレスのための
    <code>*</code>)。それぞれの <code>&lt;VirtualHost&gt</code> ディレクティブ
    の中には、最低限、どのホストが扱われるかを示す <a
d119 2
a120 2
    <a href="../mod/core.html#documentroot">DocumentRoot</a> ディレクティブを
    書く必要があります。</p>
d122 12
a133 3
    <p>たとえば、<samp>www.domain.tld</samp> と
    <samp>www.otherdomain.tld</samp> の両方が 1つの IP
    アドレスを指しているとしましょう。そのような場合は、
d163 1
a163 1
    <p><code>domain.tld</code> ドメインへの全てのホストへのリクエストは
d165 4
a168 4
    * や ? をワイルドカード文字として使用できます。
  Of course,you can't just make up names and place them in <code>ServerName</code>
  or <code>ServerAlias</code>.
    第一に DNS のホスト名と IP アドレスをサーバにあわせて適誓擇棒設定する事が必要です</p>
d174 1
a174 1
    href="../mod/directive-dist.html#context">コンテキスト</a> を
@


1.2
log
@merge
@
text
@d100 1
d140 2
a141 1
    * の部分には明声アドレスを指定することができます。</p>
@


1.1
log
@Apache 1.3.23+mod_ssl-2.8.6-1.3.23 merge
@
text
@d1 12
a12 15
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML><HEAD>
<!-- English revision: 1.15 -->
<TITLE>Apache のネームベースのバーチャルホスト</TITLE>
</HEAD>

<!-- Background white, links blue (unvisited), navy (visited), red (active) -->
<BODY
 BGCOLOR="#FFFFFF"
 TEXT="#000000"
 LINK="#0000FF"
 VLINK="#000080"
 ALINK="#FF0000"
>
    <div align="CENTER">
a17 1
<H1 ALIGN="CENTER">Apache のネームベースのバーチャルホストのサポート</H1>
d19 2
a20 2
<STRONG>参考:</STRONG>
<A HREF="ip-based.html">IP ベースのバーチャルホストのサポート</A>
d22 16
a37 3
<HR>

<H2>ネームベースと IP ベースのバーチャルホストの比較</H2>
d39 2
a40 42
<P>初期のバージョンの HTTP では (他の多くのプロトコル、例えば FTP と同様)
一つのサーバ上でのバーチャルホストごとに異なった IP アドレスが必要でした。
いくつかのプラットフォームでは、
これが実行可能なバーチャルホストの数を限定してしまうことになりました。
また、IP アドレスの数には限りがあるということについての懸念から、
レジストラ (ARIN, RIPE, APNIC) はバーチャルホストごとに
IP を割り当てるようなことは避けるよう強く要誓舛靴討い泙后鹿仂

斜昭地津照墺亊窺閏歪転ぢプロトコルや、
<CODE>HTTP/1.0</CODE> での一般的な拡張には、
どの名前でリクエストされているのかをサーバが判別する方法があります。
Apache 1.1 以降では誓里蕕痢屮曠好般召瓦箸アドレス」という方法に加えて、
このアプローチもサポートしています。</P>

<P>ネームベースのバーチャルホストの利点世箸靴討蓮
事実上無限の数のサーバを運用できるということ、誓瀋蠅畦僂垢襪里蔽韻覆海函
追加のハードウェアやソフトウェアが不要なこと、というのがあります。

もっとも大きな問題点世箸靴討蓮
クライアントはこのプロトコルをサポートしなければいけないということです。
ほとんどすべてのブラウザでサポートされていますが、
サポートしていないブラウザも少ないながらも依然として存在しています。
そのために問題が発誓犬垢襪海箸△蠅泙后海譴紡个垢覯魴菠，
なり得世襪發里聾綵劼靴泙后鹿仂

屡仮ネームベースのバーチャルホストを利用する</H2>

<P>ネームベースのバーチャルホストを利用するのはとても簡単です。
見た目には従来の IP ベースの方法に似ています。

IP ベースとネームベースのバーチャルホストの誓瀋蠅僚斗廚憤磴い蓮
質凖峠〓迴箝竢鱚譯釶辣鶯跏闢槇昭地津称瘢縉蜥瘡被齡鹿地津昭ディレクティブで、ネームベースのバーチャルホストのターゲットとして使われる
IP アドレスを指定するということです。</P>

<P>たとえば、
<SAMP>www.domain.tld</SAMP> と <SAMP>www.otherdomain.tld</SAMP>
の両方が <SAMP>111.22.33.44</SAMP> という IP アドレスを指しているとしましょう。

そのような場合は、Apache の誓瀋螢侫．ぅ襪琉譴
ぢ通常は <CODE>httpd.conf</CODE> か <CODE>srm.conf</CODE> のどちらか) に
以下のようなコードを追加するだ世韻任瑳箚験
甕牡
斜凖令辣帷鶯貳闢臼窺臆凱幹
箟俺
甕俺
帷鶯貳闢臼窺臆凱幹
箟咳
甕咳
帷鶯貳闢臼窺臆凱幹
箟概
甕概鹿侑転

斜ぢもちろん、ディレクティブを
<CODE>&lt;VirtualHost&gt;</CODE>
セクションに追加することができます (するべきです) 。

これを動作するために必要なことは、
<SAMP>www.domain.tld</SAMP> や <SAMP>www.otherdomain.tld</SAMP>
という名前が IP アドレス <SAMP>111.22.33.44</SAMP>
を指しているか確認するということだ世韻任后鹿仂

斜ぢ注意: <CODE>NameVirtualHost</CODE> ディレクティブで
IP アドレスを指定した場合、その IP アドレスへのリクエストは、
常にそのリクエストにマッチする &lt;VirtualHost&gt; でのみ処理されます。
その IP アドレスでは「メインサーバ」は<STRONG>決して</STRONG>見えません。
バーチャルホストを使うのであれば「メインサーバ」を独立したサーバとして使うのは
止めるべきです。むしろ、その部分はすべてのバーチャルホストで共通な誓瀋螢妊
クティブを記述するために使用してくだ世気ぁ
言世ご垢┐襪函▲機璽仂紊捻人僂靴燭偲余すべての</EM>サーバ
(ホスト名) について &lt;VirtualHost&gt; セクションを追加すべきです。

<P>Apache 1.3.13 以降では、

<CODE>NameVirtualHost</CODE> の IP アドレスにワイルドカード <CODE>*</CODE>
を指定できます。このワイルドカードは、
より具体的なバーチャルホストのディレクティブでカバーされていない任意の
IP アドレスにマッチします。
これは、前もって IP アドレスを知ることのできないサーバを誓瀋蠅垢觝櫃北
に立ちます。たとえば、動的に IP アドレスが誓瀋蠅気譴訃豺腓筺韻言設定ファ
イルを共有する負荷分散のためのクラスタの一部となる場合などです。</P>

<P>さらに、複数の名前でサーバアクセスができるようにしたいことも多いでしょう。
たとえば、同じ IP アドレスを指す
<CODE>domain.tld</CODE> と <CODE>www2.domain.tld</CODE>
のどちらででもサーバにアクセスできるようにしたい場合などです。
それどころか、<CODE>domain.tld</CODE> のどんなアドレスででもそのサーバに
アクセスできるようにしたい場合があるかもしれません。

このようなことは、
<A HREF="../mod/core.html#serveralias"><CODE>ServerAlias</CODE></A>
ディレクティブを &lt;VirtualHost&gt; セクションに記述することで実現できます。
たとえば:</P>
d137 10
a146 1
<PRE>
d148 1
a148 4
</PRE>

<P><CODE>*</CODE> や <CODE>?</CODE> をワイルドカード文字として使用できることに
注意してくだ世気ぁ鹿仂
箟軌甕恒
斜ぢ普通はドメイン名を省略するであろうローカルのユーザのために
<CODE>ServerAlias</CODE> が必要かもしれません。
d193 2
a194 3
たとえば、もしローカルのユーザが "www" や "www.foobar" とタイプするのに
親しんでいる場合、
<CODE>ServerAlias www www.foobar</CODE> を追加する必要があるでしょう。
d196 2
a197 21
クライアントが名前の解決にどのようなドメイン名を使ったのかをサーバが
知ることは不可能です。クライアントはリクエストにそのような情報を含めない
からです。
通常は、<CODE>ServerAlias</CODE> ディレクティブは同じバーチャルホストに対して
異なったホスト名を割り当てる方法です。</P>

<H2>古いブラウザとの互換誓鹿伐
斜ぢ上で書いたように、ネームベースのバーチャルホストが誓気靴虻遒垢
ために必要な情報を送ってこないクライアントが依然として存在しています。
そのようなクライアントに対しては、該当する IP アドレスについて、
一番最初に誓瀋蠅気譴討い襯弌璽船礇襯曠好
┝檀堙ぢプライマリ</CITE>のネームベースのバーチャルホスト)
からページが送り返されます。</P>

<P><A HREF="../mod/core.html#serverpath"><CODE>ServerPath</CODE></A>
ディレクティブで対処が可能です。ちょっと不格好ですけれども。</P>

<P>誓瀋衫
斜凖箍圧
甓圧鹿侑転

斜ぢこの例にはどういう意味があるでしょうか? これは
"<SAMP>/domain</SAMP>" で始まる URI へのリクエストはすべて、
バーチャルホスト <SAMP>www.domain.tld</SAMP> で処理される、という意味です。

つまり、すべてのクライアントで
<CODE>http://www.domain.tld/domain/</CODE> でアクセスできるページが、
<SAMP>Host:</SAMP> ヘッダ世鯀辰討襯薀ぅ▲鵐箸任△譴
蔀歪転蔗痕闕瘟隨箝鹿地津としてもアクセスできる、という
意味です。</P>

<P>これを実用的なものとするためには、
プライマリのバーチャルホストのページに
<SAMP>http://www.domain.tld/domain/</SAMP> へのリンクを誓瀉屬靴泙后

そして、バーチャルホストのページでは、
純粋な相対リンク (<EM>例:</EM> "<SAMP>file.html</SAMP>" や 
"<SAMP>../icons/image.gif</SAMP>")、
あるいは <SAMP>/domain/</SAMP> で始まるリンク
(<EM>例:</EM> "<SAMP>http://www.domain.tld/domain/misc/file.html</SAMP>" や
"<SAMP>/domain/misc/file.html</SAMP>") だ世韻鮴設置します。</P>

<P>これには、幾分かの規律が必要となりますが、
このようなガイドラインを忠実に守ることにより、たいていの場合、
すべてのブラウザで―新しいブラウザでも古いものでも―
作誓靴織據璽犬┐襪箸いΔ海箸鯤歉擇靴泙后鹿仂
箍扱甓恩
斜ぢ参考: <A HREF="examples.html#serverpath">ServerPath 誓瀋衫鹿曽鹿仂
箍外
甓咳
取
箍碍
甓蓋
鹿堆潰鹿挽楊

窺窺窺跫千逅闥瘰痺蒹迴籖齠荻軒碓

絶欝
甕渦
漆鴦蜿扈緕竢粡鈑就蜩鎰屋臆陟疹
次掴痴捐蔗迪嫗棉↓彝誰堋挽楊鱇銖蜚蜿釶豁裏
∵雕鱧勵豈堋蔗迪鵜瘤皷闔瘡⊂
取跪鷭∵雕鱧更康譬迪碕瘤臀∬瓣瘤臀∬瓣取縺箴
儒蜚跂ぢ名前ベースのバーチャルホスト</title>
  </head>
  <!-- Background white, links blue (unvisited), navy (visited), red (active) -->
  <!-- English revision: 1.18 -->
  <body bgcolor="#ffffff" text="#000000" link="#0000ff"
  vlink="#000080" alink="#ff0000">
        <div align="CENTER">
d21 1
d23 2
a24 2
    <p>この文書では名前ベースのバーチャルホストをどんなとき、
    またどうやって使うのかということを誓睫誓します。</p>
d26 3
a28 16
    <ul>
      <li><a href="#namevip">名前ベース と IP-based
      のバーチャルホストの比較</a></li>

      <li><a href="#using">名前ベースのバーチャルホストを利用する</a></li>

      <li><a href="#compat">古いブラウザとの互換誓鹿畩鹿跚鹿
腫ぢ参考: <a href="examples.html">標準的なセットアップでの
    バーチャルホストの例</a>、 <a href="ip-based.html">IP ベースの
    バーチャルホストのサポート</a>、 <a href="details.html">
    バーチャルホストのマッチングの具体的な詳細</a> と <a
    href="mass.html">大量のバーチャルホストを動的に誓瀋蠅垢鹿畩
鹿霈
取
箜寛
畄取仮釈篏瘢纐蜷釶辣就釶辣陟
ぢ名前ベースと IP ベースのバーチャルホストの比較</a></h2>
d73 2
a74 83
    <p>初期のバージョンの HTTP では (他の多くのプロトコル、例えば FTP
    と同様) 一つのサーバ上でのバーチャルホストごとに異なった IP
    アドレスが必要でした。いくつかのプラットフォームでは、このことが
    実行可能なバーチャルホストの数を限定してしまうことになりました。
    また、IP アドレスの数には限りがあるということについての懸念から、
    レジストラ (ARIN, RIPE, APNIC) はバーチャルホストごとに
    IP を割り当てるようなことは避けるよう強く要誓舛靴討い泙后鹿霈

腫ぢ名前ベースのバーチャルホストは通常単純で、それぞれのホスト名と
    それに対応する誓騎里アドレスを DNS で誓瀋蠅掘曚覆
ホスト名を区別出来るように Apache HTTP サーバを誓瀋蠅垢襪誓けです。
    さらに、名前ベースのバーチャルホストは不足する IP
    アドレスの需要を緩和します。したがって、IP ベースのバーチャルホストを
    選択すべき特定の理由がなければ名前ベースのバーチャルホストを使うべきです。
    IP ベースのバーチャルホストを使用することを考慮する理由として、</p>

    <ul> 
      <li>名前ベースのバーチャルホストに対応していない古いクライアントがある
      名前ベースのバーチャルホストが働くためには、クライアントは
      HTTP ホストヘッダ世鯀辰討海覆韻譴个覆蠅泙擦鵝
これは HTTP/1.1 の仕様で要求されていて、すべての現代的な
      HTTP/1.0 ブラウザでも拡張として実装されています。
      とても古いクライアントをサポートしつつ、名前ベースの
      バーチャルホストを行いたい場合は、この文書の最後の方に
      書かれている解決策になるかもしれない方法を見てくだ世気ぁ鹿跚
殊蘊名前ベースのバーチャルホストは SSL プロトコルの特徴により、
      SSL セキュアサーバには使えません。</li>

      <li>オペレーティングシステムやネットワーク装置のなかには、
      別の IP アドレス上でない場合、複数のホストを別扱いできないような
      帯域管理の方法を実装しているものがあります。</li>
    </ul>

    <h2><a id="using"
    name="using">名前ベースのバーチャルホストを利用する</a></h2>

    <table border="1">
      <tr>
        <td align="top"><strong>関連ディレクティブ</strong><br />
         <br />
         <a href="../mod/core.html#documentroot">DocumentRoot</a><br />
         <a
         href="../mod/core.html#namevirtualhost">NameVirtualHost</a><br />
         <a href="../mod/core.html#serveralias">ServerAlias</a><br />
         <a href="../mod/core.html#servername">ServerName</a><br />
         <a href="../mod/core.html#serverpath">ServerPath</a><br />
         <a href="../mod/core.html#virtualhost">VirtualHost</a><br />
        </td>
      </tr>
    </table>

    <p>名前ベースのバーチャルホストを使うには、そのホストへの
    リクエストを受け付けるサーバの IP アドレス (もしかしたらポートも)
    を指定する必要があります。
    これは <a href="../mod/core.html#namevirtualhost">NameVirtualHost</a>
    ディレクティブで誓瀋蠅靴泙后Ｄ名錙若閼緇令辣帷鶯貳闢閼緇ぢで
    <code>*</code> の属誓鮖箸辰謄機璽个料瓦討アドレスを使います。
    <code>NameVirtualHost</code> ディレクティブで IP アドレスを書いても、
    自動的にサーバがその IP アドレスをリッスンするということはないことに
    注意してくだ世気ぁ楮戮蓿繙就蜴筮蔗迪⊂草痺蒹ぢの使うアドレスと
    ポートを誓瀋蠅垢鹿畩ぢを読んでくだ世気ぁ気蕕法△海海濃慊蠅気譴
賓ぢアドレスは全てサーバのネットワークインターフェースと関連付けられて
    いなければなりません。</p>

    <p>次は、扱いたいそれぞれのホストに対して <a
    href="../mod/core.html#virtualhost">&lt;VirtualHost&gt;</a> ブロックを
    作誓靴討誓さい。<code>&lt;VirtualHost&gt</code> ディレクティブの
    引数は <code>NameVirtualHost</code> ディレクティブの引数と
    同じにしてくだ世気すなわち、IP アドレス一つや全てのアドレスのための
    <code>*</code>)。それぞれの <code>&lt;VirtualHost&gt</code> ディレクティブ
    の中には、最低限、どのホストが扱われるかを示す <a
    href="../mod/core.html#servername">ServerName</a> ディレクティブと、
    そのホスト用のコンテンツがファイルシステム上のどこにあるかを示す
    <a href="../mod/core.html#documentroot">DocumentRoot</a> ディレクティブを
    書く必要があります。</p>

    <p>たとえば、<samp>www.domain.tld</samp> と
    <samp>www.otherdomain.tld</samp> の両方が 1つの IP
    アドレスを指しているとしましょう。そのような場合は、
    <code>httpd.conf</code> に以下のようなコードを追加するだ世韻任鹿霈
腫鱚令辣帷鶯貳闢箏畄帷鶯貳闢苳筝畍帷鶯貳闢苳筝寛
甕俺
鹿頏緇
箟恩
甕恩腫昭竢粤称瘢縉蜥瘡被齡鹿竢粤及び
    <code>&lt;VirtualHost&gt;</code> のどちらの場合も、
    * の部分には明声アドレスを指定することができます。</p>

    <p>複数の名前でサーバアクセスができるようにしたいことも多いでしょう。
    このようなことは、<a href="../mod/core.html#serveralias"
    ><code>ServerAlias</code></a> ディレクティブを &lt;VirtualHost&gt;
    セクションに記述することで実現できます。
    例えばこれを最初の &lt;VirtualHost&gt; ブロックに書き加えると、</p> 
<pre>
d130 4
a133 1
</pre>
d135 2
a136 42
    <p><code>domain.tld</code> ドメインへの全てのホストへのリクエストは
    <code>www.domain.tld</code> のバーチャルホストが処理します。
    * や ? をワイルドカード文字として使用できます。
  Of course,you can't just make up names and place them in <code>ServerName</code>
  or <code>ServerAlias</code>.
    第一に DNS のホスト名と IP アドレスをサーバにあわせて適誓擇棒設定する事が必要です</p>

    <p>最後に、<code>&lt;VirtualHost&gt;</code> コンテナの中に
    他のディレクティブを書くことで、バーチャルホストの誓瀋蠅鮑戮儿
することができます。どのディレクティブを書くことができるかは、
    ディレクティブの <a
    href="../mod/directive-dist.html#context">コンテキスト</a> を
    調べてくだ世気ぁ弱躱主サーバコンテキスト</em>
    (<code>&lt;VirtualHost&gt;</code> コンテナの外) の
    誓瀋衢僖妊譽謄屬魯弌璽船礇襯曠好箸任寮設定で上書きされていない
    ときのみ使用されます。</p>

    <p>リクエストが来ると、サーバはまず最初に <code>NameVirtualHost</code>
    にマッチする IP アドレスかどうかをチェックします。マッチすれば
    マッチした IP アドレスの <code>&lt;VirtualHost&gt;</code>
    のそれぞれのセクションの中から <code>ServerName</code> か
    <code>ServerAlias</code> に要求されたホスト名があるか探します。
    見つかればそのサーバ用の誓瀋蠅鮖箸い泙后泪奪舛垢襯弌璽船礇襯曠好
が見つからなければ、マッチした IP アドレスの 
    <strong>リストの最初にあるバーチャルホスト</strong> が使われます。</p>

    <p>結果として、リストの最初のバーチャルホストが <em>デフォルト</em> の
    バーチャルホストになります。IP アドレスが <code>NameVirtualHost</code>
    ディレクティブにマッチした場合は、<em>メインのサーバ</em> の
    <code>DocumentRoot</code> 使われ <strong>ません</strong>
    どのバーチャルホストにもマッチしないリクエストに対して、
    特別な誓瀋蠅鬚靴燭い里任△譴弌∪設定ファイル中の最初の
    <code>&lt;VirtualHost&gt;</code> にそれを記述してくだ世気ぁ鹿霈

取仮釈篏≪闕鞜槇瘢綵≪闕鞜槇ぢ古いブラウザとの互換誓鹿畩鹿莢
腫ぢ上で書いたように、名前ベースのバーチャルホストが誓気靴虻遒垢
ために必要な情報を送ってこないクライアントが依然として存在しています。
    そのようなクライアントに対しては、該当する IP アドレスについて、
    一番最初に誓瀋蠅気譴討い襯弌璽船礇襯曠好
┝竕ぢプライマリ</cite>の名前ベースのバーチャルホスト)
    からページが送り返されます。</p>
d138 3
a140 2
    <p><a href="../mod/core.html#serverpath"><code>ServerPath</code></a>
    ディレクティブで対処が可能です。ちょっと不格好ですけれども。</p>
d142 21
a162 2
    <p>誓瀋衫鹿霈
腫鱚箟薫甕攻
鹿頏緇
箟晃
甕晃腫ぢこの例にはどういう意味があるでしょうか? これは
    "<samp>/domain</samp>" で始まる URI へのリクエストはすべて、
    バーチャルホスト <samp>www.domain.tld</samp> で処理される、
    という意味です。つまり、すべてのクライアントで
    <code>http://www.domain.tld/domain/</code> でアクセスできるページが、
    <samp>Host:</samp> ヘッダ世鯀辰討襯薀ぅ▲鵐箸任△譴
若閼緇蔗痕闕瘟隨箝鹿竢粤としてもアクセスできる、
    という意味です。</p>

    <p>これを実用的なものとするためには、
    プライマリのバーチャルホストのページに
    <samp>http://www.domain.tld/domain/</samp> へのリンクを誓瀉屬靴泙后
そして、バーチャルホストのページでは、純粋な相対リンク (<em>例:</em>
    "<samp>file.html</samp>" や "<samp>../icons/image.gif</samp>")、
    あるいは <samp>/domain/</samp> で始まるリンク (<em>例:</em>
    "<samp>http://www.domain.tld/domain/misc/file.html</samp>" や
    "<samp>/domain/misc/file.html</samp>") だ世韻鮴設置します。</p>

    <p>これには、幾分かの規律が必要となりますが、
    このようなガイドラインを忠実に守ることにより、たいていの場合、
    すべてのブラウザで ― 新しいブラウザでも古いものでも ―
    作誓靴織據璽犬┐襪箸いΔ海箸鯤歉擇靴泙后鹿霈
箍旭
甓旭
腫ぢ参考: <a href="examples.html#serverpath">ServerPath 誓瀋衫鹿畩鹿霈
取
箍斡
甓扱
鹿硼糯鹿蔗迪

窺窺窺跫千逅闥瘰痺蒹瘤迴籖齠荻軒臼

節更
┝竢粤称瘢縉蜥瘡被齡鹿竢粤はバージョン 1.3.13 以降のみで動作します。)
d139 1
a139 2
    * の部分には明声アドレスを指定することができます。
    バージョン 1.3.12 以前では IP アドレスの指定が必要でした。</p>
@


1.1.1.3
log
@import apache 1.3.28 and mod_ssl 2.8.15
@
text
@d9 1
a9 1
  <!-- English revision: 1.21 -->
d45 3
a47 3
    実行可能なバーチャルホストの数を限定してしまうことになりました。また、
    IP アドレスの数には限りがあるということについての懸念から、レジストラ
    (ARIN, RIPE, APNIC) はバーチャルホストごとに
d50 6
a55 7
    <p>名前ベースのバーチャルホストは通常単純で、
    それぞれのホスト名とそれに対応する誓騎里アドレスを DNS
    で誓瀋蠅掘曚覆襯曠好般召魘菠冥侏茲襪茲Δ鞜竏挽墅
サーバを誓瀋蠅垢襪誓けです。さらに、名前ベースのバーチャルホストは不足する
    IP アドレスの需要を緩和します。したがって、IP
    ベースのバーチャルホストを選択すべき特定の理由がなければ名前ベースの
    バーチャルホストを使うべきです。
d71 2
a72 2
      <li>オペレーティングシステムやネットワーク装置のなかには、別の IP
      アドレス上でない場合、複数のホストを別扱いできないような
d99 1
a99 1
    <code>*</code> の属誓鮖箸辰謄機璽个里垢戮討アドレスを使います。
d105 1
a105 1
    IP アドレスはすべてサーバのネットワークインターフェースと関連付けられて
d109 6
a114 7
    href="../mod/core.html#virtualhost">&lt;VirtualHost&gt;</a>
    ブロックを作誓靴討誓さい。<code>&lt;VirtualHost&gt;</code>
    ディレクティブの引数は <code>NameVirtualHost</code>
    ディレクティブの引数と同じにしてくだ世気すなわち、IP
    アドレス一つやすべてのアドレスを表す <code>*</code>)。それぞれの
    <code>&lt;VirtualHost&gt;</code> ディレクティブの中には、最低限、
    どのホストが扱われるかを示す <a
d117 2
a118 2
    <a href="../mod/core.html#documentroot">DocumentRoot</a>
    ディレクティブを書く必要があります。</p>
d120 3
a122 12
    <p>既に存在するウェブサーバにバーチャルホストを追加する場合、
    存在するホスト用の &lt;VirtualHost&gt; ブロックを作らなければなりません。
    <code>ServerName</code> と <code>DocumentRoot</code>
    はこのバーチャルホストも含めて、それぞれグローバルな
    <code>ServerName</code> 及び <code>DocumentRoot</code>
    と同じものにするべきです。誓瀋螢侫．ぅ訝罎悩能蕕傍劼靴
このバーチャルホストは
    デフォルトのバーチャルホストとしても振る舞います。
    </p>
    <p>例えば、ドメイン <samp>www.domain.tld</samp> を運用しているところに
    バーチャルホスト <samp>www.otherdomain.tld</samp> を追加する場合で、
    両方が同じ IP アドレスを指しているとします。そのような場合は、
d152 1
a152 1
    <p><code>domain.tld</code> ドメインへのすべてのホストへのリクエストは
d154 4
a157 4
    * や ? をワイルドカード文字として使用できますが、当然ながらそれだ世韻
若閼緇嚆鴟纈令辣鹿竢粤や <code>ServerAlias</code>
    の名前や場所を構誓垢襪海箸呂任泙擦鵝泙査能蕕林ぢのホスト名と
    IP アドレスをサーバにあわせて適誓擇棒設定する事が必要です</p>
d163 1
a163 1
    href="../mod/directive-dict.html#context">コンテキスト</a> を
@


