head	1.9;
access;
symbols;
locks; strict;
comment	@# @;


1.9
date	2010.12.30.18.23.19;	author ajacoutot;	state dead;
branches;
next	1.8;

1.8
date	2009.06.29.17.19.48;	author ajacoutot;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.27.20.55.50;	author jufi;	state Exp;
branches;
next	1.6;

1.6
date	2003.01.06.22.01.41;	author jufi;	state Exp;
branches;
next	1.5;

1.5
date	2002.05.19.13.11.18;	author jufi;	state Exp;
branches;
next	1.4;

1.4
date	2002.05.18.22.54.00;	author jufi;	state Exp;
branches;
next	1.3;

1.3
date	2002.03.23.10.16.59;	author jufi;	state Exp;
branches;
next	1.2;

1.2
date	2002.03.05.07.11.35;	author jufi;	state Exp;
branches;
next	1.1;

1.1
date	2002.01.26.11.46.29;	author jufi;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Sync with Steelix CVS
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <meta http-equiv="Content-Language" content="es">
   <title>Gu&iacute;a de actualizaci&oacute;n de OpenBSD
   (versiones antiguas)</title>
</head>
<body bgcolor="#ffffff" text="#000000" link="#23238e">


<h1>Gu&iacute;a de actualizaci&oacute;n de las versiones
antiguas de OpenBSD</h1>
<h2>Versiones: desde la 2.3 hasta la 2.8</h2>

<address>
<p>
Kjell Wooding 
&lt;<a href="mailto:kjell@@openbsd.com">kjell@@openbsd.org</a>&gt; <br />
Updated:
$OpenBSD: upgrade-old.html,v 1.8 2009/06/29 17:19:48 ajacoutot Exp $
</p>
</address>

<br />

<blockquote>
<p>
Este documento contiene informaci&oacute;n para la
actualizaci&oacute;n de las versiones de OpenBSD que ya no se
mantienen de forma activa.  La informaci&oacute;n concerniente
a las versiones recientes y las instrucciones generales para
la actualizaci&oacute;n se encuentra en la
<a href="upgrade-minifaq.html">gu&iacute;a de
actualizaci&oacute;n para las versiones actuales</a>.
</p>
</blockquote>


<h2>1.0: Instrucciones generales para la
actualizaci&oacute;n del sistema</h2>

<p>
<a href="#1.1">
1.1: &iquest;D&oacute;nde se encuentra la informaci&oacute;n
sobre las versiones de OpenBSD m&aacute;s recientes?
</a>
</p>


<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.8</h2>
    
<p>
<a href="#2.8.1">
2.8.1: Nuevo grupo <em>auth</em>.
</a><br />

<a href="#2.8.2">
2.8.2: Nuevo sistema de consola <em>wscons</em>.
</a><br />

<a href="#2.8.3">
2.8.3: La compilaci&oacute;n del n&uacute;cleo falla con
errores tipo <em>Undefined symbol</em>.
</a>
</p>


<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.7</h2>

<p>
<a href="#2.7.1">
2.7.1: &iquest;Cu&aacute;les son los problemas m&aacute;s
comunes para actualizar desde la versi&oacute;n 2.7 a la 2.8?
</a>
</p>


<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.6</h2>

<p>
<a href="#2.6.1">
2.6.1: Las entradas de <tt>termcap</tt> son demasiado largas.
</a><br />

<a href="#2.6.2">
2.6.2: El n&uacute;cleo ya no reconoce el dispositivo
<em>pn</em> (o <em>mx</em>, <em>al</em>, <em>ax</em>).
</a><br />

<a href="#2.6.3">
2.6.3: Actualizaci&oacute;n de <em>gcc</em> 2.95.1 a 2.95.2.
</a><br />

<a href="#2.6.4">
2.6.4: Actualizaci&oacute;n de Kerberos.
</a><br />

<a href="#2.6.5">
2.6.5: Actualizaci&oacute;n de M4.
</a><br />

<a href="#2.6.6">
2.6.6: Actualizaci&oacute;n de Sendmail.
</a><br />

<a href="#2.6.7">
2.6.7: Despu&eacute;s de actualizar el sistema, los
n&uacute;cleos con soporte de <em>apm(8)</em> incluido no
arrancan.
</a><br />

<a href="#2.6.8">
2.6.8: Ha cambiado el grupo predeterminado del usuario <em>daemon</em>.
</a>
</p>


<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.5</h2>

<p>
<a href="#2.5.1">
2.5.1: &iquest;Cu&aacute;les son los problemas m&aacute;s
comunes para actualizar desde la versi&oacute;n 2.5 a la 2.6?
</a><br />

<a href="#2.5.2">
2.5.2: &iquest;C&oacute;mo actualizo de <em>gcc</em> a
<em>egcs</em>?
</a>
</p>

<blockquote>
<p>
<a href="#2.5.2.1">2.5.2.1 - <tt>i386</tt> y <tt>sparc</tt> ya
no usan <code>#define</code></a><br />
<a href="#2.5.2.2">2.5.2.2 - El proceso de compilaci&oacute;n
falla en <em>xlint</em>.</a><br />
<a href="#2.5.2.3">2.5.2.3 - Volcado de memoria (<em>core
dump</em>) en <code>uthread_autoinit.c</code></a><br />
<a href="#2.5.2.4">2.5.2.4 - <em>egcs</em> parece ir
m&aacute;s lento que <em>gcc</em>.</a><br />
<a href="#2.5.2.5">2.5.2.5 - <em>egcs</em> genera
c&oacute;digo de mayor tama&ntilde;o que
<em>gcc</em>.</a><br />
<a href="#2.5.2.6">2.5.2.6 - Despu&eacute;s de instalar
<em>egcs</em> queda muy poco espacio en el disco.</a><br />
<a href="#2.5.2.7">2.5.2.7 - El proceso de compilaci&oacute;n
del sistema falla al compilar <em>libcurses</em>.</a><br />
<a href="#2.5.2.8">2.5.2.8 - Fallo en <kbd>make
obj</kbd>.</a>
</p>
</blockquote>

<p>
<a href="#2.5.3">
2.5.3: <kbd>make build</kbd> falla con errores tipo
<em>unimplemented syscall</em>.
</a><br />

<a href="#2.5.4">
2.5.4: Enlace al nuevo directorio de 2.6.
</a><br />

<a href="#2.5.5">
2.5.5: Despu&eacute;s de actualizar
(<em><strong>(U)</strong>pgrade</em>), la extracci&oacute;n de
<em>base26.tar.gz</em> falla mostrando un mensaje.
</a>
</p>


<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.4</h2>

<p>
<a href="#2.4.1">
2.4.1: Cambios en las p&aacute;ginas del manual.
</a><br />

<a href="#2.4.2">
2.4.2: Cambio en la sintaxis de <em>cap_mkdb</em>.
</a><br />

<a href="#2.4.3">
2.4.3: Snake.
</a>
</p>


<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.3</h2>

<p>
<a href="#2.3.1">
2.3.1: Nuevo usuario: <em>named</em>.
</a><br />

<a href="#2.3.2">
2.3.2: El proceso de compilaci&oacute;n falla al intentar
compilar <em>ssleay</em>.
</a><br />

<a href="#2.3.3">
2.3.3: El proceso de compilaci&oacute;n falla al intentar
compilar algo para <tt>PowerPC</tt>.
</a>
</p>


&nbsp;<hr width="30%">

<a name="1.0"></a>
<h2>1.0: Instrucciones generales para la
actualizaci&oacute;n del sistema</h2>

<a name="1.1"></a>
<h3>
1.1: &iquest;D&oacute;nde puedo encontrar informaci&oacute;n
sobre las versiones de OpenBSD m&aacute;s recientes?
</h3>

<p>
En la <a href="upgrade-minifaq.html">gu&iacute;a de
actualizaci&oacute;n para las versiones actuales</a>.
</p>

<a name="2.8"></a> 
<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.8</h2>

<a name="2.8.1"></a> 
<h3>
2.8.1: Nuevo grupo <em>auth</em>
</h3>

<p>
Hay un nuevo grupo <em>auth</em>, con <tt>gid 11</tt>, en el
sistema.  Debe a&ntilde;adir una entrada como la siguiente en
el fichero <tt>/etc/group</tt>:
</p>

<pre>
  auth:*:11:
</pre>

<a name="2.8.2"></a> 
<h3>
2.8.2: Nuevo sistema de consola <em>wscons</em>
</h3>

<p>
Se ha reemplazado el controlador de consola <em>pcvt</em> con
el sistema de consola <em>wscons</em>.  Antes de usar
<em>wscons</em> deber&aacute; crear los nuevos dispositivos
relacionados con wscons.  Primero aseg&uacute;rese de tener
instalado el &uacute;ltimo MAKEDEV, y luego cree todos los
dispositivos:
</p>

<pre>
 # cp /usr/src/etc/etc.i386/MAKEDEV /dev/MAKEDEV
 # cd /dev
 # ./MAKEDEV all
</pre>

<p>
Si tiene el sistema gr&aacute;fico X, cambie la secci&oacute;n
&quot;Pointer&quot; del fichero <em>XF86Config</em> para que
contenga las siguientes entradas:
</p>

<pre>
    Protocol    &quot;wsmouse&quot;
    Device      &quot;/dev/wsmouse&quot;
</pre>

<a name="2.8.3"></a> 
<h3>
2.8.3: La compilaci&oacute;n del n&uacute;cleo falla con
errores tipo <em>Undefined symbol</em>.
</h3>

<p>
Se ha actualizado
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>.
Si compila con el viejo <em>config</em> ver&aacute; errores
como:
</p>

<pre>
  Undefined symbol `_pdevnames_size' referenced
  Undefined symbol `_pdevnames' referenced
</pre>

<p>
Para corregirlo, compile e instale el nuevo <em>config</em>:
</p>

<pre>
  # cd /usr/src/usr.sbin/config
  # make clean &amp;&amp; make depend &amp;&amp; make
  # make install
</pre>

<p>
Ahora ya puede recompilar un nuevo n&uacute;cleo del sistema.
</p>


<a name="2.7"></a>
<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.7</h2>

<a name="2.7.1"></a>
<h3>
&iquest;Cu&aacute;les son los problemas m&aacute;s comunes
para actualizar desde la versi&oacute;n 2.7 a la 2.8?
</h3>

<p>
Se ha introducido un cambio significatico en <em>gcc</em> que
facilita enormemente la generaci&oacute;n de bibliotecas de
<em>libc</em> auto-referenciadas.  Por este motivo, la
actualizaci&oacute;n debe seguir este procedimiento al pie de
la letra:
</p>

<ol>
<li><a href="upgrade-minifaq.html#1.10">Limpie lo sobrante de
su &aacute;rbol de fuentes</a> y descargue el c&oacute;digo
fuente de la versi&oacute;n 2.8.</li>

<li>
<p>
Compile e instale un nuevo enlazador.  <strong>Debe</strong>
hacerlo antes de llevar a cabo una compilaci&oacute;n completa
del compilador <em>gcc</em>:
</p>
<pre>
  $ cd /usr/src/gnu/usr.bin/ld
  $ make clean &amp;&amp; make obj &amp;&amp; make
  $ sudo make install
</pre>
</li>

<li>Compile e instale el nuevo <em>gcc</em>.  Use el
procedimiento de la rutina de arranque
(<a href="upgrade-minifaq.html#1.8">BOOTSTRAP</a>) para que el
proceso sea m&aacute;s r&aacute;pido.
</li>

<li>
<p>
Compile un nuevo n&uacute;cleo.  No lo instale todav&iacute;a:
</p>
<pre>
  $ cd /usr/src/sys/arch/`machine`/conf
  $ config GENERIC
  $ cd ../compile/GENERIC
  $ make clean &amp;&amp; make depend &amp;&amp; make
</pre>
</li>

<li>
<p>
Debido a algunos cambios en <em>libc</em>, su m&aacute;quina
puede colgarse durante el inicio a menos que el fichero
<tt>/etc/resolv.conf</tt> contenga la entrada
<em>lookup file bind</em>.  A&ntilde;&aacute;dala si no
existe:
</p>
<pre>
  # echo &quot;lookup file bind&quot; &gt;&gt; /etc/resolv.conf
</pre>
</li>

<li>
<p>
Instale un nuevo n&uacute;cleo y reinicie el sistema:
</p>
<pre>
  # cd /usr/src/sys/arch/`machine`/compile/GENERIC
  # mv /bsd /bsd.old
  # mv bsd /bsd
  # chown root.wheel /bsd
  # shutdown -r now
</pre>
<p>
(si este paso fallara puede recuperar el sistema arrancando
con el n&uacute;cleo antiguo, <em>bsd.old</em>, desde el punto
<tt>boot&gt;</tt> durante el proceso de inicio del sistema).
</p>
</li>

<li> 
<p>
Compile e instale el nuevo <em>make</em> (y los archivos de
soporte).  No se salte el paso <kbd>make depend</kbd>:
</p>
<pre>
  $ cd /usr/src/usr.bin/make
  $ make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make
  $ sudo make install
  $ cd /usr/src/share/mk
  $ sudo make install
</pre>
</li>

<li>
<p>
Instale la utilidad de asignaci&oacute;n de la
jerarqu&iacute;a de directorios, <em>mtree</em>, m&aacute;s
reciente, y aseg&uacute;rese de que est&eacute; presente la
estructura de directorios necesaria:
</p>
<pre>
  $ cd /usr/src/etc/mtree
  $ sudo install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
  $ sudo mtree -qdef /etc/mtree/
</pre>
</li>

<li>
<p>
Ejecute <kbd>make build</kbd>:
</p>
<pre>
  # cd /usr/src &amp;&amp; make build
</pre>
</li>

<li><a href="upgrade-minifaq.html#1.9">Actualice <tt>/etc</tt>
<tt>/var</tt> y <tt>/dev/MAKEDEV</tt></a> a mano.
</li>
</ol>

<a name="2.6"></a>
<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.6</h2>

<a name="2.6.1"></a>
<h3>
Las entradas de <tt>termcap</tt> son demasiado largas.
</h3>

<p>
Hay un nuevo fichero <tt>termcaps.master</tt>.  Debe regenerar
los ficheros <tt>terminfo</tt> y <tt>termcaps</tt> con la
versi&oacute;n actual de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tic&amp;sektion=1">tic(1)</a>.
Si va a llevar a cabo la actualizaci&oacute;n mediante
<kbd>make build</kbd>, deber&aacute; utilizar la
versi&oacute;n correcta de tic(1).  De lo contrario
producir&aacute; el siguiente error:
</p>

<pre>
    terminfo.src is corrupt! You need to update /usr/bin/tic
</pre>

<p>
En este caso debe recompilar e instalar tic(1)
(asegur&aacute;ndose de que utiliza la versi&oacute;n actual
de <tt>libcurses</tt>), o puede compilar la versi&oacute;n de
tic(1) desde su &aacute;rbol de fuentes.
</p>

<a name="2.6.2"></a>
<h3>
2.6.2: El n&uacute;cleo ya no reconoce el dispositivo
<em>pn</em> (o <em>mx</em>, <em>al</em>, <em>ax</em>).
</h3>

<p>
Nota:  En el texto se usa <em>pn</em> por simplicidad, pero se
debe entender <em>pn</em>, <em>mx</em>, <em>al</em>, o
<em>ax</em> seg&uacute;n sea apropiado.
</p>

<p>
Estos cuatro controladores se han reemplazado con un
controlador <em>dc</em> unificado.  Debe cambiar cualquier
menci&oacute;n de <em>pn*</em>, <em>mx</em>, <em>al</em>,
<em>ax</em> en los ficheros de configuraci&oacute;n.  Esto
incluye:
</p>

<ul>
<li>Actualizar los ficheros de configuraci&oacute;n del
n&uacute;cleo (o puede empezar con un n&uacute;cleo GENERIC
nuevo y modificarlo).</li>
<li>Cambiar el nombre al fichero <tt>/etc/hostname.pn*</tt>
por el de <tt>/etc/hostname.dc*</tt>.</li>
<li>Actualizar el fichero <tt>/etc/ifaliases</tt>.</li>
<li>Modificar los ficheros <tt>/etc/ipnat.rules</tt> y
<tt>/etc/ipf.rules</tt> para que reflejen el nuevo nombre de
la interfaz.</li>
</ul>

<p>
Si va a modificar un n&uacute;cleo personalizado, no se olvide
de incluir el dispositivo <em>dcphy</em> en su fichero de
configuraci&oacute;n del n&uacute;cleo:
</p>

<pre>
dcphy*  at mii? phy ?                   # Digital Clone PHYs
</pre>

<p>
Y de paso puede a&ntilde;adir lo siguiente:
</p>

<pre>
ukphy*  at mii? phy ?                   # &quot;unknown&quot; PHYs
</pre>

<a name="2.6.3"></a>
<h3>
2.6.3: Actualizaci&oacute;n de <em>gcc</em> 2.95.1 a 2.95.2.
</h3>

<p>
<em>gcc</em> 2.95.2 fue fusionado con el &aacute;rbol de
fuentes de OpenBSD sobre el 19 de enero de 2000.  Para que
<em>gcc</em> compile correctamente se requiere una
versi&oacute;n m&aacute;s reciente de <em>libiberty</em>
(posterior a la incluida en OpenBSD 2.6).  Para compilar esta
biblioteca, haga lo siguiente:
</p>

<pre>
	cd /usr/src/gnu/egcs/libiberty
	make -f Makefile.bsd-wrapper clean
	make -f Makefile.bsd-wrapper obj
	make -f Makefile.bsd-wrapper
	make -f Makefile.bsd-wrapper install
</pre>

<p>
NOTA:  En las plataformas basadas en la arquitectura mips,
como <tt>pmax</tt>, debe invocar <kbd>ldconfig</kbd>
despu&eacute;s de haber compilado las nuevas bibliotecas.
</p>

<p>
Una vez que haya compilado <em>libiberty</em> puede continuar
con una rutina de arranque (<em>bootstrap</em>) normal de
<em>gcc</em>:
</p>

<pre>
   cd /usr/src/gnu/egcs/gcc
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper obj
   make -f Makefile.bsd-wrapper -DBOOTSTRAP
   make -f Makefile.bsd-wrapper -DBOOTSTRAP install
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper 
   make -f Makefile.bsd-wrapper install
</pre>

<a name="2.6.4"></a>
<h3>
2.6.4: Actualizaci&oacute;n de Kerberos.
</h3>

<p>
Para que Kerberos IV compile correctamente deber&aacute;
seguir los siguientes pasos:
</p>

<ul>
<li>
<p>
Obtenga la versi&oacute;n m&aacute;s reciente de
<tt>usr.bin/compile_et</tt> y comp&iacute;lela.
</p>
<pre>
   # cd /usr/src/usr.bin/compile_et
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>

<li>
<p>
Obtenga la versi&oacute;n m&aacute;s reciente de
<tt>lib/libcom_err</tt> comp&iacute;lela.
</p>
<pre>
   # cd /usr/src/lib/libcom_err
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>

<li>
<p>
Limpie los ficheros de cabecera de Kerberos y
recomp&iacute;lelos:
</p>
<pre>
  # rm -r /usr/include/kerberosIV/*
  # cd /usr/src/kerberosIV
  # make includes
</pre>
</li>
<li>
<p>
Recompile los archivos de las bibliotecas de Kerberos:
</p>
<pre>
   # cd /usr/src/kerberosIV/lib
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>
<li>
<p>
Si no va a realizar una compilaci&oacute;n completa, recompile
Kerberos:
</p>
<pre>
   # cd /usr/src/kerberosIV
   # make cleandir &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>
<li>Si va a realizar la compilaci&oacute;n completa, vuelva a
ejecutar <kbd>make build</kbd>.</li>
</ul>


<a name="2.6.5"></a>
<h3>
2.6.5: Actualizaci&oacute;n de M4.
</h3>

<p>
La versi&oacute;n de <em>m4</em> que se incluye en OpenBSD 2.6
produce un bucle infinito al procesar los ficheros
<tt>.mc</tt> en ficheros <tt>.cf</tt>.  Debido a esto es
necesario instalar la nueva versi&oacute;n de m4
<strong>antes</strong> de invocar <kbd>make build</kbd>.  En
otras palabras:
</p>

<pre>
    # cd /usr/src/usr.bin/m4
    # make &amp;&amp; make install &amp;&amp; make cleandir
</pre>

<a name="2.6.6"></a>
<h3>
2.6.6: Actualizaci&oacute;n de Sendmail.
</h3>

<p>
En <em>sendmail 8.10.X</em>, las ubicaciones (y los nombres)
de los ficheros de configuraci&oacute;n de sendmail han
cambiado.  Ahora est&aacute; todo, excepto el fichero
<tt>pid</tt> en <tt>/etc/mail</tt>.  Tambi&eacute;n han
cambiado los nombres de varios ficheros.
</p>

<table border="0">
<tr>
  <td><strong>VIEJO</strong></td>
  <td><strong>NUEVO</strong></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.cf</tt></td>
  <td><tt>/etc/mail/sendmail.cf</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.cw</tt></td>
  <td><tt>/etc/mail/local-host-names</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.ct</tt></td>
  <td><tt>/etc/mail/trusted-users</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.oE</tt></td>
  <td><tt>/etc/mail/error-header</tt></td>
</tr>
<tr>
  <td><tt>/etc/aliases</tt></td>
  <td><tt>/etc/mail/aliases</tt></td>
</tr>
<tr>
  <td><tt>/etc/service.switch</tt></td>
  <td><tt>/etc/mail/service.switch</tt></td>
</tr>
<tr>
  <td><tt>/etc/userdb</tt></td>
  <td><tt>/etc/mail/userdb</tt></td>
</tr>
<tr>
  <td><tt>/usr/share/misc/sendmail.hf</tt></td>
  <td><tt>/etc/mail/helpfile</tt></td>
</tr>
</table>

<p>
Existen un par de m&eacute;todos para convertir los ficheros
antiguos a los nuevos, y para ambos casos el primer paso es
siempre el mismo:
</p>

<ol>
<li>Actualice <tt>/etc/rc</tt> para que busque
<tt>/etc/mail/sendmail.cf</tt> en lugar de
<tt>/etc/sendmail.cf</tt></li>
<li><tt>mv /etc/sendmail.cf /etc/mail/sendmail.cf</tt><br />
&Eacute;ste es el camino de menor resistencia, y no
tendr&aacute; que cambiar la ubicaci&oacute;n de ning&uacute;n
otro fichero.</li>
<li>O compile un nuevo fichero <tt>.cf</tt> a partir del
fichero fuente <tt>.mc</tt>.  N&oacute;tese que ya no
ser&aacute; necesario especificar la l&iacute;nea
<tt>include(`../m4/cf.m4')</tt>, ya que <em>make</em> la
habr&aacute; incluido.  N&oacute;tese tambi&eacute;n que
cuando se a&ntilde;adan m&aacute;quinas a la clase w (por
medio de &quot;Cw m&aacute;quina&quot;), ya no ser&aacute;
necesario hacerlo en la secci&oacute;n LOCAL_CONFIG
(v&eacute;ase el fichero <tt>openbsd-lists.mc</tt> como
ejemplo).</li>
</ol>

<a name="2.6.7"></a>
<h3>
2.6.7: Despu&eacute;s de actualizar el sistema, los
n&uacute;cleos con soporte incluido de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apm&amp;sektion=8&amp;arch=i386">apm(8)</a>
no arrancan.
</h3>

<p>
Debe actualizar los bloques de arranque.  En la
<a href="faq14.html#14.8">secci&oacute;n 14.8</a>
encontrar&aacute; la informaci&oacute;n pertinente.
</p>

<a name="2.6.8"></a>
<h3>
2.6.8: Ha cambiado el grupo predeterminado del usuario <em>daemon</em>
</h3>

<p>
El grupo predeterminado para el usuario <em>daemon</em> se ha cambiado
del 31 al 1.  Para que este cambio surta efecto hay que usar vipw y
modificar el fichero de contrase&ntilde;as para que sea como el
siguiente:

<p>
<tt>daemon:*:1:1::0:0:The devil himself:/root:/sbin/nologin</tt>
</p>

<a name="2.5"></a>
<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.5</h2>

<a name="2.5.1"></a>
<h3>
2.5.1: &iquest;Cu&aacute;les son los problemas m&aacute;s
comunes para actualizar desde la versi&oacute;n 2.5 a la 2.6?
</h3>

<h5><em>perl</em> y <em>make</em></h5>
<p>
La &uacute;ltima versi&oacute;n de <em>Perl</em> (5.005_03)
requiere de una nueva versi&oacute;n de <em>make</em> para
compilar correctamente.  Debe recompilar <em>make</em> antes
de compilar la nueva versi&oacute;n de <em>Perl</em>:
</p>

<pre>
# cd /usr/src/usr.bin/make
# make clean &amp;&amp; make &amp;&amp; make install
</pre>

<p>
Siga con la recompilaci&oacute;n de la nueva versi&oacute;n de
<em>Perl</em>.  Para ello tendr&aacute; que limpiar antes el
directorio <tt>obj</tt> de Perl a mano.
</p>

<p>
Los programadores en Perl deber&iacute;an tomar nota de los
&uacute;ltimos cambios.  De millert@@openbsd.org:
</p>

<pre>
La versi&oacute;n de perl en el &aacute;rbol de fuentes de OpenBSD
(post-2.5) ha sido actualizada con la 5.005_03.  El m&eacute;todo de
compilaci&oacute;n ha cambiado algo, pero en su mayor parte esto no
deber&iacute;a ser visible.  Los cambios importantes que afectan a los
usuarios son los siguientes:

1) Los ficheros lib de Perl han cambiado su ubicaci&oacute;n de
/usr/lib/perl5 a /usr/libdata/perl5, que es m&aacute;s correcto.
2) Los directorios predeterminados site_perl se encuentran ahora
en /usr/local.  O sea que si instala un m&oacute;dulo de perl, se
ubicar&aacute; a s&iacute; mismo en /usr/local/libdata/perl5/site_lib.
De este modo es m&aacute;s f&aacute;cil ver los m&oacute;dulos no regulares que hay
instalados.  Tambi&eacute;n es m&aacute;s f&aacute;cil tener m&oacute;dulos de perl
en el sistema de portes.
3) Las p&aacute;ginas del manual de las bibliotecas de perl ahora se
instalan en /usr/share/man/cat3p.  Para verlas tendr&aacute; que actualizar
man.conf de acuerdo con /src/etc/man.conf.  Esto quiere decir que
ahora puede ejecutar &quot;man 3p less&quot; y obtener informaci&oacute;n sobre el
pragma de less, pero &quot;man less&quot; le seguir&aacute; mostrando la p&aacute;gina
del manual del paginador less.

Si tiene instalados m&oacute;dulos o fichero no regulares de perl, lo
m&aacute;s sencillo es pasar /usr/lib/perl5 a /usr/libdata/perl5 y
a&ntilde;adir un enlace desde /usr/lib/perl5 a /usr/libdata/perl5.
De forma alternativa, puede editar el fichero Config.pm instalado
y corregir en &eacute;ste los caminos.

</pre>

<h5>Cambio de compilador: <em>egcs</em> sustituye a
<em>gcc</em></h5>
<p>
Seguramente, este cambio ser&aacute; el m&aacute;s
significativo que se encuentre.  Puede ver las instrucciones
detalladas en la <a href="#2.5.2">secci&oacute;n 2.5.2</a>.
</p>

<h5>Estructura del n&uacute;cleo del sistema: cambio en
<tt>statfs</tt></h5>
<p>
La estructura de <tt>statfs</tt> ha cambiado desde el 31 de
mayo.  Debe recompilar el n&uacute;cleo antes de invocar
<kbd>make build</kbd>.  Puede ver los detalles en la
<a href="#2.5.3">secci&oacute;n 2.5.3</a>.
</p>

<a name="2.5.2"></a>
<h3>
2.5.2: &iquest;C&oacute;mo actualizo de <em>gcc</em> a
<em>egcs</em>?
</h3>

<p>
La forma m&aacute;s segura es actualizarse a una
versi&oacute;n preliminar (<em>snapshot</em>) reciente, en
cuanto haya una disponble.  <strong>&iexcl;Primero busque una
versi&oacute;n preliminar!</strong>.  S&oacute;lo se
deber&iacute;a utilizar una rutina de arranque para iniciar el
nuevo compilador desde el viejo como <em>&uacute;ltimo
recurso</em>.
</p>

<p>
Antes que nada, tenga en cuenta que el uso de rutinas de
arranque (<em>bootstrapping</em>) no ha tenido &eacute;xito en
algunas plataformas.  Si tiene cuidado, deber&iacute;a
funcionar en las siguientes plataformas:
</p>

<ul>
<li><strong>i386</strong>
<li><strong>sparc</strong>
<li><strong>m68k</strong>
<li><strong>alpha</strong>
</ul>

<p>
Hay problemas en <strong>mips</strong> y
<strong>rs6000</strong>.
</p>

<p>
Para comprobar que funcionen las rutinas de arranque en una
plataforma, obtenga la versi&oacute;n preliminar de
<em>egcs</em> desde la
<a href="../../es/ports.html">colecci&oacute;n de portes</a> e
inst&aacute;lelo.  Si funciona, lo m&aacute;s seguro es que
tambi&eacute;n funcione la versi&oacute;n integrada en el
&aacute;rbol de fuentes de OpenBSD.  &Eacute;ste es el
procedimiento <em>m&aacute;s seguro</em>.
</p>

<p>
Ahora, antes de continuar, aseg&uacute;rese de que las copias
de <em>binutils</em>, <em>gas</em>, y <em>ld</em> est&eacute;n
actualizadas.  N&oacute;tese que hay dos copias de
<em>gas</em> y <em>ld</em> en el &aacute;rbol.  En
<tt>i386</tt> y <tt>sparc</tt>, no se usa <em>binutils</em>.
En su lugar se usa <tt>/usr/src/gnu/usr.bin/gas</tt> y
<tt>/usr/src/gnu/usr.bin/ld</tt>.
</p>

<p>
Las siguientes instrucciones son para la versi&oacute;n
preliminar original de <em>egcs</em> (egcs-990517).  Desde
entonces ha cambiado la versi&oacute;n preliminar
(egcs-990608) del &aacute;rbol.  Si la versi&oacute;n de la
que dispone es la 2.5, es poco probable que pueda compilar la
&uacute;ltima versi&oacute;n de forma directa.  En este caso
tendr&aacute; que usar una rutina de arranque con una
versi&oacute;n intermedia siguiendo estas intrucciones.
</p>

<p>
De espie@@openbsd.org:
</p>

<blockquote>
<pre>
Hoy cambia el compilador.

Sale gcc 2.8.1 y entra egcs ... o, para ser m&aacute;s preciso, gcc 2.95.

Esto es probable que complique las cosas de momento, pero no puedo
solucionar todas las rarezas de cada arquitectura yo solo.

Voy a empezar a importarlo *ahora*.  En cuanto est&eacute; todo
estabilizado enviar&eacute; un segundo mensaje a tech@@.

Gracias a todos los que me han ayudado con esto, y de manera muy
especial a niklas, turan y millert.

Porqu&eacute; del cambio
-----------------
Como la mayor&iacute;a ya sabr&aacute;, egcs es en este momento el compilador
*oficial* con soporte de la FSF.  La pr&oacute;xima versi&oacute;n de julio
ha sido rebautizada gcc 2.95.

Con una simple mirada a los mensajes de registro se pueden ver
muchas mejoras:  el soporte para los procesadores m&aacute;s nuevos es
mejor, C++ se aproxima mucho m&aacute;s a las especificaciones ANSI/ISO,
Fortran 77 est&aacute; mucho m&aacute;s integrado.  Tambi&eacute;n hay un sinn&uacute;mero
de errores reparados y de mejoras en la generaci&oacute;n de c&oacute;digo.

Adem&aacute;s, el modelo de desarrollo es m&aacute;s abierto.  Hay un &aacute;rbol de
cvs, hay varias listas de correo disponibles, y  estamos cooperando
con el equipo de egcs.  Para ser m&aacute;s preciso, he enviado parches al
equipo de egcs para que las opciones de configuraci&oacute;n de OpenBSD
tengan soporte oficial.  El equipo de desarrollo ha ofrecido un
alto nivel de respuesta a los informes sobre errores, y se han
solucionado problemas.

Tambi&eacute;n hay algo m&aacute;s:  todos est&aacute;n migrando a egcs, lo que significa
que hay mucho c&oacute;digo sobre el que poder probar el compilador, y que
podemos beneficiarnos de proyectos relacionados.

Porqu&eacute; ahora
------------
egcs-1.1 no serv&iacute;a para algunos prop&oacute;sitos.  En concreto, el tama&ntilde;o
del c&oacute;digo en i386 era mayor que el de gcc 2.8.1, lo que provocaba
problemas con los disquetes.  En el momento en que se congel&oacute; la
versi&oacute;n 2.5 de OpenBSD, el &uacute;nico c&oacute;digo que se ajustaba para ser
incluido en el sistema era una versi&oacute;n preliminar algo inestable.
En inter&eacute;s de la estabilidad, y despu&eacute;s de muchos intentos, egcs
no fue incluido en 2.5.

Ahora mismo, el proyecto egcs se encuentra en fase de producci&oacute;n
de egcs 1.2.  A juzgar por la marcha del proyecto, hay un amplio 
margen entre egcs 1.2 y la pr&oacute;xima versi&oacute;n oficial de OpenBSD.
Adem&aacute;s, queremos disponer ya de &eacute;l, para poder tener la oportunidad
de enviar informes sobre los problemas en las arquitecturas menos
utilizadas, y tenerlo todo solucionado para la versi&oacute;n 1.2.

La &laquo;congelaci&oacute;n del desarrollo de funcionalidades&raquo; de egcs deber&iacute;a
tener lugar el 7 de mayo, y la versi&oacute;n preliminar 19990502 ya
ofrece solidez.

Qu&eacute; funciona y qu&eacute; no
---------------------
egcs funciona sin problemas en el sistema i386 de OpenBSD.  Tambi&eacute;n
funciona en m68k, con algunos arreglos relacionados con errores
extra&ntilde;os que se solucionar&aacute;n.  Tambi&eacute;n parece funcionar en sparc.
Hay algunos problemas con el enlazador en algunas otras arquitecturas
que deben ser solucionados antes del lanzamiento de nuestra pr&oacute;xima
versi&oacute;n.

En este instante, los constructores de bibliotecas din&aacute;micas
todav&iacute;a no est&aacute;n listos.

egcs dispone ahora de un preprocesador cpp independiente que ser&aacute;
mejor que el arreglo que usamos en este momento.  Esto conllevar&aacute;
algunos cambios en la interfaz y probablemente avisos extra&ntilde;os.

&iquest;Se mantendr&aacute; gcc 2.8.1?
------------------------
Debido al espacio que ocupa, gcc pasar&aacute; al m&oacute;dulo Attic de cvs
en cuanto se importe egcs.  Si no quiere pasar todav&iacute;a a egcs,
deber&aacute; tener cuidado con las actualizaciones por cvs.
Habr&aacute; algunos cambios en los ficheros Makefile:  los include,
gnu/usr.bin, y gnu/lib.  xlint y cpp.sh tambi&eacute;n cambiar&aacute;n.

C&oacute;mo instalar el compilador mediante rutinas de arranque
--------------------------------------------------------
El modo m&aacute;s f&aacute;cil es el de confiar en los mantenedores de las
arquitecturas y obtener una versi&oacute;n preliminar.

Si quiere complicarse la vida, primero tendr&aacute; que volver a compilar
los directorios obj:
cd /usr/src
make obj

Si la plataforma es i386, se debe actualizar gas.
Si la plataforma es sparc, se debe actualizar ld.

compilar libiberty:
cd /usr/src/gnu/egcs/libiberty
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper 
make -f Makefile.bsd-wrapper install

compilar el compilador de C:
cd /usr/src/gnu/egcs/gcc
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper 
make -f Makefile.bsd-wrapper install

recompilar el compilador de C con la nueva versi&oacute;n:
cd /usr/src/gnu/egcs/gcc
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper 
make -f Makefile.bsd-wrapper install

recompilar los ficheros de inclusi&oacute;n:
cd /usr/src/include
make includes

compilar todas las bibliotecas egcs e instalarlas:
cd /usr/src/gnu/egcs
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper 
make -f Makefile.bsd-wrapper install

e instalar el nuevo controlador cpp
cd /usr/src/usr.bin/cpp
make install

y ya est&aacute; listo para una compilaci&oacute;n general que ahora
deber&iacute;a funcionar.
</pre>

<p>
[nota del autor: en realidad no funcionar&aacute; del todo, ya
que fallar&aacute; la compilaci&oacute;n de <em>xlint</em>.
Sin embargo, la  soluci&oacute;n es simple.  Cambie al
directorio <tt>/usr/src/usr.bin/xlint/xlint</tt> y ejecute
<kbd>make &amp;&amp; make install</kbd> antes de invocar
<kbd>make build</kbd>.  Luego prosiga con normalidad.  Lea la
referencia en la <a href="#2.5.2.2">secci&oacute;n
2.5.2.2</a>]
</p>

<pre>
Si no funciona, entonces es que est&aacute; usando una arquitectura
que todav&iacute;a no ha pasado por make build.  Lo m&aacute;s probable es
que ocurra un error interno del compilador, como el que se
conoce por ICE.

Primero intente ver si el ICE desaparece con -O1 &oacute; -O0.
Si es as&iacute;, puede incluir un arreglo en el fichero Makefile
hasta que se solucione (mire en el fichero
/usr/src/lib/libm/Makefile a modo de ejemplo de c&oacute;mo incluir
arreglos para m68k).

Es necesario que se informe sobre el error en la lista de
correo de egcs-bugs.

Como m&iacute;nimo, debe compilar el c&oacute;digo fuente con la misma
invocaci&oacute;n del compilador, a&ntilde;adiendo -v -save-temps a las
opciones.

La opci&oacute;n -v produce la secuencia exacta de instrucciones
invocadas por gcc.  La opci&oacute;n -save-temps le dar&aacute; un fichero
C preprocesado (.i) o uno C++ (.ii) de utilidad para los
programadores de egcs... no les puede pedir que instalen OpenBSD
en sus m&aacute;quinas.

Si dispone de m&aacute;s tiempo, puede intentar reducir el fichero
de C preprocesado hasta un m&iacute;nimo en el que evite el error.
La dicotom&iacute;a funciona bastante bien.
</pre>
</blockquote>

<p>
Si ha podido pasar este procedimiento y a&uacute;n funciona
todo, le felicitamos.  Si no es as&iacute;, busque ayuda en
las secciones siguientes.  Los problemas que no aparezcan en
el documento los puede enviar a tech@@openbsd.org.
</p>

<a name="2.5.2.1"></a>
<h5>2.5.2.1 - <tt>i386</tt> y <tt>sparc</tt> ya no usan
<code>#define</code></h5>

<p>
Es cierto, ahora <em>egcs</em> usa <code>__i386__</code> y
<code>__sparc__</code>, que es m&aacute;s limpio.  Si necesita
compilar c&oacute;digo que dependa de los viejos
<code>#define</code>, a&ntilde;ada <code>-Di386</code>
&oacute; <code>-Dsparc</code> en el sitio apropiado del
fichero <tt>Makefile</tt> correspondiente.
</p>

<a name="2.5.2.2"></a>
<h5>2.5.2.2 - El proceso de compilaci&oacute;n falla en
<em>xlint</em></h5>

<p>
Esto se debe a diferencias sem&aacute;nticas en el
preprocesador <em>cpp</em>.  La soluci&oacute;n es simple, y
parecida a la del problema con <em>cap_mkdb</em> que se
describe en la <a href="#2.4.2">secci&oacute;n 2.4.2</a>.
</p>

<p>
Compile e instale el c&oacute;digo de <em>xlint</em>
m&aacute;s reciente:
</p>

<pre>
# cd /usr/src/usr.bin/xlint/xlint
# make &amp;&amp; make install
</pre>

<p>
y a continuaci&oacute;n vuelva a compilar todo.  La
compilaci&oacute;n deber&iacute;a continuar.
</p>

<a name="2.5.2.3"></a>
<h5>2.5.2.3 - Volcado de memoria (<em>core dump</em>) en
<code>uthread_autoinit.c</code></h5>

<p>
Ha sido v&iacute;ctima de un error del enlazador.  He
aqu&iacute; un mensaje relevante:
</p>

<pre>
From: Marc Espie &lt;Marc.Espie@@liafa.jussieu.fr&gt;
Subject: egcs core-dumping on uthread_autoinit.c

Esto es un problema conocido del enlazador... cc1 est&aacute; enlazado de un
modo extra&ntilde;o.

Al principio hice que cc1 enlazara de forma est&aacute;tica con /usr/lib/libiberty 
para evitar este problema, pero era llevar las cosas muy lejos, y el error
volvi&oacute; a aparecer, probablemente por culpa de cambios en libc o en alguna
otra parte que no estaban relacionados...

Se ha parcheado el &aacute;rbol con una soluci&oacute;n en

src/gnu/egcs/f/lang-options.h

aseg&uacute;rate de tener la versi&oacute;n correcta de ese fichero (por lo menos rev 1.2),
recompila y reinstala cc1, y el problema deber&iacute;a desaparecer.

Lo que sucede es que el enlazador de 386 recibe algo extra&ntilde;o debido a la enorme
estructura de cadenas en toplev.c, y algo se desenlaza, de tal forma que
void f(void) __attribute((constructor)) {}
mata cc1.

Como soluci&oacute;n, he eliminado los textos de ayuda de las opciones de Fortran
hasta que alguien encuentre d&oacute;de se produce el error del enlazador.
</pre>

<a name="2.5.2.4"></a>
<h5>2.5.2.4 - <em>egcs</em> parece ir m&aacute;s lento que
<em>gcc</em>.</h5>

<p>
Va m&aacute;s lento, pero por un motivo.  <em>egcs</em>
realiza m&aacute;s pases de optimizaci&oacute;n.  El
alineamiento de datos y otras funcionalidades parecidas
tendr&aacute;n un mejor rendimiento con c&oacute;digo generado
por <em>egcs</em>.
</p>

<a name="2.5.2.5"></a>
<h5>2.5.2.5 - <em>egcs</em> genera c&oacute;digo de mayor
tama&ntilde;o que <em>gcc</em>.</h5>

<p>
En efecto.  Esto se nota especialmente con el viejo
interruptor <code>-O2</code> de <em>gcc</em>.  <em>egcs</em>
introduce una nueva opci&oacute;n, <code>-Os</code>, que
optimiza el espacio.  Esto es comparable de alg&uacute;n modo
al viejo comportamiento de <code>-O2</code>.
</p>

<a name="2.5.2.6"></a>
<h5>2.5.2.6 - Despu&eacute;s de instalar <em>egcs</em> queda
muy poco espacio en el disco.</h5>

<p>
<em>egcs</em> se instala en un subdirectorio diferente al de
<em>gcc</em> 2.8.1.  Debe eliminar <em>gcc</em> una vez que se
haya instalado <em>egcs</em> mediante rutina de arranque y ya
est&acute; funcionando.
</p>

<p>
Un problema relacionado es el de los cambios en <em>Perl</em>
mencionados en la <a href="#2.5.1">secci&oacute;n 2.5.1</a>,
ya que se puede eliminar el directorio
<tt>/usr/lib/perl5</tt>.  La nueva ubicaci&oacute;n para estos
datos es <tt>/usr/libdata/perl5</tt>.
</p>

<a name="2.5.2.7"></a>
<h5>2.5.2.7 - El proceso de compilaci&oacute;n del sistema
falla al compilar <em>libcurses</em>.</h5>

<p>
Ahora <em>libcurses</em> depende de la &uacute;ltima
versi&oacute;n de <em>cpp</em>.  B&aacute;jese la
&uacute;ltima versi&oacute;n de <em>cpp</em>,
recomp&iacute;lela, y contin&uacute;e:
</p>
<pre>
# cd /usr/src/usr.bin/cpp &amp;&amp; make install
</pre>

<p>
Y vuelva a invocar <kbd>make build</kbd>.
</p>

<a name="2.5.2.8"></a>
<h5>2.5.2.8 - Fallo en <kbd>make obj</kbd>.</h5>

<p>
Si falla la ejecuci&oacute;n de <kbd>make obj</kbd>, citando
errores de un fichero <tt>Makefile</tt>, es posible que los
ficheros de inclusi&oacute;n del fichero <tt>Makefile</tt>
est&eacute;n obsoletos.  Por ejemplo:
</p>

<pre>
===&gt; lib/libkvm
&quot;Makefile&quot;, line 30: Malformed conditional ((${UVM} == &quot;yes&quot;))
&quot;Makefile&quot;, line 30: Missing dependency operator
&quot;Makefile&quot;, line 32: if-less endif
&quot;Makefile&quot;, line 32: Need an operator
Fatal errors encountered -- cannot continue

</pre>

<p>
Esto se puede resolver recompilando los ficheros de
inclusi&oacute;n del <tt>Makefile</tt>:
</p>

<pre>
cd /usr/src/share/mk &amp;&amp; make install
</pre>

<p>
e intente compilar de nuevo.
</p>

<a name="2.5.3"></a>
<h3>
2.5.3: <kbd>make build</kbd> falla con errores tipo
<em>unimplemented syscall</em>.
</h3>

<p>
<strong>Respuesta corta:</strong>
</p>

<p>
La estructura <tt>statfs</tt> del n&uacute;cleo del sistema ha
cambiado.  Debe recompilar el n&uacute;cleo antes de volver a
ejecutar <kbd>make build</kbd>.
</p>

<p>
<strong>Respuesta larga:</strong>
</p>

<p>
La estructura <tt>statfs</tt> del n&uacute;cleo del sistema ha
cambiado.  La nueva <tt>struct statfs</tt> tiene las
siguientes caracter&iacute;sticas:
</p>

<ul>
<li>Tiene un campo de indicadores <tt>u_int32_t</tt>;  ahora
las dependencias indirectas pueden tener un indicador
real.</li>

<li>Usa <tt>u_int32_t</tt> en lugar de <tt>longs</tt> (mejor
en la arquitectura <tt>alpha</tt>).<br />
Nota:  la p&aacute;gina del manual sol&iacute;a mentir sobre
la configuraci&oacute;n de campos no usados o no
v&aacute;lidos con -1.  SunOS s&iacute; lo hace, pero nuestro
c&oacute;digo nunca lo ha hecho.</li>

<li>Elemina completamente <tt>f_type</tt>.  No se ha utilizado
desde NetBSD 0.9, y tenerlo ah&iacute; pero siempre 0 es
confuso.  Esto puede causar que alg&uacute;n c&oacute;digo
viejo no compile, pero eso es preferible a que se estropee sin
motivo aparente.</li>

<li>A&ntilde;ade una uni&oacute;n <tt>mount_info</tt> que
contiene la estructura <tt>FSTYPE_args</tt>.  Esto quiere
decier que ahora <em>mount</em> puede informar sobre todas las
opciones con las que se ha montado un sistema de archivos.
Esto es especialmente &uacute;til para NFS.</li>
</ul>

<p>
Otros cambios:
</p>

<ul>
<li>La emulaci&oacute;n del <code>statfs</code> de linux no
convert&iacute;a ente nombres de sistemas de archivos de BSD y
n&uacute;meros <tt>f_type</tt> de linux.  Ahora lo hace, ya
que el n&uacute;mero <tt>f_type</tt> de BSD no sirve para las
aplicaciones de linux (y de todos modos lo hemos
eliminado).</li>

<li>El <code>struct statfs</code> de FreeBSD es diferente al
nuestro (el viejo y el nuevo) y necesita conversi&oacute;n.
Anteriormente, las llamadas al sistema de OpenBSD se usaban
sin una traducci&oacute;n real.</li>

<li>ahora <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount&amp;sektion=8">mount(8)</a>
muestra informaci&oacute;n adicional cuando se invoca sin
argumentos.  Sin embargo, para verlo <em>todo</em> hay que
usar el indicador <kbd>-v</kbd> (verboso).</li>
</ul>

<a name="2.5.4"></a>
<h3>2.5.4: Enlace al nuevo directorio de 2.6.</h3>

<p>
Cuando actualice a la versi&oacute;n 2.6 tendr&aacute; que
crear un simple enlace para <em>gcc</em>.
</p>

<pre>
   cd /usr/lib/gcc-lib
   ln -s ${ARCH}-unknown-openbsd2.5 ${ARCH}-unknown-openbsd2.6
</pre>

<a name="2.5.5"></a>
<h3>2.5.5: Despu&eacute;s de actualizar
(<em><strong>(U)</strong>pgrade</em>), la extracci&oacute;n de
<em>base26.tar.gz</em> falla mostrando un mensaje.</h3>

<p>
<em>tar: Unable to remove directory ./usr/include/machine &lt;Directory
not empty&gt;
</em>
</p>

<p>
En la versi&oacute;n 2.5, <tt>/usr/include/machine</tt> era un
directorio, y <tt>/usr/include/i386</tt> un enlace a este
directorio.  En la versi&oacute;n 2.6 se ha invertido esta
situaci&oacute;n.
</p>

<p>
Para corregir el problema, salga al punto del
int&eacute;rprete, elimine el directorio
<tt>/usr/include/machine</tt>, y vuelva a intentar actualizar
el sistema.
</p>


<a name="2.4"></a>
<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.4</h2>

<a name="2.4.1"></a>
<h3>2.4.1: Cambios en las p&aacute;ginas del manual</h3>
<p>
Se han cambiado varias p&aacute;ginas del manual de la
secci&oacute;n 1 a otras secciones.  Si las p&aacute;ginas del
manual antiguas se dejan en la secci&oacute;n 1, los usuarios
que no lo sepan no ver&aacute;n la &uacute;ltima
versi&oacute;n de la p&aacute;gina.
</p>

<p>
Se deben eliminar las siguientes p&aacute;ginas del manual:
</p>
<pre>
/usr/share/man/cat1/ipf.0
/usr/share/man/cat1/ipnat.0
/usr/share/man/cat1/ipsecadm.0
</pre>

<a name="2.4.2"></a>
<h3>2.4.2: Cambio en la sintaxis de <em>cap_mkdb</em>.</h3>

<p>
<strong>Síntoma:</strong>
</p>

<p>
La ejecuci&oacute;n de <kbd>make build</kbd> produce un error
como el siguiente:
</p>

<pre>
cap_mkdb -i -f terminfo terminfo.src
cap_mkdb: illegal option -- i
usage: cap_mkdb [-v] [-f outfile] file1 [file2 ...]
*** Error code 1
</pre>

<p>
<strong>Soluci&oacute;n:</strong>
</p>

<p>
La sintaxis para invocar <em>cap_mkdb</em> ha cambiado
ligeramente.  Antes de ejecutar <kbd>make build</kbd>,
recompile <em>cap_mkdb</em> desde los fuentes m&aacute;s
recientes.
</p>

<pre>
# cd /usr/src/usr.bin/cap_mkdb
# make clean &amp;&amp; make &amp;&amp; make install
</pre>

<p>
Ahora el proceso de compilaci&oacute;n deber&iacute;a
continuar hasta completarse.
</p>

<a name="2.4.3"></a>
<h3>2.4.3: Snake</h3>
<p>
Antes de actualizar <code>/usr/src/games/snake</code> tiene
que eliminar el contenido del directorio <tt>obj</tt>.
</p>
 
<a name="2.3"></a>
<h2>C&oacute;mo actualizar desde la versi&oacute;n 2.3</h2>

<a name="2.3.1"></a>
<h3>
2.3.1: Nuevo usuario: <em>named</em>
</h3>

<p>
A partir de la versi&oacute;n 2.3, el d&aelig;mon
<em>named</em> de DNS ha cambiado a un entorno cerrado
(<em>chroot jail</em>).  Para que este cambio fuera posible,
hubo que crear el usuario <em>named</em>.  Si no lo ha hecho
todav&iacute;a, debe crear este usuario para asegurar que
todos los directorios sean creados correctamente durante el
proceso de compilaci&oacute;n del sistema.
</p>

<p>
A&ntilde;ada la siguiente entrada en <tt>/etc/passwd</tt>
usando <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
</p>

<pre>
named:*:70:70::0:0:BIND Daemon:/var/named:/sbin/nologin
</pre>

<p>
A&ntilde;ada la siguiente entrada en <tt>/etc/group</tt>:
</p>

<pre>
named:*:70:
</pre>


<a name="2.3.2"></a>
<h3>
2.3.2: La compilaci&oacute;n falla cuando intento compilar
<em>ssleay</em>.
</h3>

<p>
Es probable que falte una entrada para el usuario
<em>named</em> en el fichero de contrase&ntilde;as.
</p>

<p>
<strong>Respuesta corta:</strong>
</p>

<p>
Debe crear este usuario antes de la compilaci&oacute;n.
</p>

<p>
<strong>Respuesta larga:</strong>
</p>

<p>
El usuario <em>named</em> se requiere para configurar
correctamente los permisos.  Si falta este usuario, parte del
proceso de compilaci&oacute;n fallar&aacute;.  Si captura el
proceso de compilaci&oacute;n en un fichero (por ejemplo con
<kbd>make build &amp;&gt;/tmp/build.log</kbd>) podr&aacute;
ver el siguiente mensaje:
</p>

<pre>
(cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs)
install -d -o root -g wheel -m 755 /
mtree -def mtree/4.4BSD.dist -p // -u

mtree: unknown user named
mtree: failed at line 1632 of the specification
*** Error code 1 (ignored)
</pre>

<p>
Desafortunadamente, el proceso de compilaci&oacute;n a
continuado su camino, ignorando completamente el hecho de que
haya ocurrido un error.
</p>

<p>
Si existe el usuario <em>named</em>, <em>mtree</em>
funcionar&aacute; correctamente:
</p>

<pre>
missing: ./var/named (created)
missing: ./var/named/dev (created)
missing: ./var/named/etc (created)
missing: ./etc/afs (created)
missing: ./etc/ssl (created)
missing: ./etc/ssl/private (created)
missing: ./usr/obj (not created: File exists)
missing: ./usr/share/doc/html (created)
missing: ./usr/share/doc/html/lynx_help (created)
missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
missing: ./usr/share/doc/usd/13.viref (created)
missing: ./usr/share/man/cat4/powerpc (created)
missing: ./usr/share/man/man4/alpha (created)
missing: ./usr/share/man/man4/pmax (created)
missing: ./usr/share/man/man4/powerpc (created)
missing: ./usr/share/tmac/mdoc (created)
missing: ./var/www/htdocs/manual/vhosts (created)
missing: ./usr/include/ssl (created)
</pre>

<p>
El motivo de este fallo es que el directorio
<tt>/usr/include/ssl</tt> nunca fue creado.  Sin los ficheros
de cabecera, la compilaci&oacute;n de <em>ssleay</em>
fallar&aacute;.
</p>

<p>
<strong>Soluci&oacute;n:</strong>
</p>

<p>
Cree el usuario y grupo <em>named</em>.  Elimine
<tt>/usr/include/ssl</tt>, <tt>/var/named</tt>, y cualquier
otro directorio de la lista anterior que fuera creado como un
archivo normal por el proceso de <kbd>make build</kbd>.
</p>


<a name="2.3.3"></a>
<h3>
2.3.3: El proceso de compilaci&oacute;n falla al intentar
compilar algo para <tt>PowerPC</tt>.
</h3>

<p>
El directorio de su &aacute;rbol est&aacute; incompleto.  En
concreto, falta el directorio
<tt>/usr/share/man/cat4/powerpc</tt>.
</p>

<p>
<strong>Soluci&oacute;n r&aacute;pida:</strong>
</p>

<p>
Cree este directorio y proceda con el proceso de
compilaci&oacute;n.
</p>

<p>
<strong>Soluci&oacute;n completa:</strong>
</p>

<p>
Cree el &aacute;rbol completo del directorio:
</p>

<pre>
# cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs
</pre>

<p>
Lo m&aacute;s probable es que vea una salida como la
siguiente:
</p>

<pre>
install -d -o root -g wheel -m 755 /
mtree -def mtree/4.4BSD.dist -p // -u

missing: ./var/named (created)
missing: ./var/named/dev (created)
missing: ./var/named/etc (created)
missing: ./etc/afs (created)
missing: ./etc/ssl (created)
missing: ./etc/ssl/private (created)
missing: ./usr/obj (not created: File exists)
missing: ./usr/share/doc/html (created)
missing: ./usr/share/doc/html/lynx_help (created)
missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
missing: ./usr/share/doc/usd/13.viref (created)
missing: ./usr/share/man/cat4/powerpc (created)
missing: ./usr/share/man/man4/alpha (created)
missing: ./usr/share/man/man4/pmax (created)
missing: ./usr/share/man/man4/powerpc (created)
missing: ./usr/share/tmac/mdoc (created)
missing: ./var/www/htdocs/manual/vhosts (created)
missing: ./usr/include/ssl (created)
</pre>

<p>
F&iacute;jese en que <tt>/usr/share/man/cat4/powerpc</tt> es
uno de los directorios creados por este proceso.
</p>



<p>
--
</p>
<address>
<p>
<!--
Originally [OpenBSD: upgrade-old.html,v 1.8 2003/06/22 18:54:12 david Exp ]<br />
$Translation: upgrade-old.html,v 1.8 2009/06/29 18:34:05 ajacoutot Exp $<br />
-->
$OpenBSD: upgrade-old.html,v 1.8 2009/06/29 17:19:48 ajacoutot Exp $<br />
Copyright &copy; 1998-2003, Kjell Wooding.<br />
Env&iacute;e cualquier comentario, duda o sugerencia
(s&oacute;lo en ingl&eacute;s, por favor) a
<a href="mailto:kjell@@openbsd.org">kjell@@openbsd.org</a>
</p>
</address>
</body>
</html>
@


1.8
log
@Sync with Steelix CVS
@
text
@d21 1
a21 1
$OpenBSD: upgrade-old.html,v 1.3 2002/05/14 20:34:51 kjell Exp $
d1649 1
a1649 1
$OpenBSD$<br />
@


1.7
log
@sync with steelix translation CVS
@
text
@d1645 1
d1647 2
a1649 1
$Translation: upgrade-old.html,v 1.7 2003/06/22 21:28:33 horacio Exp $<br />
@


1.6
log
@
sync with steelix translation CVS
@
text
@d4 1
a4 1
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
d623 1
a623 1
ejecutar <kbd>make build</em>.</li>
d1645 1
a1645 1
Originally [OpenBSD: upgrade-old.html,v 1.7 2003/01/01 13:02:00 nick Exp ]<br />
d1647 1
a1647 1
$Translation: upgrade-old.html,v 1.6 2003/01/06 18:33:13 horacio Exp $<br />
a1653 1

@


1.5
log
@
sync with badlands translation CVS
@
text
@d111 4
d738 14
d1645 1
a1645 1
Originally [OpenBSD: upgrade-old.html,v 1.5 2002/05/18 20:01:53 kjell Exp ]<br />
d1647 2
a1648 2
$Translation: upgrade-old.html,v 1.5 2002/05/18 22:55:35 horacio Exp $<br />
Copyright &copy; 1998-2002, Kjell Wooding.<br />
@


1.4
log
@
sync with badlands translation CVS
@
text
@d173 1
a173 2
2.4.1: &iquest;Cu&aacute;les son los problemas m&aacute;s
comunes para actualizar desde la versi&oacute;n 2.4 a la 2.5?
d177 5
a181 2
2.4.2: El proceso de compilaci&oacute;n falla en
<code>cap_mkdb</code>.
d190 1
a190 2
2.3.1: &iquest;Cu&aacute;les son los problemas m&aacute;s
comunes para actualizar desde la versi&oacute;n 2.3 a la 2.4?
d1093 1
a1093 1
describe en la <a href="#2.4.1">secci&oacute;n 2.4.1</a>.
d1359 1
a1359 25
<h3>
2.4.1: Cu&aacute;les son los problemas m&aacute;s comunes para
actualizar desde la versi&oacute;n 2.4?
</h3>

<p>
<h3>cap_mkdb</h3>

<p>
La sintaxis utilizada para invocar <em>cap_mkdb</em> ha
cambiado ligeramente.  Antes de ejecutar <kbd>make
build</kbd>, recompile <em>cap_mkdb</em> desde el
c&oacute;digo m&aacute;s reciente:
</p>
<pre>
# cd /usr/src/usr.bin/cap_mkdb
# make clean &amp;&amp; make &amp;&amp; make install
</pre>

<p>
Ahora <kbd>make build</kbd> deber&iacute;a ejecutarse hasta
acabar de compilar.
</p>

<h3>Cambios en las p&aacute;ginas del manual</h3>
d1377 2
a1378 10
<h3>Snake</h3>
<p>
Tiene que eliminar el contenido del directorio <tt>obj</tt>
antes de actualizar el juego
<code>/usr/src/games/snake</code>.
</p>

<h3><a name="2.4.2"></a>
2.4.2: La compilaci&oacute;n falla en <em>cap_mkdb</em>.
</h3>
d1401 14
a1414 2
Debe compilar un nuevo <em>cap_mkdb</em>.  V&eacute;ase la
<a href="#2.4.1">secci&oacute;n 2.4.1</a>.
d1417 6
d1429 1
a1429 2
2.3.1: &iquest;Cu&aacute;les son los problemas m&aacute;s
comunes para actualizar desde la versi&oacute;n 2.3 a la 2.4?
a1431 2
<h4>Nuevo usuario y grupo: <em>named</em></h4>

d1627 1
a1627 1
Originally [OpenBSD: upgrade-old.html,v 1.4 2002/05/18 17:15:58 horacio Exp ]<br />
d1629 1
a1629 1
$Translation: upgrade-old.html,v 1.4 2002/05/18 18:58:58 horacio Exp $<br />
@


1.3
log
@
broken links
@
text
@d4 4
a7 5
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <meta http-equiv="Content-Language" content="es">

 <title>Gu&iacute;a de actualizaci&oacute;n de OpenBSD
 (versiones antiguas)</title>
a8 1

d14 1
a14 1
<h2>Versiones: desde la 2.3 hasta la 2.7</h2>
d21 1
a21 1
$OpenBSD: upgrade-old.html,v 1.1 2002/01/17 05:21:58 kjell Exp $
d25 1
a25 1
<br>
d29 5
a33 5
Este documento contiene la informaci&oacute;n para la
actualizaci&oacute;n de versiones de OpenBSD para las que ya
no existe soporte activo.  La informaci&oacute;n sobre las
versiones m&aacute;s recientes y las instrucciones generales
sobre actualizaci&oacute;n se encuentran en la
d35 1
a35 1
actualizaci&oacute;n</a>.
d40 2
a41 2
<h2>1.0: Instrucciones generales para la actualizaci&oacute;n
del sistema</h2>
d45 3
a47 4
1.1: &iquest;D&oacute;nde puedo encontrar informaci&oacute;n
sobre la actualizaci&oacute;n de las versiones m&aacute;s
recientes de OpenBSD?
</a><br>
a49 2
<h2>2.0: C&oacute;mo actualizar desde la versi&oacute;n
2.3</h2>
d51 2
d54 13
a66 4
<a href="#2.1">
2.1: &iquest;Cu&aacute;les son los principales problemas para
actualizar desde la versi&oacute;n 2.3 a la 2.4?
</a><br>
a67 4
<a href="#2.2">
2.2: El proceso de compilaci&oacute;n falla cuando intenta
compilar <em>ssleay</em>.
</a><br>
d69 7
a75 4
<a href="#2.3">
2.3: El proceso de compilaci&oacute;n falla cuando intenta
compilar algo para PowerPC.
</a><br>
d78 2
a79 2
<h2>3.0: C&oacute;mo actualizar desde la versi&oacute;n
2.4</h2>
d82 31
a112 4
<a href="#3.1">
3.1: &iquest;Cu&aacute;les son los principales problemas para
actualizar desde la versi&oacute;n 2.4 a la 2.5?
</a><br>
a113 5
<a href="#3.2">
3.2: El proceso de compilaci&oacute;n falla en
<code>cap_mkdb</code>.
</a><br>
</p>
d115 1
a115 2
<h2>4.0: C&oacute;mo actualizar desde la versi&oacute;n
2.5</h2>
d118 4
a121 4
<a href="#4.1">
4.1: &iquest;Cu&aacute;les son los principales problemas para
actualizar desde la versi&oacute;n 2.5 a la 2.6?
</a><br>
d123 3
a125 2
<a href="#4.2">
4.2: C&oacute;mo actualizar <em>gcc</em> a <em>egcs</em>.
d131 17
a147 16
<a href="#4.2.1">4.2.1 - i386 y sparc ya no usan
<code>#define</code></a><br>
<a href="#4.2.2">4.2.2 - La compilaci&oacute;n falla en
<em>xlint</em></a><br>
<a href="#4.2.3">4.2.3 - &laquo;Volcado de memoria&raquo;
(<em>core dump</em>) en
<code>uthread_autoinit.c</code></a><br>
<a href="#4.2.4">4.2.4 - egcs parece ir mucho m&aacute;s lento
que gcc</a><br>
<a href="#4.2.5">4.2.5 - egcs genera un c&oacute;digo de mayor
tama&ntilde;o que gcc</a><br>
<a href="#4.2.6">4.2.6 - Despu&eacute;s de instalar egcs queda
muy poco espacio en el disco</a><br>
<a href="#4.2.7">4.2.7 - El proceso de compilaci&oacute;n
falla al compilar <em>libcurses</em></a><br>
<a href="#4.2.8">4.2.8 - <kbd>make obj</kbd> falla</a>
d152 2
a153 2
<a href="#4.3">
4.3: <kbd>make build</kbd> se corta con errores tipo
d155 1
a155 1
</a><br>
d157 8
a164 8
<a href="#4.4">
4.4: Enlace al nuevo directorio de 2.6.
</a><br>

<a href="#4.5">
4.5: Despu&eacute;s de <em><strong>(U)</strong>pgrade</em>
(actualizar), la extracci&oacute;n de <em>base26.tar.gz</em>
falla mostrando un mensaje.
d169 1
a169 2
<h2>5.0: C&oacute;mo actualizar desde la versi&oacute;n
2.6</h2>
d172 4
a175 3
<a href="#5.1">
5.1: Las entradas de <em>termcap</em> son demasiado largas.
</a><br>
d177 5
a181 5
<a href="#5.2">
5.2: El n&uacute;cleo del sistema ya no reconoce los
dispositivos <em>pn</em> (or <em>mx</em>, <em>al</em>,
<em>ax</em>).
</a><br>
a182 3
<a href="#5.3">
5.3: Actualizaci&oacute;n de gcc 2.95.1 a 2.95.2.
</a><br>
d184 1
a184 3
<a href="#5.4">
5.4: Actualizaci&oacute;n de Kerberos.
</a><br>
d186 5
a190 3
<a href="#5.5">
5.5: Actualizaci&oacute;n de M4.
</a><br>
d192 4
a195 3
<a href="#5.6">
5.6: Actualizaci&oacute;n de sendmail.
</a><br>
d197 4
a200 14
<a href="#5.7">
5.7: Despu&eacute;s de actualizar, los n&uacute;cleos con
soporte para <em>apm(8)</em> incluido ya no arrancan.
</a><br>
</p>

<h2>6.0 - C&oacute;mo actualizar desde la versi&oacute;n
2.7</h2>

<p>
<a href="#6.1">
6.1: &iquest;Cu&aacute;les son los principales problemas para
actualizar desde la versi&oacute;n 2.7 a la 2.8?
</a><br>
a205 1

d207 2
a208 3
<h2>1.0: Instrucciones generales para la actualizaci&oacute;n
del sistema</h2>

d213 1
a213 2
sobre la actualizaci&oacute;n de las versiones m&aacute;s
recientes de OpenBSD?
d218 1
a218 1
actualizaci&oacute;n</a>.
d221 2
a222 3
<a name="2.0"></a>
<h2>2.0: C&oacute;mo actualizar desde la versi&oacute;n
2.3</h2>
d224 1
a224 1
<a name="2.1"></a>
d226 1
a226 2
2.1: &iquest;Cu&aacute;les son los principales problemas para
actualizar desde la versi&oacute;n 2.3 a la 2.4?
a228 2
<h4>New User: <em>named</em></h4>

d230 3
a232 8
A partir de la versi&oacute;n 2.3, el d&aelig;mon
<em>named</em> de DNS se ha cambiado a un entorno
<em>chroot</em><!-- chroot jail -->.  Para que esto fuera
posible se cre&oacute; el usuario <em>named</em>.  Si este
usuario todav&iacute;a no existe en su sistema, tendr&aacute;
que crearlo para asegurarse que todos los directorios sean
correctamente creados durante el proceso de
compilaci&oacute;n.
d235 9
d245 6
a250 2
A&ntilde;ada la siguiente entrada a <em>/etc/passwd</em>
usando <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
d254 3
a256 1
named:*:70:70::0:0:BIND Daemon:/var/named:/sbin/nologin
d260 3
a262 1
Y a&ntilde;ada lo siguiente a <em>/etc/group</em>:
d266 2
a267 1
named:*:70:
d270 1
a270 1
<a name="2.2"></a>
d272 2
a273 2
2.2: El proceso de compilaci&oacute;n falla cuando intenta
compilar <em>ssleay</em>.
d277 4
a280 2
Lo m&aacute;s probable es que falte una entrada para el el
usuario <em>named</em> en el fichero de contrase&ntilde;as.
d283 5
d289 1
a289 1
<strong>Respuesta corta:</strong>
d292 5
a296 3
<p>
Cree este usuario antes de la compilaci&oacute;n.
</p>
d299 1
a299 1
<strong>Respuesta larga:</strong>
a301 8
<p>
El usuario <em>named</em> es necesario para configurar
correctamente los permisos.  Si falta este usuario, parte del
proceso de compilaci&oacute;n fallar&aacute;.  Si tiene una
captura del proceso de compilaci&oacute;n (puede obtenerla con
<kbd>make build &amp;&gt;/tmp/build.log</em>), podr&aacute;
ver el siguiente mensaje:
</p>
d303 2
a304 4
<pre>
(cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs)
install -d -o root -g wheel -m 755 /
mtree -def mtree/4.4BSD.dist -p // -u
d306 5
a310 4
mtree: unknown user named
mtree: failed at line 1632 of the specification
*** Error code 1 (ignored)
</pre>
d313 5
a317 2
Desafortunadamente, la compilaci&oacute;n ha continuado sin
tener en cuenta que ha ocurrido un error.
d320 6
d327 3
a329 2
Si el usuario <em>named</em> existe, <em>mtree</em>
funcionar&aacute; correctamente:
a330 1

d332 3
a334 18
missing: ./var/named (created)
missing: ./var/named/dev (created)
missing: ./var/named/etc (created)
missing: ./etc/afs (created)
missing: ./etc/ssl (created)
missing: ./etc/ssl/private (created)
missing: ./usr/obj (not created: File exists)
missing: ./usr/share/doc/html (created)
missing: ./usr/share/doc/html/lynx_help (created)
missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
missing: ./usr/share/doc/usd/13.viref (created)
missing: ./usr/share/man/cat4/powerpc (created)
missing: ./usr/share/man/man4/alpha (created)
missing: ./usr/share/man/man4/pmax (created)
missing: ./usr/share/man/man4/powerpc (created)
missing: ./usr/share/tmac/mdoc (created)
missing: ./var/www/htdocs/manual/vhosts (created)
missing: ./usr/include/ssl (created)
d336 1
d338 5
a342 5
<p>
Por lo tanto, el motivo del fallo es que el directorio
<em>/usr/include/ssl</em> nunca fue creado.  Sin los ficheros
de cabecera, la compilaci&oacute;n de <em>ssleay</em> falla.
</p>
d344 1
d346 1
a346 1
<strong>Soluci&oacute;n:</strong>
d348 7
d356 1
d358 5
a362 4
Cree el usuario y grupo <em>named</em>.  Elimine
<em>/usr/include/ssl</em>, <em>/var/named</em>, y cualquier
otro directorio de la lista anterior que haya sido creado por
error como un archivo corriente por <kbd>make build</kbd>.
d364 4
d369 1
a369 7

<a name="2.3"></a>
<h3>
2.3: El proceso de compilaci&oacute;n falla cuando intenta
compilar algo para PowerPC.
</h3>

d371 1
a371 3
El &aacute;rbol del directorio est&aacute; incompleto.
M&aacute;s en concreto, falta el directorio
<em>/usr/share/man/cat4/powerpc</em>.
d373 7
a379 1

d381 3
a383 1
<strong>Soluci&oacute;n r&aacute;pida:</strong>
d385 1
d387 1
d389 2
a390 5
Cree este directorio y siga con la compilaci&oacute;n.
</p>

<p>
<strong>Soluci&oacute;n completa:</strong>
d392 8
d401 1
d403 4
a406 1
Cree el &aacute;rbol del directorio completo:
a407 1

d409 3
a411 1
# cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs
d413 1
d415 1
d417 1
a417 1
Es muy probable que vea algo como lo que sigue:
a418 1

d420 1
a420 21
install -d -o root -g wheel -m 755 /
mtree -def mtree/4.4BSD.dist -p // -u

missing: ./var/named (created)
missing: ./var/named/dev (created)
missing: ./var/named/etc (created)
missing: ./etc/afs (created)
missing: ./etc/ssl (created)
missing: ./etc/ssl/private (created)
missing: ./usr/obj (not created: File exists)
missing: ./usr/share/doc/html (created)
missing: ./usr/share/doc/html/lynx_help (created)
missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
missing: ./usr/share/doc/usd/13.viref (created)
missing: ./usr/share/man/cat4/powerpc (created)
missing: ./usr/share/man/man4/alpha (created)
missing: ./usr/share/man/man4/pmax (created)
missing: ./usr/share/man/man4/powerpc (created)
missing: ./usr/share/tmac/mdoc (created)
missing: ./var/www/htdocs/manual/vhosts (created)
missing: ./usr/include/ssl (created)
d422 1
d424 4
a427 4
<p>
N&oacute;tese que <em>/usr/share/man/cat4/powerpc</em> era uno
de los directorios creados por este proceso.
</p>
d429 2
a430 3
<a name="3.0"></a>
<h2>3.0: C&oacute;mo actualizar desde la versi&oacute;n
2.4</h2>
d432 1
a432 1
<a name="3.1"></a>
d434 1
a434 2
3.1: &iquest;Cu&aacute;les son los principales problemas para
actualizar desde la versi&oacute;n 2.4 a la 2.5?
d438 8
a445 8
<h3>cap_mkdb</h3>
</p>

<p>
La sintaxis utilizada para invocar <em>cap_mkdb</em> ha
cambiado un poco.  Antes de ejecutar <kbd>make build</kbd>,
recompile <em>cap_mkdb</em> desde el c&oacute;digo fuente
m&aacute;s reciente:
d449 1
a449 2
# cd /usr/src/usr.bin/cap_mkdb
# make clean &amp;&amp; make &amp;&amp; make install
d453 4
a456 2
Ahora el proceso de <kbd>make build</kbd> deber&iacute;a
ejecutarse hasta completarse.
d459 6
d466 3
a468 1
<h3>Cambios en la p&aacute;ginas del manual</h3>
d472 5
a476 6
Varias p&aacute;ginas del manual han pasado de la
secci&oacute;n 1 a secciones posteriores.  Si las
p&aacute;ginas antiguas se quedan en la secci&oacute;n 1, este
cambio pasar&aacute; inadvertido para los usuarios y no
ver&aacute;n la revisi&oacute;n m&aacute;s reciente de esas
p&aacute;ginas.
d479 12
d492 3
a494 1
Las siguientes p&aacute;ginas deben ser eliminadas:
d498 1
a498 3
/usr/share/man/cat1/ipf.0
/usr/share/man/cat1/ipnat.0
/usr/share/man/cat1/ipsecadm.0
d502 1
a502 1
<h3>Snake</h3>
d505 3
a507 4
<p>
Debe eliminar el contenido del directorio <em>obj</em> antes
de actualizar <code>/usr/src/games/snake</code>.
</p>
d509 4
a512 4
<h3><a name="3.2">
3.2: El proceso de compilaci&oacute;n falla en
<code>cap_mkdb</code>.
</a></h3>
d515 6
a520 6
<strong>S&iacute;ntoma:</strong>
</p>

<p>
El resultado de <kbd>make build</kbd> es un error como el
siguiente:
d524 5
a528 4
cap_mkdb -i -f terminfo terminfo.src
cap_mkdb: illegal option -- i
usage: cap_mkdb [-v] [-f outfile] file1 [file2 ...]
*** Error code 1
d532 3
a534 1
<strong>Soluci&oacute;n r&aacute;pida:</strong>
d538 3
a540 2
Debe recompilar un <em>cap_mkdb</em> nuevo (v&eacute;ase la
<a href="#3.1">secci&oacute;n 3.1</a>).
d543 10
d554 1
a554 5
<a name="4.0"></a>
<h2>4.0: C&oacute;mo actualizar desde la versi&oacute;n
2.5</h2>

<a name="4.1"></a>
d556 1
a556 2
4.1: &iquest;Cu&aacute;les son los principales problemas para
actualizar desde la versi&oacute;n 2.5 a la 2.6?
d559 4
a562 1
<h5><em>perl</em> y <em>make</em></h5>
d564 2
d567 2
a568 4
La &uacute;ltima versi&oacute;n de Perl (5.005_03) requiere
una nueva versi&oacute;n de <em>make</em> para compilar
correctamente.  Antes de compilar Perl, debe recompilar
<em>make</em>:
a569 1

d571 2
a572 2
# cd /usr/src/usr.bin/make
# make clean &amp;&amp; make &amp;&amp; make install
d574 1
d576 1
d578 2
a579 3
A continuaci&oacute;n siga con la compilaci&oacute;n del nuevo
Perl.  Para ello tendr&aacute; que limpiar a mano todo el
directorio <em>obj</em> de Perl antes de compilar.
d581 5
d587 1
d589 2
a590 2
Los programadores en Perl deber&iacute;an tomar nota de los
&uacute;ltimos cambios.  De millert@@openbsd.org:
d592 175
a766 1

d797 1
a797 1
<h5>Cambio en el compilador: <em>egcs</em> substituye a
a798 1

d800 3
a802 4
Este cambio es, probablemente, el m&aacute;s significativo de
todos los cambios que se puedan encontrar.
En la <a href="#4.2">secci&oacute;n 4.2</a> puede ver
instrucciones detalladas.
d805 2
a806 3
<h5>Cambios en la estructura <code>statfs</code> del
n&uacute;cleo del sistema</h5>

d808 4
a811 7
La estructura <code>statfs</code> ha cambiado desde el 31 de
mayo.  Debe recompilar el n&uacute;cleo (<em>kernel</em>)
antes de intentar ejecutar <kbd>make build</em>.
The <tt>statfs</tt> structure has changed as of May 31. You must
rebuild your kernel before attempting a <em>make build</em>.
M&aacute;s detalles en la <a href="#4.3">secci&oacute;n
4.3</a>.
d814 1
a814 1
<a name="4.2"></a>
d816 2
a817 1
4.2: C&oacute;mo actualizar <em>gcc</em> a <em>egcs</em>.
d821 7
a827 6
El modo m&aacute;s seguro es el de actualizar a una
versi&oacute;n preliminar (<em>snapshot</em>) reciente en
cuanto haya una disponible.  <strong>&iexcl;Busque un
<em>snapshot</em> primero!</strong>  Usar una rutina de
arranque (<em>bootstrap</em>) para el nuevo compilador desde
el viejo debe considerarse como un &uacute;ltimo recurso.
d831 4
a834 5
Antes, inf&oacute;rmese sobre qu&eacute; plataformas no han
podido usar rutinas de arranque con &eacute;xito
todav&iacute;a.  En el momento de escribir esto,
deber&iacute;a funcionar en las siguientes plataformas si
tiene cuidado:
d845 2
a846 2
<strong>mips</strong> y <strong>rs6000</strong> tienen
problemas.
d850 8
a857 6
Para verificar si funcionan las rutinas de arranque en su
plataforma, installe <em>egcs-snapshot</em>, que se encuentra
en la <a href="../../es/ports.html">colecci&oacute;n de portes</a>.
Si funciona, es muy probable que tambi&eacute;n funcione la
versi&oacute;n integrada en el &aacute;rbol de fuentes.
&Eacute;ste es el m&eacute;todo m&aacute;s seguro.
d861 7
a867 8
Antes de ir m&aacute;s lejos, aseg&uacute;rese de que todas
sus copias de <em>binutils</em>, <em>gas</em>, y <em>ld</em>
sean actuales.  N&oacute;tese que existen dos copias de
<em>gas</em> y <em>ld</em> en el &aacute;rbol.  En las
plataformas <strong>i386</strong> y <strong>sparc</strong>, no
se utilizan las versiones de <em>binutils</em>.  En lugar de
eso, compruebe <em>/usr/src/gnu/usr.bin/gas</em> y
<em>/usr/src/gnu/usr.bin/ld</em>.
d871 8
a878 9
Las siguientes instrucciones hacen referencia a la
versi&oacute;n preliminar original de egcs (egcs-990517).
Desde entonces hay una segunda versi&oacute;n preliminar
(egcs-990608) en el &aacute;rbol.  Si la versi&oacute;n 2.5
de que dispone era la versi&oacute;n final, es poco probable
que pueda compilar directamente esta versi&oacute;n.  En este
caso tendr&aacute; que usar una rutina de arranque con una
versi&oacute;n intermedia utilizando las instrucciones que
siguen a continuaci&oacute;n.
a1021 1

d1024 7
a1030 6
que fallar&aacute; la compilaci&oacute;n de xlint.  Sin
embargo la  soluci&oacute;n es simple.  Cambie al directorio
<em>/usr/src/usr.bin/xlint/xlint</em> y ejecute <kbd>make
&amp;&amp; make install</kbd> antes de ejecutar <kbd>make
build</kbd>.  Luego prosiga con normalidad.  Lea la referencia
en la <a href="#4.2.2">secci&oacute;n 4.2.2</a>]
d1064 34
a1097 29
Si ha tenido &eacute;xito con este procedimiento y todo
funciona, le felicito.  Pero si no es as&iacute;, lea las
siguientes secciones.  Los problemas que no aparezcan
aqu&iacute; deben ser enviados a tech@@openbsd.org.

<a name="4.2.1"></a>
<h5>
4.2.1 - i386 y sparc ya no usan <code>#define</code>
</h5>

<p>
En efecto, <em>egcs</em> usa <code>__i386</code>
<code>__sparc</code>, que son m&aacute;s limpios.  Si necesita
compilar c&oacute;digo que dependa de los antiguos
<code>define</code>, a&ntilde;ada <em>-Dsparc</em> o
<em>-Di386</em> en el lugar apropiado de su fichero
<em>Makefile</em>.
</p>

<a name="4.2.2"></a>
<h5>
4.2.2 - La compilaci&oacute;n falla en <em>xlint</em>
</h5>

<p>
Esto se debe a diferencias de sem&aacute;ntica en
<em>cpp</em>.  La soluci&oacute;n es simple y parecida al
problema con <code>cap_mkdb</em> descrito en la
<a href="#3.1">la secci&oacute;n 3.1</a>:
d1106 2
a1107 2
vuelva a ejecutar <kbd>make</kbd>, y la compilaci&oacute;n
debre&iacute;a continuar.
d1110 3
a1112 5
<a name="4.2.3"></a>
<h5>
4.2.3 - &laquo;Volcado de memoria&raquo; (<em>core dump</em>)
en <code>uthread_autoinit.c</code>
</h5>
d1115 2
a1116 2
Ha sido v&iacute;ctima de un error en el enlazador.  He
aqu&iacute; un mensaje al respecto:
d1123 2
a1124 2
Si le ocurre esto, es un problema consabido con el enlazador...
el cc1 que tiene ha sido enlazado de forma extra&ntilde;a.
d1126 4
a1129 4
Al principio cre&eacute; un enlace de cc1 a /usr/lib/libiberty.a,
para evitar este problema;  pero no fue suficiente y el error
volvi&oacute; a aparecer, probablemente debido a cambio sin
relaci&oacute;n alguna en libc o alguna otra parte.
d1131 1
a1131 1
En el &aacute;rbol se ha incluido una soluci&oacute;n en
d1135 2
a1136 3
Aseg&uacute;rese de tener la versi&oacute;n parcheada de ese fichero
(revisi&oacute;n 1.2 como m&iacute;nimo), recompile y reinstale cc1,
y el problema deber&iacute;a desaparecer.
d1138 4
a1141 4
Lo que sucede es que el enlazador para 386 obtiene alg&uacute;n error
debido a las enormes estructuras de cadenas de caracteres en
toplev.c, y algo se desenlaza, de tal modo que
void f(void) --attribute((constructor)) {} mata cc1.
d1143 2
a1144 3
Como soluci&oacute;n, he matado los textos de ayuda de las opciones 
de Fortran, hasta que alguien encuentre d&oacute;nde se producen los
errores del enlazador.
d1147 3
a1149 5
<a name="4.2.4"></a>
<h5>
4.2.4 - <em>egcs</em> parece ir mucho m&aacute;s lento que
<em>gcc</em>
</h5>
d1152 2
a1153 2
Es as&iacute;, pero existe una raz&oacute;n.  <em>egcs</em>
lleva a cabo m&aacute;s pases de optimizaci&oacute;n.  El
d1155 2
a1156 2
estar&aacute;n mejor con c&oacute;digo generado por
<em>egcs</em>.
d1159 15
a1173 20
<a name="4.2.5"></a>
<h5>
4.2.5 - <em>egcs</em> genera un c&oacute;digo de mayor
tama&ntilde;o que <em>gcc</em>
</h5>

<p>
Correcto.  Esto se nota mucho m&aacute;s con la antigua
opci&oacute;n <em>-O2</em> de <em>gcc</em>.  <em>egcs</em>
introduce una nueva opci&oacute;n, <em>-Os</em>, que optimiza
el espacio.  Se podr&iacute;a comparar <em>grosso modo</em>
con el comportamiento de la antigua opci&oacute;n
<em>-O2</em>.
</p>

<a name="4.2.6"></a>
<h5>
4.2.6 - Despu&eacute;s de instalar <em>egcs</em> queda muy
poco espacio en el disco
</h5>
d1177 3
a1179 2
gcc 2.8.1.  Puede eliminar <em>gcc</em> una vez que
<em>egcs</em> est&eacute; funcionando.
d1183 5
a1187 5
En relaci&oacute;n con esto, los cambios en perl que se
mencionan en la <a href="#4.1">secci&oacute;n 4.1</a> implican
que puede obtener m&aacute;s espacio eliminando el directorio
<em>/usr/lib/perl5</em>.  La nueva ubicaci&oacute;n de estos
datos es <em>/usr/libdata/perl5</em>.
d1190 3
a1192 5
<a name="4.2.7"></a>
<h5>
4.2.7 - El proceso de compilaci&oacute;n falla al compilar
<em>libcurses</em>
</h5>
d1195 1
a1195 1
Ahora, <em>libcurses</em> depende de la &uacute;ltima
d1198 1
a1198 1
recomp&iacute;lela, y contin&uacute;e.  Por ejemplo:
a1199 1

d1205 1
a1205 1
y vuelva a la ejecuci&oacute;n de <kbd>make build</kbd>.
d1208 2
a1209 4
<a name="4.2.8"></a>
<h5>
4.2.8 - <kbd>make obj</kbd> falla</a>
</h5>
d1212 4
a1215 4
Si <kbd>make obj</kbd> falla y le indica errores en un fichero
<em>Makefile</em>, es probable que los ficheros de
inclusi&oacute;n (<em>include</em>) de su <em>Makefile</em>
est&eacute;n obsoletos.  Un ejemplo de estos errores:
d1229 2
a1230 2
Esto no se puede resolver recompilando los ficheros de
inclusi&oacute;n del <em>Makefile</em>, sino:
d1238 1
a1238 1
y vuelva a intentar la compilaci&oacute;n.
d1241 1
a1241 1
<a name="4.3"></a>
d1243 1
a1243 1
4.3: <kbd>make build</kbd> se corta con errores tipo
d1247 3
a1249 1
<p><strong>Respuesta corta:</strong> </p>
d1252 3
a1254 3
La estructura <code>statfs</code> del n&uacute;cleo del
sistema ha cambiado.  Debe recompilar el n&uacute;cleo antes
de intentar ejecutar <kbd>make build</kbd>.
d1257 3
a1259 1
<p><strong>Respuesta larga:</strong> </p>
d1262 3
a1264 3
La estructura <code>statfs</code> del n&uacute;cleo del
sistema ha cambiado.  La nueva <code>struct statfs</code>
tiene las siguientes funcionalidades:
d1268 22
a1289 21
<li>Un campo de indicadores <code>u_int32_t</code>;  ahora
softdep puede tener un indicador real.</li>

<li>Usa <code>u_int32_t</code> en lugar de <code>longs</code>
(mejor en alpha).<br>
Nota: la p&aacute;gina del manual ment&iacute;a sobre la
configuraci&oacute;n de campos no v&aacute;lidos/no usados a
-1.  SunOS s&iacute; los configura, pero nuestro c&oacute;digo
nunca lo ha hecho.</li>

<li>Elimina completamente <code>f_type</code>.  No ha sido
utilizado desde NetBSD 0.9, y el tenerlo ah&iacute; pero que
siempre sea 0 es confuso.  Es normal que esto pueda hacer que
algo de c&oacute;digo antiguo no compile, pero es mejor eso a
que se caiga en silencio.</li>

<li>A&ntilde;ade una uni&oacute;n <code>mount_info</code> que
contiene la estructura <code>FSTYPE_args</code>.  Esto
significa que ahora <em>mount</em> puede indicar todas las
opciones con las que se haya montado un sistema de archivos.
Es especialmente &uacute;til para NFS.</li>
d1297 5
a1301 5
<li>La emulaci&oacute;n statfs de linux no conviert&iacute;a
entre nombres de sistemas de archivos de BSD y n&uacute;meros
<code>f_type</code> de linux.  Ahora lo hace, ya que el
n&uacute;mero <code>f_type</code> de BSD no es de utilidad
para las aplicaciones de linux (y de todos modos ha sido
d1304 9
a1312 10
<li>La estructura statfs de FreeBSD es diferente de la nuestra
(tanto la antigua como la nueva) y por lo tanto es necesaria
la conversi&aocute;n.  Anteriormente, las llamadas al sistema
de OpenBSD se usanban sin ninguna traducci&oacute;n real.
</li>

<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">mount(8)</a>
muestra ahora informaci&oacute;n adicional cuando se invoca
sin argumentos.  Sin embargo, para verlo <em>todo</em>, debe
usar el indicador <em>-v</em>.</li>
d1315 2
a1316 4
<a name="4.4"></a>
<h3>
4.4: Enlace al nuevo directorio de 2.6.
</h3>
d1319 2
a1320 2
Cuando actualice a la versi&oacute;n 2.6 deber&aacute; crear
un simple enlace para <em>gcc</em>:
d1328 4
a1331 6
<a name="4.5"></a>
<h3>
4.5: Despu&eacute;s de <em><strong>(U)</strong>pgrade</em>
(actualizar), la extracci&oacute;n de <em>base26.tar.gz</em>
falla mostrando un mensaje.
</h3>
d1334 3
a1336 2
<em>tar: Unable to remove directory ./usr/include/machine
&lt;Directory not empty&gt;</em>
d1340 4
a1343 3
En 2.5, <em>/usr/include/machine</em> era un directorio, y
<em>/usr/include/i386</em> un enlace a ese directorio.  En
2.6, esta situaci&oacute;n se ha invertido.
d1347 4
a1350 4
Para corregir el problema pase al int&eacute;rprete de
&oacute;rdenes (<em>shell</em>), elimine el directorio
<em>/usr/include/machine</em>, y vuelva a intentar la
actualizaci&oacute;n.
a1352 4
<a name="5.0"></a>
<h2>
5.0 - C&oacute;mo actualizar desde la versi&oacute;n 2.6
</h2>
d1354 4
a1357 1
<a name="5.1"></a>
d1359 2
a1360 1
5.1: Las entradas de <em>termcap</em> son demasiado largas.
d1364 7
a1370 8
Hay un nuevo fichero <em>termcaps.master</em>.  Debe regenerar
los ficheros <em>terminfo</em> y <em>termcaps</em> con la
versi&oacute;n actual de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tic&amp;apropos=0&amp;sektion=1&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">tic(1)</a>.
Si va a actualizar con <kbd>make build</kbd>, usar&aacute; la
versi&oacute;n correcta de tic(1) y los regenerar&aacute; sin
m&aacute;s.  De lo contrario, le dar&aacute; el siguiente
error:
a1371 1

d1373 2
a1374 1
    terminfo.src is corrupt! You need to update /usr/bin/tic
d1378 2
a1379 4
En este caso debe recompilar e instalar tic(1)
(asegur&aacute;ndose de que usa la versi&oacute;n actual de
<em>libcurses</em>), o compilar la versi&oacute;n de tic(1) en
su &aacute;rbol de fuentes.
d1382 8
a1389 6
<a name="5.2"></a>
<h3>
5.2: El n&uacute;cleo del sistema ya no reconoce los
dispositivos <em>pn</em> (or <em>mx</em>, <em>al</em>,
<em>ax</em>).
</h3>
d1392 1
a1392 3
Nota: <em>pn</em> se usa en este texto para simplificar.  En
realidad debe ser <em>pn</em>, <em>mx</em>, <em>al</em>, o
<em>ax</em> seg&uacute;n sea apropiado.
d1394 5
d1400 1
d1402 3
a1404 5
Estos cuatro controladores han sido substituidos por el
controlador unificado <em>dc</em>.  Debe cambiar todas las
referencias a <em>pn*</em>, <em>mx</em>, <em>al</em>, o
<em>ax</em> en los ficheros de configuraci&oacute;n.  Esto
incluye:
d1407 7
a1413 12
<ul>
<li>Actualizar el fichero (o los ficheros) de
configuraci&oacute;n del n&uacute;cleo del sistema (puede
empezar con un n&uacute;cleo GENERIC nuevo, e ir
modific&acute;ndolo).</li>
<li>Cambiar <em>/etc/hostname.pn*</em> a
<em>/etc/hostnam.dc*</em>.</li>
<li>Actualizar el fichero <em>/etc/ifaliases</em>.</li>
<li>Cambiar <em>/etc/ipnat.rules</em> y
<em>/etc/ipf.rules</em> para reflejar el nuevo nombre de la
interfaz.</li>
</ul>
d1416 2
a1417 3
Si modifica un n&uacute;cleo personailzado, aseg&uacute;rese
de que ha incluido el dispositivo <em>dcphy</em> en la
configuraci&oacute;n del n&uacute;cleo:
d1421 4
a1424 1
dcphy*  at mii? phy ?                           # PHYs cl&oacute;nicos de Digital
d1428 1
a1428 1
y de paso, tambi&eacute;n puede a&ntilde;adir:
d1431 8
a1438 3
<pre>
ukphy*  at mii? phy ?                           # PHYs desconocidos
</pre>
d1440 1
a1440 1
<a name="5.3"></a>
d1442 2
a1443 1
5.3: Actualizaci&oacute;n de gcc 2.95.1 a 2.95.2.
d1446 2
d1449 13
a1461 6
<em>gcc</em> 2.95.2 fue fusionado en el &aacute;rbol de
fuentes alrededor del 19 de enero de 2.000.  Para que
<em>gcc</em> se compile correctamente, se requiere una
versi&oacute;n de <em>libiberty</em> m&aacute;s reciente
(posterior a la incluida en 2.6).  Para compilar esta
biblioteca, haga lo siguiente:
d1464 1
a1464 5
	cd /usr/src/gnu/egcs/libiberty
	make -f Makefile.bsd-wrapper clean
	make -f Makefile.bsd-wrapper obj
	make -f Makefile.bsd-wrapper
	make -f Makefile.bsd-wrapper install
d1468 1
a1468 8
NOTA: en las arquitecturas basadas en mips, como pmax, debe
ejecutar <kbd>ldconfig</kbd> despu&eacute;s de que las
bibliotecas hayan sido compiladas e instaladas.
</p>

<p>
Una vez que <em>libiberty</em> haya sido compilada, puede
continuar con una rutina de arranque de <em>gcc</em> normal:
d1472 1
a1472 8
   cd /usr/src/gnu/egcs/gcc
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper obj
   make -f Makefile.bsd-wrapper -DBOOTSTRAP
   make -f Makefile.bsd-wrapper -DBOOTSTRAP install
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper 
   make -f Makefile.bsd-wrapper install
d1475 2
a1476 1
<a name="5.4"></a>
d1478 2
a1479 1
5.4: Actualizaci&oacute;n de Kerberos.
d1483 2
a1484 2
Para que Kerberos IV se compile correctamente, debe seguir los
siguientes pasos:
a1486 2
<ul>
<li>
d1488 1
a1488 2
Obtener y compilar la &uacute;ltima versi&oacute;n de
<code>usr.bin/compile_et</code>.
a1490 7
<pre>
   # cd /usr/src/usr.bin/compile_et
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>

<li>
d1492 1
a1492 2
Obtener y compilar la &uacute;ltima versi&oacute;n de
<code>lib/libcom_err</code>.
a1493 5
<pre>
   # cd /usr/src/lib/libcom_err
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>
a1494 1
<li>
d1496 1
a1496 1
Limpiar y reinstalar los ficheros de cabecera de Kerberos:
a1497 6
<pre>
  # rm -r /usr/include/kerberosIV/*
  # cd /usr/src/kerberosIV
  # make includes
</pre>
</li>
a1498 1
<li>
d1500 6
a1505 2
A continuaci&oacute;n, recompilar los ficheros de bibliotecas
de Kerberos:
d1507 1
d1509 7
a1515 2
   # cd /usr/src/kerberosIV/lib
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
a1516 1
</li>
a1517 1
<li>
d1519 3
a1521 2
Si no va a hacer una compilaci&oacute;n completa, recompile
Kerberos:
a1522 15
<pre>
   # cd /usr/src/kerberosIV
   # make cleandir &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>

<li>
O de otro modo, vuelva a empezar <kbd>make build</kbd>.
</li>
</ul>

<a name="5.5"></a>
<h3>
5.5: Actualizaci&oacute;n de M4.
</h3>
d1525 2
a1526 5
La versi&oacute;n de m4 incluida en OpenBSD 2.6 produce un
bucle infinito mientras procesa los ficheros <em>.mc</em> de
sendmail en ficheros <em>.cf</em>.  Por ello, debe instalar la
nueva versi&oacute;n de m4 <strong>antes</strong> iniciar
<kbd>make build</kbd>.  En otras palabras:
d1530 18
a1547 2
    # cd /usr/src/usr.bin/m4
    # make &amp;&amp; make install &amp;&amp; make cleandir
a1549 5
<a name="5.6"></a>
<h3>
5.6: Actualizaci&oacute;n de sendmail.
</h3>

d1551 4
a1554 5
La ubicaci&oacute;n (y los nombres) de los ficheros de
configuraci&oacute;n han cambiado en sendmail 8.10.X.  A
excepci&oacute;n del fichero <em>pid</em>, ahora todo se
encuentra en <em>/etc/mail</em>.  Adem&aacute;s, varios
ficheros han cambiado de nombre.
a1556 39
<table border="0">
<tr>
  <td><strong>VIEJO</strong></td>
  <td><strong>NUEVO</strong></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.cf</tt></td>
  <td><tt>/etc/mail/sendmail.cf</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.cw</tt></td>
  <td><tt>/etc/mail/local-host-names</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.ct</tt></td>
  <td><tt>/etc/mail/trusted-users</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.oE</tt></td>
  <td><tt>/etc/mail/error-header</tt></td>
</tr>
<tr>
  <td><tt>/etc/aliases</tt></td>
  <td><tt>/etc/mail/aliases</tt></td>
</tr>
<tr>
  <td><tt>/etc/service.switch</tt></td>
  <td><tt>/etc/mail/service.switch</tt></td>
</tr>
<tr>
  <td><tt>/etc/userdb</tt></td>
  <td><tt>/etc/mail/userdb</tt></td>
</tr>
<tr>
  <td><tt>/usr/share/misc/sendmail.hf</tt></td>
  <td><tt>/etc/mail/helpfile</tt></td>
</tr>
</table>

d1558 1
a1558 3
Existe un par de formas para convertir el fichero antiguo de
sendmail a uno nuevo, pero en cualquiera de los casos el
primer paso es el mismo.
a1560 31
<ol>
<li>
Actualizar <em>/etc/rc</em> para que busque
<em>/etc/mail/sendmail.cf</em> en lugar de
<em>/etc/sendmail.cf</em>
</li>
<li>
<kbd>mv /etc/sendmail.cf /etc/mail/sendmail.cf</kbd><br>
&Eacute;ste es el camino m&aacute;s f&aacute;cil, y no
tendr&aacute; que cambiar la ubicaci&oacute;n de nin&uacute;n
otro fichero.
</li>
<li>
O compile un nuevo fichero <em>.cf</em> desde el fichero
fuente <em>.mc</em>.  N&oacute;tese que ya no tendr&aacute;
que especificar la l&iacute;nea:
<pre>include(`../m4/cf.m4')</pre>, ya que la habr&aacute;
incluido <em>make</em>.  Adem&aacute;s, cuando a&ntilde;a
m&aacute;quinas a la clase w (por medio de &quot;Cw
nombre_de_m&aacute;quina&quot;), ahora debe hacerlo en la
secci&oacute;n LOCAL_CONFIG (v&eacute;ase ejemplo en
<em>openbsd-lists.mc</em>).
</li>
</ol>

<a name="5.7"></a>
<h3>
5.7: Despu&eacute;s de actualizar, los n&uacute;cleos con
soporte para <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apm&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;arch=i386&amp;format=html">apm(8)</a> incluido ya no arrancan.
</h3>

d1562 4
a1565 3
Tiene que actualizar sus bloques de arranque
(<em>bootblocks</em>).  Vea los detalles en la
<a href="faq14.html#14.8">Secci&oacute;n 14.8</a>.
d1569 1
a1569 6
<a name="6.0"></a>
<h2>
6.0 - C&oacute;mo actualizar desde la versi&oacute;n 2.7
</h2>

<a name="6.1"></a>
d1571 2
a1572 2
6.1: &iquest;Cu&aacute;les son los principales problemas para
actualizar desde la versi&oacute;n 2.7 a la 2.8?
d1576 3
a1578 5
Se ha introducido un cambio significativo en <em>gcc</em> que
facilita la generaci&oacute;n de las bibliotecas de
<em>libc</em> con auto-referencia.  Por ello, las
actualizaciones deben seguir el siguiente procedimiento con
extactitud:
a1580 9
<ol>
<li>
<a href="upgrade-minifaq.html#1.10">Limpiar lo sobrante</a> de
la &uacute;ltima compilaci&oacute;n del &aacute;rbol de
fuentes, y obtener el c&oacute;digo fuente de la
versi&oacute;n 2.8.
</li>

<li>
d1582 1
a1582 3
Compilar e instalar un nuevo enlazador.  Esto
<strong>debe</strong> hacerse antes de una compilaci&oacute;n
completa de <em>gcc</em>.
a1583 13
<pre>
  $ cd /usr/src/gnu/usr.bin/ld
  $ make clean &amp;&amp; make obj &amp;&amp; make
  $ sudo make install
</pre>
</li>

<li>
Compilar e instalar el nuevo <em>gcc</em>.  Use el
procedimiento de
<a href="upgrade-minifaq.html#1.8">rutinas de arranque
(<em>bootstrap</em>)</a> para aligerar el proceso.
</li>
a1584 1
<li>
d1586 2
a1587 2
Compilar un nuevo n&uacute;cleo.  No lo instale
todav&iacute;a.
a1588 7
<pre>
  $ cd /usr/src/sys/arch/`machine`/conf
  $ config GENERIC
  $ cd ../compile/GENERIC
  $ make clean &amp;&amp; make depend &amp;&amp; make
</pre>
</li>
a1589 1
<li>
d1591 1
a1591 4
Debido a algunos cambios en <em>libc</em>, su m&aacute;quina
se puede quedar colgada durante el arranque, a menos que
<em>/etc/resolv.conf</em> contenga la l&iacute;nea <em>lookup
file bind</em>.  A&ntilde;adala si no la tiene.
a1592 4
<pre>
  # echo &quot;lookup file bind&quot; &gt;&gt; /etc/resolv.conf
</pre>
</li>
a1593 1
<li>
d1595 1
a1595 1
Instalar el nuevo n&uacute;cleo y reiniciar.
d1597 1
d1599 1
a1599 5
  # cd /usr/src/sys/arch/`machine`/compile/GENERIC
  # mv /bsd /bsd.old
  # mv bsd /bsd
  # chown root.wheel /bsd
  # shutdown -r now
d1601 1
d1603 2
a1604 3
(si este paso fallara, puede recuperar arrancando con el
n&uacute;cleo antiguo, <em>bsd.old</em>, desde el punto de
inicio <em>boot&gt;</em>).
a1605 1
</li>
a1606 5
<li> 
<p>
Compilar e instalar el nuevo <em>make</em> (y los ficheros de
soporte).  No se salte el paso <kbd>make depend</kbd>.
</p>
d1608 2
a1609 7
  $ cd /usr/src/usr.bin/make
  $ make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make
  $ sudo make install
  $ cd /usr/src/share/mk
  $ sudo make install
</pre>
</li>
d1611 18
a1628 8
<li>
Instalar el <em>mtree</em> m&aacute;s reciente, y asegurarse
de que se est&eacute; presente la estructura de directorio
necesaria.
<pre>
  $ cd /usr/src/etc/mtree
  $ sudo install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
  $ sudo mtree -qdef /etc/mtree/
a1629 1
</li>
a1630 1
<li>
d1632 2
a1633 1
Iniciar el proceso <kbd>make build</kbd>.
a1634 4
<pre>
  # cd /usr/src &amp;&amp;; make build
</pre>
</li>
a1635 5
<li>
<a href="upgrade-minifaq.html#1.9">Actualizar <em>/etc</em>
<em>/var</em> y <em>/dev/MAKEDEV</em></a> a mano.
</li>
</ol>
a1640 1

d1643 5
a1647 5
Originally [OpenBSD: upgrade-old.html,v 1.2 2002/02/26 19:46:00 jufi Exp ]<br>
$Translation: upgrade-old.html,v 1.3 2002/03/23 09:49:47 jufi Exp $<br>
$OpenBSD$<br>
Copyright &copy; 1998-2002, Kjell Wooding.<br>
Env&iacute;e cualquier comentario, pregunta o sugerencia
@


1.2
log
@
sync with badlands translation CVS
@
text
@d623 1
a623 1
en la <a href="../ports.html">colecci&oacute;n de portes</a>.
d1583 1
a1583 1
$Translation: upgrade-old.html,v 1.2 2002/02/28 12:31:01 horacio Exp $<br>
@


1.1
log
@
sync with badlands translation CVS
@
text
@d1582 2
a1583 2
Originally [OpenBSD: upgrade-old.html,v 1.1 2002/01/17 05:21:58 kjell Exp ]<br>
$Translation: upgrade-old.html,v 1.1 2002/01/25 14:33:46 horacio Exp $<br>
@

