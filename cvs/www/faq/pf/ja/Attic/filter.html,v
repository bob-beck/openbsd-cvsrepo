head	1.17;
access;
symbols;
locks; strict;
comment	@# @;


1.17
date	2005.08.13.08.24.51;	author saad;	state dead;
branches;
next	1.16;

1.16
date	2004.05.09.09.58.22;	author saad;	state Exp;
branches;
next	1.15;

1.15
date	2004.02.25.18.31.45;	author jufi;	state Exp;
branches;
next	1.14;

1.14
date	2004.01.04.22.47.55;	author horacio;	state Exp;
branches;
next	1.13;

1.13
date	2003.12.29.22.18.26;	author horacio;	state Exp;
branches;
next	1.12;

1.12
date	2003.12.03.21.55.18;	author horacio;	state Exp;
branches;
next	1.11;

1.11
date	2003.11.10.21.40.53;	author horacio;	state Exp;
branches;
next	1.10;

1.10
date	2003.11.03.16.54.43;	author jufi;	state Exp;
branches;
next	1.9;

1.9
date	2003.09.26.13.21.47;	author horacio;	state Exp;
branches;
next	1.8;

1.8
date	2003.09.19.16.44.17;	author horacio;	state Exp;
branches;
next	1.7;

1.7
date	2003.08.16.19.32.27;	author jufi;	state Exp;
branches;
next	1.6;

1.6
date	2003.06.21.10.04.16;	author jufi;	state Exp;
branches;
next	1.5;

1.5
date	2003.06.15.12.38.56;	author jufi;	state Exp;
branches;
next	1.4;

1.4
date	2003.06.13.12.05.29;	author jufi;	state Exp;
branches;
next	1.3;

1.3
date	2003.06.12.17.22.21;	author jufi;	state Exp;
branches;
next	1.2;

1.2
date	2003.06.09.09.08.43;	author jufi;	state Exp;
branches;
next	1.1;

1.1
date	2003.06.05.13.33.00;	author jufi;	state Exp;
branches;
next	;


desc
@@


1.17
log
@remove unmaintained [ja] translation files.  requested by translator.
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Packet Filtering</title>
<link rev="made" href="mailto:www@@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-2022-jp">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2002-2004 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif">
<p>
[<a href="tables.html">前に戻る: テーブル</a>]
[<a href="index.html">目次</a>]
[<a href="nat.html">次に進む: ネットワークアドレス変換 (NAT)</a>]

<h1><font color="#e00000">PF: パケットフィルタリング</font></h1>

<hr>

<h3>目次</h3>
<ul>
<li><a href="#intro">はじめに</a>
<li><a href="#syntax">ルールのシンタクス</a>
<li><a href="#defdeny">デフォルトで拒否</a>
<li><a href="#pass">通過トラフィック</a>
<li><a href="#quick"><tt>quick</tt> キーワード</a>
<li><a href="#state">状態の保持</a>
<li><a href="#udpstate">UDP の状態の保持</a>
<li><a href="#tcpflags">TCP のフラグ</a>
<li><a href="#synproxy">TCP SYN プロキシ</a>
<li><a href="#antispoof">詐称されたパケットのブロック</a>
<li><a href="#ipopts">IP オプション</a>
<li><a href="#example">フィルタリングルールセットの例</a>
</ul>

<hr>

<a name="intro"></a>
<h2>はじめに</h2>
パケットフィルタリングとは、ネットワークインターフェイスからわたされるデータパケットを
選択的に通過させたりブロックしたりすることです。
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.4"
>pf(4)</a> がパケットを検査する場合に使用する判断基準は、レイヤ 3 
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ip&amp;sektion=4&amp;manpath=OpenBSD+3.4"
>IPv4</a> および 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ip6&amp;sektion=4&amp;manpath=OpenBSD+3.4"
>IPv6</a>) ならびにレイヤ 4
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcp&amp;sektion=4&amp;manpath=OpenBSD+3.4"
>TCP</a>、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=udp&amp;sektion=4&amp;manpath=OpenBSD+3.4"
>UDP</a>、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=icmp&amp;sektion=4&amp;manpath=OpenBSD+3.4"
>ICMP</a> および
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=icmp6&amp;sektion=4&amp;manpath=OpenBSD+3.4"
>ICMPv6</a>) のヘッダ世亡陲鼎泙后任睥匹藩僂気譴詒獣粘霆爐蓮∩気茲啻先のアドレス、
送信元および送信誓茲離檗璽函△修靴謄廛蹈肇灰襪任靴腓Α

腫フィルタルールには、パケットがマッチすべき判断基準、およびパケットがマッチした場合に
その結果として取るべき、通過かブロックかのいずれかの動作が指定されます。
フィルタルールは、誓萋號諒妨韻董∋慊蠅気譴討い觸臀派床舛気譴泙后
パケットが、<tt>quick</tt> キーワードの指定されたルールにマッチしない限りは、
最終的な動作が行われるまでに、パケットは<i>すべての</i>フィルタルールに対して
評価されることになります。最後にマッチしたルールが「勝者」であり、パケットに対して
どのような動作を取るべきかが指示されることになります。フィルタリングルールセット
の誓萋法徒曚里Δ舛情癈瘡貅ぢが指定されていると見なされるため、
パケットがどのフィルタルールにもマッチしなかった場合には、その結果として取られる
動作は<i>通過</i>となります。

<a name="syntax"></a>
<h2>ルールのシンタクス</h2>
一般的に、フィルタルールを<i>高度に単純化</i>したシンタクスは以下のとおりです。
<blockquote>
<tt>
<i>action</i> <i>direction</i> [log] [quick] on <i>interface</i> [<i>af</i>] 
[proto <i>protocol</i>] \<br>
&nbsp;&nbsp;&nbsp;from <i>src_addr</i> [port <i>src_port</i>] to 
<i>dst_addr</i> [port <i>dst_port</i>] \<br>
&nbsp;&nbsp;&nbsp;[<i>tcp_flags</i>] [<i>state</i>]
</tt>
</blockquote>

<dl>
<dt><tt><i>action</i></tt>
<dd>マッチしたパケットに対して取るべき動作は、<tt>pass</tt> か <tt>block</tt>
のいずれかです。<tt>pass</tt> がその誓茲僚萢里燭瓩縫僖吋奪箸鯆眠瓩気擦
カーネルに戻す動作であるのに対して、<tt>block</tt> は
<a href="options.html#block-policy"><tt>block-policy</tt></a> オプションの
誓瀋蠅亡陲鼎い独娠垢詁虻遒箸覆蠅泙后
デフォルトの反応は、<tt>block drop</tt> か <tt>block return</tt> の
いずれかを指定することで、こちらの方が優誓茲気譴襪茲Δ砲覆蠅泙后

寂儒守鞘蜥繝闔鹿蘊鹿寂箴インターフェイス上のパケットの移動する方向を <tt>in</tt> か <tt>out</tt>
のいずれかで指定します。

<dt><tt>log</tt>
<dd><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+3.4"
>pflogd(8)</a> 経由でパケットのログを取得世垢戮任△襪海箸鮖慊蠅靴泙后
ここで、ルールに <tt>keep state</tt>、<tt>modulate state</tt> か <tt>synproxy state</tt>
オプションが指定されている場合には、確立された状態のパケットのログのみ記録されます。
ですので、そのような状態とは無関係にすべてのパケットのログを取得世靴燭ぞ豺腓
儒跫膈瘡貅ぢを指定してくだ世気ぁ

寂儒髟蜒觴
寂箴パケットが <tt>quick</tt> の指定されたルールにマッチした場合には、そのルールは
最終的にマッチすべきルールと見なされるので、ここに指定された<tt><i>動作</i></tt>が
実行されます。

<dt><tt><i>interface</i></tt>
<dd>パケットが移動するネットワークインターフェイス名を記述します。

<dt><tt><i>af</i></tt>
<dd>パケットのアドレスファミリを指定するためのもので、IPv4 用の <tt>inet</tt> か
IPv6 用の <tt>inet6</tt> のいずれかを指定します。PF は通常は、送信元 および/または
送信誓茲離▲疋譽垢亡陲鼎い董△海離僖薀瓠璽燭魴萃蠅垢襪海箸任泙后

寂儒守情鳫竢貅昭
寂箴パケットのレイヤ 4 のプロトコルを指定します。
<ul>
<li><tt>tcp</tt>
<li><tt>udp</tt>
<li><tt>icmp</tt>
<li><tt>icmp6</tt>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=protocols&amp;sektion=5&amp;manpath=OpenBSD+3.4"
><tt>/etc/protocols</tt></a>
に記述された誓気靴ぅ廛蹈肇灰詭
殊蘊から 255 までのプロトコル番号
<li><a href="macros.html#lists">リスト</a>を使用したプロトコルの集合
</ul>

<dt><tt><i>src_addr</i></tt>, <tt><i>dst_addr</i></tt> 
<dd>IP ヘッダ醒罎料ぢ送信誓茱▲疋譽垢任后
以下のアドレスを指定することができます。
<ul>
<li>単一の IPv4 か IPv6 アドレス
<li><a href="http://public.pacbell.net/dedicated/cidr.html">CIDR</a> 
ネットワークブロック
<li>ルールセットがロードされる際に DNS
を参照して解決される FQDN。すべての結果の IP アドレスが
ルールに代入されます。
<li>ネットワークインターフェイス名。インターフェイスに割り当てられた
すべての IP アドレスがルールに代入されます。
<li><tt>/<i>netmask</i></tt> (たとえば <tt>/24</tt>) のような
ネットマスクの指定されたネットワークインターフェイス名。インターフェイスの
それぞれの IP アドレスは、ルールに代入される CIDR ネットワークブロックの形で
ネットマスクに結合されます。
<li>括弧 <tt>( )</tt> 内に指定されたネットワークインターフェイス名。これは、
PF はこの名前のインターフェイス上の IP アドレスが変更された場合に、ルールを
更新すべきことを指示します。これは、IP アドレスが DHCP 経由やダ瀬ぅ▲襯▲奪
経由でインターフェイスに割り当てられている場合に、アドレスが変更された時に
毎回ルールセットを再ロードする必要がないので便利です。
<li><tt>:network</tt> か <tt>:broadcast</tt> キーワードの指定された
ネットワークインターフェイス名。ルールセットのロードの際に、その結果の
CIDR ネットワーク (たとえば 192.168.0.0/24) やブロードキャストアドレス
(たとえば 192.168.0.255) がルールに代入されます。
<li><a href="tables.html">テーブル</a>
<li><tt>!</tt> ("否定") 修飾子を使用して意味を反転させた上記のいずれか
<li><a href="macros.html#lists">リスト</a>を使用したアドレスの集合
<li>キーワード <tt>any</tt> はすべてのアドレスを意味します。
<li>キーワード <tt>all</tt> は <tt>from any to any</tt>
の短縮形です。
</ul>

<dt><tt><i>src_port</i></tt>, <tt><i>dst_port</i></tt>
<dd>レイヤ 4 のパケットヘッダ醒罎料ぢ送信誓茱檗璽箸任后
以下のポートを指定することができます。
<ul>
<li>1 から 65535 までの番号
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=services&amp;sektion=5&amp;manpath=OpenBSD+3.4"
><tt>/etc/services</tt></a>
に記述された誓気靴ぅ機璽咼耕
殊蘊釈鱚羹痺鳫鶤蔗迪ｌ蜩⊂リスト</a>を使用したポートの集合
<li>範囲には以下の演算子が使用できます。
	<ul>
	<li><tt>!=</tt> (not equal)
	<li><tt>&lt;</tt> (less than)
	<li><tt>&gt;</tt> (greater than)
	<li><tt>&lt;=</tt> (less than or equal)
	<li><tt>&gt;=</tt> (greater than or equal)
	<li><tt>&gt;&lt;</tt> (range)
	<li><tt>&lt;&gt;</tt> (inverse range)
	</ul>
	<dl>
	<dd>最後のふたつはバイナリの演算子 (ふたつの引数を取ります) で、
	range 中には引数は含まれません。
	</dl>
</ul>

<dt><tt><i>tcp_flags</i></tt>
<dd><tt>proto tcp</tt> を使用する場合に、TCP ヘッダ世縫札奪箸気譴討い襪戮
フラグを指定します。このフラグは、<tt>flags <i>check</i>/<i>mask</i></tt>
として指定されます。たとえば、<tt>flags S/SA</tt> の場合、PF は
S と A (SYN と ACK) フラグだ世韻肪輒椶掘噎フラグが "on" の場合に
マッチするよう指示します。

<dt><tt><i>state</i></tt>
<dd>パケットがこのルールにマッチした場合に、状態の情報を保持するかどうかを
指定します。
<ul>
<li><tt>keep state</tt> - TCP、UDP および ICMP に対して有効です。
<li><tt>modulate state</tt> - TCP に対してのみ有効です。パケットが
ルールにマッチするために PF は強力な初期シーケンス番号 (ISN) を誓言成します。
<li><tt>synproxy state</tt> - 詐称された TCP SYN flood からサーバを防護するため、
着信する TCP 誓楝海離廛蹈靴鮃圓い泙后
このオプションは、<tt>keep state</tt> および <tt>modulate state</tt>
の機能を含んでいます。
</ul>
</dl>

<a name="defdeny"></a>
<h2>デフォルトで拒否</h2>
ファイアウォールを誓瀋蠅垢觝櫃里瓩諒，蓮◆屮妊侫襯箸乃馮檗廚箸い
アプローチを取ることです。それは、<i>すべてのもの</i>を拒否することであり、
確かなトラフィックだ世吋侫．ぅ▲Ε璽襪猟眠瓩鯀鯏傍弔垢襪箸いΔ發里任后
たとい間違いでも警戒するに越したことはないわけですし、またルールセットの記述が
より簡単にもなりますので、このアプローチを推奨します。

<p>
デフォルトで拒否するフィルタのポリシーを作誓垢襪砲蓮
最初のふたつのフィルタルールは以下のものでなければなりません。
<blockquote>
<tt>
block in &nbsp;all<br>
block out all
</tt>
</blockquote>

<p>
これはすべてのインターフェイス上の、どこからどこへ行くものであっても、
すべてのトラフィックを双方向ともブロックするというものです。

<a name="pass"></a>
<h2>通過トラフィック</h2>
これで、トラフィックは明声縫侫．ぅ▲Ε璽襪鯆眠瓩気擦襪▲妊侫襯箸乃馮櫃垢
ポリシーによって廃棄されるかのどちらかになりました。これは、送信元/送信誓茲離檗璽箸
送信元/送信誓茲離▲疋譽后△修靴謄廛蹈肇灰襪箸い辰織僖吋奪箸糧獣粘霆爐△海海
関係してくることを意味します。トラフィックにファイアウォールの通過を許可するときは、
常に可能な限り限定的なルールを記述すべきです。
これは、意図したトラフィック、そう、本当に意図したトラフィックだ世韻眠瓩魑気譴
ということを確実にするためなのです。

<p>
いくつかの例を以下に示します。
<blockquote>
<tt>
# dc0 上に、ローカルネットワーク 192.168.0.0/24 から OpenBSD マシンの<br>
# IP アドレス 192.168.0.1 に着信するパケットだ世韻鯆眠瓩気擦泙后泙拭錫鮠
粃から戻って行くトラフィックも同様に通過させます。<br>
pass in &nbsp;on dc0 from 192.168.0.0/24 to 192.168.0.1<br>
pass out on dc0 from 192.168.0.1 to 192.168.0.0/24<br>
<br>
<br>
# OpenBSD マシン上で実行される web サーバへの、fxp0 上の TCP の<br>
# 着信トラフィックを通過させます。パケットが OpenBSD マシン宛の<br>
# ものである場合のみこのルールにマッチするよう、インターフェイス名<br>
# fxp0 を送信誓茱▲疋譽垢箸靴道藩僂靴討い泙后錫鮠
鞜齠闔頏阡胙闕銷胯隶闥鹿鹿碎閭鞫
釈瘢綵站⊂鹿畩
取仮儒髟蜒觴ぢキーワード</h2>
上記に示したとおり、それぞれのパケットは、フィルタルールセットの誓萋號悗
評価が行われます。デフォルトでは、パケットは通過するよう誓瀋蠅気譴討い泙垢
これはフィルタルールの最後までなら、各種ルールによって変更することもできますし、
何度でも変更することができます。そして、<b>最後にマッチしたルールが採用されます</b>。
しかし、これには例外があり、フィルタリングルール上に <tt>quick</tt> 
オプションが指定されている場合、それ以降のルールの処理を無効化する効果を持ち、
指定されたとおりの動作が取られることになります。
以下のひと組の例を見てみましょう。

<p>
良くない例:
<blockquote>
<tt>
block in on fxp0 proto tcp from any to any port ssh<br>
pass &nbsp;in all
</tt>
</blockquote>

<p>
この例では、この <tt>block</tt> 行は評価されるかも知れませんが、
その次に、何でも通過させてしまう行があるため、
何の効果も持ちません。

<p>
良い例:
<blockquote>
<tt>
block in quick on fxp0 proto tcp from any to any port ssh<br>
pass &nbsp;in all
</tt>
</blockquote>

<p>
これらのルールの場合、少し異なる評価が行われます。<tt>block</tt>
行にマッチすると、<tt>quick</tt> オプションが指定されているため、
パケットはブロックされ、残りのルールセットは無視されます。

<a name="state"></a>
<h2>状態の保持</h2>
パケットフィルタの重要な機能のひとつに「状態の保持」あるいは
「状態を持つ検査」があります。状態を持つ検査は、ネットワーク誓楝海両屬
進行状況を追誓廚垢襪燭瓩の能力に属するものです。それぞれの誓楝海砲弔い討
情報を状態テーブルに保存することによって、PF は迅速にファイアウォールを
通過しようとしているパケットが既に確立された誓楝海紡阿垢襪發里匹Δ
決定することができます。もしそうなら、ルールセットの評価が行われることなしに
ファイアウォールを通過することができます。

<p>
状態の保持は、より簡単なルールセットやより良いフィルタリング誓修覆鼻
多くの優位誓鮖辰討い泙后估ぢは状態テーブルのエントリと移動するパケットとを
<i>双方向</i>ともマッチさせることができますが、これは帰りのトラフィックを
通過させるためのフィルタルールを記述する必要がないことを意味しています。
そして、状態を持つ誓楝海縫僖吋奪箸泪奪舛垢襪肇襦璽襯札奪箸鯢床舛垢
必要がないので、PF がこれらのパケットの処理に要する時間を大幅に
減少させることができます。

<p>
ルールが <tt>keep state</tt> オプションを持つ場合、ルールにマッチする
最初のパケットは、送信者と受信者との間の「状態」を誓言成することになります。
今、送信者から受信者に送出されるパケットは状態エントリにマッチし、ルールセット
の評価をバイパスするだ世韻任覆⊆埖Δ藾埖Δ冒衒屬気譴
応答パケットも同様のことが行われます。これはたとえば、以下の例のような行です。
<blockquote>
<tt>
pass out on fxp0 proto tcp from any to any keep state
</tt>
</blockquote>

<p>
これは、<tt>fxp0</tt> インターフェイスから送出されるすべての TCP トラフィックを
通過させ、応答のトラフィックがファイアウォールを通過するのを許可しています。
状態の保持はすばらしい機能であり、状態テーブルの参照は、
パケットとフィルタルールを評価していくのに比べて劇的に高速ですので、
この機能を使用することで、ファイアウォールの誓修鮹靴韻靴泙后

腫儒迴糒赱鹿オプションは、それが TCP にのみ適用可能であることを除いて、
<tt>keep state</tt> と同様に機能します。
<tt>modulate state</tt> の場合、送出される誓楝海僚藉掘璽吋鵐紅峭
嗄侮蜚蛛嚆髟緕竇矼鬧ぢがランダ瀬牴修気譴泙后海譴蓮瓶を選択する際に、
単純に決定してしまうようなある種のオペレーティングシステムから開始した誓楝海
保護する上で役に立つ機能です。

<p>
送出される TCP、UDP および ICMP パケットの状態の保持、ならびに変調された TCP の ISN を指定するには、以下の例のようにします。
<blockquote>
<tt>
pass out on fxp0 proto tcp from any to any modulate state<br>
pass out on fxp0 proto { udp, icmp } from any to any keep state
</tt>
</blockquote>

<p>
状態を保持することのもうひとつの優位誓蓮慙△垢値トラフィックが
ファイアウォールを通過することができるということです。たとえば、TCP 誓楝海
儒諷辮鹿が指定されている場合、ICMP 始点斥淦制メッセージが
この TCP 誓楝海療紊鮖仮箸靴泙垢△海譴賄切な状態エントリにマッチするので
ファイアウォールを通過することができます。

<p>
状態を持つ誓楝海蓮△修寮接続が誓言成されたインターフェイス上に誓造気譴襪箸いΔ海箸蓮
注意すべき重要事項です。このことは、PF を実行するルータやファイアウォールでは
特に重要なことであり、特に「デフォルトで拒否」のポリシーが上記の概要のとおり
実装されている場合にはなおさらです。もし、ファイアウォールが外部インターフェイス上の
すべての送出誓楝海両屬鯤飮靴討い訃豺隋△海譴蕕離僖吋奪箸呂笋呂衞誓示的に
内部インターフェイスにわたすべきでしょう。

<p>
<a href="nat.html"><tt>nat</tt></a>、
<a href="nat.html#binat"><tt>binat</tt></a>、および
<a href="rdr.html"><tt>rdr</tt></a> ルールは、マッチした誓楝海
フィルタのルールセットにわたされる限り、暗黙のうちにその誓楝海
状態を誓言成するということに注意してくだ世気ぁ

釈瘢綵♭粽齡癆紜昭取仮嫩の状態の保持</h2>
「UDP は状態を持たないプロトコルだ世蕁嫩の状態を誓言成することはできない」
ということをときどき耳にすることがあるのではないでしょうか。確かに、UDP 誓楝海
セッションは、(明声閉命粒呂篏擦覆匹状態ということについて、
いかなるコンセプトも持ち合わせてはいませんが、このことは PF の UDP セッションに
対する状態の誓言成能力には何ら影響はありません。「開始」や「終了」パケットのない
プロトコルの場合、PF はマッチしたパケットが通過してから、どれくらいの時間の
経過があったかということの追誓弖覯未鮹噂磴吠飮靴討い泙后發掘△修譴
タイムアウトすれば状態は消去されます。このタイムアウト値は、
<tt>pf.conf</tt> ファイルの <a href="options.html">オプション</a>
の部分で誓瀋蠅垢襪海箸任泙后

釈瘢綵♯竦肚瘍鵞昭取仮埣のフラグ</h2>
TCP パケットのフラグに基づくマッチングは、新しい誓楝海魍呂靴茲Δ箸垢
埣パケットのフィルタリングを行うためにかなり頻繁に使用されます。
TCP のフラグとその意味を以下にリストします。
<ul>
<li><b>F</b> : FIN  - 終了 (Finish): セッション終了
<li><b>S</b> : SYN  - 同期 (Synchronize): セッション開始要求を示す
<li><b>R</b> : RST  - リセット (Reset): 誓楝海鮴切断する
<li><b>P</b> : PUSH - プッシュ (Push): パケットを直ちに送出する要求を示す
<li><b>A</b> : ACK  - 肯定応答 (Acknowledgement)
<li><b>U</b> : URG  - 緊急 (Urgent)
<li><b>E</b> : ECE  - 明声寫堋銘里離┘魁祷韭蜒蜚闔艱齡蜿麗肅竅闔竏鍠
殊蘊錫衝鹿眈徠輻輳ウィンドウの減少通知 (Congestion Window Reduced)
</ul>

<p>
ルールの評価中に TCP のフラグを PF に検査させるためには、
<tt>flags</tt> キーワードを以下のシンタクスで使用します。
<blockquote>
<tt>
flags <i>check</i>/<i>mask</i>
</tt>
</blockquote>

<p>
<tt><i>mask</i></tt> 部は指定されたフラグのみ検査することを PF に指示し、
<tt><i>check</i></tt> 部に指定されたフラグは、マッチしたパケットの
ヘッダ醒罎離侫薀阿闔に違いないことをチェックするよう指示します。
<blockquote>
<tt>
pass in on fxp0 proto tcp from any to any port ssh flags S/SA
</tt>
</blockquote>

<p>
上記のルールは、SYN ならびに ACK フラグだ世韻肪輒椶靴討い襪里如
噎フラグのセットされた TCP トラフィックを通過させます。また、
SYN と ECE フラグのセットされたパケットは、やはり上記のルールに
マッチしますが、SYN と ACK か ACK だ世韻離僖吋奪箸魯泪奪舛靴泙擦鵝

腫注: 以前のバージョンの OpenBSD では、
以下のシンタクスがサポートされていました。
<blockquote>
<tt>
. . . flags S
</tt>
</blockquote>

<p>
現在ではもはやこれは有効ではありません。マスクは<i>常に</i>指定されている必要があります。

<p>
状態エントリの誓言成の誓罎鮃圓い笋垢垢襪燭瓩法▲侫薀阿
儒諷辮鹿ルールと関連してしばしば使用されます。
<blockquote>
<tt>
pass out on fxp0 proto tcp all flags S/SA keep state
</tt>
</blockquote>

<p>
これは、SYN、ACK フラグのうちの SYN フラグだ世韻札奪箸気譴
すべての送出 TCP パケットのための状態の誓言成を許可します。

<p>
フラグの使用には注意が必要です。なぜ、何をしようとしているのか理解すべきですし、
それは間違っているなどの、人びとのアドバイスにも耳を傾けるべきです。ある人たちは、
「他のものは除いて SYN フラグがセットされたものだ世院廚両屬鮴生誓垢襪茲
示唆しています。そのようなルールは以下のような最後になっていたりします。
<pre>
     . . . flags S/FSRPAUEW          <i>あまり良くない考えです !!</i>
</pre>

<p>
その理屈は、TCP セッションの開始時点世里濔屬鮴生誓垢戮任△蝓
セッションは他のフラグのない、SYN フラグで始まるべきである、
ということなのです。問題は、ECN フラグを使用し始めたいくつかのサイトで、
誓楝海鮖遒澆討知ぢの使用サイトはすべてこのようなルールによって
拒誓笋気譴襪任靴腓Α茲衫匹せ愎砲楼焚爾里茲Δ覆發里任后
錫跫站髟阡緇
儒
肚瘍哢啻寅
鹿鹿碎閭鞫
腫これは実誓鐡念汰瓦覆發里任呂△蠅泙垢△海離肇薀侫奪
釈鱚羹‰竰譬ぢスクラブ (scrub) 済</a>のものであった場合には、
不要なチェックでもあります。スクラブの処理では、(SYN と  FIN や SYN と RST
のような) 誓気靴覆弛ぢフラグの組み合わせを持つすべての着信パケットを
PF は廃棄します。これは、以下のような <tt>scrub</tt> による着信パケットの場合、
常に強く推奨されるものです。
<blockquote>
<tt>
scrub in on fxp0<br>
.<br>
.<br>
.<br>
pass in on fxp0 proto tcp from any to any port ssh flags S/SA \<br>
&nbsp;&nbsp;&nbsp;keep state
</tt>
</blockquote>

<a name="synproxy"></a>
<h2>TCP SYN プロキシ</h2>
<p>
通常、クライアントがサーバに対して TCP 誓楝海鮃圓Δ箸垢訃豺隋
估ぢはこれら 2 点栖屬
釈鱚羹∵雕蜴續籬纃闔闕闥蛛踈銓纈鈬隴竢銕繝闔鶤蔗迪ぢハンドシェイク</a>パケットが到着するよう、通過させます。
しかし、PF には、このハンドシェイクのプロキシを行う能力があります。
このハンドシェイクのプロキシが行われると、PF 自身がクライアントと完全な
ハンドシェイクを行い、PF がサーバに対してハンドシェイクを行おうとします。
その上で、これら 2 点栖屬離僖吋奪箸鯆眠瓩気擦泙后
このプロセスの利点世蓮▲薀ぅ▲鵐箸魯鵐疋轡Дぅ魎偉擦気擦襪泙如
サーバに対して一誓擇離僖吋奪箸鯀靴覆い海箸任后
詐称されたクライアントの誓楝海魯魯鵐疋轡Дぅ魎偉擦垢襪海箸任覆い里如
これによって、サーバに影響を及ぼす、詐称された TCP SYN flood の脅威を
取り除くことができます。

<p>
TCP SYN プロキシは、以下の例のように、フィルタルール中で <tt>synproxy state</tt>
キーワードを使用することによって有効化することができます。

<blockquote>
<tt>
pass in on $ext_if proto tcp from any to $web_server port www \<br>
&nbsp;&nbsp;&nbsp;flags S/SA synproxy state
</tt>
</blockquote>

<p>
これで、web サーバへの誓楝海蓮估ぢにより TCP のプロキシが行われるようになります。

<p>
<tt>synproxy state</tt> は、その動作原理から <tt>keep state</tt> および
<tt>modulate state</tt> の機能も含んでいます。

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bridge&amp;sektion=4&amp;manpath=OpenBSD+3.4"
>bridge(4)</a>
上で PF が動作している場合には SYN プロキシは動作しません。

<a name="antispoof"></a>
<h2>詐称されたパケットのブロック</h2>
アドレスの「詐称」とは、悪意のあるユーザが、自身の本当のアドレスを隠すためか、
あるいはネットワーク上の他のノードになりすますため、送信されるパケットの中の
発信元の IP アドレスを偽装することです。そのユーザが、いったんアドレスを詐称
できてしまうと、攻撃の際に本当のアドレスを曝すことなくネットワーク攻撃を仕掛けたり、
ある IP アドレスだ世韻妨堕蠅靴討い襯優奪肇錙璽機璽咼垢悗離▲札晃△鮗蠅貌譴
ための試みを行えたりします。

<p>
PF は、以下のような <tt>antispoof</tt> キーワードを使用した、
いくつかのアドレス詐称に対する防御機能を提供しています。

<blockquote>
<tt>
antispoof [log] [quick] for <i>interface</i> [<i>af</i>]
</tt>
</blockquote>

<dl>
<dt><tt>log</tt>
<dd>マッチしたパケットのログを
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+3.4"
>pflogd(8)</a> を通じて取得世垢襪茲慊蠅靴泙后

寂儒髟蜒觴
寂箴パケットがこのルールにマッチした場合には、それを「勝者」のルールと見なし、
ルールセットの評価をここまでで終了します。

<dt><tt><i>interface</i></tt>
<dd>詐称防御機能を有効にするネットワークインターフェイスを指定します。これはまた、
インターフェイスの<a href="macros.html#lists">リスト</a>でも構いません。

<dt><tt><i>af</i></tt>
<dd>詐称防御機能を有効にするアドレスファミリとして、IPv4 用の <tt>inet</tt>
か、IPv6 用の <tt>inet6</tt> のいずれかを指定します。
</dl>

<p>
例:
<blockquote>
<tt>
antispoof for fxp0 inet
</tt>
</blockquote>

<p>
ルールセットがロードされると、指定されている <tt>antispoof</tt> キーワードはすべて、
ふたつのフィルタルールに展開されます。インターフェイス <tt>fxp0</tt> が IP
アドレスとして 10.0.0.1 を持ち、サブネットマスクとして 255.255.255.0 (つまり /24)
を持つものとすると、上記の <tt>antispoof</tt> ルールは以下のように展開されます。

<blockquote>
<tt>
block in on ! fxp0 inet from 10.0.0.0/24 to any<br>
block in inet from 10.0.0.1 to any
</tt>
</blockquote>

<p>
これらのルールにより、以下のようなふたつのことができるようになります。
<ul>
<li><tt>fxp0</tt> を経由<i>せずに</i> 10.0.0.0/24 のネットワークから来た
すべてのトラフィックをブロックします。これは、10.0.0.0/24 のネットワークは、
<tt>fxp0</tt> に誓楝海気譴討い襪里如△海離優奪肇錙璽屮蹈奪料汽▲疋譽垢鮖
パケットが、他のネットワークインターフェイスに出現することはあり得世覆い蕕任后
殊蘊儒胯隶鹿の IP アドレスである 10.0.0.1 からのすべての着信トラフィックを
ブロックします。
これは、ホストマシンは、外部インターフェイス経由で、自分自身には決して
パケットを送信すべきではありませんので、このマシンに属する発信元アドレスを持つ
すべての着信パケットは、悪意のあるものと見なすことができるからなのです。
</ul>

<p>
<b>注</b>: <tt>antispoof</tt> ルールを展開した後のフィルタルールは、
ループバックインターフェイスからローカルアドレスに送信しようとしたパケットも
ブロックします。これらのアドレスは、以下の例のように、明声砲錣燭垢戮任后
錫跫站髟阡緇
儒
鞜齠髟蜒闔鎔跛錫鮠
錫鮠
瘤齔闖肬胯隶鈬鹿鹿碎閭鞫
腫儒瘤齔闖羲ぢの使用法は、IP アドレスが割り当てられているインターフェイスに限定
すべきものです。IP アドレスが割り当てられていないインターフェイスに <tt>antispoof</tt>
を使用することは、以下のようなフィルタルールに展開される結果となってしまいます。
<blockquote>
<tt>
block drop in on ! fxp0 inet all<br>
block drop in inet all
</tt>
</blockquote>

<p>
これらのルールには、<i>すべての</i>インターフェイスで、<i>すべての</i>
内向きトラフィックをブロックしてしまう危険誓△蠅泙后

釈瘢綵∫竟頸鵞昭取仮賓ぢオプション</h2>
デフォルトでは、PF は IP オプションのセットされたパケットをブロックします。これによって、
nmap のような「OS の指紋を取る」ユーティリティの仕事をより困難なものにすることができます。
もし、マルチキャストや IGMP のようなパケットを通過させる必要のあるアプリケーションを
使用する場合には、以下のように <tt>allow-opts</tt> ディレクティブを使用することができます。
<blockquote>
<tt>
pass in quick on fxp0 all allow-opts
</tt>
</blockquote>

<a name="example"></a>
<h2>フィルタリングルールセットの例</h2>
以下はフィルタリングルールセットの一例です。PF を実行するマシンは、
小さな内部ネットワークとインターネットとの間のファイアウォールとして
動作しています。フィルタルールは以下のものだ世韻任△蝓
釈鱚羹蜴膊蔗迪⊂髟纒繪鈑鹿畩、 
<a href="nat.html"><tt>nat</tt></a>、
<a href="rdr.html"><tt>rdr</tt></a>
などは、この例の対象外としています。
<br>
<br>
<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
ext_if  = "fxp0"
int_if  = "dc0"
lan_net = "192.168.0.0/24"

# scrub incoming packets
scrub in all

# setup a default deny policy
block in  all
block out all

# pass traffic on the loopback interface in either direction
pass quick on lo0 all

# activate spoofing protection for the internal interface.
antispoof quick for $int_if inet

# only allow ssh connections from the local network if it's from the
# trusted computer, 192.168.0.15. use "block return" so that a TCP RST is
# sent to close blocked connections right away. use "quick" so that this
# rule is not overridden by the "pass" rules below.
block return in quick on $int_if proto tcp from ! 192.168.0.15 \
   to $int_if port ssh flags S/SA

# pass all traffic to and from the local network
pass in  on $int_if from $lan_net to any
pass out on $int_if from any to $lan_net

# pass tcp, udp, and icmp out on the external (Internet) interface. 
# keep state on udp and icmp and modulate state on tcp.
pass out on $ext_if proto tcp all modulate state flags S/SA
pass out on $ext_if proto { udp, icmp } all keep state

# allow ssh connections in on the external interface as long as they're
# NOT destined for the firewall (i.e., they're destined for a machine on
# the local network). log the initial packet so that we can later tell
# who is trying to connect. use the tcp syn proxy to proxy the connection.
pass in log on $ext_if proto tcp from any to { !$ext_if, !$int_if } \
   port ssh flags S/SA synproxy state
</pre>
</td></tr>
</table>

<p>
[<a href="tables.html">前に戻る: テーブル</a>]
[<a href="index.html">目次</a>]
[<a href="nat.html">次に進む: ネットワークアドレス変換 (NAT)</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[back]"></a> 
<a href="mailto:www@@openbsd.org">www@@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: filter.html,v 1.17 ]
<br>
$Translation: filter.html,v 1.16 2004/02/01 12:35:38 toshi Exp $
<br>
$OpenBSD: filter.html,v 1.16 2004/05/09 09:58:22 saad Exp $
</small>

</body>
</html> 
@


1.16
log
@sync with Steelix CVS
@
text
@d728 1
a728 1
$OpenBSD: filter.html,v 1.17 2004/01/31 21:10:50 nick Exp $
@


1.15
log
@sync with steelix translation CVS
@
text
@@


1.14
log
@Sync with Steelix CVS
@
text
@d74 1
a74 1
の最後には、暗黙のうちに <tt>pass all</tt> が指定されていると見なされるため、
d724 1
a724 1
Originally [OpenBSD: filter.html,v 1.16 ]
d726 1
a726 1
$Translation: filter.html,v 1.15 2004/01/03 05:12:49 toshi Exp $
d728 1
a728 1
$OpenBSD: filter.html,v 1.16 2004/01/01 04:16:17 nick Exp $
@


1.13
log
@Sync with Steelix CVS
@
text
@d11 1
a11 1
<meta name="copyright"     content="This document copyright 2002-2003 by OpenBSD.">
d724 1
a724 1
Originally [OpenBSD: filter.html,v 1.15 ]
d726 1
a726 1
$Translation: filter.html,v 1.14 2003/12/26 05:14:05 toshi Exp $
d728 1
a728 1
$OpenBSD: filter.html,v 1.15 2003/11/27 15:08:25 nick Exp $
@


1.12
log
@Sync with Steelix CVS
@
text
@d199 1
a199 1
<dd><tt>proto tcp</tt> を使用する場合に、TCP ヘッダ世縫札奪箸垢戮
箍教
甓教
胯隶ぢを送信誓茱▲疋譽垢箸靴道藩僂靴討い泙后
箏俺
畄俺
ぴ鱇銖赱闔肅踉纈讙窺嘘旭劾渦梓佐減碍闢蓍


窺臼
跫績繻蝌嶝

絶屋
甓杣蓿繙就鰾鬯蔗迪⊂前に戻る: トラフィックリダ瀬ぅ譽轡腑鹿畩箍甓杣蓿繙就跫艸蜴膊蔗迪⊂次に進む: ログの取得鹿畩箜箜甞殊蘊釈鱚羹■髟蜒襤昭擾站鹿キーワード</a>
d83 1
a83 1
<i>action</i> <i>direction</i> [log] [quick] on <i>int</i> [<i>af</i>] 
d108 2
a109 2
ここで、ルールに <tt>keep state</tt> か <tt>modulate state</tt> オプションが
指定されている場合には、確立された状態のパケットのログのみ記録されます。
d115 2
a116 1
最終的にマッチすべきルールと見なされるので、ここに指定された動作が実行されます。
d118 1
a118 1
<dt><tt><i>int</i></tt>
d212 4
d270 39
d396 1
a396 1
<tt>/etc/pf.conf</tt> ファイルの <a href="options.html">オプション</a>
d504 16
a519 10
<a name="quick"></a>
<h2><tt>quick</tt> キーワード</h2>
最初の方に示しましたが、それぞれのパケットはフィルタルールセットの最初から最後まで
評価が行われます。デフォルトでは、パケットは通過するよう誓瀋蠅気譴泙垢
これはフィルタルールの最後までなら、各種ルールによって変更することもできますし、
何度でも前後に変更することができます。
そして、<b>最後にマッチしたルールが「勝者」となります。</b>
この例外が <tt>quick</tt> オプションで、これが指定されたフィルタリングルールより
後のすべてのルールの処理と、そこに指定された取るべき動作をキャンセルする効果を持ちます。
いくつかの例を見てみましょう。
d522 3
a524 1
間違った例です。
d527 2
a528 2
block in on fxp0 proto tcp from any to any port ssh<br>
pass &nbsp;in all
d533 1
a533 3
この場合、<tt>block</tt> 行は評価されますが、決して何の効果も
持たないでしょう。なぜなら、これより後にすべてを通過させる行が
存在しているからです。
d536 2
a537 7
より良い例です。
<blockquote>
<tt>
block in quick on fxp0 proto tcp from any to any port ssh<br>
pass &nbsp;in all
</tt>
</blockquote>
d540 3
a542 3
これらのルールは少し異なる評価が行われます。<tt>block</tt> 行にマッチすると、
この行には <tt>quick</tt> オプションが指定されているので、パケットはブロックされ、
残りのルールセットは無視されます。
d592 3
a594 3
ふたつのフィルタルールに展開されます。インターフェイス fxp0 が IP アドレスとして
10.0.0.1 を持ち、サブネットマスクとして 255.255.255.0 (つまり /24) を持つものとすると、
上記の <tt>antispoof</tt> ルールは以下のように展開されます。
d606 1
a606 1
<li>fxp0 を経由<i>せずに</i> 10.0.0.0/24 のネットワークから来た
d608 1
a608 1
fxp0 に誓楝海気譴討い襪里如△海離優奪肇錙璽屮蹈奪料汽▲疋譽垢鮖
箒碓
甼臼
殊蘊胯隶ぢの IP アドレスである 10.0.0.1 からの全ての着信トラフィックをブロックします。
d704 1
a704 1
# NOT destined for the firewall (ie, they're destined for a machine on
d706 1
a706 1
# who is trying to connect.
d708 1
a708 1
   port ssh flags S/SA keep state
d714 1
a714 1
[<a href="rdr.html">前に戻る: トラフィックリダ瀬ぅ譽轡腑鹿畩箏蔚
畄蔚
杣蓿繙就跫艸蜴膊蔗迪⊂次に進む: ログの取得鹿畩箏牡
畄牡
蜃蜴瘡踟緕帯頂蛹鬯蔗迪箏俺
畄俺
ぴ鱇銖赱闔肅踉纈讙窺渦旭劾臼唄叉該鰻闢蓍
箏恩
畄恩
は鞳鄲喞肅踉纈讙窺唄旭劾臼桶魂杭芦蜒祷

窺碓
跫栴繻蝌鱇銖赱闔嶝

絶換
甦釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈鞴逅雌繼闔輯逅詩瘤鞜熟鞳鄲喞箋甬┝蓿繙就蔗痕鞳鈞黻鱧芍蜴瘤芍髄鴒初隍瘢雹黼謾蜿扈侃瘢雹轣鉋癆莉緕帯朝凱晦
箋甬釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈蜷共瘢雹黼謾蜿扈侃瘢雹轣鉋癆莉緕帯朝凱晦
箋甬┝蓿繙就蔗痕鞳鈞黻鱧芍蜴瘤芍髄鴒諸竦逅雌繼闔輯逅詩瘤鞜熟鞳鄲喞箋甬釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈隍瘢雹黼謾蜿扈侃瘢雹轣鉋癆莉緕帯朝凱晦
箋甬釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈蜒逅逅雌繼闔輯逅詩瘤鞜熟鞳鄲喞箒甼釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈蜒逅共瘢雹黼謾蜿扈侃瘢雹轣鉋癆莉緕帯朝凱晦
箟圧
甕圧
寂箴釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈鞴跫舮逅雌繼闔集逅詩瘤鞜熟鞳鄲喞箟咳
甕咳
殊蘊釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈頏阡閭闌鵙瘢雹黼謾蜿扈畿瘢雹轣鉋癆莉緕帯朝凱晦
箟袈
甕袈
殊蘊釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈黼鴟蜒纉逅雌繼闔週逅詩瘤鞜熟鞳鄲喞箋屋
甬屋
釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈鞴跫舮逅雌繼闔集逅詩瘤鞜熟鞳鄲喞箒祁
甼祁
蜃蜴瘡踟緕帯頂蛹鬯蔗迪箒傾
甼傾
ぴ鱇銖赱闔肅踉纈讙窺臼旭劾姐梓些浦街闢蓍
箒険
甼険
は鞳鄲喞肅踉纈讙窺嘘旭劾姐芦魂杭鯵蜒祷

窺跫栴繻蝌

誓


窺跫栴繻蝌

絶欝甕軌
殊蘊守昭少鈬癈觴鹿蘊たとえば <tt>/24</tt>) のような
d226 1
a226 1
block in  all<br>
d615 2
a616 2
<a href="nat.html">NAT</a>、
<a href="rdr.html">rdr</a>
d677 1
a677 1
Originally [OpenBSD: filter.html,v 1.12 ]
d679 1
a679 1
$Translation: filter.html,v 1.10 2003/09/18 14:09:44 toshi Exp $
d681 1
a681 1
$OpenBSD: filter.html,v 1.12 2003/09/16 01:23:49 nick Exp $
@


1.7
log
@sync with steelix translation CVS
@
text
@d423 1
a423 1
「他のものは除いて、SYN フラグがセットされたものだ世院彎屬鮴生誓垢襪茲
箒祁
甼祁
蜃蜴瘡踟緕帯頂蛹鬯蔗迪箒傾
甼傾
ぴ鱇銖赱闔肅踉纈讙窺屋鯵遣嘘矯臆佐鼈祷箒険
甼険
は鞳鄲喞肅踉纈讙窺臼旭劾宛臆艮穏軌蜒祷

窺跫栴繻蝌鱇銖赱闔嶝

絶挟甼換
鞜齠跛鱇聿蜒瘤胙闕蒹閭瘡續鳬纉鈬肬
肅鱚跛痺蓍鈬
鞜齠ら銓煢胙闕赱釼鈬蜴蜀鞜齠ら銓煢胙闕蜴蜀れ瘤燻續
箒祁
甼祁
蜃蜴瘡踟緕帯頂蛹鬯蔗迪箒傾
甼傾
ぴ鱇銖赱闔肅踉纈讙窺屋鯵強欝該芦些鼈祷箒険
甼険
は鞳鄲喞肅踉纈讙窺碓旭劾斡蔚佐虻斡蜒祷

窺跫栴繻蝌鱇銖赱闔嶝

絶街甞慌
噎と URG フラグのセットされたパケットは、やはり上記のルールに
d412 1
a412 1
pass out on fxp0 proto tcp all flags S/SAFR keep state
d417 1
a417 1
これは、SYN、ACK、FIN および RST フラグの中から SYN フラグだ世韻札奪箸気譴
箚寛甦儀
これは、このパケットに SYN フラグがセットされていて、ACK、FIN および RST
がセットされていない場合のみマッチすることを意味します。
d614 1
a614 1
<a href="../queueing.html">queueing</a>、 
d627 3
d678 1
a678 1
Originally [OpenBSD: filter.html,v 1.9 ]
d680 1
a680 1
$Translation: filter.html,v 1.6 2003/06/14 06:40:51 toshi Exp $
d682 1
a682 1
$OpenBSD: filter.html,v 1.9 2003/06/14 03:24:32 nick Exp $
@


1.4
log
@sync with steelix translation CVS
@
text
@d624 1
a624 1
# trusted computer, 192.168.0.15. use "block drop" so that a TCP RST is
d627 1
a627 1
block drop in quick on $int_if proto tcp from ! 192.168.0.15 \
d661 1
a661 1
Originally [OpenBSD: filter.html,v 1.8 ]
d663 1
a663 1
$Translation: filter.html,v 1.5 2003/06/13 04:57:08 toshi Exp $
d665 1
a665 1
$OpenBSD: filter.html,v 1.8 2003/06/13 02:54:08 nick Exp $
@


1.3
log
@sync with steelix translation CVS
@
text
@d49 14
a62 13
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.3">
pf(4)</a> がパケットを検査する場合に使用する判断基準は、レイヤ 3 
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ip&amp;sektion=4&amp;manpath=OpenBSD+3.3">IPv4</a> 
および 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ip6&amp;sektion=4&amp;manpath=OpenBSD+3.3">
IPv6</a>) ならびにレイヤ 4
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcp&amp;sektion=4&amp;manpath=OpenBSD+3.3">TCP</a>、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=udp&amp;sektion=4&amp;manpath=OpenBSD+3.3">
UDP</a>、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=icmp&amp;sektion=4&amp;manpath=OpenBSD+3.3">
ICMP</a> および
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=icmp6&amp;sektion=4&amp;manpath=OpenBSD+3.3">
ICMPv6</a>) のヘッダ世亡陲鼎泙后任睥匹藩僂気譴詒獣粘霆爐蓮∩気茲啻先のアドレス、
d105 2
a106 2
<dd><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8&amp;manpath=OpenBSD+3.3">
pflogd(8)</a> 経由でパケットのログを取得世垢戮任△襪海箸鮖慊蠅靴泙后
箟咳
甕害
殊蘊釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈頏阡閭闌鵙瘢雹黼謾蜿扈畿瘢雹轣鉋癆莉緕帯朝凱晦儒鳫竢踈鹿昭箟袈
甕祁
殊蘊釈鱚羹∵雕關緕碵筮闥膀竍薛砠遲轣隨竍蘓髟纈黼鴟蜒纉逅雌繼闔週逅詩瘤鞜熟鞳鄲喞⊂
儒纈竇鷦鹿畩
箒怯
甼怯
蜃蜴瘡踟緕帯頂蛹鬯蔗迪
箒恭
甼恭
ぴ鱇銖赱闔肅踉纈讙窺屋鯵強姐戯牡叉鼈祷箒教
甼教
は鞳鄲喞肅踉纈讙窺屋鯵強扱浦姥艮鉗站


窺跫齷釿蜚齡繞跚瘤鼬癆蜿置
絶屋
甓杣蓿繙就糅譬ぢ前に戻る: トラフィックリダ瀬ぅ譽轡腑鹿畩箜涯
甞涯
釈鱚羹〓鰾鬯蔗迪⊂儒鰾鮗鹿畩ぢルールは、マッチした誓楝海
箒葦
甼葦
釈鱚羹〓鰾鬯蔗迪⊂鰾鮗箒軌
甼軌
杣蓿繙就糅譬ぢ前に戻る: トラフィックリダ瀬ぅ譽轡腑鹿畩箒恐
甼恐
ぴ鱇銖赱闔肅踉纈讙窺屋鯵強扱敢斡魂鼈祷

窺跫齷釿蜚齡繞跚瘤鼬癆蜿置
絶蓋
箚験箒宛
甼碓
纔蜀胯隶
蜴蜀粃赱釼鈬厩荻蔚軒握渥牡
箒蔚
箒彊
甼彊
蜃蜴瘡踟緕帯頂蛹鬯蔗迪
箒恐
甼恐
ぴ鱇銖赱闔肅踉纈讙窺屋鯵強圧穏屋佐鼈祷箒挟
甼挟
は鞳鄲喞肅踉纈讙窺屋鯵起乙浦概紺鉗站

