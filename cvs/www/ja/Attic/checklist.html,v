head	1.18;
access;
symbols;
locks; strict;
comment	@# @;


1.18
date	2008.03.31.20.01.45;	author tobias;	state dead;
branches;
next	1.17;

1.17
date	2006.12.27.16.17.15;	author saad;	state Exp;
branches;
next	1.16;

1.16
date	2006.01.06.20.58.11;	author saad;	state Exp;
branches;
next	1.15;

1.15
date	2005.08.24.06.42.31;	author saad;	state Exp;
branches;
next	1.14;

1.14
date	2005.01.20.19.41.28;	author jufi;	state Exp;
branches;
next	1.13;

1.13
date	2004.05.09.09.58.23;	author saad;	state Exp;
branches;
next	1.12;

1.12
date	2004.04.17.19.32.24;	author jufi;	state Exp;
branches;
next	1.11;

1.11
date	2004.02.15.18.18.41;	author jufi;	state Exp;
branches;
next	1.10;

1.10
date	2004.01.04.22.37.11;	author horacio;	state Exp;
branches;
next	1.9;

1.9
date	2003.12.06.10.18.07;	author horacio;	state Exp;
branches;
next	1.8;

1.8
date	2003.11.18.21.03.42;	author horacio;	state Exp;
branches;
next	1.7;

1.7
date	2003.11.03.16.46.36;	author jufi;	state Exp;
branches;
next	1.6;

1.6
date	2003.11.03.14.56.54;	author horacio;	state Exp;
branches;
next	1.5;

1.5
date	2003.06.27.21.14.44;	author jufi;	state Exp;
branches;
next	1.4;

1.4
date	2003.06.05.13.07.05;	author jufi;	state Exp;
branches;
next	1.3;

1.3
date	2003.05.12.18.54.28;	author jufi;	state Exp;
branches;
next	1.2;

1.2
date	2003.05.05.09.39.08;	author jufi;	state Exp;
branches;
next	1.1;

1.1
date	2003.04.15.17.16.33;	author jufi;	state Exp;
branches;
next	;


desc
@@


1.18
log
@Sync with Steelix CVS
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-2022-jp">
<meta name="resource-type" content="document">
<meta name="description" CONTENT="How to make/update an OpenBSD port.">
<meta name="keywords" content="openbsd,ports">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1998-2004 by OpenBSD.">

<title>OpenBSD への移植のためのチェックリスト</title>
</head>
 
<body text="#000000" bgcolor="#FFFFFF" link="#23238E">
<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="../images/smalltitle.gif" border="0"></a>

<h2><font color="#e00000">OpenBSD への移植のためのチェックリスト</font></h2>

このドキュメントには、ports を make したりアップグレードする方法が書かれています。
これを作業項目の覚え書きとして使用すると便利です。しかし、完璧に誓騎里箸いΔ錣韻任呂△蠅泙擦鵑掘
抜けがないとも限りません。質問や意見がありましたら <a href="mailto:ports@@openbsd.org">ports@@openbsd.org</a>
へお願いします (訳注: おそらく、英語で書かないと読めないと思います)。

<hr>
<ol>

<li> 
もしメンテナ (訳注: maintainer = ports の管理者) になりたいと思ったら
<a href="mailto:ports@@openbsd.org">ports@@openbsd.org</a> を講読しましょう。
<ul><li> 
あらゆる ports に関する議論世海海嚢圓錣譴討い泙后
殊蘊
このメーリングリストで多くのアナウンスがされるので、このメーリングリストを読むことは重要です。
<li>
また、このメーリングリストには ports に詳しい人々がたくさん参加しています。
その人たちはアドバイスをくれたり ports のテストをしてくれたりします。
</ul>

<br><li>
メンテナになるということは、単に ports を投稿するよりも<strong>多く</strong>のことを求められます。
担当する ports をいつも最新に保つことはもちろん、それらについての質問にも
答えるようにしなければなりません。

<br><br><li>
ports ツリーを CVS からチェックアウトします。
この方法の誓睫誓は
<a href="anoncvs.html">anonymous cvs のページ</a>にあります。

<br><br><li> 
あなたの ports の置く場所を (訳注: ports ツリー全体の中のどこかに) 決め、
そこに基本的な構造を作誓靴泙后
若閼緇齟闥鈕鱇齡鴣笏絲逅赱鶩浴諷肅跂纃韭癆綣閼緇
にある Makefile のテンプレートを使用しましょう。NEED_VERSION は古いマクロですので、
新しい ports で使用すべきではありません。あなたが ports の開発者ならば、bsd.port.mk
も含めて自分の ports ツリーをアップデートしていなければなりません。
<ul><li>
<code>pkg</code> ディレクトリを作誓靴泙靴腓Α
殊蘊
空のファイル <code>pkg/DESCR、pkg/PLIST</code> を作誓靴泙靴腓Α
鹿
錫鮠殊蘊浴諷肅跂ぢの fetch 部を書き加えます。
<ul><li>
.tar.gz ではない場合には EXTRACT_SUFX に書きます。.tar.gz 以外の例としては
.tar.Z や .tgz などが挙げられます。
<li>
DISTNAME には、ファイル名から上に述べた拡張子を除いたものを書きます。
たとえばファイル名が foo-1.0.tar.gz であったならば DISTNAME は foo-1.0 にします。
<li>
MASTER_SITES には distfile (訳注: ソフトウェアの作者が配布しているファイルのこと。
上の例で言世┐闖癇というファイルがそれに該当する) があるディレクトリの URL を書きます。
たとえば ftp://ftp.openbsd.org/pub/OpenBSD/distfiles/ というようにします。<strong>最後に / (スラッシュ記号)
を付けるのを忘れないようにしましょう。</strong> できるならば最低 3 つの異なるサイトを同じように書きましょう。
URL は書いた順番に試されますので、一番容易に行けるサイトを最初に書きましょう。
<li>
fetch プログラムは ${MASTER_SITES}${DISTNAME}${EXTRACT_SUFX} というファイルを取りに行こうとすることを
忘れないようにしてくだ世気ぁ海譴蕕ぢつのマクロがすべて使用されます。
DISTNAME にファイルを直誓椹慊蠅靴討呂い韻泙擦鵝
殊蘊
これら 3 つの値が誓気靴設定できたかどうかは
<b>make fetch-all</b> とコマンドを叩いてチェックすることができます。
</ul>
<p>
より複雑な ports には、さらに他のオプションやツールを使用することもできます。
<ul><li>
PATCHFILES という変数を使用することもできます。これは ports に対する (OpenBSD 以外の)
ベンダ世離僖奪舛離螢好箸任后茲△觧箸な箸靴討蓮▲札絅螢謄僖奪舛
安定化パッチなどのようなものがあります。
<li>
もしあなたの ports が GNU や SunSite、CPAN といった大きなミラーサイトから取得世任襪發里任△訃豺腓砲蓮
齟闥鈕鱇齡鴣笏絲逅赱鶩鈬闥覡竢鈕纃韭癆の中にサイトのリストがすでに用意されています。
MASTER_SITES を ${MASTER_SITE_GNU} や ${MASTER_SITE_SUNSITE} などに誓瀋蠅靴討誓さい。
配布物のサブディレクトリの名前を追加する場合には、
${MASTER_SITE_FOO:=subdir/} という書式を使用すると簡単です。
<li>
通常、ports はソフトウェアのある特定のバージョンと対応しています。ソフトウェアを取ってきたときには、そのファイルのチェックサムが計算され、distinfo に書かれているチェックサムと比較されます。
ですので、混乱を避けるために、DISTFILES と PATCHFILES にははっきりとわかるバージョン番号が含まれているべきです。
foo-latest.tar.gz というものがあって、これが foo-1.0.5.tar.gz にリンクされていたとしても、foo-latest.tar.gz を取得世靴討呂い韻泙擦鵝
もしどうしても必要ならば、元のプログラムの作者にそれらの区別をはっきりさせるようにお願いしましょう。
<li>
もし、ある ports が 5 個以上の DISTFILES や PATCHFILES を必要とするならば、
/usr/ports/distfiles を必要以上に散らかさないためにも DIST_SUBDIR を使用してくだ世気ぁ
殊蘊
追嘖灑嫗追にはバージョン番号を含めてはいけません。ports が最新版に更新されても、いくつかの配布ファイルは変化がないかも知れません。しかし DIST_SUBDIR が変更されていると、すべてダ瀬Ε鵐蹇璽匹慶召靴討靴泙い泙后
たとえ、すべての配布ファイルが変更になっていたとしても、同じ DIST_SUBDIR を使用する方がユーザが port を追いかけるのに便利です。
<li>
すべての DISTFILES と PATCHFILES が同じ MASTER_SITES の組み合わせから取得晴椎修任△詆廚呂△蠅泙擦鵝
輿嘖賭灑不途から MASTER_SITES9 までの変数を使用してその他のサイトを定義することができます。
foo-1.0.5.tar.gz を MASTER_SITES5 から取得世垢襪燭瓩砲蓮韻瓶堝斌途醇闖癇と書くだ世韻任后
殊蘊
ある環境においてはいくつかのファイルを取得世垢詆廚覆闥ぢもあるかもしれません。例えばいくつかのコンパイル時オプションがある ports で、ある特定の場合のみあるファイルが必要となることもあるでしょう。
また、あるアーキテクチャでのみ必要なファイルがある場合もあります。このような場合には SUPDISTFILES 変数を使用してこれらのファイルについての情報を書くことができます。
makesum や mirror-distfiles といった (訳注: make の) target は、
普通のユーザが必要としないこれら補足のファイルについても取得世靴泙后
鹿
錫鮠殊蘊
錫壌瘠轣諷齦躰を実行して <i>distinfo</i> ファイルの中にチェックサムを作誓靴泙后
その後、チェックサムが誓気靴い匹Δ里瓩襪燭瓩法錫壌瘠竏繝謫鹿眈ぢを実行しましょう。
<ul><li>
ごくまれにファイルのチェックサムが確実に確かめることができない場合があります。そのような場合には、ぜひ、信頼できるサイトを見付ける努力をすべきです。
ソフトウェアの作者やアーカイブサイトの管理者とこの段階で連絡を取るのは、大変に好ましいことです。最悪の場合には、IGNOREFILES 変数を使用して、
チェックサムの確認できないファイルを指定することができます。
<li>
通常、DISTFILES に書かれたファイルはすべて make extract 中に処理されます。
EXTRACT_ONLY を使用して一部のファイルの展開を誓造垢襪海箸發任泙空にすることもできます) (訳注: EXTRACT_ONLY に指定されたものだ世韻験気譴泙后Ｆ辰傍劼靴覆辰疹豺腓砲瓶堝斌途ぢに指定されたもの全てが展開されます)。
この変数のよくある使われ方としては、展開方法のカスタマイズが挙げられます。
たとえば、いくつかの DISTFILES がある特別な扱いを必要とするならば、それらを EXTRACT_ONLY から取り除き、post-extract ステージにおいて手で取り扱うことができます。
歴史的理由により、作業ディレクトリは make extract によってファイルの展開と共に初めて作誓気譴泙后召辰董頏絖纔痺や do-extract ターゲットを使用するのはとても特殊な場合に限られます
(そして、それはかなり怪しい動作をして、とてつもなくわかりにくくなるでしょう)。
<li>
歴史的理由により、特別な扱いを必要とするパッチは DISTFILES に書き EXTRACT_ONLY から取り除くのが推奨される方法です。
</ul>

<br><li>
<b>make extract</b> として ports を展開します。ソースの展開されるディレクトリ
に注意してくだ世気ぁＤ名錙守穣貿料妖盟嶇吽努奬瓶堽鼠統鹿蘊ぢと
なります。これが異なる場合には、Makefile の WRKDIST を変更する必要があります。

<br><br><li>
ports をビルドするためにしなければならないことと、そのとき必要となるかも知れない
特別な選択肢について注意しながら、インストールドキュメントを読みましょう。

<br><br><li>
このときが、どのような種類のライセンスの誓造討呂泙襪鯆瓦戮襪里砲舛腓Δ瀕匹ぅ織ぅ潺鵐阿任后
多くは自由に再配布可能ですが、一方では少なからずそうではないものが存在します。ports
を配布するためには、次の 4 つの項目について誓騎里謀┐詆廚△蠅泙后
これらは Makefile の中の PERMIT_* の値として誓瀋蠅靴泙后
受貍殊蘊
佚厖不瀰礎冒播瀉漬詫ぢはパッケージを CDROM に収録しても良いことを示します。
<li>
PERMIT_PACKAGE_FTP はパッケージを FTP サイトに置いても良いことを示します。
<li>
PERMIT_DISTFILES_CDROM は distfile を CDROM に収録しても良いことを示します。
<li>
PERMIT_DISTFILES_FTP は distfile を FTP サイトに置いても良いことを示します。
</ul>
<p>
該当の項目が許可されている場合にはその値を Yes に誓瀋蠅掘△修Δ任覆ぞ豺腓砲呂修陵海諒源鵑鮴設定します。
後ほど満さなければならない特別な条件がある場合には十分注意してくだ世気ぁ燭箸┐弌△△闥
はライセンスのコピーをインストールすることを求めています。このような場合には、
<code>/usr/local/share/doc/&lt;name&gt;/</code>
にそのライセンスを置くことをお薦めします。
<p>
PERMIT_* の値について補足すると、<code># License</code> のような
ライセンスマーカをコメントとして置くことで、この方法によって、私たちは
なぜ PERMIT_* の値が誓瀋蠅気譴討い襪里陵海鮹里襪海箸任泙后

錫鮠錫鮠殊蘊
コンフィギュレーションオプションを Makefile に追加し、必要があれば、コンフィギュレーションスクリプトを作誓靴泙后
受貍殊蘊
若閼緇黹鱸頸鶩鹿竢粤という名前のディレクトリの中に `configure' という名前の ports
コンフィギュレーションスクリプトを置くこともできます。このスクリプトは、 CONFIGURE_STYLE
によって指定されたどのコンフィギュレーションが実行されるよりも前に実行されます。
<li>
GNU configure が使用されている場合には、./configure --help を実行することによって
指定できるオプションを見ることができます。
<li>
上書きしたいものはどれでも、Makefile の CONFIGURE_ARGS パラメータに --option
フラグを追加することによって変更することができます。
<li>
変数に追加する場合には CONFIGURE_ARGS+= を使用しましょう。
CONFIGURE_ARGS= とすると上書きされてしまいます。
</ul>

<br><li>
<b>make build</b> として ports をビルドしてみましょう。
<ul><li>
エラーなく最後まで行けばラッキーです。
<li>
何らかのエラーで終了してしまった場合にはパッチを作誓垢詆廚△蠅泙后
どんな変更が必要であるかを調べパッチを作誓靴討誓さい。
<li>
パッチは ${WRKDIST} からの相対パスになるように作誓靴覆韻譴个覆蠅泙擦鵝
殊蘊闥ぢをリセットしてパッチのテストをする一番簡単な方法は
<b>make clean patch</b> とすることです。こうすると作業ディレクトリを消し、
展開し直して ports にパッチを適用します。
</ul>

<br><li>
さあ、何回でも <b>make build</b> してからパッチを作誓
ぢもしくは <b>make update-patches</b> を実行し)、
<b>make clean patch</b> することを繰り返しましょう。
<ul><li>
パッチは <i>patches/</i> ディレクトリに置きます。また、その名前は patch-* とし、
* の部分は何か意味のある名前にすべきです。パッチが適用されるファイルの名前を
FILENAME だ世辰燭箸垢襪函▲僖奪舛量樵阿癆竏斌杜鼠とすることをお薦めします
(<tt>make update-patches</tt> は自動的にこのようにします)。
<li>
PATCHFILES に指定されたパッチを適用するのは make patch ステージの前半です。この部分の処理は
make distpatch として分離して実行することもできます。これは ports の開発者にとって便利な
make のターゲットです。PATCHFILES を誓瀋蠅靴討い覆ぞ豺腓砲蓮△海離拭璽殴奪箸鰐技襪気譴泙后
殊蘊
ひとつのパッチのファイルは、ひとつのソースファイルにだ世吋僖奪舛鯏僂垢襪茲Δ砲靴討誓さい。
<li>
パッチを作誓垢襪砲蓮錫壌瘠籬癆竏纉鹿眈ぢを使用しましょう。
<li>
すべてのパッチは ${WRKDIST} からの相対パスで作誓気譴詆廚△蠅泙后
殊蘊
パッチが CVS によって書換えられてしまうタグを含んで<strong>いない</strong>ことを確認してくだ世気ぁ
もし含んでいる場合には、チェックインした後にパッチが当たらなくなってしまいます。これを避けるために
-kk を付けてチェックインすることもできます。
<li>
そのパッチの役割についての短い誓睫誓文をパッチファイルの誓萋傍劼靴討誓さい
(必須ではありません)。
<li>
ソフトウェアの作者にもパッチを送るように<b>お願いします。</b>
</ul>

<br><li>
<code>SEPARATE_BUILD</code> を誓瀋蠅垢襪茲Δ忙遒靴討澆討誓さい。
<ul><li>
ports がソースツリーとは別の場所でオブジェクトファイルをビルドできるようになっているならば、
これはよりきれいな方法で (<code>CONFIGURE_STYLE=gnu</code> となっている多くのプログラムではできるはずです)
ports ツリーをいくつかのアーキテクチャ上でマウントしている人達にとってはとても助かります。
<li>
これをするためには、ほとんどの時間を <code>configure</code>
を繰り返し実行し直すような作業をしなければならないかも知れません。
</ul>

<br><li>
(もしあれば) 出力をよく読んで Makefile の中のオプションを変更しましょう。
コマンドを繰り返して実行するには、`<b>make clean configure</b>' とします。
<p>
注意: ホスト依存のファイル (訳注: = ホスト毎に異なる内容を誓瀋蠅垢戮侫．ぅは <i>/etc</i> か <i>/etc/&lt;name&gt;</i> に置かれるように確認してくだ世気ぁ
しかし、もともと <i>/etc</i> に存在しているファイルを<strong>置き換えたり変更したりしてはいけません。</strong>
一番良い方法は、<i>/usr/local/share/&lt;name&gt;</i> にインストールして、
それから <i>/etc</i> または <i>/etc/&lt;name&gt;</i> にファイルが存在しないときに限ってそこにコピーすることです。
もしすでにファイルが存在していたならば、「これこれのファイルを
修誓気垢詆廚△蠅泙后廚箸いΕ瓮奪察璽犬鯢充┐靴討誓さい。
<i>/usr/local</i> の下のファイルはすべて PLIST に含まれているので、
この方法を使用すればそれらのファイルが確実にパッケージに含まれるようになります。
パッケージのインストール終了後には、<code>pkg/MESSAGE</code> が存在していれば表示されます。

<p>
OpenBSDにおけるファイルの置き場所は以下の通りです。
<pre>
   ユーザ用実行ファイル:		/usr/local/bin
   システム管理者用実行ファイル:	/usr/local/sbin
   プログラム用実行ファイル:		/usr/local/libexec
   ライブラリ:				/usr/local/lib
   アーキテクチャ依存データ:		/usr/local/lib/&lt;name&gt;
   インストールされる include ファイル:	/usr/local/include or
					/usr/local/include/&lt;name&gt;
   マシン毎のデータ:			/etc or /etc/&lt;name&gt;
   ローカルの状態ファイル:		/var/run
   ゲームの点誠織侫．ぅ	癇瘢纉
燐鈕のファイル:			/usr/local/info
   マニュアル (man pages):		/usr/local/man/...
   アーキテクチャ非依存の read-only ファイル:	/usr/local/share/&lt;name&gt;
   その他のドキュメント:		/usr/local/share/doc/&lt;name&gt;
   サンプルファイル:			/usr/local/share/examples/&lt;name&gt;
</pre>

<li>
問題がなくなるまで何回でも make し直してくだ世気ぁ竟鶯が作誓気譴襪泙妊僖奪舛鯏董
竚縺し、make します。警告 (warning) メッセージがひとつも出ないようにしましょう。
特にセキュリティ関連の警告は注意してくだ世気ぁ

錫鮠錫鮠殊蘊
單仭卅堙濛嬋鳴ぢの動作を調誓阿靴泙后
單仭卅堙濛嬋鳴ぢを定義して ports がビルドされている場合にはこの調誓阿廚任后
理想としては、${WRKSRC} 内のファイルは、<b>make patch</b> 後は
一誓敲儿垢気譴覆い茲Δ砲垢戮任后
徠睦卉以下に対する書き込み権限を持たない状態にすると
これをチェックすることができます。
これができれば <code>SEPARATE_BUILD=concurrent</code> を
誓瀋蠅垢襪海箸任泙后弔泙蝓韻献宗璽好張蝓爾鮖藩僂靴
異なるアーキテクチャ上で同時にビルドを実行できるようになるのです。
そうでない場合には、<code>SEPARATE_BUILD=simple</code> と誓瀋蠅靴討誓さい。
これは、まずいタイミングでソースファイルが誓言成し直されるかもしれないために
異なるアーキテクチャ上での同時ビルドは問題が発誓犬垢覯椎柔性があることを示します。

<br><br><li>
Makefile に <i>COMMENT</i> を加えてくだ世気ぁ
地様杜はその ports についての<strong>短い</strong> 1 行の誓睫誓文です
(最大 60 文字)。COMMENT 中にパッケージ名
 (やソフトウェアのバージョン番号)
を入れては<strong>いけません。</strong>
特に意味的に重要な場合を除いて大文字で始めては<strong>いけません。</strong>
最後にピリオドを書いても<strong>いけません。</strong>
<strong>`a' や `an' のような不定冠詞から始めてはいけません。
そのような場合、文が完全に削除されてしまいます。</strong>

<br><br><li>
<i>pkg/DESCR</i> と <i>pkg/PLIST</i> とを編集してくだ世気ぁ
受貍殊蘊
津喘は ports の長い誓睫誓文です。
1 段落〜数段落でその ports にできることを簡潔に誓睫誓してくだ世気ぁ
行 72 文字で改行するようにすることも注意してくだ世気ぁ
津喘をエディタで編集してから 'fmt -w 72' を通せばそのようになります。
<li>
PLIST はこの時点世任篭砲靴討い討誓さい。
</ul>

<br><li>
もし、アプリケーションがユーザやグループを誓言成する必要がある場合には、
<code>/usr/ports/infrastructure/db/user.list</code> から、未使用の最も小さな ID
を選択し、commit 時にこのファイルが含まれるよう確認してくだ世気ぁ

錫鮠錫鮠殊蘊
錫壌瘠蜴齡瘡貅としてアプリケーションをインストールしてくだ世気ぁ
ダ瀬ぅ淵潺奪薀ぅ屮薀蠅鬟ぅ鵐好函璽襪垢訃豺腓砲を使用して、そのシンボルテーブルをチェックしてくだ世気ぁ
ダ瀬ぅ淵潺奪薀ぅ屮薀蠅蜷ぢしてしまうソフトウェアがあるため、後に変な失敗が発誓犬垢襪海箸△蠅泙后
他方、実行バイナリは strip されているべきです。これは <code>file</code> コマンドを使用して調べることができます。
ports がバイナリを strip するコードをもともと含んでいる場合にはそれを使用しましょう
(たとえば、'install-strip' ターゲットのようなものです)。
そうでない場合には、port の Makefile にそのルールを追加してくだ世気ぁ

錫鮠錫鮠殊蘊
首闔臂竟鶯のセキュリティホールをもう一度チェックしてくだ世気ぁ鹿齡鳫鈑特にネットワークに関係する setuid プログラムの場合は重要です。
これに関しては、<a href="porting.html#Security">OpenBSD のセキュリティ勧告</a>
を参照してくだ世気ぁ５い砲覆襪發里篏だ正点世竢粤情諛澱孀不拏閼緇ぢファイルに記録しましょう。
このファイルには、監査によって発見され修誓気気譴神潜在的な問題点世髻
関連したパッチと共に並べておくようにします。そうすることによって、
すでに修誓気気譴討い詭簑蠹誓を他の人が一目で見ることができます。
以下に例を示します。
<pre> 
      &#36;OpenBSD&#36;

      ${WRKDIR}/receiver.c
         call to mktemp (wrapper function do_mktemp) does seem to be correct.

      The server makes extensive use of strlcpy/strlcat/snprintf.
</pre>

<li>
pkg/PLIST を作誓靴泙靴腓Αぅ鵐好函璽觸燦紂侈瓶ファイルを
<i>pkg</i> ディレクトリに作誓靴討譴覲塒僖灰泪鵐眈轣諷跚齡鹿眈ぢを
使用してくだ世気ぁ
腫猥棉嘖をよく見直してすべて誓気靴ぞ貊蠅縫ぅ鵐好函璽襪気譴討い襪
確認してくだ世気ぁぅ鵐好函璽襪気譴覆辰燭發里
竟鶯ぢの Makefile の `post-install' ルールで追加することができます。
<p>
共有ライブラリをインストールする ports には、PFRAG.shared という別のファイルが必要です。
<ul><li>
PLIST にはアーキテクチャが共有ライブラリをサポートしているかどうかとは関係のないファイルについて記述します。
<li>
PFRAG.shared には共有ライブラリをサポートするアーキテクチャ上のみ
インストールされるファイルについて記述します。
<li>
PFRAG.noshared には共有ライブラリをサポートしないアーキテクチャ上のみ
インストールされるファイルについて記述します。
</ul>

<br><br><li>
パッケージ化のテストをしましょう。
パッケージを作誓垢襪砲蓮竟鶯を誓気靴ぅ鵐好函璽襪靴討
若閼緇轣諷痺諱艱鹿竢粤というコマンドを実行します。
パッケージをテストするためには、まず、
<code>pkg_add</code> を実行してから <code>pkg_delete</code> します。
<br><br><li>
依存関係を確認しましょう。port が DEPENDS で指示したもののみを検知したことを、
あなたのログをよくみて確認します。隠れた依存関係を調べるために名前を確認します
(ports ツリーの他の場所にあり、もしユーザが誓茲砲修梁召闥ぢをインストールした場合に
検知されるかもしれないものなど)。
<br><br><li>
共有ライブラリの依存関係を確認しましょう。<code>make lib-depends-check</code> を実行し、
それがきちんと実行できるまで、
すべての <code>LIB_DEPENDS</code> または、必要な <code>WANTLIB</code> 注釈を追加します。
(port の Makefile をアップデートしたあと古いパッケージを削除するには
<code>make clean=package</code> を実行します)。
なぜこれが重要かということを理解するために
<a href="../porting/update.html">アップデートガイドライン</a>
を読んだ世曚Δいい任靴腓Α
錫鮠錫鮠殊蘊
後戻りテスト（訳注: 以前、問題の無かったテスト項目の再テスト）をしましょう。
そして、それらが何も問題ないかどうか確認します。
もし port に、後戻りテストが必要無ければ <code>NO_REGRESS=Yes</code> をセットします。
注: もし後戻りテストについての言正擇鬚靴覆い里任△譴竢粤称凖拝途喙閼緇ぢは
セットしないで下さい。
<br><br><li>
意見とテストを求める短い文章を書いて
<a href="mailto:ports@@openbsd.org">ports@@openbsd.org</a> にメールしてくだ世気ぁ
竟鶯をそのメールに添付して送ってくだ世気ぁ
腫あなたのためにいろいろなプラットフォームで ports をテストしてくれる人を確保しましょう。
<ul><li>
AMD64 Opteron は高速だ世箸いΔ誓けでなく、
<code>sizeof(int) != sizeof(long)</code> なので、テストするには良いプラットフォームです。
<li>
Sun SPARC および UltraSPARC も良いプラットフォームです。なぜなら、
とても一般的なプラットフォームでありそのバイトオーダ世蓋とは逆だ世蕕任后
もちろん、もし SPARC 上で開発したなら、i386 上でもテストしたほうが良いでしょう。
</ul>

<br><li>
得世蕕譴織侫璽疋丱奪呂垢戮童‘い靴泙靴腓Α△覆燭離廛薀奪肇侫璽狆紊任發Π貪戰謄好箸慶召靴討誓さい。
直した新しい ports をもう一度テストしてフィードバックを返してくれる人を確保しましょう。

<br><br><li>
最後に作誓靴闥ぢを "ports" ツリーに入れます。CVS に書き込む権限を持っていない場合には、
<a href="mailto:ports@@openbsd.org">ports@@openbsd.org</a>にいる
誰かに commit してくれるように依頼してくだ世気ぁ

錫鮠錫鮠殊蘊
もしあなたが CVS にアクセスできる開発者であるならば、
ports をチェックインしてくだ世気ぁ
新しい ports の場合、通常、大量のファイルを個別に add するのではなく
"import" を使用します。import は 1.1.1.1 というような
"vendor branch" バージョンを使用しますが、心配はいりません :-)。
どれかのファイルを変更 (つまり編集して cvs commit) すればそれは 1.2 になり、そのファイルが使用されます。
<p>
簡単にいうと、import は、普通、ports を作誓靴燭箸忙藩僂気譴泙后
その観点世埜誓えば、cvs add と cvs rm はファイルを追加したり削除したりする
ファイルを変更していく編集 → commit の通常のサイクルで使用されます。
たとえば、以下のようにすると良いでしょう。
<pre>
$ cd kaffe1
$ make clean	# you really don't want to check in all of work!
$ cvs -d cvs.openbsd.org:/cvs import -m 'kaffe port' ports/lang/kaffe1 \
	<i>YourName</i> <i>YourName_YYYY-MMM-DD</i>
</pre>
<ul><li>
-d cvs.openbsd.org:/cvs は CVS がどこにあるのかの場所を示しています。
これは環境変数 CVSROOT を誓瀋蠅垢譴仂蔑任泙后
殊蘊
諱聿竟鶯はあなたのログインメッセージです。お好きな内容にしてくだ世気ぁ
殊蘊
竟鶯鶩赱鈑瘋聽は CVS が存在している /cvs からの相対パスです。
<li>
<i>YourName</i> (あなたのログイン名になっているはずです) は「ベンダ瀬織亜
├鈔闥瘍Зぢです。あなたが import したらあなたがそのベンダ世任后
殊蘊
守訟阨鯲瘢縷捶捶様勅ぢ例: ian_2000-Jan-01) は「ベンダ瀬螢蝓璽好織亜
├鈔闥繻縺黼瘍Зぢです。これは何でも構いません。
</ul>
<br>
本当に過去にあった例として、メンテナのひとりが 1998 年 9 月 8 日に
Kaffe1 の port をチェックインしたときの出力を下に示します。
<pre>
$ cd kaffe1
$ make clean >/dev/null
$ cvs import -m 'kaffe1.0(==JDK1.1) port' ports/lang/kaffe1 ian ian_1998-Sep-08
ian@@cvs.openbsd.org's password: (not shown, obviously)
I ports/lang/kaffe1/CVS
I ports/lang/kaffe1/files/CVS
I ports/lang/kaffe1/pkg/CVS
N ports/lang/kaffe1/Makefile
cvs server: Importing /cvs/ports/lang/kaffe1/files
N ports/lang/kaffe1/files/md5
cvs server: Importing /cvs/ports/lang/kaffe1/pkg
N ports/lang/kaffe1/pkg/COMMENT
N ports/lang/kaffe1/pkg/DESCR
N ports/lang/kaffe1/pkg/PLIST

No conflicts created by this import
$ 
</pre>

<li>
最後に、親ディレクトリの Makefile に新しい ports のためのエントリを
1 行加えましょう。たとえば ports が ports/lang/kaffe1 だ世箸垢襪
それを ports/lang/Makefile に加えるのです。

<br><br><li>
ports を維持管理しましょう。時間が経つにつれて問題が起きたり、新しいバージョンのソフトウェアがリリースされたりします。
メンテナは自分の ports を最新に保つように努力すべきです。
つまり、テスト、テスト、テスト…の繰り返しなのです。

<br><br><li>
ports をアップデートするときには、その ports に依存する他の ports も取り扱わなければならないことを
忘れないでくだ世気あなたの ports に依存しているどのような ports も壊すべきではありません。
問題が起きた場合には、それらの ports のメンテナと相談してくだ世気ぁＦ瑛佑法預鹸愀犬旅洪靴砲眞躇佞鯤Г辰討誓さい。
そして、メンテナがそれらの作業をしたことをチェックするようにしてくだ世気ぁ
鹿闌緕帯の "ports" を作誓垢觧迭櫃韻鮖戮┐討譴討い襪澆覆気鵑亡脅佞靴泙后
取鮠
釈鱚羹闥鈑譬昭蜊蒹蜃蔗讐糘莉牡鱆就痺覡芍罌
闥粤鮟瘡∃闥鈑⊂鹿畩
釈鱚羹瘟踉鏈戦鞳鈞黻鱧⊂戦鞳鈞黻鱧鹿畩
錫鮠
首轣跛次蜃蜴瘡踟緕帯頂蒹站跚齡讙窺恐
ぴ鱇銖赱闔竏繝謖蜩蔗迪屋斡億俺杭姐紺謇迚諷
は鞳鄲喞竏繝謖蜩蔗迪屋斡億卸矯鰻艮黶痲
鹿鼾瘡貍
鹿硼糯鹿蔗迪

窺鰻
跫栴繻蝌嶝

絶軌甬梓
は鞳鄲喞竏繝謖蜩蔗迪屋圧丑屋杭官魂褫肅


窺蔚
跫栴繻蝌嶝

絶蓋箋葦
甬芦
蜃蜴瘡踟緕帯頂蒹站跚齡讙窺怯
ぴ鱇銖赱闔竏繝謖蜩蔗迪屋斡丑圧虻臆叉謇迚諷


窺欝
跫栴繻蝌嶝

絶慣甦卦
行加えましょう。たとえば ports が ports/lang/kaffe1s だ世箸垢襪
箚更
甦更
ぴ鱇銖赱闔竏繝謖蜩蔗迪屋圧遣桶該咳紺鼈祷

窺唄
跫績繻蝌嶝

絶更
畊ですのて、混乱を避けるために、DISTFILES と PATCHFILES にははっきりとわかるバージョン番号が含まれているべきです。
d256 1
a256 1
パッケージのインストールインストール終了後には、<code>pkg/MESSAGE</code> が存在していれば表示されます。
a355 14
注意: ファイルはタイムスタンプの情報を元に検索されます。
<ul><li>
`tar' でインストールされたファイルはファイルのタイムスタンプが変更されず、
`find' によって出てこないため、PLIST 中に入りません。
<li>
.info ファイルが追加されても <code>info/dir</code> ファイルは更新されません。
また、<code>info/dir</code> は PLIST の一部ではないことにも注意してくだ世気ぁ
殊蘊
ぢ訳注: ハード)リンクやシンボリックリンクに対して特別な処理は
行いません。ざっとした tar の検査ではリンクやシンボリックリンクを
誓気靴靴辰討い襪茲Δ妨┐泙垢里如▲僖奪院璽献螢好箸涼罎
特別な場合について取り扱う必要はなさそうに見えます。が、しかし…
</ul>
<p>
a358 1

a370 12
<br><li>
完全に動作するようになるまでアンインストールと再インストールとを繰り返して行ってくだ世気ぁ
弱躱「完全に動作する」</em>とはすべてのものがそれぞれの適誓擇憤銘屬縫ぅ鵐好函璽襪気譟
または、アンインストールされるようになることです。アンインストールするためには、`pkg_delete &lt;pkg_name&gt;'
とします。再インストールするためには、`sudo make reinstall' を実行します。
確実に「きれいに掃除する」ために PLIST ファイルに書き加えることのできるその他のコマンドについては
`pkg_create' の man page を見てくだ世気ぁ▲鵐ぅ鵐好函璽襪慮紊砲蓮⊆，離灰泪鵐鼻
腫鱚肅鈔鬲跫竅纓纈貿料妖盟嶇吽努奬瘠絖輿暖瀕冬倉暖盟嶇哈櫻銖跛燗鶯繖頏蜴鹿頏緇
が標準のディレクトリ名だ世韻鯢充┐垢襪茲Δ砲覆辰討い襪戮任后

箜袈甞抗
若閼緇韜艤粤跂鹿竢粤を実行してから <code>pkg_add</code> します。
<code>pkg_add</code> した結果とは、`make install' したときと厳密に一致しているべきです。

d498 2
a499 2
Originally [OpenBSD: checklist.html,v 1.60 ]
$Translation: checklist.html,v 1.14 2005/01/20 04:06:15 toshi Exp $
d501 1
a501 1
$OpenBSD: checklist.html,v 1.59 2004/03/25 02:41:50 jcs Exp $
@


1.13
log
@sync with Steelix CVS
@
text
@d413 2
a414 2
DEC Alpha は、誓電薀ぅ屮薀蠅靴辰討蕕此△泙拭
若閼緇皷閹銓―蝴繽罔跫鈑閼緇ぢであるということからテストするには良いプラットフォームです。
d416 1
a416 1
Sun SPARC もまた良いプラットフォームです。なぜなら、
d418 1
a418 1
もちろん、もし SPARC 上で開発したならば i386 上でもテストしたいと思うでしょう。
d509 4
a512 4
Originally [OpenBSD: checklist.html,v 1.59 ]
<br>
$Translation: checklist.html,v 1.13 2004/04/13 01:30:08 toshi Exp $
<br>
@


1.12
log
@Sync with Steelix CVS
@
text
@@


1.11
log
@*** empty log message ***
@
text
@d47 1
a47 2
<a href="http://www.openbsd.org/anoncvs.html">
http://www.openbsd.org/anoncvs.html</a>にあります。
d509 1
a509 1
Originally [OpenBSD: checklist.html,v 1.58 ]
d511 1
a511 1
$Translation: checklist.html,v 1.12 2004/02/13 18:10:06 toshi Exp $
d513 1
a513 1
$OpenBSD: checklist.html,v 1.58 2004/02/13 07:49:52 david Exp $
@


1.10
log
@Sync with Steelix CVS
@
text
@d11 1
a11 1
<title>OpenBSD Porting チェックリスト</title>
d17 1
a17 1
<h2><font color="#e00000">OpenBSD Porting チェックリスト</font></h2>
d20 1
a20 1
これを作業項目の覚え書きとして使うと便利です。しかし、完璧に誓騎里箸いΔ錣韻任發覆い掘
箋甬あなたの ports の置く場所を(訳注: ports ツリー全体の中のどこかに) 決め、
d86 1
a86 1
もっと複雑な ports には、さらに他のオプションやツールを使うこともできます。
d100 1
a100 1
よって、混乱を避けるために、DISTFILESとPATCHFILES にははっきりと分かるバージョン番号が含まれているべきです。
d105 1
a105 1
/usr/ports/distfiles を必要以上に散らかさないためにも DIST_SUBDIRを使ってくだ世気ぁ
箟扱
甕宛
追嘖灑嫗追にはバージョン番号を含めてはいけません。ports が最新版に更新されても、いくつかの配布ファイルは変化がないかも知れません。しかし DIST_SUBDIR が変更されていると、すべてダ瀬Ε鵐蹇璽匹靴覆靴討靴泙い泙后
たとえすべての配布ファイルが変更になっていたとしても、同じ DIST_SUBDIR を使う方がユーザが port を追いかけるのに便利です。
d133 1
a133 1
(そして、それはかなり怪しい動作をして、とてつもなく分かりにくくなるでしょう)。
d144 1
a144 1
portをビルドするためにしなければいけないことと、そのとき必要となるかも知れない
d165 6
a170 1
<code>/usr/local/share/DISTNAME/</code> にそのライセンスを置くことをお薦めします。
d185 1
a185 1
変数に追加する場合には CONFIGURE_ARGS+= を使いましょう。
d200 1
a200 1
展開しなおして ports にパッチを適用します。
d209 1
a209 1
* の部分は何か意味のある名前にするべきです。パッチが適用されるファイルの名前を
d241 1
a241 1
を繰り返し実行しなおすような作業をしなければいけないかも知れません。
d245 1
a245 1
(もしあれば) 出力をよく読んで Makefile の中のオプションをいじりましょう。
d248 1
a248 1
注意: ホスト依存のファイル (訳注: = ホスト毎に異なる内容を誓瀋蠅垢襪戮侫．ぅ箍教
甓況
ぢライブラリ				/usr/local/lib
   アーキテクチャ依存データ		/usr/local/lib/&lt;name&gt;
   インストールされるincludeファイル:	/usr/local/include or
d274 1
a274 1
   アーキテクチャ非依存のread-onlyファイル:	/usr/local/share/&lt;name&gt;
d276 1
d288 1
a288 1
一誓敲儿垢気譴覆い茲Δ砲垢襪戮任后
箜外
甞外
竟鶯がバイナリを strip するコードをもともと含んでいる場合にはそれを使いましょう
d412 1
a412 1
あなたのためにいろいろなプラットフォームで ports をテストしてくれる人を捕まえましょう。
d424 1
a424 1
直した新しい ports をもう一度テストしてフィードバックを返してくれる人を捕まえましょう。
d429 1
a429 1
誰かに commit してくれるように頼んでくだ世気ぁ
箚概
甦概
∫逅闥槇ぢを使います。import は 1.1.1.1 というような
d447 1
a447 1
	<I>YourName</I> <I>YourName_YYYY-MMM-DD</I>
d493 1
a493 1
メンテナは自分の ports を最新に保つように努力するべきです。
d510 1
a510 1
Originally [OpenBSD: checklist.html,v 1.55 ]
d512 1
a512 1
$Translation: checklist.html,v 1.9 2004/01/02 09:42:16 toshi Exp $
d514 1
a514 1
$OpenBSD: checklist.html,v 1.55 2004/01/02 02:51:54 jose Exp $
@


1.9
log
@Sync with Steelix CVS
@
text
@d9 1
a9 1
<meta name="copyright" content="This document copyright 1998-2003 by OpenBSD.">
d504 1
a504 1
Originally [OpenBSD: checklist.html,v 1.54 ]
d506 1
a506 1
$Translation: checklist.html,v 1.8 2003/12/05 12:24:18 toshi Exp $
d508 1
a508 1
$OpenBSD: checklist.html,v 1.54 2003/12/05 10:22:47 jmc Exp $
@


1.8
log
@Sync with Steelix CVS
@
text
@d153 1
a153 1
PERMIT_PACKAGE_CDROMはパッケージをCDROMに収録しても良いことを示します。
d155 1
a155 1
PERMIT_PACKAGE_FTPはパッケージをFTPサイトに置いても良いことを示します。
d157 1
a157 1
PERMIT_DISTFILES_CDROMはdistfileをCDROMに収録しても良いことを示します。
d159 1
a159 1
PERMIT_DISTFILES_FTPはdistfileをFTPサイトに置いても良いことを示します。
d300 1
a300 1
<strong>`a' や `as' を使用したあいまいな意味の文を書いてはいけません。
d326 1
a326 1
そうでない場合には、portのMakefileにそのルールを追加してくだ世気ぁ
箚温
甦温
∫逅闥槇を使います。import は 1.1.1.1 というような
d431 1
a431 1
どれかのファイルを変更 (つまり編集して cvs commit) すればそれは1.2になり、そのファイルが使用されます。
d504 1
a504 1
Originally [OpenBSD: checklist.html,v 1.53 ]
d506 1
a506 1
$Translation: checklist.html,v 1.7 2003/11/18 16:38:52 toshi Exp $
d508 1
a508 1
$OpenBSD: checklist.html,v 1.53 2003/11/18 03:51:14 jose Exp $
@


1.7
log
@sync with steelix translation CVS
@
text
@d9 1
a9 1
<meta name="copyright" content="This document copyright 1998-2002 by OpenBSD.">
d14 1
a14 1
<body text=Black bgcolor=White link="#23238E">
d29 1
a29 1
<a href="mailto:ports@@openbsd.org"> ports@@openbsd.org</a> を講読しましょう。
d499 2
a500 2
<a href="porting.html"><img height=24 width=24 src=../back.gif
 border=0 alt=Porting></a> 
d504 1
a504 1
Originally [OpenBSD: checklist.html,v 1.52 ]
d506 1
a506 1
$Translation: checklist.html,v 1.6 2003/11/02 15:22:14 toshi Exp $
d508 1
a508 1
$OpenBSD: checklist.html,v 1.52 2003/10/31 22:31:19 margarida Exp $
@


1.6
log
@Sync with Steelix CVS
@
text
@@


1.5
log
@sync with steelix translation CVS
@
text
@d222 2
a223 2
そのパッチの役割についての短い誓睫誓文と OpenBSDのCVS tag <code>&#36;OpenBSD&#36;</code>
をパッチファイルのパッチ自身の前に付けてくだ世気ぁ
箋梓
甬梓
蜃蜴瘡踟緕帯頂蒹站跚齡讙窺輝
箋斡
甬斡
ぴ鱇銖赱闔竏繝謖蜩蔗迪旭劾斡厩些浦温闢蓍
箋宛
甬宛
は鞳鄲喞竏繝謖蜩蔗迪屋鯵強臆該牡些齡祷

窺跫齷釿蜚齡繞跚瘤鼬癆蜿置
絶咳箋梓
甬梓
蜃蜴瘡踟緕帯頂蒹站跚齡讙窺軌
箋斡
甬斡
ぴ鱇銖赱闔竏繝謖蜩蔗迪旭劾斡欝艮刑葦闢蓍
箋宛
甬宛
は鞳鄲喞竏繝謖蜩蔗迪屋鯵強芦穏街魂褊赱祷

窺跫齷釿蜚齡繞跚瘤鼬癆蜿置
絶害甞俺
これに関しては、<a href="porting.html#security">OpenBSD のセキュリティ勧告</a>
d499 1
a499 1
Originally [OpenBSD: checklist.html,v 1.49 ]
d501 1
a501 1
$Translation: checklist.html,v 1.3 2003/05/11 07:09:11 toshi Exp $
d503 1
a503 1
$OpenBSD: checklist.html,v 1.49 2003/05/11 04:59:48 cannings Exp $
@


1.2
log
@
sync with steelix translation CVS
@
text
@d52 1
a52 1
そこに基本的な構造を作ります。
d58 1
a58 1
<code>patches、pkg</code> ディレクトリを作りましょう。
d60 1
a60 1
空のファイル <code>pkg/DESCR、pkg/PLIST</code> を作りましょう。
d189 2
a190 2
何らかのエラーで終了してしまった場合にはパッチを作る必要があります。
どんな変更が必要であるかを調べパッチを作ってくだ世気ぁ
箟慌
甕慌
パッチは ${WRKDIST} からの相対パスになるように作らなければなりません。
d199 1
a199 1
さあ、何回でも <b>make build</b> してからパッチを作り
d214 1
a214 1
パッチを作るには、<b>make update-patches</b> を使用しましょう。
d216 1
a216 1
すべてのパッチは ${WRKDIST} からの相対パスで作られる必要があります。
d342 1
a342 1
pkg/PLIST を作りましょう。インストール終了後、PLIST ファイルを
d390 1
a390 1
パッケージを作るには、ports を誓気靴ぅ鵐好函璽襪靴討
箚蔚
甦蔚
最後に作った ports を "ports" ツリーに入れます。CVS に書き込む権限を持っていない場合には、
d428 1
a428 1
簡単にいうと、import は、普通、ports を作ったときに使用されます。
d492 1
a492 1
OpenBSD の "ports" を作る仕掛けを支えてくれているみなさんに感謝します。
d499 1
a499 1
Originally [OpenBSD: checklist.html,v 1.48 ]
d501 1
a501 1
$Translation: checklist.html,v 1.2 2003/05/04 17:33:03 jufi Exp $
d503 1
a503 1
$OpenBSD: checklist.html,v 1.48 2003/04/11 02:46:22 david Exp $
@


1.1
log
@
sync with steelix translation CVS
@
text
@d15 1
a15 1
<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="images/smalltitle.gif" border="0"></a>
d501 1
a501 1
$Translation: checklist.html,v 1.1 2003/04/15 14:09:52 toshi Exp $
@

